{"version":3,"sources":["views/gmx-test/img/ddl/ic_eth_40.svg","views/gmx-test/img/ddl sync /^/ic_.*_40/.svg$","views/gmx-test/img/DROP_DOWN.svg","views/gmx-test/img/ddl/icon_dollar.svg","views/gmx-test/img/ddl/icon_dollar_active.svg","views/gmx-test/img/ddl/icon_market.svg","views/gmx-test/img/ddl/icon_market_active.svg","views/gmx-test/img/ddl/icon_trigger.svg","views/gmx-test/img/ddl/icon_trigger_active.svg","views/gmx-test/img/ddl/icon_withdraw.svg","views/gmx-test/img/ddl/icon_withdraw_active.svg","views/gmx-test/img/ddl/long.svg","views/gmx-test/img/ddl/long_active.svg","views/gmx-test/img/ddl/short.svg","views/gmx-test/img/ddl/short_active.svg","views/gmx-test/img/gmx-logo-with-name.svg","views/gmx-test/img/ic_discord.svg","views/gmx-test/img/ic_github.svg","views/gmx-test/img/ic_gmx_footer.svg","views/gmx-test/img/ic_medium.svg","views/gmx-test/img/ic_telegram.svg","views/gmx-test/img/ic_twitter.svg","views/gmx-test/img/position-share-bg.png","views/gmx-test/img/swap.svg","views/gmx-test/img/coinbaseWallet.png","views/gmx-test/img/ddl/ic_btc_40.svg","views/gmx-test/img/ddl/ic_dai_40.svg","views/gmx-test/img/ddl/ic_frax_40.svg","views/gmx-test/img/ddl/ic_link_40.svg","views/gmx-test/img/ddl/ic_uni_40.svg","views/gmx-test/img/ddl/ic_usdc_40.svg","views/gmx-test/img/ddl/ic_usdt_40.svg","views/gmx-test/img/ddl/ic_weth_40.svg","views/gmx-test/img/ic_arbitrum_24.svg","views/gmx-test/img/ic_avalanche_24.svg","views/gmx-test/img/ic_avax_24.svg","views/gmx-test/img/ic_btc.b_24.svg","views/gmx-test/img/ic_btc_24.svg","views/gmx-test/img/ic_busd_24.svg","views/gmx-test/img/ic_dai_24.svg","views/gmx-test/img/ic_eth_24.svg","views/gmx-test/img/ic_frax_24.svg","views/gmx-test/img/ic_glp_24.svg","views/gmx-test/img/ic_gmx_24.svg","views/gmx-test/img/ic_link_24.svg","views/gmx-test/img/ic_mim_24.svg","views/gmx-test/img/ic_settings_24.svg","views/gmx-test/img/ic_tether_24.svg","views/gmx-test/img/ic_uni_24.svg","views/gmx-test/img/ic_usdc.e_24.svg","views/gmx-test/img/ic_usdc_24.svg","views/gmx-test/img/ic_usdt_24.svg","views/gmx-test/img/ic_wallet_24.svg","views/gmx-test/img/ic_wavax_24.svg","views/gmx-test/img/ic_weth_24.svg","views/gmx-test/img/metamask.png","views/gmx-test/img/walletconnect-circle-blue.svg","views/gmx-test/img sync /^/.*$","views/gmx-test/img/Anyswap.png","views/gmx-test/img/Anyswap.svg","views/gmx-test/img/Artwork.svg","views/gmx-test/img/Artwork_gmx.svg","views/gmx-test/img/Banxa.png","views/gmx-test/img/Hop.png","views/gmx-test/img/Hop.svg","views/gmx-test/img/Hop_dark.png","views/gmx-test/img/Hop_dark.svg","views/gmx-test/img/Synapse.png","views/gmx-test/img/Synapse.svg","views/gmx-test/img/binance.png","views/gmx-test/img/bscscan.png","views/gmx-test/img/btn_big_arbitrum.png","views/gmx-test/img/btn_big_avalanche.png","views/gmx-test/img/btn_big_bsc.png","views/gmx-test/img/btn_big_purchasegmx.png","views/gmx-test/img/btn_big_purchasegmx.svg","views/gmx-test/img/buy_gmx.svg","views/gmx-test/img/buy_gmx_bond.svg","views/gmx-test/img/buy_transfer_eth.svg","views/gmx-test/img/coingecko.png","views/gmx-test/img/cross.svg","views/gmx-test/img/ddl/chevron-down.svg","views/gmx-test/img/ddl/chevron-down_sm.svg","views/gmx-test/img/ddl/ic_btc_40.png","views/gmx-test/img/ddl/ic_dai_40.png","views/gmx-test/img/ddl/ic_eth_40.png","views/gmx-test/img/ddl/ic_frax_40.png","views/gmx-test/img/ddl/ic_link_40.png","views/gmx-test/img/ddl/ic_uni_40.png","views/gmx-test/img/ddl/ic_usdc_40.png","views/gmx-test/img/ddl/ic_usdt_40.png","views/gmx-test/img/ddl/ic_weth_40.png","views/gmx-test/img/ddl/icon_arrow.svg","views/gmx-test/img/ddl/icon_check.svg","views/gmx-test/img/ddl/icon_close.svg","views/gmx-test/img/ddl/icon_close_sm.svg","views/gmx-test/img/ddl/icon_close_toast.svg","views/gmx-test/img/ddl/lock.svg","views/gmx-test/img/flag_en.svg","views/gmx-test/img/flag_es.svg","views/gmx-test/img/flag_fr.svg","views/gmx-test/img/flag_ja.svg","views/gmx-test/img/flag_ko.svg","views/gmx-test/img/flag_ru.svg","views/gmx-test/img/flag_zh.svg","views/gmx-test/img/glp_icon.svg","views/gmx-test/img/gmx-logo-final-white-small.png","views/gmx-test/img/gmx-logo-final-white.png","views/gmx-test/img/gmx-logo-final.png","views/gmx-test/img/gmx-logo-glow.png","views/gmx-test/img/gmx_logo.svg","views/gmx-test/img/graphite-01.png","views/gmx-test/img/ic-communityproject.svg","views/gmx-test/img/ic_arbitrum_16.svg","views/gmx-test/img/ic_arbitrum_96.svg","views/gmx-test/img/ic_arbitrum_hover_16.svg","views/gmx-test/img/ic_arrowleft16.svg","views/gmx-test/img/ic_arrowright16.svg","views/gmx-test/img/ic_avalanche_16.svg","views/gmx-test/img/ic_avalanche_96.svg","views/gmx-test/img/ic_avax_30.svg","views/gmx-test/img/ic_avax_40.svg","views/gmx-test/img/ic_banxa.svg","views/gmx-test/img/ic_binance_logo.svg","views/gmx-test/img/ic_bsc.svg","views/gmx-test/img/ic_bsc_96.svg","views/gmx-test/img/ic_btc.b_40.svg","views/gmx-test/img/ic_btc_40.svg","views/gmx-test/img/ic_buy_glp.svg","views/gmx-test/img/ic_cash.png","views/gmx-test/img/ic_cash.svg","views/gmx-test/img/ic_checked.svg","views/gmx-test/img/ic_coingecko_16.svg","views/gmx-test/img/ic_coingecko_hover_16.svg","views/gmx-test/img/ic_convert_down.svg","views/gmx-test/img/ic_copy_16.svg","views/gmx-test/img/ic_cost.svg","views/gmx-test/img/ic_dai_40.svg","views/gmx-test/img/ic_eth_40.svg","views/gmx-test/img/ic_frax_40.svg","views/gmx-test/img/ic_glp_40.svg","views/gmx-test/img/ic_glp_custom.svg","views/gmx-test/img/ic_gmx.svg","views/gmx-test/img/ic_gmx_30.svg","views/gmx-test/img/ic_gmx_40.svg","views/gmx-test/img/ic_gmx_64.svg","views/gmx-test/img/ic_gmx_arbitrum.svg","views/gmx-test/img/ic_gmx_avax.svg","views/gmx-test/img/ic_gmx_big.svg","views/gmx-test/img/ic_gmx_custom.svg","views/gmx-test/img/ic_hop.svg","views/gmx-test/img/ic_info.svg","views/gmx-test/img/ic_language24.svg","views/gmx-test/img/ic_link_40.svg","views/gmx-test/img/ic_liquidity.svg","views/gmx-test/img/ic_menu_dots.svg","views/gmx-test/img/ic_metamask_16.svg","views/gmx-test/img/ic_metamask_hover_16.svg","views/gmx-test/img/ic_mim_40.svg","views/gmx-test/img/ic_multiswap.svg","views/gmx-test/img/ic_new_link_16.svg","views/gmx-test/img/ic_olympus.svg","views/gmx-test/img/ic_olympus_arbitrum.svg","views/gmx-test/img/ic_selector_dropdowns.svg","views/gmx-test/img/ic_settings_16.svg","views/gmx-test/img/ic_sign in_16.svg","views/gmx-test/img/ic_sign_out_16.svg","views/gmx-test/img/ic_simpleswaps.svg","views/gmx-test/img/ic_stats.svg","views/gmx-test/img/ic_stats_big.svg","views/gmx-test/img/ic_synapse.svg","views/gmx-test/img/ic_tokens.svg","views/gmx-test/img/ic_totaluser.svg","views/gmx-test/img/ic_trading.svg","views/gmx-test/img/ic_transfer_avax.svg","views/gmx-test/img/ic_uni_40.svg","views/gmx-test/img/ic_usdc.e_40.svg","views/gmx-test/img/ic_usdc_40.svg","views/gmx-test/img/ic_usdt_40.svg","views/gmx-test/img/ic_wavax_40.svg","views/gmx-test/img/ic_weth_40.svg","views/gmx-test/img/lg_arbitrum.svg","views/gmx-test/img/logo_GMX.svg","views/gmx-test/img/logo_GMX_small.svg","views/gmx-test/img/long.svg","views/gmx-test/img/metamask-text.svg","views/gmx-test/img/page-not-found.svg","views/gmx-test/img/short.svg","views/gmx-test/img/trading.jpg","views/gmx-test/img/wallet-connect-text.svg","views/gmx-test/img/wave-01.png","views/gmx-test/img/wave-02.png","views/gmx-test/img sync /^/ic_.*_24/.svg$","../ /^/.*/messages/.po$/ groupOptions: {} namespace object","components/UI/logo/Logo.jsx","components/UI/button/Button.jsx","img/icon-wallet.svg","img/icon-link.svg","components/Wallet.jsx","context/context.js","components/utils/wallet.js","components/utils/providers.js","components/utils/contracts.js","components/utils/sepThousands.js","components/utils/math.js","components/utils/stats.js","components/Tabs.jsx","components/UI/modal/Modal.jsx","components/UI/loader/Loader.jsx","components/UI/input/Input.jsx","components/UI/input/NumberInput.jsx","components/Form.jsx","img/icon-usdc.svg","components/UI/modal/RegisterModal.jsx","img/icon-user.svg","components/AccountDroplist.jsx","Header.jsx","Footer.jsx","views/gmx-test/config/Addresses.js","views/gmx-test/config/Tokens.js","views/gmx-test/lib/legacy.js","components/utils/notifications.js","components/utils/constants.js","components/UI/modal/BorrowModal.jsx","components/UI/modal/RepayModal.jsx","components/Currency.jsx","components/MarketInfoBoard.jsx","components/SupplyCard.jsx","components/WithdrawCard.jsx","views/markets/SupplyMarket.jsx","views/gmx-test/config/chains.js","views/gmx-test/domain/common.js","views/gmx-test/lib/contracts/fetcher.ts","views/gmx-test/lib/helperToast.ts","views/gmx-test/components/ToastifyDebug/ToastifyDebug.tsx","views/gmx-test/lib/contracts/transactionErrors.ts","views/gmx-test/lib/contracts/constants.js","views/gmx-test/lib/contracts/utils.ts","views/gmx-test/lib/contracts/callContract.tsx","views/gmx-test/domain/prices.js","views/gmx-test/domain/legacy.js","views/gmx-test/components/Checkbox/Checkbox.js","views/gmx-test/config/ui.js","views/gmx-test/components/Tooltip/Tooltip.js","views/gmx-test/components/Tab/Tab.js","views/gmx-test/lib/useLockBodyScroll.ts","views/gmx-test/components/Modal/Modal.js","views/gmx-test/components/Common/Portal.js","views/gmx-test/components/Tooltip/TooltipWithPortal.js","views/gmx-test/components/Exchange/TokenSelector.js","views/gmx-test/components/Exchange/ExchangeInfoRow.js","views/gmx-test/components/StatsTooltip/StatsTooltipRow.tsx","views/gmx-test/components/SlippageInput/SlippageInput.jsx","views/gmx-test/components/Exchange/ConfirmationBox.js","views/gmx-test/components/Exchange/OrdersToa.js","views/gmx-test/components/Referrals/referralsHelper.js","views/gmx-test/domain/referrals.js","views/gmx-test/components/Exchange/NoLiquidityErrorModal.tsx","components/UI/input/NumberInput_v2.jsx","img/icon-repay.svg","views/gmx-test/components/Exchange/SwapBox.js","views/gmx-test/components/Exchange/ChartTokenSelector.js","views/gmx-test/components/Exchange/ExchangeTVChart.js","views/gmx-test/components/Exchange/PositionSeller.js","views/gmx-test/components/Exchange/PositionEditor.js","views/gmx-test/components/Common/SpinningLoader.js","views/gmx-test/components/Exchange/PositionShare.js","views/gmx-test/lib/useLoadImage.js","views/gmx-test/components/Exchange/PositionDropdown.js","views/gmx-test/components/Exchange/CollateralLocked.jsx","views/gmx-test/components/Exchange/PositionsItem.jsx","views/gmx-test/components/Exchange/PositionsList.js","views/gmx-test/components/Exchange/OrderEditor.js","views/gmx-test/components/Exchange/OrdersList.js","views/gmx-test/components/Exchange/TradeHistory.js","views/gmx-test/components/Exchange/ExchangeBanner.js","views/gmx-test/components/Footer/Footer.js","views/gmx-test/components/Exchange/BorrowsItem.jsx","views/gmx-test/components/Exchange/BorrowsList.jsx","views/gmx-test/components/Common/AttentionBox.jsx","components/MarginLevel.jsx","views/gmx-test/pages/Exchange/Exchange.js","views/gmx-test/config/events.js","views/gmx-test/components/EventToast/AnnouncementIcon.js","views/gmx-test/components/EventToast/EventToast.js","views/gmx-test/components/EventToast/useEventToast.js","views/gmx-test/components/EventToast/EventToastContainer.js","views/gmx-test/components/Common/SEO.js","views/gmx-test/components/ModalViews/RedirectModal.js","views/gmx-test/lib/i18n.js","views/gmx-test/App/App.js","views/gmx-test/lib/useRouteQuery.js","img/icon-ETH.svg","img/icon-WBTC.svg","img/icon-dollar.svg","views/MarginAccount.jsx","components/AppRouter.jsx","components/UI/warning/Warning.jsx","App.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","webpackAsyncContext","Promise","then","ids","t","Logo","className","href","Button","children","disabled","clickHandler","isMain","props","classes","cx","btnActive","childProps","toString","Wallet","addr","address","setAddress","setAccount","useState","open","setOpen","closeWallet","document","removeEventListener","onClick","stopPropagation","addEventListener","src","icon_wallet","alt","slice","xmlns","width","height","viewBox","fill","clipPath","d","rel","target","icon_link","GlobalStatsContext","createContext","UserStatsContext","ARBITRUM","requestAccount","setWalletAddress","window","ethereum","networkVersion","Number","alert","request","method","params","chainId","ethers","utils","hexlify","location","reload","console","log","chainName","nativeCurrency","symbol","decimals","rpcUrls","blockExplorerUrls","accounts","on","connectWallet","cutAddress","isAdaptive","outerWidth","netProvider","getDefaultProvider","mmProvider","providers","Web3Provider","undefined","signer","getSigner","DDL_ETH_signed","Contract","_DDL_ETH","abi","connect","DDL_BTC_signed","_DDL_BTC","DDL_POOL","_DDL_POOL","DDL_POOL_signed","OptManager","_OptManager","USDC","_USDC","USDC_signed","PriceProviderETH","_PriceProviderETH","PriceProviderBTC","_PriceProviderBTC","DDL_AccountManager","_AccountManager","DDL_AccountManager_abi","DDL_AccountManagerToken","_AccountManagerToken","DDL_GMX","_DDL_GMX","WETH_address","_Vault","_WETH","getDgContract","dgAddress","_Doppelganger","separateThousands","num","symb","str","split","intPart","fractionPart","hasFraction","replace","length","convertInputNum","result","match","substr","removeNonNumeric","sepToNumber","join","floor","fraction","Math","formatForContract","val","getGlobalStats","globalStats","getTotalBalance","totalBalance","toNumber","totalLocked","totalSupplied","round","formatUnits","availToBorrow","totalBorrowed","utilRate","borrowAPY","getUserStats","walletAddress","balanceOf","balance","shareOf","curBalance","avail","min","userStats","getOptionStats","isETH","contract","profitByOption","intrinsicValue","maxBorrowLimit","borrowLimit","borrowedByOption","borrowLimitUsed","currentLiqPrice","liqPrice","realVals","Tabs","links","cls","link","isHidden","linkCls","isActive","isExternal","to","name","Modal","visible","setVisible","resetModal","isObligatory","push","closeModal","onMouseDown","Loader","style","stroke","strokeWidth","strokeLinecap","cy","r","Input","msg","setValue","setBtnActive","type","NumberInput","value","onChange","onBlur","Form","maxVal","inputProps","btnText","btnIsActive","onSubmit","modalVisible","currency","class","state","setState","setVal","useEffect","action","preventDefault","maxWarningMsg","validateForm","isModal","maxOnClick","icon","text","btnIsDisabled","RegisterModal","onRegisterClick","onApproveClick","curStep","isLoading","depositVal","setDepositVal","steps","title","body","btn","placeholder","icon_usdc","step","el","i","AccountDroplist","account","closeAccounts","accountCut","icon_user","strokeLinejoin","acc","Header","registerVisible","setRegisterVisible","setGlobalStats","useContext","setUserStats","registerStep","setRegisterStep","registerLoading","userAddress","hot","hegicOperationalTreasury","HegicOperationalTreasury","iface","Interface","OptionsManager","strategyMap","Map","HegicStrategyATM_CALL_ETH","HegicStrategyOTM_CALL_110_ETH","HegicStrategyOTM_CALL_120_ETH","HegicStrategyOTM_CALL_130_ETH","HegicStrategyATM_CALL_BTC","HegicStrategyOTM_CALL_110_BTC","HegicStrategyOTM_CALL_120_BTC","HegicStrategyOTM_CALL_130_BTC","HegicStrategyATM_PUT_ETH","HegicStrategyOTM_PUT_70_ETH","HegicStrategyOTM_PUT_80_ETH","HegicStrategyOTM_PUT_90_ETH","HegicStrategyATM_PUT_BTC","HegicStrategyOTM_PUT_70_BTC","HegicStrategyOTM_PUT_80_BTC","HegicStrategyOTM_PUT_90_BTC","transferTopics","encodeFilterTopics","getLogs","transferLogs","arrObj","event","decodeData","decodeEventLog","data","topics","lockedLiquidity","tokenId","lockL","includes","expiration","Date","now","strategyInf","get","strategy","HegicStrategy","inf","strategyData","amount","strike","res","isCALL","PriceProvider","latestRoundData","curPrice","diff","priorLiqPrice","stats","loc","useLocation","nav","useNavigate","headerLinks","getOptionByUser","options","pathname","find","startsWith","Footer","rx","fillRule","clipRule","CONTRACTS","Treasury","BUSD","GMT","Vault","Router","Reader","AmmFactory","AmmFactoryV2","OrderBook","OrderBookReader","GmxMigrator","USDG","NATIVE_TOKEN","XGMT","GMT_USDG_PAIR","XGMT_USDG_PAIR","GMT_USDG_FARM","XGMT_USDG_FARM","USDG_YIELD_TRACKER","XGMT_YIELD_TRACKER","GMT_USDG_FARM_TRACKER_XGMT","GMT_USDG_FARM_TRACKER_NATIVE","XGMT_USDG_FARM_TRACKER_XGMT","XGMT_USDG_FARM_TRACKER_NATIVE","AUTO","AUTO_USDG_PAIR","AUTO_USDG_FARM","AUTO_USDG_FARM_TRACKER_XGMT","AUTO_USDG_FARM_TRACKER_NATIVE","GMT_GMX_IOU","XGMT_GMX_IOU","GMT_USDG_GMX_IOU","XGMT_USDG_GMX_IOU","VaultReader","GlpManager","RewardRouter","RewardReader","GLP","GMX","ES_GMX","BN_GMX","ES_GMX_IOU","StakedGmxTracker","BonusGmxTracker","FeeGmxTracker","StakedGlpTracker","FeeGlpTracker","StakedGmxDistributor","StakedGlpDistributor","GmxVester","GlpVester","PositionRouter","PositionManager","ReferralStorage","ReferralReader","OrderExecutor","UniswapGmxEthPool","TraderJoeGmxAvaxPool","getContract","TOKENS","coingeckoUrl","imageUrl","constants","AddressZero","isNative","isWrapped","baseSymbol","isUsdg","isStable","isShortable","isTempHidden","ADDITIONAL_TOKENS","CHAIN_IDS","TOKENS_MAP","TOKENS_BY_SYMBOL_MAP","j","tokens","concat","token","WRAPPED_TOKENS_MAP","NATIVE_TOKENS_MAP","getWrappedToken","getNativeToken","getTokens","isValidToken","getToken","getTokenBySymbol","getWhitelistedTokens","filter","MAINNET","createRandom","AVALANCHE","ARBITRUM_TESTNET","DEFAULT_CHAIN_ID","SELECTED_NETWORK_LOCAL_STORAGE_KEY","IS_NETWORK_DISABLED","CHAIN_NAMES_MAP","alchemyWhitelistedDomains","ARBITRUM_RPC_PROVIDERS","AVALANCHE_RPC_PROVIDERS","WALLET_CONNECT_LOCALSTORAGE_KEY","SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY","CURRENT_PROVIDER_LOCALSTORAGE_KEY","LANGUAGE_LOCALSTORAGE_KEY","getChainName","USDG_ADDRESS","BASIS_POINTS_DIVISOR","MAX_LEVERAGE","MAX_ALLOWED_LEVERAGE","USDG_DECIMALS","USD_DECIMALS","DUST_BNB","DUST_USD","expandDecimals","PRECISION","DEFAULT_MAX_USDG_AMOUNT","TAX_BASIS_POINTS","MARGIN_FEE_BASIS_POINTS","LIQUIDATION_FEE","THRESHOLD_REDEMPTION_VALUE","FUNDING_RATE_PRECISION","SWAP","INCREASE","DECREASE","LONG","SHORT","MARKET","LIMIT","STOP","BORROW","LEVERAGE_ORDER_OPTIONS","SWAP_ORDER_OPTIONS","SWAP_OPTIONS","DEFAULT_SLIPPAGE_AMOUNT","SLIPPAGE_BPS_KEY","REFERRAL_CODE_KEY","REFERRAL_CODE_QUERY_PARAM","TRIGGER_PREFIX_ABOVE","TRIGGER_PREFIX_BELOW","HIGH_EXECUTION_FEES_MAP","coingecko","arbitrum","ETH","BTC","LINK","UNI","USDT","DAI","MIM","FRAX","avalanche","AVAX","supportedChainIds","isDevelopment","injectedConnector","InjectedConnector","getWalletConnectConnector","localStorage","getItem","WalletConnectConnector","rpc","qrcode","deserialize","entries","key","_type","bigNumberify","isHomeSite","process","REACT_APP_IS_HOME_SITE","helperToast","content","opts","toast","dismiss","success","error","useLocalStorageByChainId","defaultValue","useLocalStorage","internalValue","setInternalValue","useCallback","useLocalStorageSerializeKey","JSON","stringify","getLiquidationPriceFromDelta","liquidationAmount","size","collateral","averagePrice","isLong","eq","gt","priceDelta","sub","mul","div","add","replaceNativeTokenAddress","path","nativeTokenAddress","updatedPath","getMarginFee","sizeDelta","afterFeeUsd","getServerBaseUrl","hostname","fromLocalStorage","getServerUrl","isTriggerRatioInverted","fromTokenInfo","toTokenInfo","maxPrice","lt","getExchangeRate","tokenAInfo","tokenBInfo","inverted","minPrice","getMostAbundantStableToken","infoTokens","availableAmount","whitelistedTokens","stableToken","info","getTokenInfo","adjustedAvailableAmount","adjustForDecimals","shouldInvertTriggerRatio","tokenA","tokenB","getExchangeRateDisplay","rate","rateValue","formatAmount","omitSymbols","adjustForDecimalsFactory","n","number","divDecimals","mulDecimals","getFeeBasisPoints","usdgDelta","feeBasisPoints","taxBasisPoints","increment","usdgSupply","totalTokenWeights","usdgAmount","initialAmount","nextAmount","targetAmount","weight","getTargetUsdgAmount","initialDiff","nextDiff","rebateBps","averageDiff","taxBps","getNextFromAmount","toAmount","fromTokenAddress","toTokenAddress","toTokenPriceUsd","ratio","forSwap","fromTokenMinPrice","toTokenMaxPrice","fromToken","toToken","contractMinPrice","contractMaxPrice","fromAmountBasedOnRatio","adjustDecimals","isZero","fromAmount","swapFeeBasisPoints","feeBasisPoints0","feeBasisPoints1","getNextToAmount","toAmountBasedOnRatio","getSwapFeeBasisPoints","redemptionAmount","expectedAmount","getProfitPrice","closePrice","position","profitPrice","calculatePositionDelta","price","lastIncreasedTime","delta","pendingDelta","minProfitExpired","hasProfit","lte","deltaPercentage","pendingDeltaPercentage","getDeltaStr","deltaStr","deltaPercentageStr","getLeverage","increaseSize","collateralDelta","increaseCollateral","entryFundingRate","cumulativeFundingRate","includeDelta","nextSize","gte","remainingCollateral","fundingFee","getLiquidationPrice","adjustedDelta","positionFee","liquidationPriceForFees","liquidationPriceForMaxLeverage","getUsd","tokenAddress","max","orderOption","triggerPriceUsd","getTriggerPrice","getPositionKey","collateralTokenAddress","indexTokenAddress","getPositionContractKey","collateralToken","indexToken","solidityKeccak256","BSC_RPC_PROVIDERS","RPC_PROVIDERS","FALLBACK_PROVIDERS","host","formatDateTime","time","formatDateFn","activateInjectedProvider","providerName","isCoinbaseWallet","isMetaMask","provider","setSelectedProvider","getInjectedConnector","useChainId","useWeb3React","chainIdFromLocalStorage","parseInt","removeItem","clearWalletConnectData","clearWalletLinkData","x","getProvider","library","_","sample","StaticJsonRpcProvider","getFallbackProvider","BigNumber","from","pow","limitDecimals","maxDecimals","amountStr","dotIndex","indexOf","_parseOrdersData","ordersData","indexes","extractor","uintPropsLength","addressPropsLength","uintProps","addressProps","count","orders","sliced","order","index","parseDecreaseOrdersData","decreaseOrdersData","triggerPrice","triggerAboveThreshold","parseIncreaseOrdersData","increaseOrdersData","purchaseToken","purchaseTokenAmount","parseSwapOrdersData","swapOrdersData","shouldUnwrap","amountIn","minOut","triggerRatio","every","tokenDecimals","displayDecimals","useCommas","minDecimals","padEnd","padDecimals","numberWithCommas","formatAmountFree","parseFloat","trimZeroDecimals","parseValue","pValue","isNaN","parseUnits","parts","getExplorerUrl","usePrevious","ref","useRef","current","approveTokens","setIsApproving","spender","onApproveSubmitted","pendingTxns","setPendingTxns","includeMessage","Token","approve","MaxUint256","txUrl","hash","pendingTxn","message","catch","failMsg","finally","shouldRaiseGasError","replaceNative","NETWORK_METADATA","addNetwork","metadata","switchNetwork","active","setItem","chainIdHex","setTokenUsingIndexPrices","indexPrices","indexPrice","indexPriceBn","spreadBps","MAX_PRICE_DEVIATION_BASIS_POINTS","minPrimaryPrice","halfSpreadBps","getInfoTokens","tokenBalances","vaultTokenInfo","fundingRateInfo","vaultPropsLength","parse","poolAmount","reservedAmount","bufferAmount","maxUsdgAmount","globalShortSize","maxGlobalShortSize","maxGlobalLongSize","guaranteedUsd","maxPrimaryPrice","maxAvailableShort","hasMaxAvailableShort","availableUsd","maxAvailableLong","hasMaxAvailableLong","remainingLongSize","maxLongCapacity","managedUsd","managedAmount","fundingRate","CHART_PERIODS","sleep","ms","isAddressZero","isLocal","getAppBaseUrl","getPositionForOrder","positionsMap","getOrderError","positionForOrder","notifySuccess","url","errAlert","err","setIsLoading","reason","APY","BorrowModal","available","updateOptionStats","option","setStep","inputVal","setInputVal","setLiqPrice","oldLiqPrice","setOldLiqPrice","positionStats","setPositionStats","setBorrowLimit","borrowed","setBorrowed","borrowedByCollateral","ddl","keyId","curInputVal","classic","prior","positionProfit","input","loanToValue","entryPrice","isFinite","multiplier","borderPrice","wait","lockOption","lockCollateral","borrow","toFixed","tipText","isVisible","RepayModal","repay","setRepay","calculateUpcomingFee","fee","Infinity","proceedRepay","approveUSDC","unlock","isStep","Currency","MarketInfoBoard","SupplyCard","tsc","provideFrom","WithdrawCard","withdraw","SupplyMarket","supplyStep","setSupplyStep","parseEther","nativeTokenSymbol","defaultCollateralSymbol","defaultFlagOrdersEnabled","positionReaderPropsLength","v2","SWAP_ORDER_EXECUTION_GAS_FEE","INCREASE_ORDER_EXECUTION_GAS_FEE","DECREASE_ORDER_EXECUTION_GAS_FEE","wrappedTokenSymbol","getConstant","chainlinkClient","createClient","arbitrumGraphClient","avalancheGraphClient","arbitrumReferralsGraphClient","avalancheReferralsGraphClient","uri","ApolloClient","cache","InMemoryCache","fetcher","contractInfo","additionalArgs","args","arg0","arg1","isAddress","contractCall","getContractCall","shouldCallFallback","handleFallback","reject","fallbackProvider","contractName","setTimeout","ToastifyDebug","old","NOT_ENOUGH_FUNDS","USER_DENIED","SLIPPAGE","RPC_ERROR","TX_ERROR_PATTERNS","extractError","ex","patterns","pattern","matchCode","matchMessage","GAS_PRICE_ADJUSTMENT_MAP","MAX_GAS_PRICE_MAP","setGasPrice","txnOpts","maxGasPrice","premium","getGasPrice","gasPrice","getFeeData","feeData","maxPriorityFeePerGas","maxFeePerGas","getGasLimit","estimateGas","gasLimit","callContract","Array","isArray","sentMsg","hideSuccessMsg","successMsg","autoCloseToast","errorData","originalError","autoClose","FEED_ID_MAP","BTC_USD","ETH_USD","BNB_USD","LINK_USD","UNI_USD","SUSHI_USD","AVAX_USD","AAVE_USD","YFI_USD","SPELL_USD","timezoneOffset","getTimezoneOffset","getChartPricesFromStats","period","timeDiff","done","fetch","lastEx","ok","status","statusText","json","prices","OBSOLETE_THRESHOLD","updatedAt","toISOString","close","c","high","h","low","l","getChainlinkChartPricesFromGraph","tokenSymbol","marketName","feedId","requests","query","gql","all","chunks","uniqTs","Set","forEach","chunk","rounds","item","has","unixTimestamp","sort","periodTime","candles","first","prevTsGroup","prevPrice","ts","tsGroup","getCandlesFromPrices","useChartPrices","currentAveragePrice","swrKey","useSWR","warn","dedupingInterval","focusThrottleInterval","updatePrices","mutate","currentAveragePriceString","retPrices","useMemo","periodSeconds","priceData","getStablePriceData","_prices","currentCandleTime","last","averagePriceValue","newCandle","appendCurrentAveragePrice","newPrices","prevTime","fillGaps","getGmxGraphClient","invariant","condition","errorMsg","useMinExecutionFee","positionRouterAddress","minExecutionFee","finalExecutionFee","estimatedExecutionFee","finalExecutionFeeUSD","isFeeHigh","getHighExecutionFee","minExecutionFeeUSD","minExecutionFeeErrorMessage","useHasOutdatedUi","hasOutdatedUi","approvePlugin","pluginAddress","routerAddress","createSwapOrder","executionFee","shouldWrap","orderBookAddress","fromETH","createDecreaseOrder","cancelSwapOrder","cancelDecreaseOrder","cancelIncreaseOrder","handleCancelOrder","func","cancelMultipleOrders","getIndexes","ordersWithTypes","allIndexes","groupBy","v","updateDecreaseOrder","updateIncreaseOrder","updateSwapOrder","Checkbox","isChecked","setIsChecked","selected","IS_TOUCH","Tooltip","enabled","intervalCloseRef","intervalOpenRef","trigger","onMouseEnter","clearInterval","onMouseClick","onMouseLeave","disableHandleStyle","handleClassName","handle","renderContent","Tab","setOption","optionLabels","icons","disabledTooltip","opt","disabledNode","label","disabledList","TOUCH_MOVE_CONTAINER_CLASS_NAME","allowTouchMoveFn","parentElement","setIsVisible","zIndex","onAfterOpen","allowContentTouchMove","disableBodyScrollLock","isNifty","modalRef","disableLock","disableBodyScroll","allowTouchMove","enableBodyScroll","clearAllBodyScrollLocks","useLockBodyScroll","keyCode","AnimatePresence","motion","initial","animate","exit","variants","hidden","opacity","visibility","transition","duration","overflow","fontSize","transformStyle","transformOrigin","transform","Portal","root","createElement","appendChild","removeChild","createPortal","TooltipWithPortal","coords","setCoords","tooltipWidth","setTooltipWidth","handlerRef","updateTooltipCoords","rect","getBoundingClientRect","left","top","y","scrollY","fitHandleWidth","closeOnDoubleClick","TokenSelector","isModalVisible","setIsModalVisible","searchKeyword","setSearchKeyword","tokenInfo","mintingCap","showMintingCap","selectedTokenLabel","showBalances","showTokenImgInDropdown","showSymbolImage","showNewCaret","getTokenState","visibleTokens","onSelectToken","tokenImage","require","toLowerCase","filteredTokens","tokenIndex","tokenPopupImage","mintAmount","tokenState","portalClassName","default","dropDownIcon","ExchangeInfoRow","isTop","isWarning","StatsTooltipRow","showDollar","SlippageInput","onFocus","classList","remove","HIGH_SPREAD_THRESHOLD","ConfirmationBox","fromTokenUsd","toTokenUsd","isSwap","isMarketOrder","isShort","isHigherSlippageAllowed","setIsHigherSlippageAllowed","onConfirmationClick","setIsConfirming","shortCollateralAddress","hasExistingPosition","leverage","existingPosition","existingLiquidationPrice","displayLiquidationPrice","shortCollateralToken","isPendingConfirmation","fees","feesUsd","isSubmitting","fromUsdMin","toUsdMax","nextAveragePrice","feeBps","savedSlippageAmount","isProfitWarningAccepted","setIsProfitWarningAccepted","isTriggerWarningAccepted","setIsTriggerWarningAccepted","isLimitOrdersVisible","setIsLimitOrdersVisible","onCancelOrderClick","collateralAfterFees","existingOrder","wrappedToken","sameToken","existingOrders","existingTriggerOrders","decreaseOrdersThatWillBeExecuted","markPrice","getError","hasPendingProfit","spread","fromSpread","toSpread","isHigh","getSpread","showSpread","userSlippage","setUserSlippage","allowedSlippage","renderSpreadWarning","renderFeeWarning","MIN_PROFIT_TIME","renderMinProfitWarning","renderExistingOrderWarning","sizeInToken","p","triggerPricePrefix","renderExistingTriggerErrors","existingTriggerOrderLength","orderText","renderExistingTriggerWarning","renderMain","renderExecutionFee","renderAvailableLiquidity","availableLiquidity","isLiquidityRisk","riskThresholdBps","poolWithoutBuffer","adjustedMaxGlobalShortSize","sizeTokens","renderMarginSection","renderSwapSection","getPrimaryText","OrdersToa","isPluginApproving","approveOrderBook","REGEX_VERIFY_BYTES32","getGraphClient","decodeReferralCode","hexCode","parseBytes32String","substring","String","fromCharCode","trim","encodeReferralCode","final","HashZero","formatBytes32String","useUserReferralCode","localStorageCode","referralStorageAddress","onChainCode","localStorageCodeOwner","test","attachedOnChain","userReferralCode","userReferralCodeString","NoLiquidityErrorModal","outputCurrency","modalError","setModalError","nativeToken","inputCurrency","swapTokenSymbol","oneInchSwapUrl","rootUrl","get1InchSwapUrl","Boolean","NumberInput_v2","hasError","hasFocus","setHasFocus","SWAP_ICONS","longImg","shortImg","swapImg","longActiveImg","shortActiveImg","SwapBox","positions","pendingPositions","setPendingPositions","setFromTokenAddress","setToTokenAddress","swapOption","setSwapOption","tokenSelection","setTokenSelection","isConfirming","setIsPendingConfirmation","flagOrdersEnabled","savedIsPnlInLeverage","orderBookApproved","positionRouterApproved","isWaitingForPluginApproval","approvePositionRouter","setIsWaitingForPluginApproval","isWaitingForPositionRouterApproval","setIsWaitingForPositionRouterApproval","isPositionRouterApproving","savedShouldDisableValidationForTesting","ethShortExists","ethLongExists","fromValue","setFromValue","toValue","setToValue","anchorOnFromAmount","setAnchorOnFromAmount","isApproving","isWaitingForApproval","setIsWaitingForApproval","setIsSubmitting","setShortCollateralAddress","leverageOption","setLeverageOption","isLeverageSliderEnabled","hasLeverageOption","ordersToaOpen","setOrdersToaOpen","setOrderOption","positionKey","isBorrow","borrowValue","setBorrowValue","orderOptions","orderOptionLabels","triggerPriceValue","setTriggerPriceValue","stableTokens","toTokens","needOrderBookApproval","prevNeedOrderBookApproval","needPositionRouterApproval","prevNeedPositionRouterApproval","tokenAllowanceAddress","tokenAllowance","Api","fromBalance","toBalance","isPotentialWrap","isWrapOrUnwrap","needApproval","prevFromTokenAddress","prevNeedApproval","prevToTokenAddress","triggerRatioValue","setTriggerRatioValue","triggerRatioInverted","maxToTokenOut","maxToTokenOutUSD","maxFromTokenInUSD","maxFromTokenIn","maxSwapAmountUsd","entryMarkPrice","nextToAmount","nextToValue","nextFromAmount","nextFromValue","updateSwapAmounts","leverageMultiplier","fromUsdMinAfterFee","toNumerator","toDenominator","baseFromAmountUsd","swapFees","updateLeverageAmounts","nextDelta","nextHasProfit","nextPrice","divisor","getNextAveragePrice","liquidationPrice","getToLabel","currentRate","usdgFromAmount","getSwapError","requiredAmount","swapAmount","sizeUsd","stableTokenAmount","getLeverageError","isPrimaryEnabled","isStopOrder","modal","hasInputFocus","setHasInputFocus","hasInputError","setHasInputError","wrap","WETH","unwrap","swap","multiPath","createIncreaseOrder","referralCode","increasePosition","tokenAddress0","refPrice","priceBasisPoints","priceLimit","boundedFromAmount","pendingChanges","showFromAndToSection","showTriggerPriceSection","showTriggerRatioSection","feeTokenPrice","setFromValueToMaximumAvailable","maxAvailableAmount","icon_repay","Fragment","shouldShowMaxButton","getTokenLabel","evt","positive","negative","errorCode","isSupportedChain","charAt","indexTokenInfo","nextToAmountUsd","ChartTokenSelector","selectedToken","indexTokens","shortableTokens","onSelect","as","Items","Item","marginLeft","marginRight","getChartToken","RED_COLOR","GREEN_COLOR","ExchangeTVChart","savedShouldShowPositionLines","currentChart","setCurrentChart","currentSeries","setCurrentSeries","setPeriod","hoveredCandlestick","setHoveredCandlestick","chartToken","setChartToken","tmp","previousMarketName","currentOrders","chartRef","updatePriceData","chartInited","setChartInited","scaleChart","timeScale","setVisibleRange","onCrosshairMove","seriesPrices","values","point","chart","createChart","offsetWidth","offsetHeight","layout","backgroundColor","textColor","fontFamily","localization","timeFormatter","businessDayOrTimestamp","grid","vertLines","color","horzLines","rightOffset","borderVisible","barSpacing","timeVisible","fixLeftEdge","priceScale","crosshair","horzLine","vertLine","mode","subscribeCrosshairMove","series","addCandlestickSeries","lineColor","topColor","bottomColor","lineWidth","priceLineColor","downColor","wickDownColor","upColor","wickUpColor","interval","setInterval","resizeChart","resize","setData","lines","createPriceLine","line","removePriceLine","deltaPrice","candleStatsHtml","candlestick","timeThreshold","average","marketImg","marketActiveImg","triggerImg","triggerActiveImg","ORDER_SIZE_DUST_USD","getTokenAmount","usdAmount","shouldSwap","receiveToken","isCollateralWrapped","isSameToken","isUnwrap","PositionSeller","keepLeverage","prevIsVisible","savedRecieveTokenAddress","setSavedRecieveTokenAddress","swapToToken","setSwapToToken","maxAmount","maxAmountFormatted","maxAmountFormattedFree","convertedAmount","convertedAmountFormatted","nextLeverage","nextLiquidationPrice","isClosing","nextCollateral","isNotEnoughReceiveTokenLiquidity","isCollateralPoolCapacityExceeded","swapFeeToken","swapFee","ret","isSwapAllowed","receiveAmount","convertedReceiveAmount","totalFees","executionFeeUsd","residualSize","abs","deductions","collateralInfo","receiveTokenInfo","onClickPrimary","minProfitExpiration","minProfitTimeExpired","withdrawETH","prefix","warning","tokenOptionInfo","convertedTokenAmount","maxInUsd","maxIn","maxOut","maxOutUsd","fromInfo","toInfo","getSwapLimits","DEPOSIT","WITHDRAW","EDIT_OPTIONS","EDIT_ICONS","depositImg","withdrawImg","depositActiveImg","withdrawActiveImg","PositionEditor","nextLeverageExcludingPnl","isSwapping","setIsSwapping","isDeposit","isWithdrawal","resetForm","depositCollateral","collateralSnapshot","expectingCollateralChange","withdrawCollateral","SpinningLoader","ROOT_SHARE_URL","UPLOAD_URL","UPLOAD_SHARE","config","quality","canvasWidth","canvasHeight","getShareURL","imageInfo","PositionShareCard","positionRef","userAffiliateCode","uploadedImageInfo","uploadedImageError","sharePositionBgImg","deltaAfterFeesPercentageStr","homeURL","backgroundImage","gmxLogo","PositionShare","setIsPositionShareModalOpen","isPositionShareModalOpen","positionToShare","affiliateCodes","setAffiliateCodes","variables","parsedAffiliateCodes","referrerTotalStats","useAffiliateCodes","setUploadedImageInfo","setUploadedImageError","useCopyToClipboard","copyToClipboard","sourceLoaded","setSourceLoaded","img","Image","onload","useLoadImage","shareBgImg","tweetLink","hashtag","finalURL","encodeURIComponent","getTwitterIntentURL","element","toJpeg","dataUrl","download","click","image","PositionDropdown","CollateralLocked","PositionsItem","onPositionClick","setListSection","positionOrders","showPnlAfterFees","hasPositionProfit","positionDelta","hasOrderError","borrowFeeUSD","editPosition","sellPosition","isLarge","isLocked","setIsLocked","DG","keyByIndexToken","ADDRESS_ZERO","ownerOf","owner","hasPendingChanges","display","netValue","deltaBeforeFeesStr","deltaAfterFeesStr","muted","collateralAfterFee","hasLowCollateral","getOrdersForPosition","hasMatchingIndexToken","hasMatchingCollateralToken","PositionsList","positionsDataIsLoading","setMarket","positionToEditKey","setPositionToEditKey","positionToSellKey","setPositionToSellKey","isPositionEditorVisible","setIsPositionEditorVisible","isPositionSellerVisible","setIsPositionSellerVisible","setCollateralTokenAddress","borrowFeeRate","colSpan","OrderEditor","setEditingOrder","initialRatio","indexTokenMarkPrice","OrdersList","hideActions","cancelOrderIdList","setCancelOrderIdList","editingOrder","onCancelClick","onEditClick","renderHead","renderEmptyRow","renderActions","renderLargeList","markExchangeRate","orderId","indexTokenSymbol","collateralTokenInfo","collateralUSD","renderSmallList","getOrderActionTitle","actionDisplay","renderLiquidationTooltip","liquidationData","minCollateral","borrowFee","loss","getLiquidationData","liquidationsDataMap","timestamp","TradeHistory","shouldShowPaginationButtons","pageIds","setPageIds","pageIndex","setPageIndex","forSingleAccount","afterId","urlItem","URL","searchParams","append","trades","updateTrades","item0","item1","data0","data1","time0","time1","block0","blockNumber","block1","useTrades","liquidationsData","graphClient","_data","liquidatedPositions","useLiquidationsData","reduce","memo","getMsg","trade","tradeData","defaultMsg","tokenAmount","tokenIn","tokenOut","amountOut","acceptablePrice","flags","isOrderExecution","isLiquidation","longShortDisplay","executionPriceDisplay","executionPrice","sizeDeltaDisplay","increase","priceDisplay","getPositionDisplay","fromAmountDisplay","toAmountDisplay","amountInDisplay","minOutDisplay","tradesWithMessages","txhash","lastTrade","ExchangeBanner","hideBanner","twitterIcon","mediumIcon","githubIcon","telegramIcon","discordIcon","BorrowsItem","borrowState","setBorrowState","repayState","setRepayState","isModalLoading","curPosition","setCurPosition","borrowStep","setBorrowStep","repayStep","setRepayStep","setAvailable","borrowPosition","repayPosition","availableRaw","currentTriggerPrice","getApproved","BorrowsList","setIsModalLoading","bool","MarginLevel","notifications","pushSuccessNotification","transactionHash","pushErrorNotification","getFundingFee","getTokenAddress","applyPendingChanges","Exchange","forwardRef","setSavedIsPnlInLeverage","savedShowPnlAfterFees","setSavedShouldShowPositionLines","showBanner","setShowBanner","bannerHidden","setBannerHidden","updatedPositions","setUpdatedPositions","currentAccount","vaultAddress","readerAddress","usdgAddress","whitelistedTokenAddresses","positionQuery","collateralTokens","getPositionQuery","defaultTokenSelection","notShowAgain","shortWarningState","setShortWarningState","setShortWarningVisible","showShortWarning","tokenAddr","selectedSwapOption","newTokenSelection","tokenAddresses","positionData","positionDataError","VaultV2","vaultReaderAddress","indexPricesUrl","refreshInterval","refreshWhenHidden","useInfoTokens","currentTokenPriceStr","propsLength","contractKey","hasRealisedProfit","realisedPnl","updatedPosition","closingFee","hasProfitAfterFees","pendingDeltaAfterFees","deltaPercentageAfterFees","getPositions","setEthLongExists","setEthShortExists","longPos","pos","shortPos","useImperativeHandle","onUpdatePosition","reserveAmount","onClosePosition","onIncreasePosition","indexTokenItem","onDecreasePosition","onCancelIncreasePosition","blockGap","timeGap","onCancelDecreasePosition","receiver","overrideAccount","connectedAccount","shouldRequest","orderBookReaderAddress","orderBookContract","orderBookReaderContract","fetchIndexesFromServer","ordersIndexesUrl","a","b","decrease","fetchLastIndex","_hex","fetchLastIndexes","getRange","_indexes","knownIndexes","lastIndex","getOrders","parseFunc","serverIndexes","lastIndexes","swapOrders","increaseOrders","decreaseOrders","useAccountOrders","setIsPluginApproving","setIsPositionRouterApproving","setIsCancelMultipleOrderProcessing","tx","LIST_SECTIONS","listSection","LIST_SECTIONS_LABELS","Orders","Positions","getListSection","section","hiddenLimit","getTime","checked","homeEventsData","validTill","bodyText","buttons","newTab","appEventsData","Icon","EventToast","button","useEventToast","isHome","visited","setVisited","isFuture","custom","EventToastContainer","useWindowScroll","breakpoint","createBreakpoint","XL","L","S","useBreakpoint","reverseOrder","gutter","containerClassName","containerStyle","right","toastOptions","SEO","customMeta","meta","description","Helmet","property","RedirectPopupModal","redirectModalVisible","setRedirectModalVisible","appRedirectUrl","setRedirectPopupTimestamp","setShouldHideRedirectModal","shouldHideRedirectModal","removeRedirectPopupTimestamp","locale","messages","i18n","load","activate","loadLocaleData","en","plurals","es","zh","ko","ru","ja","fr","getLibrary","autoRefreshOnNetworkChange","Jelly","cssTransition","enter","arbWsProvider","WebSocketProvider","avaxWsProvider","JsonRpcProvider","FullApp","exchangeRef","connector","deactivate","history","activatingConnector","setActivatingConnector","triedEager","tried","setTried","shouldTryWalletConnect","rawData","connected","SyntaxError","currentProviderName","isAuthorized","useEagerConnect","suppress","injected","handleConnect","handleChainChanged","handleAccountsChanged","handleNetworkChanged","networkId","removeListener","useInactiveListener","search","React","URLSearchParams","useRouteQuery","encodedReferralCode","queryParams","delete","navigator","connectInjectedWallet","fn","UnsupportedChainIdError","errString","getInjectedHandler","userAgent","attemptActivateWallet","selectedToPage","isSettingsVisible","setIsSettingsVisible","setSavedSlippageAmount","slippageAmount","setSlippageAmount","isPnlInLeverage","setIsPnlInLeverage","shouldDisableValidationForTesting","setShouldDisableValidationForTesting","setShowPnlAfterFees","setSavedShowPnlAfterFees","setSavedShouldDisableValidationForTesting","decodedRefCode","checkPendingTxns","updatedPendingTxns","getTransactionReceipt","receipt","wsVaultAbi","VaultV2b","wsProvider","getWsProvider","wsVault","wsPositionRouter","callExchangeRef","off","limit","hideProgressBar","newestOnTop","closeOnClick","draggable","pauseOnHover","slippage","basisPoints","GMXInterface","MarginAccount","icon_WBTC","icon_ETH","icon_dollar","AppRouter","allowance","Warning","App","setDgAddress","dynamicActivate","Provider","ReactDOM","createRoot","getElementById","render","StrictMode"],"mappings":"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CAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,s/S,+BCAf,OAAe,cAA0B,iC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,szB,+BCAf,OAAe,suB,+BCAf,OAAe,8zB,+BCAf,OAAe,khB,+BCAf,OAAe,kmB,+BCAf,OAAe,skB,+BCAf,OAAe,k7B,+BCAf,OAAe,syB,+BCAf,OAAe,02B,+BCAf,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,cAA0B,gC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,03C,+BCAf,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,00D,+BCAf,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,iD,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cA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","file":"static/js/main.89120bb1.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/ic_eth_40.03a12ea6.svg\";","var map = {\n\t\"./ic_btc_40.svg\": 253,\n\t\"./ic_dai_40.svg\": 254,\n\t\"./ic_eth_40.svg\": 137,\n\t\"./ic_frax_40.svg\": 255,\n\t\"./ic_link_40.svg\": 256,\n\t\"./ic_uni_40.svg\": 257,\n\t\"./ic_usdc_40.svg\": 258,\n\t\"./ic_usdt_40.svg\": 259,\n\t\"./ic_weth_40.svg\": 260\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 181;","export default __webpack_public_path__ + \"static/media/DROP_DOWN.ef525fad.svg\";","export default __webpack_public_path__ + \"static/media/icon_dollar.8908c0f2.svg\";","export default __webpack_public_path__ + \"static/media/icon_dollar_active.059213a3.svg\";","export default __webpack_public_path__ + \"static/media/icon_market.1494995a.svg\";","export default __webpack_public_path__ + \"static/media/icon_market_active.257003dd.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger.abfde3ea.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger_active.8868a9b4.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw.09cda1b1.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw_active.1e16a67d.svg\";","export default __webpack_public_path__ + \"static/media/long.0f8a81b9.svg\";","export default __webpack_public_path__ + \"static/media/long_active.d0e619ea.svg\";","export default __webpack_public_path__ + \"static/media/short.670d98eb.svg\";","export default __webpack_public_path__ + \"static/media/short_active.d3098d1c.svg\";","export default __webpack_public_path__ + \"static/media/gmx-logo-with-name.03a4464f.svg\";","export default __webpack_public_path__ + \"static/media/ic_discord.be4d716c.svg\";","export default __webpack_public_path__ + \"static/media/ic_github.dbd4de8a.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_footer.e7821eb2.svg\";","export default __webpack_public_path__ + \"static/media/ic_medium.f6051b2e.svg\";","export default __webpack_public_path__ + \"static/media/ic_telegram.af1a4a66.svg\";","export default __webpack_public_path__ + \"static/media/ic_twitter.9f35b403.svg\";","export default __webpack_public_path__ + \"static/media/position-share-bg.900fbfaa.png\";","export default __webpack_public_path__ + \"static/media/swap.40fb8e49.svg\";","export default __webpack_public_path__ + \"static/media/coinbaseWallet.ae86a337.png\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.ec9214a7.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.eb3c180f.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.7e94b658.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.9db627fc.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.02be34a3.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.38f03c0f.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.6edf6fb0.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.2dd52bee.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_24.21ec7bfe.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_24.be4891c9.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_24.bab8cadc.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_24.f992927a.svg\";","export default __webpack_public_path__ + \"static/media/ic_busd_24.2432ce58.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_24.bafa9da6.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_24.6b1d8a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_24.7349c478.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_24.eff381d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_24.2b59d7e0.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_24.0d641e52.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_24.b6a1708c.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_24.25d2f4a7.svg\";","export default __webpack_public_path__ + \"static/media/ic_tether_24.a7c88dcd.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_24.47e903f7.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_24.5ab8778d.svg\";","export default __webpack_public_path__ + \"static/media/ic_wallet_24.4be97369.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_24.bc395894.svg\";","export default __webpack_public_path__ + \"static/media/metamask.4b5d438a.png\";","export default __webpack_public_path__ + \"static/media/walletconnect-circle-blue.31c29967.svg\";","var map = {\n\t\"./Anyswap.png\": 360,\n\t\"./Anyswap.svg\": 361,\n\t\"./Artwork.svg\": 362,\n\t\"./Artwork_gmx.svg\": 363,\n\t\"./Banxa.png\": 364,\n\t\"./DROP_DOWN.svg\": 182,\n\t\"./Hop.png\": 365,\n\t\"./Hop.svg\": 366,\n\t\"./Hop_dark.png\": 367,\n\t\"./Hop_dark.svg\": 368,\n\t\"./Synapse.png\": 369,\n\t\"./Synapse.svg\": 370,\n\t\"./binance.png\": 371,\n\t\"./bscscan.png\": 372,\n\t\"./btn_big_arbitrum.png\": 373,\n\t\"./btn_big_avalanche.png\": 374,\n\t\"./btn_big_bsc.png\": 375,\n\t\"./btn_big_purchasegmx.png\": 376,\n\t\"./btn_big_purchasegmx.svg\": 377,\n\t\"./buy_gmx.svg\": 378,\n\t\"./buy_gmx_bond.svg\": 379,\n\t\"./buy_transfer_eth.svg\": 380,\n\t\"./coinbaseWallet.png\": 252,\n\t\"./coingecko.png\": 381,\n\t\"./cross.svg\": 382,\n\t\"./ddl/chevron-down.svg\": 383,\n\t\"./ddl/chevron-down_sm.svg\": 384,\n\t\"./ddl/ic_btc_40.png\": 385,\n\t\"./ddl/ic_btc_40.svg\": 253,\n\t\"./ddl/ic_dai_40.png\": 386,\n\t\"./ddl/ic_dai_40.svg\": 254,\n\t\"./ddl/ic_eth_40.png\": 387,\n\t\"./ddl/ic_eth_40.svg\": 137,\n\t\"./ddl/ic_frax_40.png\": 388,\n\t\"./ddl/ic_frax_40.svg\": 255,\n\t\"./ddl/ic_link_40.png\": 389,\n\t\"./ddl/ic_link_40.svg\": 256,\n\t\"./ddl/ic_uni_40.png\": 390,\n\t\"./ddl/ic_uni_40.svg\": 257,\n\t\"./ddl/ic_usdc_40.png\": 391,\n\t\"./ddl/ic_usdc_40.svg\": 258,\n\t\"./ddl/ic_usdt_40.png\": 392,\n\t\"./ddl/ic_usdt_40.svg\": 259,\n\t\"./ddl/ic_weth_40.png\": 393,\n\t\"./ddl/ic_weth_40.svg\": 260,\n\t\"./ddl/icon_arrow.svg\": 394,\n\t\"./ddl/icon_check.svg\": 395,\n\t\"./ddl/icon_close.svg\": 396,\n\t\"./ddl/icon_close_sm.svg\": 397,\n\t\"./ddl/icon_close_toast.svg\": 398,\n\t\"./ddl/icon_dollar.svg\": 183,\n\t\"./ddl/icon_dollar_active.svg\": 184,\n\t\"./ddl/icon_market.svg\": 185,\n\t\"./ddl/icon_market_active.svg\": 186,\n\t\"./ddl/icon_trigger.svg\": 187,\n\t\"./ddl/icon_trigger_active.svg\": 188,\n\t\"./ddl/icon_withdraw.svg\": 189,\n\t\"./ddl/icon_withdraw_active.svg\": 190,\n\t\"./ddl/lock.svg\": 399,\n\t\"./ddl/long.svg\": 191,\n\t\"./ddl/long_active.svg\": 192,\n\t\"./ddl/short.svg\": 193,\n\t\"./ddl/short_active.svg\": 194,\n\t\"./flag_en.svg\": 400,\n\t\"./flag_es.svg\": 401,\n\t\"./flag_fr.svg\": 402,\n\t\"./flag_ja.svg\": 403,\n\t\"./flag_ko.svg\": 404,\n\t\"./flag_ru.svg\": 405,\n\t\"./flag_zh.svg\": 406,\n\t\"./glp_icon.svg\": 407,\n\t\"./gmx-logo-final-white-small.png\": 408,\n\t\"./gmx-logo-final-white.png\": 409,\n\t\"./gmx-logo-final.png\": 410,\n\t\"./gmx-logo-glow.png\": 411,\n\t\"./gmx-logo-with-name.svg\": 195,\n\t\"./gmx_logo.svg\": 412,\n\t\"./graphite-01.png\": 413,\n\t\"./ic-communityproject.svg\": 414,\n\t\"./ic_arbitrum_16.svg\": 415,\n\t\"./ic_arbitrum_24.svg\": 261,\n\t\"./ic_arbitrum_96.svg\": 416,\n\t\"./ic_arbitrum_hover_16.svg\": 417,\n\t\"./ic_arrowleft16.svg\": 418,\n\t\"./ic_arrowright16.svg\": 419,\n\t\"./ic_avalanche_16.svg\": 420,\n\t\"./ic_avalanche_24.svg\": 262,\n\t\"./ic_avalanche_96.svg\": 421,\n\t\"./ic_avax_24.svg\": 263,\n\t\"./ic_avax_30.svg\": 422,\n\t\"./ic_avax_40.svg\": 423,\n\t\"./ic_banxa.svg\": 424,\n\t\"./ic_binance_logo.svg\": 425,\n\t\"./ic_bsc.svg\": 426,\n\t\"./ic_bsc_96.svg\": 427,\n\t\"./ic_btc.b_24.svg\": 264,\n\t\"./ic_btc.b_40.svg\": 428,\n\t\"./ic_btc_24.svg\": 265,\n\t\"./ic_btc_40.svg\": 429,\n\t\"./ic_busd_24.svg\": 266,\n\t\"./ic_buy_glp.svg\": 430,\n\t\"./ic_cash.png\": 431,\n\t\"./ic_cash.svg\": 432,\n\t\"./ic_checked.svg\": 433,\n\t\"./ic_coingecko_16.svg\": 434,\n\t\"./ic_coingecko_hover_16.svg\": 435,\n\t\"./ic_convert_down.svg\": 436,\n\t\"./ic_copy_16.svg\": 437,\n\t\"./ic_cost.svg\": 438,\n\t\"./ic_dai_24.svg\": 267,\n\t\"./ic_dai_40.svg\": 439,\n\t\"./ic_discord.svg\": 196,\n\t\"./ic_eth_24.svg\": 268,\n\t\"./ic_eth_40.svg\": 440,\n\t\"./ic_frax_24.svg\": 269,\n\t\"./ic_frax_40.svg\": 441,\n\t\"./ic_github.svg\": 197,\n\t\"./ic_glp_24.svg\": 270,\n\t\"./ic_glp_40.svg\": 442,\n\t\"./ic_glp_custom.svg\": 443,\n\t\"./ic_gmx.svg\": 444,\n\t\"./ic_gmx_24.svg\": 271,\n\t\"./ic_gmx_30.svg\": 445,\n\t\"./ic_gmx_40.svg\": 446,\n\t\"./ic_gmx_64.svg\": 447,\n\t\"./ic_gmx_arbitrum.svg\": 448,\n\t\"./ic_gmx_avax.svg\": 449,\n\t\"./ic_gmx_big.svg\": 450,\n\t\"./ic_gmx_custom.svg\": 451,\n\t\"./ic_gmx_footer.svg\": 198,\n\t\"./ic_hop.svg\": 452,\n\t\"./ic_info.svg\": 453,\n\t\"./ic_language24.svg\": 454,\n\t\"./ic_link_24.svg\": 272,\n\t\"./ic_link_40.svg\": 455,\n\t\"./ic_liquidity.svg\": 456,\n\t\"./ic_medium.svg\": 199,\n\t\"./ic_menu_dots.svg\": 457,\n\t\"./ic_metamask_16.svg\": 458,\n\t\"./ic_metamask_hover_16.svg\": 459,\n\t\"./ic_mim_24.svg\": 273,\n\t\"./ic_mim_40.svg\": 460,\n\t\"./ic_multiswap.svg\": 461,\n\t\"./ic_new_link_16.svg\": 462,\n\t\"./ic_olympus.svg\": 463,\n\t\"./ic_olympus_arbitrum.svg\": 464,\n\t\"./ic_selector_dropdowns.svg\": 465,\n\t\"./ic_settings_16.svg\": 466,\n\t\"./ic_settings_24.svg\": 274,\n\t\"./ic_sign in_16.svg\": 467,\n\t\"./ic_sign_out_16.svg\": 468,\n\t\"./ic_simpleswaps.svg\": 469,\n\t\"./ic_stats.svg\": 470,\n\t\"./ic_stats_big.svg\": 471,\n\t\"./ic_synapse.svg\": 472,\n\t\"./ic_telegram.svg\": 200,\n\t\"./ic_tether_24.svg\": 275,\n\t\"./ic_tokens.svg\": 473,\n\t\"./ic_totaluser.svg\": 474,\n\t\"./ic_trading.svg\": 475,\n\t\"./ic_transfer_avax.svg\": 476,\n\t\"./ic_twitter.svg\": 201,\n\t\"./ic_uni_24.svg\": 276,\n\t\"./ic_uni_40.svg\": 477,\n\t\"./ic_usdc.e_24.svg\": 277,\n\t\"./ic_usdc.e_40.svg\": 478,\n\t\"./ic_usdc_24.svg\": 278,\n\t\"./ic_usdc_40.svg\": 479,\n\t\"./ic_usdt_24.svg\": 279,\n\t\"./ic_usdt_40.svg\": 480,\n\t\"./ic_wallet_24.svg\": 280,\n\t\"./ic_wavax_24.svg\": 281,\n\t\"./ic_wavax_40.svg\": 481,\n\t\"./ic_weth_24.svg\": 282,\n\t\"./ic_weth_40.svg\": 482,\n\t\"./lg_arbitrum.svg\": 483,\n\t\"./logo_GMX.svg\": 484,\n\t\"./logo_GMX_small.svg\": 485,\n\t\"./long.svg\": 486,\n\t\"./metamask-text.svg\": 487,\n\t\"./metamask.png\": 283,\n\t\"./page-not-found.svg\": 488,\n\t\"./position-share-bg.png\": 202,\n\t\"./short.svg\": 489,\n\t\"./swap.svg\": 203,\n\t\"./trading.jpg\": 490,\n\t\"./wallet-connect-text.svg\": 491,\n\t\"./walletconnect-circle-blue.svg\": 284,\n\t\"./wave-01.png\": 492,\n\t\"./wave-02.png\": 493\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 359;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAZlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+Vn2moAAAAInRSTlMABhQdEgsKKUeEstIZdbP/wlfRwTjgpJRm8fDhhaNlk3ZW+c569wAAAsRJREFUeAHs0AEBwEAMAjFaCv4lbz7+IiHSrJ+3I40vfVzOo72it3JaxHLxI4IIIogggggiiCDia9cMdx5FwSj8aw84Ug4qCoL96t7/Te68YL7GjrPpn0nsxCepLXrA8IQ3NoY/IULp5keLJ0YbHKM1/gfd3PQni7Ak6b6bXU9y8DigIz1+hx9JsvefKwITyfBsVCIOgrPkjlGp7WDiPJqPFWF6kvHpISgox6R+DXKyI35DpK6LJn6oCPEwW/rNw6bEZC4Hc+0iu/Irmttw7wDdKKB8bSKwaDRPF6bpANUM96/aTT2GR3dOEeLBY9p7ABY6vDJkGJakG1N24krVdp+h5qRRaceyNPptgfg0O8dBuiVKt/spRbTiAa8esP4qQjFIxABwnMq85GO2K3Hm+PBVogcCqWp8zAaIMrKTHAL1CUVE8sgDJk7YU+fXlYgrOiJVneBaxjBrS44d4LkC41SOFtClergALkPI7oQiJoYjD5HUeGFMzU/qGi9T0ZKZ+1IZFRMzY5mpZ2ctvLTMfWQaiogAwY4nFOG4HHuY8ILnhtqJCFSlMryvKnIv57DOWGlWKph+Dstii4h6r8BTiggvHnQ88iCBTv8kct2JUAylMtyIgsvirOstFKNrJdV9l4atkTOWRmRSOw9YORx5QHIo5HEnAjaVylhrf5WsZKy0WivSYkmtRQQ9RFM4oQiTmW76q3/WReChh/h8sPqdiI51Yi1/3L4eafZ1DFOOClBz/69+sIiQe93SbE4oAj5TmOOzWHj0pLc0KChOOxHI9EXpMpN0ul5pZWi2pZFl+LkHnJOMUyf9Z7m0bIP6blNY8D59xoZROETV88Wf/5T3Eb6dVm3wPp4r3sS5v/bFjL83KRtcIlRL6/EuYfkbRFzvLC8Rl4hLxCXiEnGJuET8A+HaTFa3F17bC68Np9uG02sL8rYF+T+idSlyqmiqtwAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Anyswap.491d1f32.svg\";","export default __webpack_public_path__ + \"static/media/Artwork.a2d41b8c.svg\";","export default __webpack_public_path__ + \"static/media/Artwork_gmx.cc61d732.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAAoCAMAAABO8gGqAAABcVBMVEUAAAAoKDwnKTsnKTsnKTuGh5HJyc6urrWFhpA1Nkehoqrx8vO7vMF4eoVCRFRrbHhQUWARbooBqMcRcojKys////+vr7ZdX2zW19ry8vMUZIIBo8cBqMYBrMUUbYCTlJ0iN00BnsgAoscArMUDqbwiO0zl5ee8vcLX2NsNd50Bp8YBrcYAscQPgpHk5OYeRF8AmcgAo8cUaYEBssUAtsMdTl0Gh7gBmckPdpMPe5IBtsQIn6mgoalcXmtqa3gWVnoBlcoAmckDmMAlMUQiOUwDqr0Bu8MYYm4lL0QDicIBlMoAu8MDtrolM0MSYI0Bj8oFi7clMkQFpbMAv8EUd34iNU0Bi8sBkMsbTGgZXm8AwMIAxMEiPUwKb6gBi8wLeqcKl6EAv8IBxcEMl5YbRWkBhs0gPVYgRFUBwMIAycAdUlwGeLwBhswRY4wPh48Fuq8UVoQBgs0Azr8YaWwKbKkBzsAKqZ4ZS3IDfcQCxLcbXmRL8BeXAAAABHRSTlMAM7D2JaXEwgAAAp1JREFUeAHszjEBADAQArF7wL/myigDURA4OaWsg3OK+VCqCaeaSbkFF/xswQUfa2XRJa8OxNFNYF6gvUkz7u7u7u7u7m6f/1UqZArW/9wNhZ26kd+JZWvy/uMsjOPGQg8c247rOmHblrwm4a8UQ+K2HUswIp3JGhL0BOEmGRGHBzm6FYA29IXwUBCe5eMgUlAVQKUpLCouKTUvKFyaBO4KwCdBSSoqyMrgWV7wcUGK/VFeUZmpqq4xJej4SLIWSlpSIbGjgm6KBJE6eGgxVo/TSzRUFDU2NbeYEvRpUT39OCE7h9sKpJVHBblU8x0hh0a0tVd0dFZ1dfcYFrRCgp6sy6QRCeb0liNBligQwoXndSxEb19FPxtoHhwyJDg8goy6lAofNxyH7mUk6Ftqy5Eg1pJ6zoix8YnJKTY90z07ZzokQvepVa5xyg0mRs6hQ4KIpdJDzC8s9hXCtXRwaXnFtGDeX9MCHryNkaD6Oh4VrBcYFGJ1bXxdXjc2Z7e2jQjWlyk8lAC4q1v6+IgEVSjCgjmBJJlmZ3dvcR+rg6XDo2MzIaG6LGhaS/3zSTAIBaaJFrhePkuxgJPTtbOgPL+4vDIqWKYap1CGUhoPCbIUPBBaEM+SWu4Livv1ze7eLVPc3R89PBoQ1MvDW9UMetifpF1OgtKJBFPBCWIJPdHs6fn0hWleLx/eDAi6tgK6iYQ2COOQIBBHQT0iNb85HbD3j2fYg30VcBY3D8IefPj8MprieNAsikeC2sbTAXboRJG5+v54Pl0bn5BncVf37MXlw8/vPwrWkUdBXQrXrVZEKZDa8DDFyLAO92r0RCmA6/8rr0iFhKCWNjAEgWmwsmq0RY0XjDpw1IGjDhx14KAfwBz0Q8CDfhB90E9DAACtALoxSNWoNwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAYAAACZvCZrAAAFLElEQVR4Ae3aBWwcRxTG8QjKQqsUEtOJpTJzw+U2zMmGmZlJVIYwYznMya0ZjslU58Jo2Nu43L7Os2ej7eiMMt+30s8ws+a7f2Zn044PIrpbeFDonPAA4EHhbnsceDBJeEC4P2EBwAOyBZ0rIiFrkWSdAAAgm/BgO1kKdeUAAFhJdJaBUCYBABAIAKhzIAAAEAgAQCAAAIEAAAQCABAIAEAg8tcEHIExrqhPc/ui26Pt78wBAAIRmRXs4h3pIe9wH3lGBLa30V80AAJx6aszT0dXHFt+bslxZ+H841Q49xTlzzpDeTOcFJmWHM2dlr4/PD1zBq8a7qwgluU7vMP95B4cINfAMLlGFfbm8QbmELoIVa1Q2qvzANCAgbjyyekuRYuPUNHCY1Q4/wQVzLHioFNkajKFJ6dRaEI6BcdlkX9MDvlHe5zBCcGR/LHuoSE9R8Qhu18eZfYuKIuuvdnQT9QVVHl0qWK+izoP0IAQiPOrTmpFC49TwTyOw2nKm3mW8qaLOExJqYhDcEKGiEO2CEMO+TQ3eYd7yTMsQK7BQZ9reO7MrL4ch0JKf7+I0j88vx+BgDYGlxiFi07PLFygr8ifp888tyKzS8ESV5eCha4ukRkuLTzR9YV/tMvvG+khD8dhqIjDoBDl9I9QVp98yvyI43CO0t45Tym9LlJG72saAgEJBpuUvOfg00IrcgaGjOz+uZRZEYdfKO09jsMFSu51iZJ7XKWzXa6VucbecrSAQIwU9gtOYXu8c+TYcuV8thz7GoBA1ENgftSR1a/gQMaHHIcopb4t4tDzEundOQ7X6czrt4SSA80YiPaCT46fF3T5mo/98T6/7Xxd4iMqPI0HGyR8IMx9W3sbO74pMw/+UOt/+dP7np+Z+vZFEYfLIg7X6OyblXE49UoJnXzJoAYOhE9wxuGLEwinHFPvqsyU4yvifH6/YP/ZOQyG/Fx4wAECEdvxDZk719bpCZH24TVN78ZxuEGnXyumUy+X0skXY3TipdsNvYLwC3ocfiUQDiUCqgNCWQ0rFHUOqwjAJYa5Y+15EQiK7V6/oi4fl/xOsXb6NV41lJKza7l2ppvZO7yC2jfTJUbvGs6fqczLz48N0LgAgeDLitjezSPN3eu/4FUEu/3Tzjo9KU6/VrrjxAsmnXih/EAz3+acWcP5vesRCA0POEjcQFgrB46DZefasl/376n10ppXDMeeLT9/9KnfKX3gH45mDEQXZf9B9YWcdyifv31NMQFIvEDk6O1tYVCVmfs2abVeRfT4q8vhx/887xxIzRkIdl6Iqk96+X6ZoKufv4o9C6dg4HYnJPQKIrZjrd+KgrqS4PfN3es+55DU5XM2cyB6225TjpRzM2QcDOFp9fPbboF+JDnl2Ew82CChA8GXEhyD6vAt0NiejTN4v6IVBMIa99P/D12Jg/r5z9vONay9BwDc5ty7cYUSBUNZSdjfdpp7NnzOG5vGd9u6sPLvxNt7NizncQ5JC/pFta8yLvE3KR3S/QAIhE1sp7zUkMx9WzTewJTv14m1wdmiKYEAQCBquNSwrxSMnet28DhvVJoyHvb5qt43dnxt8KVIGwoEAALBYns3zLQ/4dX/L1Exv3PdAXVlwe/zOM+3ojgwzbqrAYBA1IK5a50uVwa2SwUAQCDkSqFyRbDWj180AAIBAAgEACAQANDwEAgAQCAAAIEAAATiAdsgAMADViAeFJKsCQAA2YQHORB3cynkAFYSAFg5JMkm3N2ODxmJB3kQABLeg1Yc/gOptOvB5Z4VkgAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Hop.4b77c9e3.svg\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/Hop_dark.423942af.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAABmFBMVEUAAAD///////////////////////+PcOZ/UON5R+KNT+iFQeWSYOi4hfWIP+aRP+iIP+WUP+ibPeqSPOiiauz///////////////95VON4U+O3N/C1LO9+WOL///////9yS+F4SeO/JvK+IvF4SOP///////////////9+WOWHVeXRQPbKHvTRO/b///////////+pOOyxKu6+KfG7JvCxKu+wRPH///////////////////////////////////+qL+21J+/CIvLTS/PCIPK2J++sMuz///////////+eT+2iOOu3QfG8MPDNQPbUH/beGff1Zv/gGPjVIfXNNvS+MvOiNuv///////96SOKHQeaZQ+noMvrvDfv3A/3vC/vmRPmHP+V6R+J7SOKIQuaXQefvDfz3Bf2ZQeehNuuzPu27MPDUHfbeG/fTIfWiNuurMuy2J/DBIPGtQO2wKu68KPGwKe7NKvXKHvR3SOJ4SOJ3UuK/SfG0Ku+7QfF7V+OUPuidPeqIQOaRPueQP+eQT+iFQOV6R+MNOs0rAAAAhnRSTlMABhQdEgsKKXb/V/84Gf+z/7OF4SkpZYRWdnVmwVeT////wv//lIU4s1dXOMI44MLSdv+U0v9H4dFHV6PBGbJ10v/gKf//o/DxZkekR3Y4lIUZk4VHZrN2pPHwdjiz/8Ip8fDS4Xaz4XazV3WUhYWkpP//V/+z/2bB//+FOMJHZrKF/8KzVzMrutwAAANDSURBVHgB7NDFAQRBCERRfHxa8091PYK9Ur8Fzo+IRdMnTMRqHslzUyaxQGFC6oHClfQ90f8QgAAEIACxAOLTuq2AeLcfOyDO67dcZ2qI8y6/rdQzM8TV+m/rYz65LYvt9nkgju7mDWSXp2Q5JdsfxkqscmunzMzMzPjqf4+isrv3iQq6yZzfQlf4W5gZZhkrYRHlFRoqqyo1VVckZGuQmlm6ImrrNNQ31GtqrP0ZtZDbYGeQl6yIpmYNLa1tmpqbfkYdV3WeU9JnxF9//6Pp3//+T45mfdUJDsJkRDkTmMlEPjClqhj59g4iYcqOIK8QmBnkDSiW24MalnoRnV3dPQp6evv6k6MW5mWRBFrUOdmY8ui6GMYF6ccUhQyAox+5HvoSwMYsEaiy50ZYSLeIgcGh4ZHRMYDxicmp6aGZgaSodBHbDUmYdYAGOQsCURBxGn4OgEUZIk+SrTmAjEcrhypBJADkHLIUi5hfWFT90vLK6pqixfWNpLCYi1AtiwINzUL2tjZcF8C2iTIOiWCEcxgXHEk5pqyRzGguxSI2t7aLInZ2d5YU7W1tQnKz52jJS5p4x6NpL7yJANNH9H0E4BFQy6GI/8J8hw1quwTUQjfdW2P/4HDq6Bhg/Phk6vDgNGlrSCFVP0urYQ6ZmmOB4k2EhXOcW1kSoU9VqjHuIgaStourWiblh+XZ+YU+LC/Oz5LXAs7q8c2qDxayLyL0JiERqI0x0EtjDgooFNss5SIur641Xd9cJkcjX1LH1ZA8h3bGFxE8BhYqEVxfKhBliHwXZBQULfIUi6hu1nB7d6upufpnNIehWWa2ozruCoizX0W4oSGMMFIisEYYvjpQYxI1WKBAYIiO0JNpfmLf/3hiP9QmZIWLiBGXxDJC9lWEpKrFkdFFmkXM5qjCI4ooj/F3OCfT/I54fNTw9Pyi6fXxl0vjnRwvwRT9K54R7H3EjL2T/WdDoRve0AhlNTbwEmGOJZ42opr8UB6YaWqGslqaCA7MqFuLuxuw4QmIkTJUJ2ruoYEns3vqD/XB29a2VjA9OpzfPjqcPzrBgxWMBsRoQIwGxGhAjAYEK4geXUwGXV44urwQuuB0dMEpdAny6BJkAMRHfxzYlb9eAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/Synapse.3cfd1d07.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAn1BMVEUAAAD////////////////////////1vjzzuzPzui/yvDTyujD////////////////2xE3/////////////////1nrzuzH////////////////zvTb1wELzvDL0wEbyvDb////////////////////////0uzDzuzHzuy/////////////////////////////0vDLyujD////////1wD3k7xDPAAAANXRSTlMABhQdEgsKZqT/o/EpRzgZOIX/wcIZ0nbx4JSEScJFiVeEk6NlsvbR8vDS4dFmpLPB8FZ1ZcrSjpcAAAKDSURBVHgB7NABAcBQFAFAD/SPvPX4LsIBRz2PB5ycPi7Wge7UhNJpBHV+i1jEIr527aipUR8IAPjTP4KSpGxigaoK0P49AFDv7vt/ttvNmpnrVfrgE7TZmcBOlIf8Jlkk5hsQNwHCRRTfBgjnEKNEgCAHkrhyCHJgieuGYAeWuGYIdri7uTsjkUgKRamW6kIh2GEjNmckUnBh0ECCvUyI+y07CJbY3n8NkUkps7wQQtndRUKQBDuQxIwDQki67UBdao14eESJpw1ebpFg84SX55dZiJJulWtJbWopKGRtqoTqSJXIxlSaOxtTl8LF/mDqZOkQD/H/jzwtXuNXngzPP+KXOYhDroWAFNuh7WwONNQGOttTJqEBa6HVrrPHzgYzPbifj0uGIIeYJdAhZgl0iE8lUhiMMUWOHAxBF91bGv6EfbaljLQUpK6kYOdIwzf0jJ5ArgRiy3VyHqKz1vZQe4iee+nFqt2YE4RwVdSiTmEFxbRjF4z8bS1LY8sO55fG6BCoTR5ClAeAwoBEiPETQvPoKTIYDEVbrKFYvlOxjKhYvp8vlqKzBMGNIUqwaZp2DkIyhJ8GfipxLByC68PH5+vzg+vEPIQ9gbAdZdkRhOBFIpRCp9KnS4egOkkS5MAVcx5CwXQCMVA2HENMrXuftpPQueEH01X8iU0S7BBHMzOiqaqqafPkGIJaJX8aOIZI8vaX3Bf02yOYvdy3vV48hJf47R3mvzXyt0T8CyF2AGAzGP+GEMpSr1sOZY/ppFf2GR6Jb4T6cpRS+NBqdRszUdiq8w5h89Y7hO18cggQ4R88sxEgAkSACBABIkD855JwmCwcL+Tjhf7AaThwGo4g8xHkP7gaLtKObnJaAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/btn_big_arbitrum.ff6ad480.png\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAf8AAAB/CAMAAADW6DvgAAABF1BMVEUbIDIeITUbHDAXGCwhGi2HLjhhJjNhJzNOIzJPIzI8HzBYJjNrKDRqKDRYJTM7Hy+QMDhGITGsNTwqHC51KjWaMTqPMDkzHi8eIDYbHDBFITB0KjYeITaiMzt+LDceITajMzt9LDdCIDCZMTo4HzA+IDBLKDmBMT15LzuuOD+TND05JjhRIzJyKjVwKjU2Hi+RMDgyHi8oIzdSIzJUKTp7LDYjGy5PJDKeMjuELThAIDBjJjSbMjqKLzg5HzBUJDJ5LDYlGy5hJzSSMDkfGSxqKDUpHC5EITEnGy5VJDMcGS02HS9DIDFAIDFFITFDIDAsHC4eITYcHzMaGy8TFiMeITUAAAASFiIcHzJlLDowJDduLjpCJjgHX8VeAAAAWXRSTlM4+O////////////////////////////+18P//+f/////////////////////////////////////////////////////////////////////6vvJR+SRTwHfs7R4AAA1sSURBVHgB7d2Hmuo6lgVgute2jKRNkLYoTcPgQ01NzjnnnKdzvO//HAOc2+jjkGRjwFT5vzmHtSwkWTaDwTe+iZOowJYqkY2GWhP2KIMvkLGsRuMJnf9Hm6lDiwq/UeBGRDOPBfUwGgh+bfZCuEY08ZvfGPzCt3Ca1vhMOCLL3DrCl5zBUWLUyRZYBVpMI54i/yRa5iHdOn+wnzmYqcGVvjX4xcx/OWszwldacIQxOCM6xVwOJ0gAWr6Uy4rQKpvyv6WoeDRHJoUrKEW4zuATTiOFrawhIFobT/4hJOdbELFFL36N0C6aeu9XEXdgFJcTXCYa1xB2N8zfCoCsISAq5doouXFKcTmfvPgNg5aRVZZwJ+SUGkecZwyuY4LcLH/GPlERR8hY6TYHOXKV31J4dqKVGgpOU4RrqZJuk390+JJTdBB+sNT6JCfl//zEspoTjmNcT8IQtChepeX8FQ4RGyQ0rlhuMMkhv7ESvBfR8miCI1SLE1tvkO+XLuZPFse4INiiYQjmJpPcuJxN1/E7vCtGqcMpYWhzZfvSav5acJRUJUDD10ITcIv8zcwCxuD9Icf7U8KocA2aTCbjclS8+c+Q7Zd/JeVfOzR+e5kpQdJq/noa8Y6R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\"","export default __webpack_public_path__ + \"static/media/btn_big_bsc.5e5ec82b.png\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/btn_big_purchasegmx.86c08dee.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx.01459500.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx_bond.ed3174dc.svg\";","export default __webpack_public_path__ + \"static/media/buy_transfer_eth.373e200e.svg\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/cross.2c9772ea.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down.4485a8ac.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down_sm.5c6065f6.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHjSURBVHgBfVO/a1NRFP7Ova8NQYkZigSDJbqJQh4Ogk4NiqIuCiJuDZgOQhGKk1P9C1Tq4KJQR12yiRWkg4ODg3EQp7ahpTSUQtMftE2bvNN7zstLXtMfH7x3f5zznXO+c+8l9GB7IlsEYZgBn8BpBtUJqFjCZP/o4qe4L3VI7zM5apkyM3wcjyq8oJB8VqvKwkRENM10L9EMXEbfvY8w2ev6Oaif+kdk2VBDG/bSYySefEffrTe69q69iMfMUZPK6tfWWIxbeeUfTOYqzGAB2FoGDVyBHRwCNhbAqzOiNjN+P1U10pyjxFF/Sse9r0+x+/k2kDgD7+bbjr3FQdELu3oEOXsD3FiHzZd0pEQKvL7QrQ7kGzmOXqI0SpyDuW9K9PyRsIofY93gQNrIOcaJ9uIdWL8Ulvb/C1p/P2C3/Ci05UuxzKh7hKDi4gx1IrqsxpUskC5LqZQ6HxpdFd3MXLEv754mQ/Qg2gwWf2m3ldBYA5066wLMOwlTaP1+7cpptNn8Snu18+7cH2lcR7O7EKLZ5kew93Ncgx0AczX5fOmCp/Nm8BCWpkGUi7Kr5tkpHIIjunMqaBL5Jcdq4YYYToDoFD/1R+xhRNicyBQt0TAz+URIu/teJ3Ik4snkaO3Aq9oHE/y09owWmgYAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGoSURBVHgBpVM7SwNBEJ7ZXHwSH6CFlQG1sPMB5hAUrQQro8ZgpWCpkNhZCLn8ApPCTrC0CDGpUvpsYoQQLSysoq2CSKIhJHfj7pm73AmagB8szDc3s/PNzB7CD5QSsps0ChDBEqdu3UmQA0Y5xli43ZvOW+PRSopxTxAJDuAPaERhly+jGJwZxkdMVhol6wmIoUJsSrEpKMblTSQ6FrZjcBFY34S96ksW1OeUzaeq5O3yZ5LsWwaFzAoiuVIA9SllHkf/OLQtxAE7BswLJAl1tViIyXMM6dz44JzcB+01qydaIQ37wTEwA+XrnboyUufxM+EJkAoR4WidPeQKxqERSqfTRv9Bia+sx1hG+Wr7VwVGgcrDkckJqef/CtQq3vEZNFQgDa8B8gFX0numD5mWYy5f+oLbeWswOl36xMVh/RPgHN0CacgP1fuINSzfvnx7KQlLBdp1ACaELaqLVUrdI2ak9v4I1bMNoEqx3j+QUmuj1ldcDvFnqkAzQFI6VzJh2wXNXiIG17F6E7VwO95OZHeLU+MvE8c4Hau583zOyXIVo73r9r/xCzLjs4Txvi/RAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHoSURBVHgBfVPPaxNBFP7eTBI31Wr8RdpDYRURxUMCIogemoJnrUdva/QoWC9etN0kXgXJP6C5eRK8efHSkygICYq0IDR4MIm1ECGaNMnOczNpNrtT6INd9s1775vv+2aHYITjNmwB+RCMZT+195arIFQVvGKlOF8P91M4ybvNFbB4gYOCveLLZ/OFSSqC4dVWwRw+lZK4cTUZBSDp5lcbUYC8+8sBkWtu9uDOUVw8m0D6pNwH4jxtLU8ZMPYNX89aWJiL6e8rlyyzDCFIsxX33e0cpmYF1G8tHQ7yE8cEMucTJobtPGnkBAvOmJWbSzOQPuuNrQE+fumh+dvTUo7MRDz3e2Qmxh6lRhomkYgT4v5T2+zrvLfL2Nzpw0oQTh+X6PwbBr0MSsVIcpu9KWp/wPj2vQ9PAecW4nptOGT8/KPAKsqUwG3hKaqZEqxDhAt2HOufu9hpe0jNSixeTqLTjSIopqoWdXettUUgO1y8d3sW1/yT+FDb1azevO/gb5dD9Ln+qpQ+o4+RCY9MFq/fdfTuSYvw6WsvMrwnoKCNHL2q6883MouPR/91blIe+F79aI4NG7GIUAcXKqV0eexDKJy1bVf4RRwQCmqlUporBzzMBn0blXR9WVm/mB3rRZ0Yb5XwyuZt/A/V0KylFRZwagAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEHSURBVHgBjVMLEYQgEGUuAQ3EJNrACNLACEYwgjYwAhGwAZqAa8DxdsAB8Rx3Zt3Zx779gYyVIr0qr9arCxZ+zx5EeNWB8E9NiCuIhnP+RHThvEhARK21W9fVCSHcMAxumiay8JdlccaYmECnM1JmBNyJtZbsPM9pJ7QDFQFUQCAqNE1DGCx8yGUs8M6tOiklBXVdl83ati3hGCHB7cd/eOy/qiqy27Zl29z3nayvnMIc5G/0juMgW9d1RvaVsyRBvsXMcUF935OPljEzMPjXmWUElFLZdq+Cq0yWdr44DRAVcLc4xNLGcaQOcAYc56G6SfsXAC5tvX5hZwL2/Lb1HTEVyV7+VT9KbxPpO/XgrgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFDSURBVHgBrZIxUoNQEIbfvkcVmxyBJmoSC3MDPIGWJmNBTgCeALhBPEGoJCVHwBNoJRgbvEGqjEXYdWHChHlA4Uz+hvfe/PuxO/uD6JH58D4cDC58Pt4jwjLbjJIuH3QXDlwA6RDRsGEMCyyCbDPOewE3T98WIq1LjugTUoACwxpUAa4fU1MpY81/tDSzz+YfCdITAE1oTnR4TqNJbJQ3KZXVLCYSCVGxbLQbThZfHgjpkqjGYpjh8DeWrQ4R/DS6vNNn/Xy9Cgo8zHR/C6AU5KJHOrQT8F+dHwBEZp+5zIj+ZugPKMifLrZmMzRauNoAxCJRSvHqhFXe2WLzau3pfLviHX8QoV9y6mIOz44Q4+P5JA6U3RGa03hVIa32v/uXPJ7tWoBa43nmggCnCeoIl+gFHLsxeQyPK2+RE5hFo7cu3x+G+J1ieOsLEAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEuSURBVHgBlVO9UgJBDP6wszut7LxWG6mtHF9AHR8A3gB9Anpt7C3Aws5CZ9TKmbOhgzlooIKDBjoWKuhCQrif5ff4ZjJ7m82X5MvuAUsgojybx2ZIYRb7HDaBD102n7YjkLh1xIDSwU6wBzGEn9SYcPfTJsgJ2bNcZsKeDjf2rIlKVd63ubehnsXwDrh4dmV69QHgOsBoCvTGwN078PDD/n4yKitkxyKOJmo3ZyIKKF4DhUtN9Pirq8KRto3VdvGPWzR2m7LmP1jKE1HhOxIoletR1c8m8NXSyu6R+v47al0DnLIvk4nECfktIjuHGiQayzXgpcJJjoHbc6B0DzR4FhcnYXQ5vC7fuiqZ9tWrrnGb+h3MVQa7X5gkCvXHkDjXGjKle6L+CnEpSeq/agZ2kCMI5PSNywAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAI/SURBVHgBfVNNaFNBEJ7dF6sRUhJUqglK/KG8kEKF1tSCQiH1WEguHltvXgJG0iLtJcnFIFFsIR48xpteInpsAgpCTPRQpcHnXw1CA4KY0iCK5L11ZrfvNemhA8vb2flm9vtm9jHYY/qtatA0XTc4FzEQEKQzAbCGnzXOzaxxZ7LZi2e9Tmj+ddJi/D7sYwxE1shPZGyfOzcv1DJ2cuJKAGYvDTlJc5eHID5+FBQbliZsXwF9oX6NAgHfQSglR8BzSIPS25/4dclVXm9D5IwHY2EZI+xwqhZzCggGaXWzHyrrvyD3/Dt0/prSp7XZ/geLT75BpbEFD+bOKSkaSLZcT72ZomZFznrkLYVySwJyV0/DoFuTKzHtl2eF1U3MZBKHtwb1VHXKJbgYpSAdFl/9cHST5mjuPTLpwgVK2LEKyomGfVDf6IDg2igXgnkpQPoJbFthtSXpFq/rEDpx2DnfRgyxktIxlzMmtsghzdQwMgJ8aP2G2HIDEsXPOIXjToFBxGz/MVUfMJczy3xHTrnRhumwV92CgKWZU3Kc8fFj6O8yi474sJltuTfpcRn3Jl/gvln/2pENio+pec8+NFDWAIT8bslEvgd8GwHvgNSPAppf8pGXkrOwxE3GWWnx8QY8Qs2USNOgriu9TLEZOyILqxzISBk2teH5WpoxlqFkApPR7MmWZk6Cx+2C28/U+xBCZD7dncj2FegtAvualfyYv7hie2xvWE9Wg9YBLY2B86AWWdMS7KnW7a4Yy/1/43+jYdjzTW6D2QAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHYSURBVHgBlVM9SCNBFH4zu0rk7nSvuuO8g72zuas81MafQrEVRYuUatDeYONfkU0VtVDSC0HFysJYWigR/Cn9AdFGXDCYiEViUBR15jkz68ZNiIIfPN7bN+9973vDLIEimLGg8UQrghxIFyXElDmOaBOCiTLGo3ZgyvbWE+9H9cJEUCRCCGjAGyAMw8lAxHK/NTf4OT9mCbqICH3wHihprepsIbnVrUReQfXCeL9wMUX02YBfn76W7D2/zUDyJqtizp66U4HpuP5yFnKL/H/qYLi2vSTBzME6zBxuOEI0fVa4ODFj4/8fNdhzixq//VYmMfivWfm5423ldy/PlEH+PlibznRqAvJ88iiTUlZVXgH+mnqoLPfB3MkOVJb5IHmbLVDEdK1W58gN7/Tcw70ikF7i+uFOxdLkuSRcOz92FAAYupdRypNF/po61XiUuXBW+dukLlCSuM0SCJDVGWMJTdMKSNw9ww0doghhILEEpYCI+zQtX5Z4ZfBBiGY73RvZpM4uPAwfhNjfkl5pz61s2196mkWStHqL5GUun+7B1f1N0XRuXfRNRl+IXvFjcTREkFrvDM5yZFaqbyrqUVKI77ERk2h0iKJQQ8B0RoKNwOOc43y66G98Bj1CxfZyFDl9AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAILSURBVHgBdVJNaBNBFP5msjFRobsVsRVtGEE9RVgFT0VIQS9ejBfFk6voRRA82aBoLkLoLacetZ4EDzYo2INCAtKDl2bxKBTWRDH4uyuIxmRnnDdN0iS07zLvvZnvvfd98xjG7NtMwYNilxljrlLK0WeoTz/BsTTZKD0efsv6zk8xL2SXLyvAxTbGGAKekHOTwUIwABtgzKtKQVAcyTaacajPv8gmp2Hz1JYFLEoMA5/8fodfqg3oxMfd/3D362uc3XkUtydOGTC9kx2+rN3jrMfxEV28/PMeGcvBK7eD04UryOVyBlCr1fD25iKuhYcHE2gNPIvE6SeacYTWyT14sDKiiykiXgg8PXcPF37MmFws4XFNwgi02v5gOp8p3dhSLCEE0ldnERGlDXN1Z+WQN8HSJhMEAcrlMlzXRaVSQT6fHynS7Eawk/vIdSzdOaQCGcs2VWnEMAzhOI7x+3EURajX6+YHehZSZ59o2TyNS7uOwfd9eJ5nbse7rr9Zw2wq04uUz6VSA3Wyepz712+Z0ceNik49W99MKLZkluT7wTt1BeWeaC2ioTmROMVi0fAmqz5fQerhGi7GR3pABHs/lQ4Z8OfpeZFM8KreN7Habox0tFkK2R1TQx0RdGI5t7+1EAx2e7gAtjG9XX43lucJSDEbf/DlQMHjDHpxuJ6ZvlH/BqRPHPWoI9vzH5xq3+2NFxVlAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/icon_arrow.5a2e0b83.svg\";","export default __webpack_public_path__ + \"static/media/icon_check.11b53f10.svg\";","export default __webpack_public_path__ + \"static/media/icon_close.0c82fb42.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_sm.d5bc42f1.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_toast.0a4cfb5c.svg\";","export default __webpack_public_path__ + \"static/media/lock.d4328791.svg\";","export default __webpack_public_path__ + \"static/media/flag_en.c92a8361.svg\";","export default __webpack_public_path__ + \"static/media/flag_es.4ba7dfef.svg\";","export default __webpack_public_path__ + \"static/media/flag_fr.589da1a2.svg\";","export default __webpack_public_path__ + \"static/media/flag_ja.81aa61af.svg\";","export default __webpack_public_path__ + \"static/media/flag_ko.97c8fe63.svg\";","export default __webpack_public_path__ + \"static/media/flag_ru.0c71e16b.svg\";","export default __webpack_public_path__ + \"static/media/flag_zh.fd0e8daf.svg\";","export default __webpack_public_path__ + \"static/media/glp_icon.ef02d046.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABPCAQAAAC3gKgqAAADyUlEQVR4Ae3BfWhVdQDH4e/Z3Uvb2lZukS5sOEI3UHS95xbBqg2iQmcvpCRZZClYkBoWaAvpD0ncHxVCFjE0iyE6eyFqK6K3RRTaiy1ptaXljDnL29h2t7v7iZGeTuuen9vd7r3nynke+Xw+n8/n800EWToXUMKrVCnVkcELwPsUKbWxlH5GbcZS6mI23/OPk9QqVZHNTv7VxiVKTawkhFMDAaUeKujkv4LUKdWQTzP/9zWlSi2sI0w0O8hU6qCSbqIbYLlSBYW04O4w5UoFWNQTwWQ3OfI+aujFbIhV8jqKaePsuqiQlxGggfHZT768iyX8xfiMsF5eRSnfMn7dVMmLyOJlJqaFafIe7mOQiYnwFJa8hXl0MHG91MhLyKWJ2LRRLO/gEYaJ1TYC8gau5iixC7JIXsAFvI1ZK3sxOcAsJR9PEMGki/mUcBCTF8lUcnEDv2MyxCpJoo4g7vpZqmTiIj7EbDc5kkSABkzaKVOykMYzmP1AuU6jmM8x2UW2koNb+AOTAe6VA7WcxN0QDysZmMkXmO0gUw5YbMakkwVKNNJ5DrODzNIYFPEBJs3kKbG4iz5MgixWFFzPcdyFeUyJxGV8h9lWAoqKxxnB3TEWKlE4j0bMPmOGbAQIyEYBb2DSQqESg/sZxKSXm+XAA6yWA1fQhbsIm5QIzOMnzOqxZKOCI3RzrRxYzRDuTnCj4o3z2YNZC4Wykc9+Rr3LNNnI4TVMPmGG4otHCWNyjIVyYB1hRkXYKAfKOYzJs6QpfriGXzEJs1YOVNLNGT1Uy4HlDODuFLcrXriQdzDbR55sFNKK00dcLBtZvITJV5QoPthIBJOfmS8bFk8z1hbSZKOUbzDZTqamHtX0YBLiQTlQQy9j/cmtcuAO+nDXzzJNNabzMWaNZMtGMW1E8yUzZSOdBkzaKdNUIo0tmB1itmwE2Iab58mQjWLaMNlJtqYOt3EKkyB3yoHFBHHTx91yoJZe3IV4SONi6awo0V5dLpNf1KiQLI1C6bpHZXJ3SIusDp2GpXo9qXS56VKddUCTRwbbmWqvkCUbRbRiso88TR7L6GeqDbJCDlRxHHdh1mqymEM78dDBXDmwgRHc/cZ1mgyy2UW8NJErGwW8icl7FCp2rCREvAyzRg5cyRHcRdikWLGATuLpKFfJgTUM4+4ENykW5NNMvL1FgWzk0oTJp0zXxLGeMPE2wgY5MJcfMdlKQBNDJT0kQi/VcmAFIdz1s0Qu0hVdjpoV0fhZik1Al2JZ6IzXVag5iii6dOXKq7Dk8/l8Pp/Pd676GwYUP6Kwt1/bAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/gmx-logo-final-white.b7833ed6.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-final.0b59e423.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-glow.83c5aea5.png\";","export default __webpack_public_path__ + \"static/media/gmx_logo.2b33868e.svg\";","export default __webpack_public_path__ + \"static/media/graphite-01.6f3526cd.png\";","export default __webpack_public_path__ + \"static/media/ic-communityproject.9b5f97dd.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_16.f4c1a9fe.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_96.b12913b6.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_hover_16.d779b479.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowleft16.21502a04.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowright16.b425521a.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_16.90aca01d.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_96.b6255c50.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_30.403cd87e.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_40.ba220dde.svg\";","export default __webpack_public_path__ + \"static/media/ic_banxa.06412144.svg\";","export default __webpack_public_path__ + \"static/media/ic_binance_logo.46794a16.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc.8de996f1.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc_96.369f1d28.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_40.1560513c.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.1560513c.svg\";","export default __webpack_public_path__ + \"static/media/ic_buy_glp.8eb00e6a.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAsCAYAAAAq/ZsdAAAFI0lEQVR4Ac1ZA5AsSRCd2FkMvm2cbdu2bdu2bdt3obN9X6tGrW3vxv6x509e5dwtukZdXYt5EW9ZNf1eZFZmVbVJL8yyfJpZlT2UYIw4VzrVlC3IJXINChNhriLXZJOh56gon4Ahbw5RHs8SO+JRwrmmbEMuIfuYiRzgNYNzcK4pG5Gryk9j+vCkGs7JGgOiqYdjj7MEzj/OErrfCHHuBBiS9slR5XpMpXTEMZtf037hcdYgiPAEe3gHU7bghBkw43hrsNWoGZw77iLNqnqWWVW+yVElNR1xDG2mZ51gCRxg1BDOHT8nkrQFFfgLpVvP+rmorRUe6ekJPtrTU3P6Lt7PDRh6Ydy85CjSlVRkxKxIusr2TrXVMBq3NnVtOGq2b5An1TBdxyfFiPwRFbmep/cc1FCvMfRgTzfY/yqLzP6iehJTTVEW5SqyRA3FU0zUEP7dUkRiW13W0X3EIu/Tx9kCDyTjsZbABWNvRi1ckUuUOr0phpxdTuDGzg742+MG4vdrDLWEQvG/v9DfB4c01ofiG9WysiWmCUF5+cxcVaniMYNrxhGNgl6scnpg578anbsfMHgKjcj+oznmfcesyKuoyCC/GT784vDBwnfqk66hY63Bv+g6WiFuRpVf5dyrwT8eD/DCR/3fWBeDZauaYaMHW1IVBwfl9SLV7HTeUylGJxnQ5Cq3B9a4fEA8G6CSeu4Pac2cQP7jrNXVsOPpPelK+Ff8JbyoaBoVOMBbzW6iRYAFVjhrURmsLGxFwRre0xiDy6q1fzuAeKGgSIVDNvKkK+Uq19rKJdKLQzsAHmI5ZmEpIbBVcReK1c0tV3fB8kebMvUnB5rS1W+ouBgl8PKk5iZg8fWAH0Vy07a6DPbbySFsCrc193JFh+k9qVDkBHixnUmxNNx6VTesvL8ZRYuZov2mnREqnHYsmv0A3/ZriwHLw0kILOuI3o2rioUi6WFtqLKJ8Pv1LtCLCk9qYzP/qYZdj+7Xu4H9KjHdiHIP00S5iUVgb+KCL3rjJVkXvNHkppaXtsCOp/bqPmIcawudwDRS5S9RMxutaxsWdHZFDN7tikGxEzKiLwQJhrYhPbDpg208Z6YWxpD0i4ihXMojSChB2JC5x1ti8OfgUFNNxEvt2jl7Egcs+LSexxBoduc0Ql4RQxsVtukuy9hUGWAkNWMOI0GYsqacwxATJbMitxk1YysqgwOJl6fX4BZIA/ydHTPr92o4YoEPhXKvJUy5P40amlZUmZBij7XEv6dMQW80s6Gt3u3kv1CxhT4wIUQu4Dcr7dCIbfYPVTAszYnEIsAAK6PGzFEkPNSLeOkYMvS3ETP2deWwB3GwZriPEGw0dyODsPDdeqNXXiv+v2OTndxbnj9rYC/iRBHxMs2PxAqHnLu6DnY5vk/sDo8K/I23uVpKCRxJwsNCvhvgiUxyM5uXdMKitxoMmUHiBYspDlWdkavIMs8WaObq6gRBuAnFNYELvYVJQexD+HeMJptmx5Eobc6tMPeLWjhyrk/IEHNiVd5BU3qiNefvGq6ewy7+Y6kJPNhtWdIFtnVlsNFDicdwYUOIPEJ2zFXjrx8bKMO5RC5KGqFfqwzdyyE3+bQN8ktVmPldNWxyeyvsv71T2AxS6D4PK0q6D79+d22N/vyRqIBYjionAvohf6d7wIuXReJGkGcuGF8zqMWYCzZKlqBTTIg4UcNQdISBR2GBF1rCxGejhjF/S4cVhj9aYlHBZ/Lf1/Gn4QFxc+PIdK9a/gVaRiAcqhHzNAAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/ic_cash.21569a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_checked.b4f2217c.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_hover_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_convert_down.74b7eb02.svg\";","export default __webpack_public_path__ + \"static/media/ic_copy_16.fafdf331.svg\";","export default __webpack_public_path__ + \"static/media/ic_cost.56371371.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.6f901476.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_40.5e255508.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.1e127166.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_40.087335c1.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_custom.11dd75db.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx.bf8fb0b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_30.375de394.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_40.8cd483b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_64.f4caeaad.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_arbitrum.59f04e87.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_avax.fb50658c.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_big.a0a74216.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_custom.fd35b66a.svg\";","export default __webpack_public_path__ + \"static/media/ic_hop.0f4a98a0.svg\";","export default __webpack_public_path__ + \"static/media/ic_info.f334ee0a.svg\";","export default __webpack_public_path__ + \"static/media/ic_language24.ceaebef6.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.4bb3a048.svg\";","export default __webpack_public_path__ + \"static/media/ic_liquidity.f00d35e4.svg\";","export default __webpack_public_path__ + \"static/media/ic_menu_dots.87c2cfaa.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_hover_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_40.42c8b575.svg\";","export default __webpack_public_path__ + \"static/media/ic_multiswap.e577f4fa.svg\";","export default __webpack_public_path__ + \"static/media/ic_new_link_16.5b7cb7bf.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus.70b17676.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus_arbitrum.b358dc93.svg\";","export default __webpack_public_path__ + \"static/media/ic_selector_dropdowns.aaf0b8f0.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_16.9d97766b.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign in_16.b6f5b1d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign_out_16.1b0564f3.svg\";","export default __webpack_public_path__ + \"static/media/ic_simpleswaps.4cd51f2a.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats.f0a18011.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats_big.4a4ebfb7.svg\";","export default __webpack_public_path__ + \"static/media/ic_synapse.b100121a.svg\";","export default __webpack_public_path__ + \"static/media/ic_tokens.6a27251b.svg\";","export default __webpack_public_path__ + \"static/media/ic_totaluser.e274ef10.svg\";","export default __webpack_public_path__ + \"static/media/ic_trading.2c53815a.svg\";","export default __webpack_public_path__ + \"static/media/ic_transfer_avax.53893264.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.efe1f12f.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.e357d24a.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_40.ba36eda4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.334ca16a.svg\";","export default __webpack_public_path__ + \"static/media/lg_arbitrum.bdf133fe.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX.b956aa96.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX_small.f593fa5c.svg\";","export default __webpack_public_path__ + \"static/media/long.0bc4a064.svg\";","export default __webpack_public_path__ + \"static/media/metamask-text.2f9c2df2.svg\";","export default __webpack_public_path__ + \"static/media/page-not-found.bb90d073.svg\";","export default __webpack_public_path__ + \"static/media/short.1f94a0c2.svg\";","export default __webpack_public_path__ + \"static/media/trading.7ea1604c.jpg\";","export default __webpack_public_path__ + \"static/media/wallet-connect-text.78166b41.svg\";","export default __webpack_public_path__ + \"static/media/wave-01.3c9bce1e.png\";","export default __webpack_public_path__ + \"static/media/wave-02.4a56e8c7.png\";","var map = {\n\t\"./ic_arbitrum_24.svg\": 261,\n\t\"./ic_avalanche_24.svg\": 262,\n\t\"./ic_avax_24.svg\": 263,\n\t\"./ic_btc.b_24.svg\": 264,\n\t\"./ic_btc_24.svg\": 265,\n\t\"./ic_busd_24.svg\": 266,\n\t\"./ic_dai_24.svg\": 267,\n\t\"./ic_eth_24.svg\": 268,\n\t\"./ic_frax_24.svg\": 269,\n\t\"./ic_glp_24.svg\": 270,\n\t\"./ic_gmx_24.svg\": 271,\n\t\"./ic_link_24.svg\": 272,\n\t\"./ic_mim_24.svg\": 273,\n\t\"./ic_settings_24.svg\": 274,\n\t\"./ic_tether_24.svg\": 275,\n\t\"./ic_uni_24.svg\": 276,\n\t\"./ic_usdc.e_24.svg\": 277,\n\t\"./ic_usdc_24.svg\": 278,\n\t\"./ic_usdt_24.svg\": 279,\n\t\"./ic_wallet_24.svg\": 280,\n\t\"./ic_wavax_24.svg\": 281,\n\t\"./ic_weth_24.svg\": 282\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 575;","var map = {\n\t\"./en/messages.po\": [\n\t\t609,\n\t\t4\n\t],\n\t\"./es/messages.po\": [\n\t\t610,\n\t\t5\n\t],\n\t\"./fr/messages.po\": [\n\t\t611,\n\t\t6\n\t],\n\t\"./ja/messages.po\": [\n\t\t612,\n\t\t7\n\t],\n\t\"./ko/messages.po\": [\n\t\t613,\n\t\t8\n\t],\n\t\"./ru/messages.po\": [\n\t\t614,\n\t\t9\n\t],\n\t\"./zh/messages.po\": [\n\t\t615,\n\t\t10\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 606;\nmodule.exports = webpackAsyncContext;","import React from 'react';\r\n\r\nconst Logo = () => {\r\n\treturn (\r\n\t\t<div className=\"logo-wrapper\">\r\n\t\t\t<a className='logo' href=\"/index.html\">DeDeLend</a>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Logo;","import React from 'react';\r\nimport cx from 'classnames';\r\n\r\nconst Button = ({children, className, clickHandler, disabled, isMain, ...props}) => {\r\n\tconst classes = cx('btn', className, (isMain && 'btn_main'), (props.btnActive && 'btn_hlight'));\r\n\t\r\n\tconst childProps = { ...props };\r\n\tdelete childProps.btnActive;\r\n\t\r\n\treturn (\r\n\t\t<button {...childProps} disabled={disabled} className={classes} data-text={children}>\r\n\t\t\t{\r\n\t\t\t\tisMain ? \r\n\t\t\t\t\t<span>{children.toString()}</span> :\r\n\t\t\t\t\tchildren\r\n\t\t\t}\r\n\t\t</button>\r\n\t);\r\n};\r\n\r\nexport default Button;","export default __webpack_public_path__ + \"static/media/icon-wallet.fade0d04.svg\";","export default __webpack_public_path__ + \"static/media/icon-link.d25d108e.svg\";","import React, { useState } from 'react';\r\nimport icon_wallet from '../img/icon-wallet.svg';\r\nimport icon_link from '../img/icon-link.svg';\r\nimport Button from './UI/button/Button';\r\n\r\nconst Wallet = ({ address, setAddress, setAccount }) => {\r\n\tconst [open, setOpen] = useState(false);\r\n\r\n\tfunction openWallet(e) {\r\n\t\tif (open) {\r\n\t\t\tcloseWallet();\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\te.stopPropagation();\r\n\t\tdocument.addEventListener('click', closeWallet);\r\n\t\tsetOpen(true);\r\n\t}\r\n\tfunction closeWallet() {\r\n\t\tdocument.removeEventListener('click', closeWallet);\r\n\t\tsetOpen(false);\r\n\t}\r\n\r\n\r\n\tfunction cutAddress(addr) {\r\n\t\tif (!addr) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\t\r\n\t\treturn addr.slice(0, 9) + '...' + addr.slice(-15);\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className={\"wallet\" + (open ? \" active\" : \"\")}>\r\n\t\t\t<button className=\"wallet__header\" onClick={openWallet}>\r\n\t\t\t\t<div className=\"wallet__address\">\r\n\t\t\t\t\t<img src={icon_wallet} alt=\"ETH\" />\r\n\t\t\t\t\t<span>\r\n\t\t\t\t\t\t{cutAddress(address)}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t</button>\r\n\t\t\t<div className=\"wallet__body\" onClick={(e) => e.stopPropagation()}>\r\n\t\t\t\t<button className=\"close-btn\" onClick={closeWallet}>\r\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" fill=\"none\">\r\n\t\t\t\t\t\t<g clipPath=\"url(#clip0_1830_494)\">\r\n\t\t\t\t\t\t\t<path d=\"M10 0.875L9.125 0L5 4.125L0.875 0L0 0.875L4.125 5L0 9.125L0.875 10L5 5.875L9.125 10L10 9.125L5.875 5L10 0.875Z\" fill=\"white\"/>\r\n\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t\t<clipPath id=\"clip0_1830_494\">\r\n\t\t\t\t\t\t\t\t<rect width=\"10\" height=\"10\" fill=\"white\"/>\r\n\t\t\t\t\t\t\t</clipPath>\r\n\t\t\t\t\t\t</defs>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t\t<a className=\"wallet__link\" href={`https://arbiscan.io/address/${address}`} rel='noreferrer' target='_blank'>\r\n\t\t\t\t\t<img src={icon_link} alt=\"external link\" />\r\n\t\t\t\t\t<span>View on Arbiscan</span>\r\n\t\t\t\t</a>\r\n\t\t\t\t<Button className=\"wallet__button\" btnActive={true} onClick={() => {\r\n\t\t\t\t\tsetAddress('');\r\n\t\t\t\t\tsetAccount('');\r\n\t\t\t\t}}>\r\n\t\t\t\t\tDisconnect wallet\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Wallet;","import { createContext } from \"react\";\r\n\r\nexport const GlobalStatsContext = createContext(null)\r\nexport const UserStatsContext = createContext(null)","import { ethers } from 'ethers';\r\n\r\nconst ARBITRUM = 42161;\r\n\r\nexport const requestAccount = async (setWalletAddress) => {\r\n\tif (window.ethereum) {\r\n\t\ttry {\r\n\t\t\tif (window.ethereum.networkVersion && Number(window.ethereum.networkVersion) !== ARBITRUM) {\r\n\t\t\t\talert('Change your network (Arbitrum) and reload the page')\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait window.ethereum.request({\r\n\t\t\t\t\t\tmethod: \"wallet_switchEthereumChain\",\r\n\t\t\t\t\t\tparams: [{\r\n\t\t\t\t\t\t\tchainId: ethers.utils.hexlify(ARBITRUM)\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\twindow.location.reload()\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\tconsole.log(err);\r\n\r\n\t\t\t\t\tif (err.code === 4902) {\r\n\t\t\t\t\t\tawait window.ethereum.request({\r\n\t\t\t\t\t\t\tmethod: \"wallet_addEthereumChain\",\r\n\t\t\t\t\t\t\tparams: [{\r\n\t\t\t\t\t\t\t\tchainId: ethers.utils.hexlify(ARBITRUM),\r\n\t\t\t\t\t\t\t\tchainName: 'Arbitrum One',\r\n\t\t\t\t\t\t\t\tnativeCurrency: {\r\n\t\t\t\t\t\t\t\t\tsymbol: 'ETH',\r\n\t\t\t\t\t\t\t\t\tdecimals: 18\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\trpcUrls: ['https://arb1.arbitrum.io/rpc'],\r\n\t\t\t\t\t\t\t\tblockExplorerUrls: ['https://arbiscan.io/']\r\n\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\twindow.location.reload()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst accounts = await window.ethereum.request({\r\n\t\t\t\tmethod: 'eth_requestAccounts',\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tsetWalletAddress(accounts[0])\r\n\r\n\t\t\twindow.ethereum.on('accountsChanged', (accounts) => {\r\n\t\t\t\tsetWalletAddress(accounts[0])\r\n\t\t\t})\r\n\t\t} catch(e) {\r\n\t\t\tconsole.log(e);\r\n\t\t}\r\n\t\t\r\n\t} else {\r\n\t\talert('Please, install MetaMask extension to use this application.');\r\n\t}\r\n}\r\n\r\nexport const connectWallet = async (setWalletAddress) => {\r\n\tawait requestAccount(setWalletAddress);\r\n}\r\n\r\n\r\nexport const cutAddress = (addr, isAdaptive = true) => {\r\n\tif (!addr) {\r\n\t\treturn '';\r\n\t}\r\n\r\n\tif (isAdaptive && window.outerWidth <= 480) {\r\n\t\treturn addr.slice(0, 3) + '...' + addr.slice(-3);\r\n\t}\r\n\t\r\n\treturn addr.slice(0, 10) + '...' + addr.slice(-5);\r\n}","import { ethers } from 'ethers';\r\n\r\nexport const netProvider = new ethers.getDefaultProvider('https://arb-mainnet.g.alchemy.com/v2/r6kd0heyoOCe8RFndkyv0XW0F-BG38Fy');\r\n\r\n\r\nexport const mmProvider = window.ethereum ? new ethers.providers.Web3Provider(window.ethereum) : undefined;\r\n\r\nexport const signer = mmProvider?.getSigner()","import { ethers } from 'ethers';\r\nimport _DDL_ETH from '../../deployments/arbitrum_ddl/DDL_ETH.json'\r\nimport _DDL_BTC from '../../deployments/arbitrum_ddl/DDL_BTC.json'\r\nimport _DDL_POOL from '../../deployments/arbitrum_ddl/DDL_POOL.json'\r\nimport _OptManager from \"../../deployments/arbitrum_ddl/OptionsManager.json\";\r\nimport _USDC from \"../../deployments/arbitrum_ddl/USDC.json\";\r\nimport _PriceProviderETH from \"../../deployments/arbitrum_ddl/PriceProviderETH.json\";\r\nimport _PriceProviderBTC from \"../../deployments/arbitrum_ddl/PriceProviderBTC.json\";\r\nimport {netProvider, mmProvider, signer} from './providers.js'\r\n\r\nimport _AccountManager from \"../../deployments/arbitrum_ddl/accountManager.json\";\r\nimport _AccountManagerToken from \"../../deployments/arbitrum_ddl/accountManagerToken.json\";\r\nimport _Doppelganger from \"../../deployments/arbitrum_ddl/Doppelganger.json\";\r\nimport _DDL_GMX from \"../../deployments/arbitrum_ddl/DDL_GMX.json\";\r\n\r\nimport _Vault from \"../../deployments/arbitrum_ddl/vault.json\";\r\nimport _WETH from \"../../deployments/arbitrum_ddl/WETH.json\";\r\n\r\n// Options Contracts\r\nexport const DDL_ETH = new ethers.Contract(_DDL_ETH.address, _DDL_ETH.abi, mmProvider ?? netProvider);\r\nexport const DDL_ETH_signed = DDL_ETH.connect(signer);\r\n\r\nexport const DDL_BTC = new ethers.Contract(_DDL_BTC.address, _DDL_BTC.abi, mmProvider ?? netProvider);\r\nexport const DDL_BTC_signed = DDL_BTC.connect(signer)\r\n\r\nexport const DDL_POOL = new ethers.Contract(_DDL_POOL.address, _DDL_POOL.abi, mmProvider ?? netProvider);\r\nexport const DDL_POOL_signed = DDL_POOL.connect(signer)\r\n\r\nexport const OptManager = new ethers.Contract(_OptManager.address, _OptManager.abi, signer)\r\n\r\nexport const USDC = new ethers.Contract(_USDC.address, _USDC.abi, mmProvider ?? netProvider)\r\nexport const USDC_signed = USDC.connect(signer)\r\n\r\nexport const PriceProviderETH = new ethers.Contract(_PriceProviderETH.address, _PriceProviderETH.abi, mmProvider ?? netProvider)\r\n\r\nexport const PriceProviderBTC = new ethers.Contract(_PriceProviderBTC.address, _PriceProviderBTC.abi, mmProvider ?? netProvider)\r\n\r\n\r\n// GMX Contracts\r\nexport const DDL_AccountManager = new ethers.Contract(_AccountManager.address, _AccountManager.abi, signer);\r\nexport const DDL_AccountManager_abi = _AccountManager.abi;\r\n\r\nexport const DDL_AccountManagerToken = new ethers.Contract(_AccountManagerToken.address, _AccountManagerToken.abi, signer);\r\n\r\nexport const DDL_GMX = new ethers.Contract(_DDL_GMX.address, _DDL_GMX.abi, signer);\r\n\r\nexport const Vault = new ethers.Contract(_Vault.address, _Vault.abi, signer);\r\nexport const WETH_address = _WETH.address;\r\n\r\n\r\nexport function getDgContract(dgAddress) {\r\n\tconst contract = new ethers.Contract(dgAddress, _Doppelganger.abi, signer);\r\n\treturn contract;\r\n}\r\n","export const separateThousands = (num, symb = \",\") => {\r\n\tif (typeof num === 'undefined' || num === null) {\r\n\t\treturn '';\r\n\t}\r\n\t\r\n\tconst str = num.toString();\r\n\tlet [intPart, fractionPart] = str.split('.')\r\n\tconst hasFraction = fractionPart !== undefined;\r\n\r\n\tintPart = intPart.replace(/\\B(?=(\\d{3})+(?!\\d))/g, hasFraction ? ',' : symb)\r\n\t\r\n\tif (hasFraction) {\r\n\t\tif (fractionPart.length === 1 && symb !== ' ') {\r\n\t\t\tfractionPart += '0'\r\n\t\t}\r\n\t\t\r\n\t\treturn intPart + '.' + fractionPart\r\n\t} else {\r\n\t\treturn intPart;\r\n\t}\r\n}\r\n\r\n\r\nconst removeNonNumeric = (num) => {\r\n\tlet result = num.toString().replace(/^\\./g, '').replace(/[^0-9.]/g, '').replace(/^0\\d/, '')\r\n\r\n\tif (result.match(/\\./g)?.length > 1) {\r\n\t\tresult = result.replace(/\\.$/, '')\r\n\t}\r\n\r\n\tlet [, fractionPart] = result.split('.')\r\n\r\n\tif (fractionPart?.length > 6) {\r\n\t\tresult = result.substr(0, result.length - 1)\r\n\t}\r\n\t\r\n\treturn result;\r\n}\r\n\r\nexport const convertInputNum = (num) => {\r\n\treturn separateThousands(removeNonNumeric(num), ' ')\r\n}\r\n\r\n\r\nexport const sepToNumber = (str, symb = ' ') => {\r\n\tif (typeof str !== 'string') {\r\n\t\treturn str;\r\n\t}\r\n\t\r\n\treturn Number(str.split(symb).join(''));\r\n}","import { sepToNumber } from \"./sepThousands\";\r\n\r\nexport const floor = (num, fraction = 2) => {\r\n\tif (typeof num !== 'number') {\r\n\t\treturn '...'\r\n\t}\r\n\t\r\n\treturn Math.floor(num * 10**fraction) / 10**fraction;\r\n}\r\n\r\n\r\nexport const formatForContract = (val, fraction = 6) => {\r\n\treturn Math.floor(sepToNumber(val) * 10**fraction);\r\n}","import { ethers } from \"ethers\"\r\nimport { DDL_ETH, DDL_ETH_signed, USDC, DDL_POOL, DDL_BTC, DDL_BTC_signed } from './contracts';\r\nimport { floor } from './math';\r\n\r\n\r\nexport const getGlobalStats = async () => {\r\n\tconst globalStats = {}\r\n\t\r\n\tconst totalBalance = (await DDL_POOL.getTotalBalance()).toNumber()\r\n\t\r\n\tconst totalLocked = (await DDL_POOL.totalLocked()).toNumber()\r\n\tconst totalSupplied = totalBalance + totalLocked;\r\n\tglobalStats.totalSupplied = Math.round(ethers.utils.formatUnits(totalSupplied, 6));\r\n\tglobalStats.availToBorrow = Math.round(ethers.utils.formatUnits(totalBalance, 6));\r\n\tglobalStats.totalBorrowed = Math.round(ethers.utils.formatUnits(totalLocked, 6));\r\n\t\r\n\tglobalStats.utilRate = floor(totalSupplied === 0 ? \r\n\t\t0 : (totalLocked / totalSupplied * 100))\r\n\tglobalStats.borrowAPY = 10;\r\n\t\r\n\t\r\n\treturn globalStats;\r\n}\r\n\r\nexport const getUserStats = async (walletAddress) => {\r\n\ttry {\r\n\t\tconst balance = Number(ethers.utils.formatUnits(await USDC.balanceOf(walletAddress), 6))\r\n\t\tconst curBalance = Number(ethers.utils.formatUnits(await DDL_POOL.shareOf(walletAddress), 6))\r\n\t\r\n\t\tconst totalBalance = (await DDL_POOL.getTotalBalance()).toNumber()\r\n\t\tconst avail = Math.min(curBalance, totalBalance)\r\n\t\r\n\t\tconst userStats = {\r\n\t\t\tbalance: floor(balance),\r\n\t\t\tcurBalance: floor(curBalance),\r\n\t\t\tavail: floor(avail),\r\n\t\t}\r\n\t\r\n\t\treturn userStats;\r\n\t} catch(err) {\r\n\t\tconsole.log(err);\r\n\t}\r\n\t\r\n}\r\n\r\n\r\nexport const getOptionStats = async (id, isETH) => {\r\n\tconsole.log('getting option stats', id);\r\n\r\n\tconst contract = isETH ? DDL_ETH_signed : DDL_BTC_signed;\r\n\t\r\n\tconst intrinsicValue = Number(ethers.utils.formatUnits(await contract.profitByOption(id), 6))\r\n\tconst borrowLimit = Number(ethers.utils.formatUnits(await contract.maxBorrowLimit(id), 6))\r\n\tconst borrowLimitUsed = Number(ethers.utils.formatUnits((await contract.borrowedByOption(id))[0], 6))\r\n\tconst liqPrice = Number(borrowLimitUsed) === 0 ? '' : Number(ethers.utils.formatUnits(await contract.currentLiqPrice(id), 8))\r\n\r\n\treturn {\r\n\t\tintrinsicValue: floor(intrinsicValue),\r\n\t\tborrowLimit: floor(borrowLimit),\r\n\t\tborrowLimitUsed: floor(borrowLimitUsed),\r\n\t\tliqPrice: (typeof liqPrice === 'string') ? liqPrice : floor(liqPrice),\r\n\t\trealVals: {\r\n\t\t\tintrinsicValue,\r\n\t\t\tborrowLimit,\r\n\t\t\tborrowLimitUsed,\r\n\t\t\tliqPrice,\r\n\t\t},\r\n\t\tcontract,\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { Link } from \"react-router-dom\";\r\nimport cx from 'classnames';\r\n\r\nconst Tabs = ({className, links}) => {\r\n\tconst cls = cx(className, 'tabs');\r\n\t\r\n\treturn (\r\n\t\t<div className={cls}>\r\n\t\t\t{links.map((link) => {\r\n\t\t\t\tif (link.isHidden) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst linkCls = cx('btn', 'btn_tab', link.isActive && 'active')\r\n\t\t\t\tconst linkEl = link.isExternal ?\r\n\t\t\t\t\t<a className={linkCls} target=\"_blank\" rel=\"noreferrer\" href={link.to}  key={link.to}>{link.name}</a>\r\n\t\t\t\t\t: <Link to={link.to} className={linkCls} key={link.to}>{link.name}</Link>\r\n\t\t\t\treturn (\r\n\t\t\t\t\tlinkEl\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t\t\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Tabs;","import React from 'react';\r\n\r\nconst Modal = ({children, className, visible, setVisible, resetModal, isObligatory}) => {\r\n\tconst classes = ['modal', className]\r\n\r\n\t\r\n\tif (visible) {\r\n\t\tclasses.push('active')\r\n\t}\r\n\r\n\tconst closeModal = () => {\r\n\t\tif (isObligatory) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tsetVisible(false)\r\n\t\t\r\n\t\tif (resetModal) {\r\n\t\t\tresetModal()\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className={classes.join(' ')} onMouseDown={closeModal}>\r\n\t\t\t<div className=\"modal__content-wrapper\">\r\n\t\t\t\t<div className=\"modal__content\" onMouseDown={e => e.stopPropagation()}>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{isObligatory ?\r\n\t\t\t\t\"\" : <button className=\"close-btn\" onClick={closeModal}></button>}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Modal;","import React from 'react';\r\n\r\nconst Loader = () => {\r\n\treturn (\r\n\t\t<div className='loader-container'>\r\n\t\t\t<svg viewBox=\"0 0 100 100\">\r\n\t\t\t\t<defs>\r\n\t\t\t\t</defs>\r\n\t\t\t\t<circle className=\"loader\" style={{fill:'transparent',stroke:'#fff',strokeWidth: '7px',strokeLinecap: 'round'}} cx=\"50\" cy=\"50\" r=\"45\"/>\r\n\t\t\t</svg>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Loader;","import React from 'react';\r\n\r\nconst Input = ({msg, ...props}) => {\r\n\tconst childProps = { ...props };\r\n\tdelete childProps.setValue;\r\n\tdelete childProps.setBtnActive;\r\n\t\r\n\treturn (\r\n\t\t<div className='input-container'>\r\n\t\t\t<input type=\"text\" {...childProps} />\r\n\t\t\t<span className=\"msg\">{msg}</span>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Input;","import React, { useState, } from 'react';\r\nimport Input from './Input';\r\nimport { convertInputNum } from '../../utils/sepThousands';\r\n\r\n\r\nconst NumberInput = (props) => {\r\n\t\r\n\treturn (\r\n\t\t<Input\r\n\t\t\t{...props}\r\n\t\t\tvalue={props.value}\r\n\r\n\t\t\tonChange={e => {\r\n\t\t\t\tif (props.setBtnActive) {\r\n\t\t\t\t\tprops.setBtnActive(true)\r\n\t\t\t\t}\r\n\t\t\t\tprops.setValue(convertInputNum(e.target.value))\r\n\t\t\t}}\r\n\t\t\t\r\n\t\t\tonBlur={() => {\r\n\t\t\t\tif(!props.value && props.setBtnActive) {\r\n\t\t\t\t\tprops.setBtnActive(false)\r\n\t\t\t\t}\r\n\t\t\t}} />\r\n\t);\r\n};\r\n\r\nexport default NumberInput;","import React, { useState, useEffect } from 'react';\r\nimport NumberInput from './UI/input/NumberInput';\r\nimport Button from './UI/button/Button';\r\n\r\nconst Form = ({children, maxVal, inputProps, btnText, btnIsActive, onSubmit, modalVisible, currency, ...props}) => {\r\n\r\n\tconst [state, setState] = useState({class: '', msg: ''});\r\n\t\r\n\tlet [val, setVal] = useState('')\r\n\tif (inputProps.state) {\r\n\t\tval = inputProps.state.val\r\n\t\tsetVal = inputProps.state.setVal\r\n\t}\r\n\r\n\tconst [btnActive, setBtnActive] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!modalVisible) {\r\n\t\t\tsetState({\r\n\t\t\t\tclass: '',\r\n\t\t\t\tmsg: ''\r\n\t\t\t});\r\n\t\t\tsetVal('')\r\n\t\t}\r\n\t}, [modalVisible])\r\n\t\r\n\treturn (\r\n\t\t<form className={props.className} action=\"post\" onSubmit={((e) => {\r\n\t\t\te.preventDefault()\r\n\t\t\t\r\n\t\t\tconst validateForm = () => {\r\n\t\t\t\tif (!val) {\r\n\t\t\t\t\te.preventDefault()\r\n\t\r\n\t\t\t\t\tsetState({\r\n\t\t\t\t\t\tclass: 'error',\r\n\t\t\t\t\t\tmsg: 'Empty field'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(Number(val.toString().split('.').join('')) === 0) {\r\n\t\t\t\t\t\te.preventDefault()\r\n\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tclass: 'error',\r\n\t\t\t\t\t\t\tmsg: ''\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else if(val.toString().split(' ').join('') > maxVal) {\r\n\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tclass: 'error',\r\n\t\t\t\t\t\t\tmsg: props.maxWarningMsg ?? 'Insufficient balance'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tclass: '',\r\n\t\t\t\t\t\t\tmsg: ''\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tonSubmit(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (inputProps.disabled) {\r\n\t\t\t\tonSubmit(e)\r\n\t\t\t} else {\r\n\t\t\t\tvalidateForm()\r\n\t\t\t}\r\n\t\t})}>\r\n\t\t\t<div className='form-field'>\r\n\t\t\t\t<div className=\"input-container\">\r\n\t\t\t\t\t<NumberInput value={val} setValue={setVal} {...inputProps} className={state.class} msg={state.msg} setBtnActive={setBtnActive}></NumberInput>\r\n\t\t\t\t\t{props.isModal ?\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\tclassName=\"btn_plain\"\r\n\t\t\t\t\t\t\tdisabled={inputProps.disabled}\r\n\t\t\t\t\t\t\tonClick={props.maxOnClick}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tMax\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t{currency ?\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\tclassName=\"btn_plain currency-label\"\r\n\t\t\t\t\t\t\tdisabled={true}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<img src={currency.icon} alt={currency.text + ' icon'} />\r\n\t\t\t\t\t\t\t{currency.text}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t: ''}\r\n\t\t\t\t</div>\r\n\t\t\t\t<Button btnActive={btnActive || btnIsActive} disabled={props.btnIsDisabled} className=\"submit-btn\">\r\n\t\t\t\t\t{btnText}\r\n\t\t\t\t</Button>\r\n\t\t\t</div>\r\n\t\t\t{children}\r\n\t\t</form>\r\n\t);\r\n};\r\n\r\nexport default Form;","export default __webpack_public_path__ + \"static/media/icon-usdc.8a706a47.svg\";","import React from 'react';\r\nimport Modal from './Modal';\r\nimport Button from '../button/Button';\r\nimport Loader from './../loader/Loader';\r\nimport Form from './../../Form';\r\nimport icon_usdc from '../../../img/icon-usdc.svg';\r\n\r\nconst RegisterModal = (props) => {\r\n\tconst {\r\n\t\tvisible, \r\n\t\tsetVisible, \r\n\t\tonRegisterClick, \r\n\t\tonApproveClick, \r\n\t\tcurStep, \r\n\t\tisLoading,\r\n\t\tdepositVal,\r\n\t\tsetDepositVal\r\n\t} = props;\r\n\t\r\n\tfunction getDepositText() {\r\n\t\treturn 'Approve';\r\n\t}\r\n\t\r\n\tconst steps = [\r\n\t\t{\r\n\t\t\tname: 'Create Account',\r\n\t\t\ttitle: 'Create Margin Account',\r\n\t\t\tbody: <div className=\"modal__text\">\r\n\t\t\t\t\t\t\t<p>DeDeLend Margin Account isaderivative product based onSpot and Perpetual trading. Itallows you touse assets inyour Margin Account ascollateral toborrow additional funds from DeDeLend inorder toopen positions larger than your wallet balance, with upto5x leverage.</p>\r\n\t\t\t\t\t\t\t<p>With DeDeLend Margin Account, all assets inyour Account can beused ascollateral toprevent your Position from being liquidated. When the risk level ofyour Margin Account reaches alevel that triggers liquidation, the system will automatically sell the collateral assets torepay the borrowings inyour Account.</p>\r\n\t\t\t\t\t\t\t<p className='text-inline'><a href=\"#\">Read more</a> about DeDeLend Margin Account</p>\r\n\t\t\t\t\t\t</div>,\r\n\t\t\tbtn: <Button btnActive={true} onClick={onRegisterClick}>Create Margin Account</Button>,\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Deposit',\r\n\t\t\ttitle: 'Deposit',\r\n\t\t\tbody: '',\r\n\t\t\tbtn:  <Form\r\n\t\t\t\t\t\t\tclassName='modal__form-wrapper'\r\n\t\t\t\t\t\t\tinputProps={{\r\n\t\t\t\t\t\t\t\tval: depositVal,\r\n\t\t\t\t\t\t\t\tsetVal: setDepositVal,\r\n\t\t\t\t\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tbtnIsActive={true}\r\n\t\t\t\t\t\t\tonSubmit={onApproveClick}\r\n\t\t\t\t\t\t\tbtnText={getDepositText()}\r\n\t\t\t\t\t\t\tcurrency={{\r\n\t\t\t\t\t\t\t\ttext: 'USDC',\r\n\t\t\t\t\t\t\t\ticon: icon_usdc\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Button className=\"btn_stroke\">Start Trading</Button>\r\n\t\t\t\t\t\t</Form>,\r\n\t\t},\r\n\t]\r\n\r\n\tconst step = steps[curStep];\r\n\t\r\n\treturn (\r\n\t\t<Modal visible={visible} setVisible={setVisible} className=\"modal_register\">\r\n\t\t\t<div className=\"modal__steps steps\">\r\n\t\t\t\t{steps.map((el, i) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div className={curStep === i ? 'modal__step step current' : 'modal__step step'} key={i}>\r\n\t\t\t\t\t\t\t{el.name}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t\t<h1 className='modal__title'>{step.title}</h1>\r\n\t\t\t<div className=\"modal__body\">\r\n\t\t\t\t{step.body}\r\n\t\t\t\t{isLoading ? <Loader /> : step.btn}\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default RegisterModal;","export default __webpack_public_path__ + \"static/media/icon-user.e1304f70.svg\";","import React, {useState} from 'react';\r\nimport icon_user from '../img/icon-user.svg';\r\nimport { cutAddress } from './utils/wallet';\r\n\r\nconst AccountDroplist = ({ accounts, account }) => {\r\n\tconst [open, setOpen] = useState(false);\r\n\r\n\tfunction openAccounts(e) {\r\n\t\tif (open) {\r\n\t\t\tcloseAccounts();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\te.stopPropagation();\r\n\t\tdocument.addEventListener('click', closeAccounts);\r\n\t\tsetOpen(true);\r\n\t}\r\n\tfunction closeAccounts() {\r\n\t\tdocument.removeEventListener('click', closeAccounts);\r\n\t\tsetOpen(false);\r\n\t}\r\n\t\r\n\tconst accountCut = cutAddress(account);\r\n\t\r\n\t\r\n\treturn (\r\n\t\t<div className={\"Account-droplist\" + (open ? \" active\" : \"\")}>\r\n\t\t\t<button className=\"Account-droplist__header\" onClick={openAccounts}>\r\n\t\t\t\t<img src={icon_user} alt=\"icon\" />\r\n\t\t\t\t<span className='Account-droplist__address'>{accountCut}</span>\r\n\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" className='chevron-down' width=\"13\" height=\"13\" viewBox=\"0 0 13 13\" fill=\"none\">\r\n\t\t\t\t\t<path d=\"M2.60001 4.76667L7.10001 8.76667L11.6 4.76667\" stroke=\"#747FA6\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t\t<div className=\"Account-droplist__items\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t{accounts?.map(acc => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<button className={\"Account-droplist__item\"} key={acc}>\r\n\t\t\t\t\t\t\t<div className={\"Account-droplist__item-address\" + (account === acc ? ' chosen' : '')}>\r\n\t\t\t\t\t\t\t\t{cutAddress(acc)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"Account-droplist__item-balance\">\r\n\t\t\t\t\t\t\t\t$1,000\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t\t<button className='Account-droplist__btn btn_inline'>Create account</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AccountDroplist;","import React, { useContext, useEffect, useState } from 'react';\r\nimport Logo from './components/UI/logo/Logo'\r\nimport Button from './components/UI/button/Button';\r\nimport Wallet from './components/Wallet';\r\nimport { GlobalStatsContext, UserStatsContext } from './context/context';\r\nimport { ethers } from 'ethers';\r\nimport { connectWallet } from './components/utils/wallet';\r\nimport HegicStrategyATM_CALL_ETH from \"./deployments/arbitrum_ddl/HegicStrategyATM_CALL_ETH.json\";\r\nimport HegicStrategyOTM_CALL_110_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_110_ETH.json\";\r\nimport HegicStrategyOTM_CALL_120_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_120_ETH.json\";\r\nimport HegicStrategyOTM_CALL_130_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_130_ETH.json\";\r\nimport HegicStrategyATM_CALL_BTC from \"./deployments/arbitrum_ddl/HegicStrategyATM_CALL_BTC.json\";\r\nimport HegicStrategyOTM_CALL_110_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_110_BTC.json\";\r\nimport HegicStrategyOTM_CALL_120_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_120_BTC.json\";\r\nimport HegicStrategyOTM_CALL_130_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_130_BTC.json\";\r\nimport HegicStrategyATM_PUT_ETH from \"./deployments/arbitrum_ddl/HegicStrategyATM_PUT_ETH.json\";\r\nimport HegicStrategyOTM_PUT_70_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_70_ETH.json\";\r\nimport HegicStrategyOTM_PUT_80_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_80_ETH.json\";\r\nimport HegicStrategyOTM_PUT_90_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_90_ETH.json\";\r\nimport HegicStrategyATM_PUT_BTC from \"./deployments/arbitrum_ddl/HegicStrategyATM_PUT_BTC.json\";\r\nimport HegicStrategyOTM_PUT_70_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_70_BTC.json\";\r\nimport HegicStrategyOTM_PUT_80_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_80_BTC.json\";\r\nimport HegicStrategyOTM_PUT_90_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_90_BTC.json\";\r\nimport OptionsManager from \"./deployments/arbitrum_ddl/OptionsManager.json\";\r\nimport HegicOperationalTreasury from \"./deployments/arbitrum_ddl/HegicOperationalTreasury.json\";\r\nimport {mmProvider} from './components/utils/providers.js'\r\nimport { OptManager, PriceProviderETH, PriceProviderBTC, DDL_AccountManager, getDgContract } from './components/utils/contracts';\r\nimport { getGlobalStats, getUserStats, getOptionStats } from './components/utils/stats';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport Tabs from './components/Tabs';\r\nimport RegisterModal from './components/UI/modal/RegisterModal';\r\nimport AccountDroplist from './components/AccountDroplist';\r\n\r\n\r\nconst Header = (props) => {\r\n\tconst {\r\n\t\twalletAddress, \r\n\t\tsetWalletAddress, \r\n\t\taccount,\r\n\t\tsetAccount,\r\n\t\taccounts,\r\n\t\tregisterVisible,\r\n\t\tsetRegisterVisible\r\n\t} = props;\r\n\r\n\tconst { setGlobalStats } = useContext(GlobalStatsContext)\r\n\tconst { setUserStats } = useContext(UserStatsContext)\r\n\t\r\n\tconst [registerStep, setRegisterStep] = useState(0);\r\n\tconst [registerLoading, setRegisterLoading] = useState(false);\r\n\tconst [depositVal, setDepositVal] = useState('');\r\n\t\r\n\tasync function register() {\r\n\t\t// setRegisterLoading(true);\r\n\t\tsetRegisterStep(1);\r\n\t}\r\n\r\n\tasync function approveAll() {\r\n\t\t\r\n\t}\r\n\t\r\n\tasync function getOptionByUser(userAddress) {\r\n\t\tlet hot = OptManager;\r\n\r\n\t\tlet hegicOperationalTreasury = new ethers.Contract(HegicOperationalTreasury.address, HegicOperationalTreasury.abi, mmProvider)\r\n\t\tconst iface = new ethers.utils.Interface(OptionsManager.abi)\r\n\t\r\n\t\tconst strategyMap = new Map([\r\n\t\t\t[HegicStrategyATM_CALL_ETH.address, { \"name\": \"ETH-ATM-CALL\", \"inf\": HegicStrategyATM_CALL_ETH }],\r\n\t\t\t[HegicStrategyOTM_CALL_110_ETH.address, { \"name\": \"ETH-OTM-CALL-10%\", \"inf\": HegicStrategyOTM_CALL_110_ETH }],\r\n\t\t\t[HegicStrategyOTM_CALL_120_ETH.address, { \"name\": \"ETH-OTM-CALL-20%\", \"inf\": HegicStrategyOTM_CALL_120_ETH }],\r\n\t\t\t[HegicStrategyOTM_CALL_130_ETH.address, { \"name\": \"ETH-OTM-CALL-30%\", \"inf\": HegicStrategyOTM_CALL_130_ETH }],\r\n\t\t\t[HegicStrategyATM_CALL_BTC.address, { \"name\": \"BTC-ATM-CALL\", \"inf\": HegicStrategyATM_CALL_BTC }],\r\n\t\t\t[HegicStrategyOTM_CALL_110_BTC.address, { \"name\": \"BTC-OTM-CALL-10%\", \"inf\": HegicStrategyOTM_CALL_110_BTC }],\r\n\t\t\t[HegicStrategyOTM_CALL_120_BTC.address, { \"name\": \"BTC-OTM-CALL-20%\", \"inf\": HegicStrategyOTM_CALL_120_BTC }],\r\n\t\t\t[HegicStrategyOTM_CALL_130_BTC.address, { \"name\": \"BTC-OTM-CALL-30%\", \"inf\": HegicStrategyOTM_CALL_130_BTC }],\r\n\t\t\t[HegicStrategyATM_PUT_ETH.address, { \"name\": \"ETH-ATM-PUT\", \"inf\": HegicStrategyATM_PUT_ETH }],\r\n\t\t\t[HegicStrategyOTM_PUT_70_ETH.address, { \"name\": \"ETH-OTM-PUT-30%\", \"inf\": HegicStrategyOTM_PUT_70_ETH }],\r\n\t\t\t[HegicStrategyOTM_PUT_80_ETH.address, { \"name\": \"ETH-OTM-PUT-20%\", \"inf\": HegicStrategyOTM_PUT_80_ETH }],\r\n\t\t\t[HegicStrategyOTM_PUT_90_ETH.address, { \"name\": \"ETH-OTM-PUT-10%\", \"inf\": HegicStrategyOTM_PUT_90_ETH }],\r\n\t\t\t[HegicStrategyATM_PUT_BTC.address, { \"name\": \"BTC-ATM-PUT\", \"inf\": HegicStrategyATM_PUT_BTC }],\r\n\t\t\t[HegicStrategyOTM_PUT_70_BTC.address, { \"name\": \"BTC-OTM-PUT-30%\", \"inf\": HegicStrategyOTM_PUT_70_BTC }],\r\n\t\t\t[HegicStrategyOTM_PUT_80_BTC.address, { \"name\": \"BTC-OTM-PUT-20%\", \"inf\": HegicStrategyOTM_PUT_80_BTC }],\r\n\t\t\t[HegicStrategyOTM_PUT_90_BTC.address, { \"name\": \"BTC-OTM-PUT-10%\", \"inf\": HegicStrategyOTM_PUT_90_BTC }],\r\n\t\t])\r\n\t\r\n\t\tlet transferTopics = iface.encodeFilterTopics(\"Transfer\", [\r\n\t\t\tnull,\r\n\t\t\tuserAddress\r\n\t\t\t])\r\n\t\tlet transferLogs = await mmProvider.getLogs({\r\n\t\t\t\"address\":hot.address,\r\n\t\t\t\"fromBlock\": 6661745 , \r\n\t\t\t\"topics\": transferTopics\r\n\t\t})\r\n\t\r\n\t\tlet arrObj = []\r\n\t\tlet ids = []\r\n\t\t\r\n\t\tfor (let event of transferLogs) {\r\n\t\t\t\r\n\t\t\tlet decodeData = iface.decodeEventLog(\"Transfer\", event.data, event.topics)\r\n\t\t\t\r\n\t\t\tlet lockL = await hegicOperationalTreasury.lockedLiquidity(decodeData.tokenId)\r\n\t\t\t\r\n\t\t\tif (Number(lockL.state) !== 0) {\r\n\t\t\t\tconst id = decodeData.tokenId.toNumber()\r\n\t\t\t\tif (ids.includes(id)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet expiration = lockL.expiration * 1000 - Date.now();\r\n\t\t\t\tif (expiration <= 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet strategyInf = strategyMap.get(lockL.strategy);\r\n\t\t\t\tif (!strategyInf) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tids.push(id)\r\n\t\t\t\t\r\n\t\t\t\tconst HegicStrategy = new ethers.Contract(lockL.strategy, strategyInf.inf.abi, mmProvider)\r\n\t\t\t\t\r\n\t\t\t\tlet strategyData = await HegicStrategy.strategyData(id)\r\n\t\t\t\tlet isETH = strategyInf.name?.includes(\"ETH\")\r\n\t\t\t\tlet amount = Number(ethers.utils.formatUnits(strategyData.amount.toString(),isETH ? 18 :8))\r\n\t\t\t\tlet strike = Number(ethers.utils.formatUnits(strategyData.strike.toString(),8))\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tconst res = await getOptionStats(id, isETH)\r\n\t\t\t\t\r\n\t\t\t\tconst isCALL = strategyInf.name?.includes(\"CALL\");\r\n\t\t\t\tconst PriceProvider = isETH ? PriceProviderETH : PriceProviderBTC\r\n\t\t\t\tconst curPrice = Number(ethers.utils.formatUnits(\r\n\t\t\t\t\t(await PriceProvider.latestRoundData())[1], 8\r\n\t\t\t\t))\r\n\t\t\t\t\r\n\t\t\t\tconst diff = isETH ? 0.04 : 0.03;\r\n\t\t\t\tlet priorLiqPrice;\r\n\t\t\t\tif (isCALL) {\r\n\t\t\t\t\tpriorLiqPrice = strike * (1 + diff);\r\n\r\n\t\t\t\t\tif (curPrice <= priorLiqPrice) {\r\n\t\t\t\t\t\tres.borrowLimit = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpriorLiqPrice = strike * (1 - diff)\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (curPrice >= priorLiqPrice) {\r\n\t\t\t\t\t\tres.borrowLimit = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tarrObj.push({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tname: strategyInf.name,\r\n\t\t\t\t\tamount: Math.floor(amount * 100)/100,\r\n\t\t\t\t\tstrike: Math.floor(strike * 100)/100,\r\n\t\t\t\t\texpiration,\r\n\t\t\t\t\t// strategy: lockL.strategy,\r\n\t\t\t\t\tintrinsicValue: res.intrinsicValue,\r\n\t\t\t\t\tborrowLimit: res.borrowLimit,\r\n\t\t\t\t\tborrowLimitUsed: res.borrowLimitUsed,\r\n\t\t\t\t\tliqPrice: res.liqPrice ?? '',\r\n\t\t\t\t\trealVals: res.realVals ?? {},\r\n\t\t\t\t\tcontract: res.contract,\r\n\t\t\t\t\tisETH,\r\n\t\t\t\t\tpriorLiqPrice\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\r\n\t\tif (!arrObj.length) {\r\n\t\t\tarrObj.push('You dont have active Hegic Options')\r\n\t\t}\r\n\t\treturn arrObj;\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tconnectWallet(setWalletAddress)\r\n\r\n\t\tgetGlobalStats()\r\n\t\t\t.then(stats => {\r\n\t\t\t\tsetGlobalStats(stats)\r\n\t\t\t})\r\n\t}, [window.ethereum?.networkVersion])\r\n\r\n\tconst loc = useLocation();\r\n\tconst nav = useNavigate();\r\n\tconst headerLinks = [\r\n\t\t/* {\r\n\t\t\tname: 'Options',\r\n\t\t\tto: '/options',\r\n\t\t}, */\r\n\t\t{\r\n\t\t\tname: 'Perpetuals',\r\n\t\t\tto: '/perpetuals',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Earn',\r\n\t\t\tto: '/earn',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Margin Account',\r\n\t\t\tto: '/account',\r\n\t\t\tisHidden: !account,\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Old Version',\r\n\t\t\tto: 'https://old.dedelend.co/',\r\n\t\t\tisExternal: true,\r\n\t\t},\r\n\t]\r\n\r\n\tuseEffect(() => {\r\n\t\tif (walletAddress) {\r\n\t\t\tgetUserStats(walletAddress)\r\n\t\t\t\t.then(stats => {\r\n\t\t\t\t\tsetUserStats(stats)\r\n\r\n\t\t\t\t\tgetOptionByUser(walletAddress)\r\n\t\t\t\t\t\t.then(options => {\r\n\t\t\t\t\t\t\tsetUserStats({\r\n\t\t\t\t\t\t\t\t...stats,\r\n\t\t\t\t\t\t\t\toptions\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t} else {\r\n\t\t\tsetAccount('');\r\n\t\t\tif (loc.pathname === '/account') {\r\n\t\t\t\tnav('/');\r\n\t\t\t}\r\n\t\t}\r\n\t}, [walletAddress])\r\n\t\r\n\theaderLinks.find(link => {\r\n\t\tlink.isActive = loc.pathname === link.to;\r\n\t\treturn link.isActive;\r\n\t})\r\n\r\n\treturn (\r\n\t\t<header className='header'>\r\n\t\t\t<div className=\"header__content _container\">\r\n\t\t\t\t<div className=\"header__nav\">\r\n\t\t\t\t\t<Logo />\r\n\t\t\t\t\t<Tabs className='header__links' links={headerLinks} />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"Account-data\">\r\n\t\t\t\t\t{walletAddress ?\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{account ? \r\n\t\t\t\t\t\t\t\t<AccountDroplist\r\n\t\t\t\t\t\t\t\t\taccounts={accounts}\r\n\t\t\t\t\t\t\t\t\taccount={account} />\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t<div className=\"account-btn-wrapper\">\r\n\t\t\t\t\t\t\t\t\t<Button className='account-btn' isMain={true} onClick={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tsetAccount('0x0641bc55ddab3b9636e82cbf87ede3c3c533039d');\r\n\t\t\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t\t\t{window.outerWidth > 480 ?\r\n\t\t\t\t\t\t\t\t\t\t'Create Margin Account      '\r\n\t\t\t\t\t\t\t\t\t\t: 'Create Account      '}\r\n\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t<Wallet address={walletAddress} \r\n\t\t\t\t\t\t\t\tsetAddress={setWalletAddress}\r\n\t\t\t\t\t\t\t\tsetAccount={setAccount}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<Button isMain={true} onClick={(e) => {\r\n\t\t\t\t\t\t\tconnectWallet(setWalletAddress)\r\n\t\t\t\t\t\t}}>Connect wallet</Button>}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{loc.pathname.startsWith('/perpetuals') && (\r\n\t\t\t\t\t<RegisterModal\r\n\t\t\t\t\t\tvisible={registerVisible}\r\n\t\t\t\t\t\tsetVisible={setRegisterVisible}\r\n\t\t\t\t\t\tonRegisterClick={register}\r\n\t\t\t\t\t\tonApproveClick={approveAll}\r\n\t\t\t\t\t\tcurStep={registerStep}\r\n\t\t\t\t\t\tisLoading={registerLoading}\r\n\t\t\t\t\t\tdepositVal={depositVal}\r\n\t\t\t\t\t\tsetDepositVal={setDepositVal}\r\n\t\t\t\t\t\t />\r\n\t\t\t\t)}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t</header>\r\n\t);\r\n};\r\n\r\nexport default Header;","import React from 'react';\r\nimport Logo from './components/UI/logo/Logo';\r\n\r\nconst Footer = () => {\r\n\treturn (\r\n\t\t<footer className=\"footer\">\r\n\t\t\t<div className=\"footer__content _container\">\r\n\t\t\t\t<Logo></Logo>\r\n\t\t\t\t<div className=\"footer__smedia-items\">\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://mirror.xyz/dedelend.eth/GkbH1xqXuhiKMR2hmiLNhq_UqEG30PD9udkC1g6nJ9Y\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<g clipPath=\"url(#clip0_58_113)\">\r\n\t\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t\t<path d=\"M9 14C9 10.6863 11.6863 8 15 8C18.3137 8 21 10.6863 21 14V21.3929C21 22.2805 20.2805 23 19.3929 23H10.6071C9.71954 23 9 22.2805 9 21.3929V14Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t\t\t<clipPath id=\"clip0_58_113\">\r\n\t\t\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"3\" fill=\"white\"/>\r\n\t\t\t\t\t\t\t\t</clipPath>\r\n\t\t\t\t\t\t\t</defs>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://github.com/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M15.5 8C11.3562 8 8 11.4411 8 15.6897C8 19.0924 10.1469 21.9664 13.1281 22.9853C13.5031 23.0526 13.6437 22.8219 13.6437 22.62C13.6437 22.4374 13.6344 21.8319 13.6344 21.1878C11.75 21.5435 11.2625 20.7168 11.1125 20.2843C11.0281 20.0632 10.6625 19.3808 10.3438 19.1981C10.0812 19.0539 9.70625 18.6983 10.3344 18.6887C10.925 18.6791 11.3469 19.2462 11.4875 19.4769C12.1625 20.64 13.2406 20.3131 13.6719 20.1113C13.7375 19.6115 13.9344 19.275 14.15 19.0828C12.4812 18.8905 10.7375 18.2273 10.7375 15.286C10.7375 14.4497 11.0281 13.7577 11.5063 13.2194C11.4313 13.0271 11.1688 12.2389 11.5812 11.1816C11.5812 11.1816 12.2094 10.9798 13.6437 11.9698C14.2437 11.7968 14.8812 11.7103 15.5187 11.7103C16.1562 11.7103 16.7937 11.7968 17.3938 11.9698C18.8281 10.9701 19.4563 11.1816 19.4563 11.1816C19.8687 12.2389 19.6063 13.0271 19.5312 13.2194C20.0094 13.7577 20.3 14.4401 20.3 15.286C20.3 18.2369 18.5469 18.8905 16.8781 19.0828C17.15 19.3231 17.3844 19.7845 17.3844 20.5054C17.3844 21.5339 17.375 22.3605 17.375 22.62C17.375 22.8219 17.5156 23.0622 17.8906 22.9853C19.3795 22.4699 20.6732 21.4888 21.5898 20.1801C22.5063 18.8714 22.9996 17.3009 23 15.6897C23 11.4411 19.6438 8 15.5 8Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://twitter.com/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M23 10.4234C22.4484 10.664 21.8558 10.8265 21.2328 10.8999C21.8756 10.5215 22.3565 9.92574 22.5858 9.22397C21.9819 9.57697 21.3209 9.82545 20.6317 9.95859C20.1682 9.47158 19.5543 9.14877 18.8852 9.0403C18.2162 8.93183 17.5295 9.04376 16.9317 9.35871C16.334 9.67366 15.8586 10.174 15.5794 10.7821C15.3002 11.3902 15.2328 12.0719 15.3877 12.7215C14.164 12.6611 12.9669 12.3481 11.8741 11.8029C10.7813 11.2577 9.81726 10.4924 9.04444 9.55683C8.78019 10.0054 8.62825 10.5255 8.62825 11.0794C8.62795 11.578 8.75273 12.069 8.99151 12.5088C9.23029 12.9486 9.57568 13.3236 9.99705 13.6005C9.50837 13.5852 9.03048 13.4552 8.60314 13.2215V13.2605C8.6031 13.9598 8.84892 14.6377 9.2989 15.1789C9.74888 15.7202 10.3753 16.0916 11.0719 16.2302C10.6185 16.3509 10.1433 16.3687 9.68193 16.2822C9.87847 16.8839 10.2613 17.4101 10.7768 17.7871C11.2923 18.1641 11.9148 18.373 12.5569 18.3846C11.4668 19.2268 10.1205 19.6836 8.73461 19.6816C8.48911 19.6816 8.24382 19.6675 8 19.6393C9.40677 20.5294 11.0444 21.0018 12.7168 21C18.3783 21 21.4733 16.3855 21.4733 12.3835C21.4733 12.2535 21.47 12.1221 21.4641 11.9921C22.0661 11.5637 22.5857 11.0332 22.9987 10.4254L23 10.4234Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://discord.gg/5DGZ7rzSfS\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M20.6981 10.9123C19.7418 10.4907 18.7169 10.179 17.645 10.0018C17.6355 10 17.6256 10.0012 17.6167 10.0051C17.6079 10.009 17.6005 10.0156 17.5956 10.0238C17.4644 10.2493 17.3182 10.5432 17.2157 10.7754C16.0789 10.6094 14.9232 10.6094 13.7864 10.7754C13.6722 10.5181 13.5435 10.2671 13.4008 10.0238C13.3959 10.0155 13.3886 10.0088 13.3798 10.0047C13.371 10.0005 13.3611 9.99908 13.3514 10.0006C12.2802 10.1778 11.2552 10.4894 10.2984 10.9117C10.2901 10.9151 10.2831 10.9208 10.2784 10.9282C8.33342 13.7238 7.80031 16.4504 8.06217 19.1428C8.0629 19.1494 8.065 19.1558 8.06833 19.1616C8.07166 19.1673 8.07616 19.1724 8.08155 19.1764C9.21676 19.9845 10.4829 20.6001 11.8271 20.9974C11.8364 21.0002 11.8465 21.0002 11.8558 20.9974C11.8652 20.9946 11.8735 20.989 11.8796 20.9815C12.1688 20.6033 12.4251 20.2021 12.6458 19.782C12.6489 19.7762 12.6506 19.7699 12.651 19.7635C12.6513 19.757 12.6502 19.7505 12.6478 19.7445C12.6454 19.7385 12.6417 19.733 12.6369 19.7285C12.6321 19.724 12.6264 19.7206 12.6202 19.7184C12.2164 19.5698 11.8252 19.3904 11.4502 19.1819C11.4435 19.1782 11.4378 19.1728 11.4337 19.1664C11.4296 19.16 11.4272 19.1526 11.4267 19.145C11.4262 19.1375 11.4276 19.1299 11.4308 19.123C11.4341 19.1161 11.439 19.1101 11.4452 19.1055C11.5239 19.0487 11.6027 18.9894 11.6777 18.9302C11.6844 18.9248 11.6926 18.9214 11.7012 18.9204C11.7098 18.9193 11.7185 18.9206 11.7264 18.9241C14.1807 20.002 16.8388 20.002 19.2643 18.9241C19.2723 18.9204 19.2811 18.9189 19.2898 18.9199C19.2986 18.9208 19.3068 18.9242 19.3137 18.9295C19.3887 18.9894 19.4668 19.0487 19.5462 19.1055C19.5525 19.11 19.5575 19.1159 19.5608 19.1228C19.5642 19.1296 19.5657 19.1371 19.5653 19.1447C19.565 19.1523 19.5627 19.1596 19.5587 19.1661C19.5547 19.1726 19.5491 19.1781 19.5425 19.1819C19.1687 19.3921 18.78 19.57 18.3719 19.7178C18.3656 19.7201 18.3599 19.7236 18.3551 19.7281C18.3504 19.7327 18.3466 19.7382 18.3442 19.7442C18.3418 19.7503 18.3407 19.7568 18.3411 19.7633C18.3414 19.7698 18.3432 19.7762 18.3463 19.782C18.5712 20.2018 18.8287 20.6014 19.1119 20.9809C19.1177 20.9887 19.1259 20.9945 19.1353 20.9976C19.1447 21.0006 19.1549 21.0008 19.1644 20.998C20.5108 20.6018 21.779 19.986 22.9155 19.1764C22.921 19.1726 22.9257 19.1677 22.9291 19.162C22.9326 19.1563 22.9348 19.15 22.9355 19.1434C23.248 16.0306 22.4118 13.326 20.7174 10.9294C20.7133 10.9216 20.7064 10.9155 20.6981 10.9123ZM13.0127 17.5033C12.2739 17.5033 11.6646 16.8501 11.6646 16.049C11.6646 15.2472 12.2621 14.5946 13.0127 14.5946C13.7689 14.5946 14.3726 15.2527 14.3607 16.049C14.3607 16.8507 13.7633 17.5033 13.0127 17.5033ZM17.9969 17.5033C17.2575 17.5033 16.6488 16.8501 16.6488 16.049C16.6488 15.2472 17.2457 14.5946 17.9969 14.5946C18.7531 14.5946 19.3568 15.2527 19.345 16.049C19.345 16.8507 18.7537 17.5033 17.9969 17.5033Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" rel=\"noreferrer\" href=\"https://t.me/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M21.9875 9.0789L8.70041 13.9664C7.79362 14.3138 7.79886 14.7964 8.53404 15.0115L11.9454 16.0267L19.8382 11.2764C20.2114 11.0598 20.5524 11.1763 20.2721 11.4136L13.8774 16.9188H13.8759L13.8774 16.9195L13.642 20.2737C13.9868 20.2737 14.1389 20.1228 14.3323 19.9448L15.9892 18.4079L19.4358 20.8363C20.0713 21.1701 20.5277 20.9985 20.6858 20.2751L22.9483 10.104C23.1798 9.2183 22.5938 8.81726 21.9875 9.0789Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</footer>\r\n\t);\r\n};\r\n\r\nexport default Footer;","const CONTRACTS = {\r\n  56: {\r\n    // bsc mainnet\r\n    Treasury: \"0xa44E7252a0C137748F523F112644042E5987FfC7\",\r\n    BUSD: \"0xe9e7cea3dedca5984780bafc599bd69add087d56\",\r\n    GMT: \"0x99e92123eB77Bc8f999316f622e5222498438784\",\r\n    Vault: \"0xc73A8DcAc88498FD4b4B1b2AaA37b0a2614Ff67B\",\r\n    Router: \"0xD46B23D042E976F8666F554E928e0Dc7478a8E1f\",\r\n    Reader: \"0x087A618fD25c92B61254DBe37b09E5E8065FeaE7\",\r\n    AmmFactory: \"0xBCfCcbde45cE874adCB698cC183deBcF17952812\",\r\n    AmmFactoryV2: \"0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73\",\r\n    OrderBook: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBookReader: \"0x1111111111111111111111111111111111111111\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x85E76cbf4893c1fbcB34dCF1239A91CE2A4CF5a7\",\r\n    NATIVE_TOKEN: \"0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c\",\r\n    XGMT: \"0xe304ff0983922787Fd84BC9170CD21bF78B16B10\",\r\n    GMT_USDG_PAIR: \"0xa41e57459f09a126F358E118b693789d088eA8A0\",\r\n    XGMT_USDG_PAIR: \"0x0b622208fc0691C2486A3AE6B7C875b4A174b317\",\r\n    GMT_USDG_FARM: \"0x3E8B08876c791dC880ADC8f965A02e53Bb9C0422\",\r\n    XGMT_USDG_FARM: \"0x68D7ee2A16AB7c0Ee1D670BECd144166d2Ae0759\",\r\n    USDG_YIELD_TRACKER: \"0x0EF0Cf825B8e9F89A43FfD392664131cFB4cfA89\",\r\n    XGMT_YIELD_TRACKER: \"0x82A012A9b3003b18B6bCd6052cbbef7Fa4892e80\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x08FAb024BEfcb6068847726b2eccEAd18b6c23Cd\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd8E26637B34B2487Cad1f91808878a391134C5c2\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0x026A02F7F26C1AFccb9Cba7C4df3Dc810F4e92e8\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x22458CEbD14a9679b2880147d08CA1ce5aa40E84\",\r\n    AUTO: \"0xa184088a740c695E156F91f5cC086a06bb78b827\",\r\n    AUTO_USDG_PAIR: \"0x0523FD5C53ea5419B4DAF656BC1b157dDFE3ce50\",\r\n    AUTO_USDG_FARM: \"0xE6958298328D02051769282628a3b4178D0F3A47\",\r\n    AUTO_USDG_FARM_TRACKER_XGMT: \"0x093b8be41c1A30704De84a9521632f9a139c08bd\",\r\n    AUTO_USDG_FARM_TRACKER_NATIVE: \"0x23ed48E5dce3acC7704d0ce275B7b9a0e346b63A\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  97: {\r\n    // bsc testnet\r\n    Vault: \"0x1B183979a5cd95FAF392c8002dbF0D5A1C687D9a\",\r\n    Router: \"0x10800f683aa564534497a5b67F45bE3556a955AB\",\r\n    Reader: \"0x98D4742F1B6a821bae672Cd8721283b91996E454\",\r\n    AmmFactory: \"0x6725f303b657a9451d8ba641348b6761a6cc7a17\",\r\n    AmmFactoryV2: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBook: \"0x9afD7B4f0b58d65F6b2978D3581383a06b2ac4e9\",\r\n    OrderBookReader: \"0x0713562970D1A802Fa3FeB1D15F9809943982Ea9\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x2D549bdBf810523fe9cd660cC35fE05f0FcAa028\",\r\n    GMT: \"0xedba0360a44f885ed390fad01aa34d00d2532817\",\r\n    NATIVE_TOKEN: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n    XGMT: \"0x28cba798eca1a3128ffd1b734afb93870f22e613\",\r\n    GMT_USDG_PAIR: \"0xe0b0a315746f51932de033ab27223d85114c6b85\",\r\n    XGMT_USDG_PAIR: \"0x0108de1eea192ce8448080c3d90a1560cf643fa0\",\r\n    GMT_USDG_FARM: \"0xbe3cB06CE03cA692b77902040479572Ba8D01b0B\",\r\n    XGMT_USDG_FARM: \"0x138E92195D4B99CE3618092D3F9FA830d9A69B4b\",\r\n    USDG_YIELD_TRACKER: \"0x62B49Bc3bF252a5DB26D88ccc7E61119e3179B4f\",\r\n    XGMT_YIELD_TRACKER: \"0x5F235A582e0993eE9466FeEb8F7B4682993a57d0\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x4f8EE3aE1152422cbCaFACd4e3041ba2D859913C\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd691B26E544Fe370f39A776964c991363aF72e56\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0xfd5617CFB082Ba9bcD62d654603972AE312bC695\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x0354387DD85b7D8aaD1611B3D167A384d6AE0c28\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  421611: {\r\n    // arbitrum testnet\r\n    Vault: \"0xBc9BC47A7aB63db1E0030dC7B60DDcDe29CF4Ffb\",\r\n    Router: \"0xe0d4662cdfa2d71477A7DF367d5541421FAC2547\",\r\n    VaultReader: \"0xFc371E380262536c819D12B9569106bf032cC41c\",\r\n    Reader: \"0x2E093c70E3A7E4919611d2555dFd8D697d2fC0a1\",\r\n    GlpManager: \"0xD875d99E09118d2Be80579b9d23E83469077b498\",\r\n    RewardRouter: \"0x0000000000000000000000000000000000000000\",\r\n    RewardReader: \"0x0000000000000000000000000000000000000000\",\r\n    NATIVE_TOKEN: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n    GLP: \"0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    GMX: \"0x0000000000000000000000000000000000000000\",\r\n    ES_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    BN_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    USDG: \"0xBCDCaF67193Bf5C57be08623278fCB69f4cA9e68\",\r\n    ES_GMX_IOU: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    BonusGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    StakedGmxDistributor: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpDistributor: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    GmxVester: \"0x0000000000000000000000000000000000000000\",\r\n    GlpVester: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    OrderBook: \"0xebD147E5136879520dDaDf1cA8FBa48050EFf016\",\r\n    OrderBookReader: \"0xC492c8d82DC576Ad870707bb40EDb63E2026111E\",\r\n\r\n    PositionRouter: \"0xB4bB78cd12B097603e2b55D2556c09C17a5815F8\",\r\n    PositionManager: \"0x168aDa266c2f10C1F37973B213d6178551030e44\",\r\n\r\n    // UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0x0000000000000000000000000000000000000000\",\r\n    ReferralReader: \"0x0000000000000000000000000000000000000000\",\r\n  },\r\n  42161: {\r\n    // arbitrum mainnet\r\n    Vault: \"0x489ee077994B6658eAfA855C308275EAd8097C4A\",\r\n    Router: \"0xaBBc5F99639c9B6bCb58544ddf04EFA6802F4064\",\r\n    VaultReader: \"0xfebB9f4CAC4cD523598fE1C5771181440143F24A\",\r\n    Reader: \"0x2b43c90D1B727cEe1Df34925bcd5Ace52Ec37694\",\r\n    GlpManager: \"0x321F653eED006AD1C29D174e17d96351BDe22649\",\r\n    RewardRouter: \"0xA906F338CB21815cBc4Bc87ace9e68c87eF8d8F1\",\r\n    RewardReader: \"0x8BFb8e82Ee4569aee78D03235ff465Bd436D40E0\",\r\n    NATIVE_TOKEN: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n    GLP: \"0x4277f8F2c384827B5273592FF7CeBd9f2C1ac258\",\r\n    GMX: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    ES_GMX: \"0xf42Ae1D54fd613C9bb14810b0588FaAa09a426cA\",\r\n    BN_GMX: \"0x35247165119B69A40edD5304969560D0ef486921\",\r\n    USDG: \"0x45096e7aA921f27590f8F19e457794EB09678141\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\",\r\n    StakedGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    BonusGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    FeeGmxTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n    StakedGlpTracker: \"0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    FeeGlpTracker: \"0x4e971a87900b931fF39d1Aad67697F49835400b6\",\r\n\r\n    StakedGmxDistributor: \"0x23208B91A98c7C1CD9FE63085BFf68311494F193\",\r\n    StakedGlpDistributor: \"0x60519b48ec4183a61ca2B8e37869E675FD203b34\",\r\n\r\n    GmxVester: \"0x199070DDfd1CFb69173aa2F7e20906F26B363004\",\r\n    GlpVester: \"0xA75287d2f8b217273E7FCD7E86eF07D33972042E\",\r\n\r\n    OrderBook: \"0x09f77E8A13De9a35a7231028187e9fD5DB8a2ACB\",\r\n    OrderExecutor: \"0x7257ac5D0a0aaC04AA7bA2AC0A6Eb742E332c3fB\",\r\n    OrderBookReader: \"0xa27C20A7CF0e1C68C0460706bB674f98F362Bc21\",\r\n\r\n    PositionRouter: \"0xb87a436B93fFE9D75c5cFA7bAcFff96430b09868\",\r\n    PositionManager: \"0x75E42e6f01baf1D6022bEa862A28774a9f8a4A0C\",\r\n\r\n    UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0xe6fab3f0c7199b0d34d7fbe83394fc0e0d06e99d\",\r\n    ReferralReader: \"0x8Aa382760BCdCe8644C33e6C2D52f6304A76F5c8\",\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    Vault: \"0x9ab2De34A33fB459b538c43f251eB825645e8595\",\r\n    Router: \"0x5F719c2F1095F7B9fc68a68e35B51194f4b6abe8\",\r\n    VaultReader: \"0x66eC8fc33A26feAEAe156afA3Cb46923651F6f0D\",\r\n    Reader: \"0x2eFEE1950ededC65De687b40Fd30a7B5f4544aBd\",\r\n    GlpManager: \"0xe1ae4d4b06A5Fe1fc288f6B4CD72f9F8323B107F\",\r\n    RewardRouter: \"0x82147C5A7E850eA4E28155DF107F2590fD4ba327\",\r\n    RewardReader: \"0x04Fc11Bd28763872d143637a7c768bD96E44c1b6\",\r\n    NATIVE_TOKEN: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n    GLP: \"0x01234181085565ed162a948b6a5e88758CD7c7b8\",\r\n    GMX: \"0x62edc0692BD897D2295872a9FFCac5425011c661\",\r\n    ES_GMX: \"0xFf1489227BbAAC61a9209A08929E4c2a526DdD17\",\r\n    BN_GMX: \"0x8087a341D32D445d9aC8aCc9c14F5781E04A26d2\",\r\n    USDG: \"0xc0253c3cC6aa5Ab407b5795a04c28fB063273894\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\", // placeholder address\r\n\r\n    StakedGmxTracker: \"0x2bD10f8E93B3669b6d42E74eEedC65dd1B0a1342\",\r\n    BonusGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    FeeGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    StakedGlpTracker: \"0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    FeeGlpTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n\r\n    StakedGmxDistributor: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    StakedGlpDistributor: \"0xDd593Cf40734199afc9207eBe9ffF23dA4Bf7720\",\r\n\r\n    GmxVester: \"0x472361d3cA5F49c8E633FB50385BfaD1e018b445\",\r\n    GlpVester: \"0x62331A7Bd1dfB3A7642B7db50B5509E57CA3154A\",\r\n\r\n    OrderBook: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderExecutor: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderBookReader: \"0xccFE3E576f8145403d3ce8f3c2f6519Dae40683B\",\r\n\r\n    PositionRouter: \"0xffF6D276Bc37c61A23f06410Dce4A400f66420f8\",\r\n    PositionManager: \"0xA21B83E579f4315951bA658654c371520BDcB866\",\r\n\r\n    TraderJoeGmxAvaxPool: \"0x0c91a070f862666bbcce281346be45766d874d98\",\r\n    ReferralStorage: \"0x827ed045002ecdabeb6e2b0d1604cf5fc3d322f8\",\r\n    ReferralReader: \"0x505Ce16D3017be7D76a7C2631C0590E71A975083\",\r\n  },\r\n};\r\n\r\nexport function getContract(chainId, name) {\r\n  if (!CONTRACTS[chainId]) {\r\n    throw new Error(`Unknown chainId ${chainId}`);\r\n  }\r\n  if (!CONTRACTS[chainId][name]) {\r\n    throw new Error(`Unknown contract \"${name}\" for chainId ${chainId}`);\r\n  }\r\n  return CONTRACTS[chainId][name];\r\n}\r\n\r\nexport const XGMT_EXCLUDED_ACCOUNTS = [\r\n  \"0x330eef6b9b1ea6edd620c825c9919dc8b611d5d5\",\r\n  \"0xd9b1c23411adbb984b1c4be515fafc47a12898b2\",\r\n  \"0xa633158288520807f91ccc98aa58e0ea43acb400\",\r\n  \"0xffd0a93b4362052a336a7b22494f1b77018dd34b\",\r\n];\r\n","import { ethers } from \"ethers\";\r\nimport { getContract } from \"./Addresses\";\r\n\r\nconst TOKENS = {\r\n  56: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 18,\r\n      address: \"0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-bitcoin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/14108/small/Binance-bitcoin.png\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x2170Ed0880ac9A755fd29B2688956BD959F933F8\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/ethereum\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: getContract(56, \"NATIVE_TOKEN\"),\r\n      isWrapped: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(56, \"USDG\"),\r\n      isUsdg: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-gambit\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/15886/small/usdg-02.png\",\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-usd\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9576/small/BUSD.png\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 18,\r\n      address: \"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/small/USD_Coin_icon.png\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 18,\r\n      address: \"0x55d398326f99059fF775485246999027B3197955\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/tether\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/small/Tether-logo.png\",\r\n    },\r\n  ],\r\n  97: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0xb19C12715134bee7c4b1Ca593ee9E430dABe7b56\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x1958f7C067226c7C8Ac310Dc994D0cebAbfb2B02\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n      isWrapped: true,\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(97, \"USDG\"),\r\n      isUsdg: true,\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0x3F223C4E5ac67099CB695834b20cCd5E5D5AA9Ef\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  421611: [\r\n    {\r\n      name: \"Bitcoin\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x27960f9A322BE96A1535E6c19B3958e80E6a2670\",\r\n      isShortable: true,\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n    },\r\n    // https://github.com/OffchainLabs/arbitrum/blob/950c2f91b2e951cd3764394e0a73eac3797aecf3/packages/arb-ts/src/lib/networks.ts#L65\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xf0DCd4737A20ED33481A49De94C599944a3Ca737\",\r\n      isStable: true,\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0x818ED84bA1927945b631016e0d402Db50cE8865f\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  42161: [\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/2518/thumb/weth.png?1628852295\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f\",\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Chainlink\",\r\n      symbol: \"LINK\",\r\n      decimals: 18,\r\n      address: \"0xf97f4df75117a78c1A5a0DBb814Af92458539FB4\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/877/thumb/chainlink-new-logo.png?1547034700\",\r\n    },\r\n    {\r\n      name: \"Uniswap\",\r\n      symbol: \"UNI\",\r\n      decimals: 18,\r\n      address: \"0xFa7F8980b0f1E64A2062791cc3b0871572f1F7f0\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12504/thumb/uniswap-uni.png?1600306604\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/thumb/Tether-logo.png?1598003707\",\r\n    },\r\n    {\r\n      name: \"Dai\",\r\n      symbol: \"DAI\",\r\n      decimals: 18,\r\n      address: \"0xDA10009cBd5D07dd0CeCc66161FC93D7c9000da1\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9956/thumb/4943.png?1636636734\",\r\n    },\r\n    {\r\n      name: \"Frax\",\r\n      symbol: \"FRAX\",\r\n      decimals: 18,\r\n      address: \"0x17FC002b466eEc40DaE837Fc4bE5c67993ddBd6F\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/13422/small/frax_logo.png?1608476506\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      decimals: 18,\r\n      address: \"0xFEa7a6a0B346362BF88A9e4A88416B77a57D6c2A\",\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"Avalanche\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Wrapped AVAX\",\r\n      symbol: \"WAVAX\",\r\n      decimals: 18,\r\n      address: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n      isWrapped: true,\r\n      baseSymbol: \"AVAX\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Ethereum (WETH.e)\",\r\n      symbol: \"ETH\",\r\n      address: \"0x49D5c2BdFfac6CE2BFdB6640F4F80f226bc10bAB\",\r\n      decimals: 18,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC.e)\",\r\n      symbol: \"BTC\",\r\n      address: \"0x50b7545627a5162F82A992c33b87aDc75187B218\",\r\n      decimals: 8,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (BTC.b)\",\r\n      symbol: \"BTC.b\",\r\n      address: \"0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n      decimals: 8,\r\n      isShortable: false,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/26115/thumb/btcb.png?1655921693\",\r\n    },\r\n    {\r\n      name: \"USD Coin (USDC.e)\",\r\n      symbol: \"USDC.e\",\r\n      address: \"0xA7D7079b0FEaD91F3e65f86E8915Cb59c1a4C664\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      address: \"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      address: \"0x130966628846BFd36ff31a822705796e8cb8C18D\",\r\n      decimals: 18,\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n};\r\n\r\nconst ADDITIONAL_TOKENS = {\r\n  42161: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(42161, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(42161, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(43114, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(43114, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n};\r\n\r\nconst CHAIN_IDS = [56, 97, 42161, 421611, 43114];\r\n\r\nconst TOKENS_MAP = {};\r\nconst TOKENS_BY_SYMBOL_MAP = {};\r\n\r\nfor (let j = 0; j < CHAIN_IDS.length; j++) {\r\n  const chainId = CHAIN_IDS[j];\r\n  TOKENS_MAP[chainId] = {};\r\n  TOKENS_BY_SYMBOL_MAP[chainId] = {};\r\n  let tokens = TOKENS[chainId];\r\n  if (ADDITIONAL_TOKENS[chainId]) {\r\n    tokens = tokens.concat(ADDITIONAL_TOKENS[chainId]);\r\n  }\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = tokens[i];\r\n    TOKENS_MAP[chainId][token.address] = token;\r\n    TOKENS_BY_SYMBOL_MAP[chainId][token.symbol] = token;\r\n  }\r\n}\r\n\r\nconst WRAPPED_TOKENS_MAP = {};\r\nconst NATIVE_TOKENS_MAP = {};\r\nfor (const chainId of CHAIN_IDS) {\r\n  for (const token of TOKENS[chainId]) {\r\n    if (token.isWrapped) {\r\n      WRAPPED_TOKENS_MAP[chainId] = token;\r\n    } else if (token.isNative) {\r\n      NATIVE_TOKENS_MAP[chainId] = token;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getWrappedToken(chainId) {\r\n  return WRAPPED_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getNativeToken(chainId) {\r\n  return NATIVE_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getTokens(chainId) {\r\n  return TOKENS[chainId];\r\n}\r\n\r\nexport function isValidToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  return address in TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  if (!TOKENS_MAP[chainId][address]) {\r\n    throw new Error(`Incorrect address \"${address}\" for chainId ${chainId}`);\r\n  }\r\n  return TOKENS_MAP[chainId][address];\r\n}\r\n\r\nexport function getTokenBySymbol(chainId, symbol) {\r\n  const token = TOKENS_BY_SYMBOL_MAP[chainId][symbol];\r\n  if (!token) {\r\n    throw new Error(`Incorrect symbol \"${symbol}\" for chainId ${chainId}`);\r\n  }\r\n  return token;\r\n}\r\n\r\nexport function getWhitelistedTokens(chainId) {\r\n  return TOKENS[chainId].filter((token) => token.symbol !== \"USDG\");\r\n}\r\n\r\nexport function getVisibleTokens(chainId) {\r\n  return getWhitelistedTokens(chainId).filter((token) => !token.isWrapped && !token.isTempHidden);\r\n}\r\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { InjectedConnector } from \"@web3-react/injected-connector\";\r\nimport {\r\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\r\n  WalletConnectConnector,\r\n} from \"@web3-react/walletconnect-connector\";\r\nimport { toast } from \"react-toastify\";\r\nimport { UnsupportedChainIdError, useWeb3React } from \"@web3-react/core\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { ethers } from \"ethers\";\r\nimport { format as formatDateFn } from \"date-fns\";\r\nimport Token from \"../abis/Token.json\";\r\nimport _ from \"lodash\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBookReader from \"../abis/OrderBookReader.json\";\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\n\r\nimport { getWhitelistedTokens, isValidToken } from \"../config/Tokens\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport const UI_VERSION = \"1.3\";\r\n\r\n// use a random placeholder account instead of the zero address as the zero address might have tokens\r\nexport const PLACEHOLDER_ACCOUNT = ethers.Wallet.createRandom().address;\r\n\r\nexport const MAINNET = 56;\r\nexport const AVALANCHE = 43114;\r\nexport const TESTNET = 97;\r\nexport const ARBITRUM_TESTNET = 421611;\r\nexport const ARBITRUM = 42161;\r\n// TODO take it from web3\r\nexport const DEFAULT_CHAIN_ID = ARBITRUM;\r\nexport const CHAIN_ID = DEFAULT_CHAIN_ID;\r\n\r\nexport const MIN_PROFIT_TIME = 0;\r\n\r\nconst SELECTED_NETWORK_LOCAL_STORAGE_KEY = \"SELECTED_NETWORK\";\r\n\r\nexport const IS_NETWORK_DISABLED = {\r\n  [ARBITRUM]: false,\r\n  [AVALANCHE]: false,\r\n};\r\n\r\nconst CHAIN_NAMES_MAP = {\r\n  [MAINNET]: \"BSC\",\r\n  [TESTNET]: \"BSC Testnet\",\r\n  [ARBITRUM_TESTNET]: \"ArbRinkeby\",\r\n  [ARBITRUM]: \"Arbitrum\",\r\n  [AVALANCHE]: \"Avalanche\",\r\n};\r\n\r\nconst alchemyWhitelistedDomains = [\"gmx.io\", \"app.gmx.io\"];\r\n\r\nexport function getDefaultArbitrumRpcUrl() {\r\n  return \"https://arb1.arbitrum.io/rpc\";\r\n}\r\n\r\nexport function getAlchemyHttpUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"https://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"https://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nexport function getAlchemyWsUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"wss://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"wss://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nconst ARBITRUM_RPC_PROVIDERS = [getDefaultArbitrumRpcUrl()];\r\nconst AVALANCHE_RPC_PROVIDERS = [\"https://api.avax.network/ext/bc/C/rpc\"];\r\nexport const WALLET_CONNECT_LOCALSTORAGE_KEY = \"walletconnect\";\r\nexport const WALLET_LINK_LOCALSTORAGE_PREFIX = \"-walletlink\";\r\nexport const SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY = \"eagerconnect\";\r\nexport const CURRENT_PROVIDER_LOCALSTORAGE_KEY = \"currentprovider\";\r\nexport const LANGUAGE_LOCALSTORAGE_KEY = \"LANGUAGE_KEY\";\r\n\r\nexport function getChainName(chainId) {\r\n  return CHAIN_NAMES_MAP[chainId];\r\n}\r\n\r\nexport const USDG_ADDRESS = getContract(CHAIN_ID, \"USDG\");\r\n\r\nexport const BASIS_POINTS_DIVISOR = 10000;\r\nexport const MAX_LEVERAGE = 100 * BASIS_POINTS_DIVISOR;\r\nexport const MAX_ALLOWED_LEVERAGE = 50 * BASIS_POINTS_DIVISOR;\r\n\r\nexport const MAX_PRICE_DEVIATION_BASIS_POINTS = 750;\r\nexport const DEFAULT_GAS_LIMIT = 1 * 1000 * 1000;\r\nexport const SECONDS_PER_YEAR = 31536000;\r\nexport const USDG_DECIMALS = 18;\r\nexport const USD_DECIMALS = 30;\r\nexport const DEPOSIT_FEE = 30;\r\nexport const DUST_BNB = \"2000000000000000\";\r\nexport const DUST_USD = expandDecimals(1, USD_DECIMALS);\r\nexport const PRECISION = expandDecimals(1, 30);\r\nexport const GLP_DECIMALS = 18;\r\nexport const GMX_DECIMALS = 18;\r\nexport const DEFAULT_MAX_USDG_AMOUNT = expandDecimals(200 * 1000 * 1000, 18);\r\n\r\nexport const TAX_BASIS_POINTS = 50;\r\nexport const STABLE_TAX_BASIS_POINTS = 5;\r\nexport const MINT_BURN_FEE_BASIS_POINTS = 25;\r\nexport const SWAP_FEE_BASIS_POINTS = 30;\r\nexport const STABLE_SWAP_FEE_BASIS_POINTS = 1;\r\nexport const MARGIN_FEE_BASIS_POINTS = 10;\r\n\r\nexport const LIQUIDATION_FEE = expandDecimals(5, USD_DECIMALS);\r\n\r\nexport const TRADES_PAGE_SIZE = 100;\r\n\r\nexport const GLP_COOLDOWN_DURATION = 15 * 60;\r\nexport const THRESHOLD_REDEMPTION_VALUE = expandDecimals(993, 27); // 0.993\r\nexport const FUNDING_RATE_PRECISION = 1000000;\r\n\r\nexport const SWAP = \"Swap\";\r\nexport const INCREASE = \"Increase\";\r\nexport const DECREASE = \"Decrease\";\r\nexport const LONG = \"Long\";\r\nexport const SHORT = \"Short\";\r\n\r\nexport const MARKET = \"Market\";\r\nexport const LIMIT = \"Limit\";\r\nexport const STOP = \"Stop\";\r\nexport const BORROW = \"Borrow\";\r\n\r\n// Market/limit orders disabling\r\n// export const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT, STOP];\r\n// export const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT];\r\nexport const LEVERAGE_ORDER_OPTIONS = [BORROW, MARKET, LIMIT];\r\n\r\nexport const SWAP_ORDER_OPTIONS = [MARKET, LIMIT];\r\n\r\n// Swap disabling\r\n// export const SWAP_OPTIONS = [LONG, SHORT, SWAP];\r\nexport const SWAP_OPTIONS = [LONG, SHORT];\r\n\r\n\r\n// Default Slippage\r\n// export const DEFAULT_SLIPPAGE_AMOUNT = 30;\r\nexport const DEFAULT_SLIPPAGE_AMOUNT = 100;\r\n\r\nexport const DEFAULT_HIGHER_SLIPPAGE_AMOUNT = 100;\r\n\r\nexport const SLIPPAGE_BPS_KEY = \"Exchange-swap-slippage-basis-points-v3\";\r\nexport const CLOSE_POSITION_RECEIVE_TOKEN_KEY = \"Close-position-receive-token\";\r\nexport const IS_PNL_IN_LEVERAGE_KEY = \"Exchange-swap-is-pnl-in-leverage\";\r\nexport const SHOW_PNL_AFTER_FEES_KEY = \"Exchange-swap-show-pnl-after-fees\";\r\nexport const DISABLE_ORDER_VALIDATION_KEY = \"disable-order-validation\";\r\nexport const SHOULD_SHOW_POSITION_LINES_KEY = \"Exchange-swap-should-show-position-lines\";\r\nexport const REFERRAL_CODE_KEY = \"GMX-referralCode\";\r\nexport const REFERRAL_CODE_QUERY_PARAM = \"ref\";\r\nexport const REFERRALS_SELECTED_TAB_KEY = \"Referrals-selected-tab\";\r\nexport const MAX_REFERRAL_CODE_LENGTH = 20;\r\n\r\nexport const TRIGGER_PREFIX_ABOVE = \">\";\r\nexport const TRIGGER_PREFIX_BELOW = \"<\";\r\n\r\nexport const MIN_PROFIT_BIPS = 0;\r\n\r\nexport const GLPPOOLCOLORS = {\r\n  ETH: \"#6062a6\",\r\n  BTC: \"#F7931A\",\r\n  \"BTC.b\": \"#F7931A\",\r\n  USDC: \"#2775CA\",\r\n  \"USDC.e\": \"#2A5ADA\",\r\n  USDT: \"#67B18A\",\r\n  MIM: \"#9695F8\",\r\n  FRAX: \"#000\",\r\n  DAI: \"#FAC044\",\r\n  UNI: \"#E9167C\",\r\n  AVAX: \"#E84142\",\r\n  LINK: \"#3256D6\",\r\n};\r\n\r\nexport const HIGH_EXECUTION_FEES_MAP = {\r\n  [ARBITRUM]: 3, // 3 USD\r\n  [AVALANCHE]: 3, // 3 USD\r\n};\r\n\r\nexport function getHighExecutionFee(chainId) {\r\n  return HIGH_EXECUTION_FEES_MAP[chainId] || 3;\r\n}\r\n\r\nexport const ICONLINKS = {\r\n  [ARBITRUM_TESTNET]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://testnet.arbiscan.io/token/0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    },\r\n  },\r\n  [ARBITRUM]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://arbiscan.io/token/0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\",\r\n    },\r\n    LINK: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\r\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\",\r\n    },\r\n    UNI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\",\r\n    },\r\n    USDT: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\",\r\n    },\r\n    DAI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\r\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\",\r\n    },\r\n    FRAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\r\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\",\r\n    },\r\n  },\r\n  [AVALANCHE]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      avalanche: \"https://snowtrace.io/address/0x62edc0692bd897d2295872a9ffcac5425011c661\",\r\n    },\r\n    GLP: {\r\n      avalanche: \"https://snowtrace.io/address/0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    },\r\n    AVAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/avalanche\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/weth\",\r\n      avalanche: \"https://snowtrace.io/address/0x49d5c2bdffac6ce2bfdb6640f4f80f226bc10bab\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x50b7545627a5162f82a992c33b87adc75187b218\",\r\n    },\r\n    \"BTC.b\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      avalanche: \"https://snowtrace.io/address/0x130966628846bfd36ff31a822705796e8cb8c18d\",\r\n    },\r\n    \"USDC.e\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin-avalanche-bridged-usdc-e\",\r\n      avalanche: \"https://snowtrace.io/address/0xa7d7079b0fead91f3e65f86e8915cb59c1a4c664\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      avalanche: \"https://snowtrace.io/address/0xb97ef9ef8734c71904d8002f8b6bc66dd9c48a6e\",\r\n    },\r\n  },\r\n};\r\n\r\nexport const platformTokens = {\r\n  42161: {\r\n    // arbitrum\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n};\r\n\r\nconst supportedChainIds = [ARBITRUM, AVALANCHE];\r\nif (isDevelopment()) {\r\n  supportedChainIds.push(ARBITRUM_TESTNET);\r\n}\r\nconst injectedConnector = new InjectedConnector({\r\n  supportedChainIds,\r\n});\r\n\r\nconst getWalletConnectConnector = () => {\r\n  const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n  return new WalletConnectConnector({\r\n    rpc: {\r\n      [AVALANCHE]: AVALANCHE_RPC_PROVIDERS[0],\r\n      [ARBITRUM]: ARBITRUM_RPC_PROVIDERS[0],\r\n      [ARBITRUM_TESTNET]: \"https://rinkeby.arbitrum.io/rpc\",\r\n    },\r\n    qrcode: true,\r\n    chainId,\r\n  });\r\n};\r\n\r\nexport function isSupportedChain(chainId) {\r\n  return supportedChainIds.includes(chainId);\r\n}\r\n\r\nexport function deserialize(data) {\r\n  for (const [key, value] of Object.entries(data)) {\r\n    if (value._type === \"BigNumber\") {\r\n      data[key] = bigNumberify(value.value);\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function isHomeSite() {\r\n  return process.env.REACT_APP_IS_HOME_SITE === \"true\";\r\n}\r\n\r\nexport const helperToast = {\r\n  success: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n\r\nexport function useLocalStorageByChainId(chainId, key, defaultValue) {\r\n  const [internalValue, setInternalValue] = useLocalStorage(key, {});\r\n\r\n  const setValue = useCallback(\r\n    (value) => {\r\n      setInternalValue((internalValue) => {\r\n        if (typeof value === \"function\") {\r\n          value = value(internalValue[chainId] || defaultValue);\r\n        }\r\n        const newInternalValue = {\r\n          ...internalValue,\r\n          [chainId]: value,\r\n        };\r\n        return newInternalValue;\r\n      });\r\n    },\r\n    [chainId, setInternalValue, defaultValue]\r\n  );\r\n\r\n  let value;\r\n  if (chainId in internalValue) {\r\n    value = internalValue[chainId];\r\n  } else {\r\n    value = defaultValue;\r\n  }\r\n\r\n  return [value, setValue];\r\n}\r\n\r\nexport function useLocalStorageSerializeKey(key, value, opts) {\r\n  key = JSON.stringify(key);\r\n  return useLocalStorage(key, value, opts);\r\n}\r\n\r\nfunction getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd) {\r\n  // Limit/stop orders are executed with price specified by user\r\n  if (orderOption && orderOption !== MARKET && triggerPriceUsd) {\r\n    return triggerPriceUsd;\r\n  }\r\n\r\n  // Market orders are executed with current market price\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n  return max ? info.maxPrice : info.minPrice;\r\n}\r\n\r\nexport function getLiquidationPriceFromDelta({ liquidationAmount, size, collateral, averagePrice, isLong }) {\r\n  if (!size || size.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  if (liquidationAmount.gt(collateral)) {\r\n    const liquidationDelta = liquidationAmount.sub(collateral);\r\n    const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n    return isLong ? averagePrice.add(priceDelta) : averagePrice.sub(priceDelta);\r\n  }\r\n\r\n  const liquidationDelta = collateral.sub(liquidationAmount);\r\n  const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n\r\n  return isLong ? averagePrice.sub(priceDelta) : averagePrice.add(priceDelta);\r\n}\r\n\r\nexport const replaceNativeTokenAddress = (path, nativeTokenAddress) => {\r\n  if (!path) {\r\n    return;\r\n  }\r\n\r\n  let updatedPath = [];\r\n  for (let i = 0; i < path.length; i++) {\r\n    let address = path[i];\r\n    if (address === AddressZero) {\r\n      address = nativeTokenAddress;\r\n    }\r\n    updatedPath.push(address);\r\n  }\r\n\r\n  return updatedPath;\r\n};\r\n\r\nexport function getMarginFee(sizeDelta) {\r\n  if (!sizeDelta) {\r\n    return bigNumberify(0);\r\n  }\r\n  const afterFeeUsd = sizeDelta.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n  return sizeDelta.sub(afterFeeUsd);\r\n}\r\n\r\nexport function getServerBaseUrl(chainId) {\r\n  if (!chainId) {\r\n    throw new Error(\"chainId is not provided\");\r\n  }\r\n  if (document.location.hostname.includes(\"deploy-preview\")) {\r\n    const fromLocalStorage = localStorage.getItem(\"SERVER_BASE_URL\");\r\n    if (fromLocalStorage) {\r\n      return fromLocalStorage;\r\n    }\r\n  }\r\n  if (chainId === MAINNET) {\r\n    return \"https://gambit-server-staging.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://gambit-server-devnet.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://gmx-avax-server.uc.r.appspot.com\";\r\n  }\r\n  return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n}\r\n\r\nexport function getServerUrl(chainId, path) {\r\n  return `${getServerBaseUrl(chainId)}${path}`;\r\n}\r\n\r\nexport function isTriggerRatioInverted(fromTokenInfo, toTokenInfo) {\r\n  if (!toTokenInfo || !fromTokenInfo) return false;\r\n  if (toTokenInfo.isStable || toTokenInfo.isUsdg) return true;\r\n  if (toTokenInfo.maxPrice) return toTokenInfo.maxPrice.lt(fromTokenInfo.maxPrice);\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRate(tokenAInfo, tokenBInfo, inverted) {\r\n  if (!tokenAInfo || !tokenAInfo.minPrice || !tokenBInfo || !tokenBInfo.maxPrice) {\r\n    return;\r\n  }\r\n  if (inverted) {\r\n    return tokenAInfo.minPrice.mul(PRECISION).div(tokenBInfo.maxPrice);\r\n  }\r\n  return tokenBInfo.maxPrice.mul(PRECISION).div(tokenAInfo.minPrice);\r\n}\r\n\r\nexport function getMostAbundantStableToken(chainId, infoTokens) {\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  let availableAmount;\r\n  let stableToken = whitelistedTokens.find((t) => t.isStable);\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const info = getTokenInfo(infoTokens, whitelistedTokens[i].address);\r\n    if (!info.isStable || !info.availableAmount) {\r\n      continue;\r\n    }\r\n\r\n    const adjustedAvailableAmount = adjustForDecimals(info.availableAmount, info.decimals, USD_DECIMALS);\r\n    if (!availableAmount || adjustedAvailableAmount.gt(availableAmount)) {\r\n      availableAmount = adjustedAvailableAmount;\r\n      stableToken = info;\r\n    }\r\n  }\r\n  return stableToken;\r\n}\r\n\r\nexport function shouldInvertTriggerRatio(tokenA, tokenB) {\r\n  if (tokenB.isStable || tokenB.isUsdg) return true;\r\n  if (tokenB.maxPrice && tokenA.maxPrice && tokenB.maxPrice.lt(tokenA.maxPrice)) return true;\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRateDisplay(rate, tokenA, tokenB, opts = {}) {\r\n  if (!rate || !tokenA || !tokenB) return \"...\";\r\n  if (shouldInvertTriggerRatio(tokenA, tokenB)) {\r\n    [tokenA, tokenB] = [tokenB, tokenA];\r\n    rate = PRECISION.mul(PRECISION).div(rate);\r\n  }\r\n  const rateValue = formatAmount(rate, USD_DECIMALS, tokenA.isStable || tokenA.isUsdg ? 2 : 4, true);\r\n  if (opts.omitSymbols) {\r\n    return rateValue;\r\n  }\r\n  return `${rateValue} ${tokenA.symbol}/${tokenB.symbol}`;\r\n}\r\n\r\nconst adjustForDecimalsFactory = (n) => (number) => {\r\n  if (n === 0) {\r\n    return number;\r\n  }\r\n  if (n > 0) {\r\n    return number.mul(expandDecimals(1, n));\r\n  }\r\n  return number.div(expandDecimals(1, -n));\r\n};\r\n\r\nexport function adjustForDecimals(amount, divDecimals, mulDecimals) {\r\n  return amount.mul(expandDecimals(1, mulDecimals)).div(expandDecimals(1, divDecimals));\r\n}\r\n\r\nexport function getTargetUsdgAmount(token, usdgSupply, totalTokenWeights) {\r\n  if (!token || !token.weight || !usdgSupply) {\r\n    return;\r\n  }\r\n\r\n  if (usdgSupply.eq(0)) {\r\n    return bigNumberify(0);\r\n  }\r\n\r\n  return token.weight.mul(usdgSupply).div(totalTokenWeights);\r\n}\r\n\r\nexport function getFeeBasisPoints(\r\n  token,\r\n  usdgDelta,\r\n  feeBasisPoints,\r\n  taxBasisPoints,\r\n  increment,\r\n  usdgSupply,\r\n  totalTokenWeights\r\n) {\r\n  if (!token || !token.usdgAmount || !usdgSupply || !totalTokenWeights) {\r\n    return 0;\r\n  }\r\n\r\n  feeBasisPoints = bigNumberify(feeBasisPoints);\r\n  taxBasisPoints = bigNumberify(taxBasisPoints);\r\n\r\n  const initialAmount = token.usdgAmount;\r\n  let nextAmount = initialAmount.add(usdgDelta);\r\n  if (!increment) {\r\n    nextAmount = usdgDelta.gt(initialAmount) ? bigNumberify(0) : initialAmount.sub(usdgDelta);\r\n  }\r\n\r\n  const targetAmount = getTargetUsdgAmount(token, usdgSupply, totalTokenWeights);\r\n  if (!targetAmount || targetAmount.eq(0)) {\r\n    return feeBasisPoints.toNumber();\r\n  }\r\n\r\n  const initialDiff = initialAmount.gt(targetAmount)\r\n    ? initialAmount.sub(targetAmount)\r\n    : targetAmount.sub(initialAmount);\r\n  const nextDiff = nextAmount.gt(targetAmount) ? nextAmount.sub(targetAmount) : targetAmount.sub(nextAmount);\r\n\r\n  if (nextDiff.lt(initialDiff)) {\r\n    const rebateBps = taxBasisPoints.mul(initialDiff).div(targetAmount);\r\n    return rebateBps.gt(feeBasisPoints) ? 0 : feeBasisPoints.sub(rebateBps).toNumber();\r\n  }\r\n\r\n  let averageDiff = initialDiff.add(nextDiff).div(2);\r\n  if (averageDiff.gt(targetAmount)) {\r\n    averageDiff = targetAmount;\r\n  }\r\n  const taxBps = taxBasisPoints.mul(averageDiff).div(targetAmount);\r\n  return feeBasisPoints.add(taxBps).toNumber();\r\n}\r\n\r\nexport function getBuyGlpToAmount(fromAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!fromAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = fromAmount.mul(swapToken.minPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = fromAmount.mul(swapToken.minPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpFromAmount(toAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!toAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = toAmount.mul(swapToken.maxPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = toAmount.mul(swapToken.maxPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getBuyGlpFromAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.minPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpToAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.maxPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getNextFromAmount(\r\n  chainId,\r\n  toAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n\r\n  if (!toAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromToken || !fromTokenMinPrice || !toToken || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(fromToken.decimals - toToken.decimals);\r\n\r\n  let fromAmountBasedOnRatio;\r\n  if (ratio && !ratio.isZero()) {\r\n    fromAmountBasedOnRatio = toAmount.mul(ratio).div(PRECISION);\r\n  }\r\n\r\n  const fromAmount =\r\n    ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(toTokenMaxPrice).div(fromTokenMinPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, toToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getNextToAmount(\r\n  chainId,\r\n  fromAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!fromAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromTokenMinPrice || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(toToken.decimals - fromToken.decimals);\r\n\r\n  let toAmountBasedOnRatio = bigNumberify(0);\r\n  if (ratio && !ratio.isZero()) {\r\n    toAmountBasedOnRatio = fromAmount.mul(PRECISION).div(ratio);\r\n  }\r\n\r\n  if (toTokenAddress === USDG_ADDRESS) {\r\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio;\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const toAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n    return {\r\n      amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n      feeBasisPoints,\r\n    };\r\n  }\r\n\r\n  if (fromTokenAddress === USDG_ADDRESS) {\r\n    const redemptionValue = toToken.redemptionAmount\r\n      .mul(toTokenPriceUsd || toTokenMaxPrice)\r\n      .div(expandDecimals(1, toToken.decimals));\r\n\r\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const expectedAmount = fromAmount;\r\n\r\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\r\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio\r\n        .mul(BASIS_POINTS_DIVISOR - feeBasisPoints0 - feeBasisPoints1)\r\n        .div(BASIS_POINTS_DIVISOR);\r\n      return {\r\n        amount: adjustDecimals(toAmount),\r\n        path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n        feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n      };\r\n    }\r\n\r\n    // get toAmount for USDG => stableToken\r\n    let toAmount = fromAmount.mul(PRECISION).div(stableToken.maxPrice);\r\n    // apply USDG => stableToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints0).div(BASIS_POINTS_DIVISOR);\r\n\r\n    // get toAmount for stableToken => toToken\r\n    toAmount = toAmount.mul(stableToken.minPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n    // apply stableToken => toToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\r\n\r\n    return {\r\n      amount: adjustDecimals(toAmount),\r\n      path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n      feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n    };\r\n  }\r\n\r\n  const toAmount =\r\n    ratio && !ratio.isZero()\r\n      ? toAmountBasedOnRatio\r\n      : fromAmount.mul(fromTokenMinPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, fromToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getProfitPrice(closePrice, position) {\r\n  let profitPrice;\r\n  if (position && position.averagePrice && closePrice) {\r\n    profitPrice = position.isLong\r\n      ? position.averagePrice.mul(BASIS_POINTS_DIVISOR + MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR)\r\n      : position.averagePrice.mul(BASIS_POINTS_DIVISOR - MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR);\r\n  }\r\n  return profitPrice;\r\n}\r\n\r\nexport function calculatePositionDelta(\r\n  price,\r\n  { size, collateral, isLong, averagePrice, lastIncreasedTime },\r\n  sizeDelta\r\n) {\r\n  if (!sizeDelta) {\r\n    sizeDelta = size;\r\n  }\r\n  const priceDelta = averagePrice.gt(price) ? averagePrice.sub(price) : price.sub(averagePrice);\r\n  let delta = sizeDelta.mul(priceDelta).div(averagePrice);\r\n  const pendingDelta = delta;\r\n\r\n  const minProfitExpired = lastIncreasedTime + MIN_PROFIT_TIME < Date.now() / 1000;\r\n  const hasProfit = isLong ? price.gt(averagePrice) : price.lt(averagePrice);\r\n  if (!minProfitExpired && hasProfit && delta.mul(BASIS_POINTS_DIVISOR).lte(size.mul(MIN_PROFIT_BIPS))) {\r\n    delta = bigNumberify(0);\r\n  }\r\n\r\n  const deltaPercentage = delta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n  const pendingDeltaPercentage = pendingDelta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n\r\n  return {\r\n    delta,\r\n    pendingDelta,\r\n    pendingDeltaPercentage,\r\n    hasProfit,\r\n    deltaPercentage,\r\n  };\r\n}\r\n\r\nexport function getDeltaStr({ delta, deltaPercentage, hasProfit }) {\r\n  let deltaStr;\r\n  let deltaPercentageStr;\r\n\r\n  if (delta.gt(0)) {\r\n    deltaStr = hasProfit ? \"+\" : \"-\";\r\n    deltaPercentageStr = hasProfit ? \"+\" : \"-\";\r\n  } else {\r\n    deltaStr = \"\";\r\n    deltaPercentageStr = \"\";\r\n  }\r\n  deltaStr += `$${formatAmount(delta, USD_DECIMALS, 2, true)}`;\r\n  deltaPercentageStr += `${formatAmount(deltaPercentage, 2, 2)}%`;\r\n\r\n  return { deltaStr, deltaPercentageStr };\r\n}\r\n\r\nexport function getLeverage({\r\n  size,\r\n  sizeDelta,\r\n  increaseSize,\r\n  collateral,\r\n  collateralDelta,\r\n  increaseCollateral,\r\n  entryFundingRate,\r\n  cumulativeFundingRate,\r\n  hasProfit,\r\n  delta,\r\n  includeDelta,\r\n}) {\r\n  if (!size && !sizeDelta) {\r\n    return;\r\n  }\r\n  if (!collateral && !collateralDelta) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n  }\r\n\r\n  let remainingCollateral = collateral ? collateral : bigNumberify(0);\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = collateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(collateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  if (delta && includeDelta) {\r\n    if (hasProfit) {\r\n      remainingCollateral = remainingCollateral.add(delta);\r\n    } else {\r\n      if (delta.gt(remainingCollateral)) {\r\n        return;\r\n      }\r\n\r\n      remainingCollateral = remainingCollateral.sub(delta);\r\n    }\r\n  }\r\n\r\n  if (remainingCollateral.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  remainingCollateral = sizeDelta\r\n    ? remainingCollateral.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR)\r\n    : remainingCollateral;\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    remainingCollateral = remainingCollateral.sub(fundingFee);\r\n  }\r\n\r\n  return nextSize.mul(BASIS_POINTS_DIVISOR).div(remainingCollateral);\r\n}\r\n\r\nexport function getLiquidationPrice(data) {\r\n  let {\r\n    isLong,\r\n    size,\r\n    collateral,\r\n    averagePrice,\r\n    entryFundingRate,\r\n    cumulativeFundingRate,\r\n    sizeDelta,\r\n    collateralDelta,\r\n    increaseCollateral,\r\n    increaseSize,\r\n    delta,\r\n    hasProfit,\r\n    includeDelta,\r\n  } = data;\r\n  if (!size || !collateral || !averagePrice) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  let remainingCollateral = collateral;\r\n\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n\r\n    if (includeDelta && !hasProfit) {\r\n      const adjustedDelta = sizeDelta.mul(delta).div(size);\r\n      remainingCollateral = remainingCollateral.sub(adjustedDelta);\r\n    }\r\n  }\r\n\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = remainingCollateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(remainingCollateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = remainingCollateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  let positionFee = getMarginFee(size).add(LIQUIDATION_FEE);\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    positionFee = positionFee.add(fundingFee);\r\n  }\r\n\r\n  const liquidationPriceForFees = getLiquidationPriceFromDelta({\r\n    liquidationAmount: positionFee,\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  const liquidationPriceForMaxLeverage = getLiquidationPriceFromDelta({\r\n    liquidationAmount: nextSize.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE),\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  if (!liquidationPriceForFees) {\r\n    return liquidationPriceForMaxLeverage;\r\n  }\r\n  if (!liquidationPriceForMaxLeverage) {\r\n    return liquidationPriceForFees;\r\n  }\r\n\r\n  if (isLong) {\r\n    // return the higher price\r\n    return liquidationPriceForFees.gt(liquidationPriceForMaxLeverage)\r\n      ? liquidationPriceForFees\r\n      : liquidationPriceForMaxLeverage;\r\n  }\r\n\r\n  // return the lower price\r\n  return liquidationPriceForFees.lt(liquidationPriceForMaxLeverage)\r\n    ? liquidationPriceForFees\r\n    : liquidationPriceForMaxLeverage;\r\n}\r\n\r\nexport function getUsd(amount, tokenAddress, max, infoTokens, orderOption, triggerPriceUsd) {\r\n  if (!amount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return amount.mul(PRECISION).div(expandDecimals(1, 18));\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  const price = getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd);\r\n  if (!price) {\r\n    return;\r\n  }\r\n\r\n  return amount.mul(price).div(expandDecimals(1, info.decimals));\r\n}\r\n\r\nexport function getPositionKey(account, collateralTokenAddress, indexTokenAddress, isLong, nativeTokenAddress) {\r\n  const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n  const tokenAddress1 = indexTokenAddress === AddressZero ? nativeTokenAddress : indexTokenAddress;\r\n  return account + \":\" + tokenAddress0 + \":\" + tokenAddress1 + \":\" + isLong;\r\n}\r\n\r\nexport function getPositionContractKey(account, collateralToken, indexToken, isLong) {\r\n  return ethers.utils.solidityKeccak256(\r\n    [\"address\", \"address\", \"address\", \"bool\"],\r\n    [account, collateralToken, indexToken, isLong]\r\n  );\r\n}\r\n\r\nexport function getSwapFeeBasisPoints(isStable) {\r\n  return isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n}\r\n\r\n// BSC TESTNET\r\n// const RPC_PROVIDERS = [\r\n//   \"https://data-seed-prebsc-1-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s3.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s3.binance.org:8545\"\r\n// ]\r\n\r\n// BSC MAINNET\r\nexport const BSC_RPC_PROVIDERS = [\r\n  \"https://bsc-dataseed.binance.org\",\r\n  \"https://bsc-dataseed1.defibit.io\",\r\n  \"https://bsc-dataseed1.ninicoin.io\",\r\n  \"https://bsc-dataseed2.defibit.io\",\r\n  \"https://bsc-dataseed3.defibit.io\",\r\n  \"https://bsc-dataseed4.defibit.io\",\r\n  \"https://bsc-dataseed2.ninicoin.io\",\r\n  \"https://bsc-dataseed3.ninicoin.io\",\r\n  \"https://bsc-dataseed4.ninicoin.io\",\r\n  \"https://bsc-dataseed1.binance.org\",\r\n  \"https://bsc-dataseed2.binance.org\",\r\n  \"https://bsc-dataseed3.binance.org\",\r\n  \"https://bsc-dataseed4.binance.org\",\r\n];\r\n\r\nconst RPC_PROVIDERS = {\r\n  [MAINNET]: BSC_RPC_PROVIDERS,\r\n  [ARBITRUM]: ARBITRUM_RPC_PROVIDERS,\r\n  [AVALANCHE]: AVALANCHE_RPC_PROVIDERS,\r\n};\r\n\r\nconst FALLBACK_PROVIDERS = {\r\n  [ARBITRUM]: [getAlchemyHttpUrl()],\r\n  [AVALANCHE]: [\"https://avax-mainnet.gateway.pokt.network/v1/lb/626f37766c499d003aada23b\"],\r\n};\r\n\r\nexport function shortenAddress(address, length) {\r\n  if (!length) {\r\n    return \"\";\r\n  }\r\n  if (!address) {\r\n    return address;\r\n  }\r\n  if (address.length < 10) {\r\n    return address;\r\n  }\r\n  let left = Math.floor((length - 3) / 2) + 1;\r\n  return address.substring(0, left) + \"...\" + address.substring(address.length - (length - (left + 3)), address.length);\r\n}\r\n\r\nexport function formatDateTime(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy, h:mm a\");\r\n}\r\n\r\nexport function getTimeRemaining(time) {\r\n  const now = parseInt(Date.now() / 1000);\r\n  if (time < now) {\r\n    return \"0h 0m\";\r\n  }\r\n  const diff = time - now;\r\n  const hours = parseInt(diff / (60 * 60));\r\n  const minutes = parseInt((diff - hours * 60 * 60) / 60);\r\n  return `${hours}h ${minutes}m`;\r\n}\r\n\r\nexport function formatDate(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy\");\r\n}\r\n\r\nexport function hasMetaMaskWalletExtension() {\r\n  return window.ethereum;\r\n}\r\n\r\nexport function hasCoinBaseWalletExtension() {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet) {\r\n    return false;\r\n  }\r\n  return window.ethereum.isCoinbaseWallet || ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n}\r\n\r\nexport function activateInjectedProvider(providerName) {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet && !ethereum?.isMetaMask) {\r\n    return undefined;\r\n  }\r\n\r\n  let provider;\r\n  if (ethereum?.providers) {\r\n    switch (providerName) {\r\n      case \"CoinBase\":\r\n        provider = ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n        break;\r\n      case \"MetaMask\":\r\n      default:\r\n        provider = ethereum.providers.find(({ isMetaMask }) => isMetaMask);\r\n        break;\r\n    }\r\n  }\r\n\r\n  if (provider) {\r\n    ethereum.setSelectedProvider(provider);\r\n  }\r\n}\r\n\r\nexport function getInjectedConnector() {\r\n  return injectedConnector;\r\n}\r\n\r\nexport function useChainId() {\r\n  let { chainId } = useWeb3React();\r\n\r\n  if (!chainId) {\r\n    const chainIdFromLocalStorage = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n    if (chainIdFromLocalStorage) {\r\n      chainId = parseInt(chainIdFromLocalStorage);\r\n      if (!chainId) {\r\n        // localstorage value is invalid\r\n        localStorage.removeItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!chainId || !supportedChainIds.includes(chainId)) {\r\n    chainId = DEFAULT_CHAIN_ID;\r\n  }\r\n  return { chainId };\r\n}\r\n\r\nexport function useENS(address) {\r\n  const [ensName, setENSName] = useState();\r\n\r\n  useEffect(() => {\r\n    async function resolveENS() {\r\n      if (address) {\r\n        const provider = new ethers.providers.JsonRpcProvider(\"https://rpc.ankr.com/eth\");\r\n        const name = await provider.lookupAddress(address.toLowerCase());\r\n        if (name) setENSName(name);\r\n      }\r\n    }\r\n    resolveENS();\r\n  }, [address]);\r\n\r\n  return { ensName };\r\n}\r\n\r\nexport function clearWalletConnectData() {\r\n  localStorage.removeItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n}\r\n\r\nexport function clearWalletLinkData() {\r\n  Object.entries(localStorage)\r\n    .map((x) => x[0])\r\n    .filter((x) => x.startsWith(WALLET_LINK_LOCALSTORAGE_PREFIX))\r\n    .map((x) => localStorage.removeItem(x));\r\n}\r\n\r\nexport function useEagerConnect(setActivatingConnector) {\r\n  const { activate, active } = useWeb3React();\r\n  const [tried, setTried] = useState(false);\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (Boolean(localStorage.getItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY)) !== true) {\r\n        // only works with WalletConnect\r\n        clearWalletConnectData();\r\n        // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n        clearWalletLinkData();\r\n        return;\r\n      }\r\n\r\n      let shouldTryWalletConnect = false;\r\n      try {\r\n        // naive validation to not trigger Wallet Connect if data is corrupted\r\n        const rawData = localStorage.getItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n        if (rawData) {\r\n          const data = JSON.parse(rawData);\r\n          if (data && data.connected) {\r\n            shouldTryWalletConnect = true;\r\n          }\r\n        }\r\n      } catch (ex) {\r\n        if (ex instanceof SyntaxError) {\r\n          // rawData is not a valid json\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      if (shouldTryWalletConnect) {\r\n        try {\r\n          const connector = getWalletConnectConnector();\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n          // in case Wallet Connect is activated no need to check injected wallet\r\n          return;\r\n        } catch (ex) {\r\n          // assume data in localstorage is corrupted and delete it to not retry on next page load\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      try {\r\n        const connector = getInjectedConnector();\r\n        const currentProviderName = localStorage.getItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY) ?? false;\r\n        if (currentProviderName !== false) {\r\n          activateInjectedProvider(currentProviderName);\r\n        }\r\n        const authorized = await connector.isAuthorized();\r\n        if (authorized) {\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n        }\r\n      } catch (ex) {}\r\n\r\n      setTried(true);\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []); // intentionally only running on mount (make sure it's only mounted once :))\r\n\r\n  // if the connection worked, wait until we get confirmation of that to flip the flag\r\n  useEffect(() => {\r\n    if (!tried && active) {\r\n      setTried(true);\r\n    }\r\n  }, [tried, active]);\r\n\r\n  return tried;\r\n}\r\n\r\nexport function useInactiveListener(suppress = false) {\r\n  const injected = getInjectedConnector();\r\n  const { active, error, activate } = useWeb3React();\r\n\r\n  useEffect(() => {\r\n    const { ethereum } = window;\r\n    if (ethereum && ethereum.on && !active && !error && !suppress) {\r\n      const handleConnect = () => {\r\n        activate(injected);\r\n      };\r\n      const handleChainChanged = (chainId) => {\r\n        activate(injected);\r\n      };\r\n      const handleAccountsChanged = (accounts) => {\r\n        if (accounts.length > 0) {\r\n          activate(injected);\r\n        }\r\n      };\r\n      const handleNetworkChanged = (networkId) => {\r\n        activate(injected);\r\n      };\r\n\r\n      ethereum.on(\"connect\", handleConnect);\r\n      ethereum.on(\"chainChanged\", handleChainChanged);\r\n      ethereum.on(\"accountsChanged\", handleAccountsChanged);\r\n      ethereum.on(\"networkChanged\", handleNetworkChanged);\r\n\r\n      return () => {\r\n        if (ethereum.removeListener) {\r\n          ethereum.removeListener(\"connect\", handleConnect);\r\n          ethereum.removeListener(\"chainChanged\", handleChainChanged);\r\n          ethereum.removeListener(\"accountsChanged\", handleAccountsChanged);\r\n          ethereum.removeListener(\"networkChanged\", handleNetworkChanged);\r\n        }\r\n      };\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [active, error, suppress, activate]);\r\n}\r\n\r\nexport function getProvider(library, chainId) {\r\n  let provider;\r\n  if (library) {\r\n    return library.getSigner();\r\n  }\r\n  provider = _.sample(RPC_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function getFallbackProvider(chainId) {\r\n  if (!FALLBACK_PROVIDERS[chainId]) {\r\n    return;\r\n  }\r\n\r\n  const provider = _.sample(FALLBACK_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function bigNumberify(n) {\r\n  try {\r\n    return ethers.BigNumber.from(n);\r\n  } catch (e) {\r\n    console.error(\"bigNumberify error\", e);\r\n    return undefined;\r\n  }\r\n}\r\n\r\nexport function expandDecimals(n, decimals) {\r\n  return bigNumberify(n).mul(bigNumberify(10).pow(decimals));\r\n}\r\n\r\nexport const trimZeroDecimals = (amount) => {\r\n  if (parseFloat(amount) === parseInt(amount)) {\r\n    return parseInt(amount).toString();\r\n  }\r\n  return amount;\r\n};\r\n\r\nexport const limitDecimals = (amount, maxDecimals) => {\r\n  let amountStr = amount.toString();\r\n  \r\n  if (maxDecimals === undefined) {\r\n    return amountStr;\r\n  }\r\n  if (maxDecimals === 0) {\r\n    return amountStr.split(\".\")[0];\r\n  }\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    let decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals > maxDecimals) {\r\n      amountStr = amountStr.substr(0, amountStr.length - (decimals - maxDecimals));\r\n    }\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const padDecimals = (amount, minDecimals) => {\r\n  let amountStr = amount.toString();\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    const decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals < minDecimals) {\r\n      amountStr = amountStr.padEnd(amountStr.length + (minDecimals - decimals), \"0\");\r\n    }\r\n  } else {\r\n    amountStr = amountStr + \".0000\";\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatKeyAmount = (map, key, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!map || !map[key]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(map[key], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nexport const formatArrayAmount = (arr, index, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!arr || !arr[index]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(arr[index], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nfunction _parseOrdersData(ordersData, account, indexes, extractor, uintPropsLength, addressPropsLength) {\r\n  if (!ordersData || ordersData.length === 0) {\r\n    return [];\r\n  }\r\n  const [uintProps, addressProps] = ordersData;\r\n  const count = uintProps.length / uintPropsLength;\r\n\r\n  const orders = [];\r\n  for (let i = 0; i < count; i++) {\r\n    const sliced = addressProps\r\n      .slice(addressPropsLength * i, addressPropsLength * (i + 1))\r\n      .concat(uintProps.slice(uintPropsLength * i, uintPropsLength * (i + 1)));\r\n\r\n    if (sliced[0] === AddressZero && sliced[1] === AddressZero) {\r\n      continue;\r\n    }\r\n\r\n    const order = extractor(sliced);\r\n    order.index = indexes[i];\r\n    order.account = account;\r\n    orders.push(order);\r\n  }\r\n\r\n  return orders;\r\n}\r\n\r\nfunction parseDecreaseOrdersData(chainId, decreaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[4].toString() === \"1\";\r\n    return {\r\n      collateralToken: sliced[0],\r\n      indexToken: sliced[1],\r\n      collateralDelta: sliced[2],\r\n      sizeDelta: sliced[3],\r\n      isLong,\r\n      triggerPrice: sliced[5],\r\n      triggerAboveThreshold: sliced[6].toString() === \"1\",\r\n      type: DECREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(decreaseOrdersData, account, indexes, extractor, 5, 2).filter((order) => {\r\n    return isValidToken(chainId, order.collateralToken) && isValidToken(chainId, order.indexToken);\r\n  });\r\n}\r\n\r\nfunction parseIncreaseOrdersData(chainId, increaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[5].toString() === \"1\";\r\n    return {\r\n      purchaseToken: sliced[0],\r\n      collateralToken: sliced[1],\r\n      indexToken: sliced[2],\r\n      purchaseTokenAmount: sliced[3],\r\n      sizeDelta: sliced[4],\r\n      isLong,\r\n      triggerPrice: sliced[6],\r\n      triggerAboveThreshold: sliced[7].toString() === \"1\",\r\n      type: INCREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(increaseOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return (\r\n      isValidToken(chainId, order.purchaseToken) &&\r\n      isValidToken(chainId, order.collateralToken) &&\r\n      isValidToken(chainId, order.indexToken)\r\n    );\r\n  });\r\n}\r\n\r\nfunction parseSwapOrdersData(chainId, swapOrdersData, account, indexes) {\r\n  if (!swapOrdersData || !swapOrdersData.length) {\r\n    return [];\r\n  }\r\n\r\n  const extractor = (sliced) => {\r\n    const triggerAboveThreshold = sliced[6].toString() === \"1\";\r\n    const shouldUnwrap = sliced[7].toString() === \"1\";\r\n\r\n    return {\r\n      path: [sliced[0], sliced[1], sliced[2]].filter((address) => address !== AddressZero),\r\n      amountIn: sliced[3],\r\n      minOut: sliced[4],\r\n      triggerRatio: sliced[5],\r\n      triggerAboveThreshold,\r\n      type: SWAP,\r\n      shouldUnwrap,\r\n    };\r\n  };\r\n  return _parseOrdersData(swapOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return order.path.every((token) => isValidToken(chainId, token));\r\n  });\r\n}\r\n\r\nexport function getOrderKey(order) {\r\n  return `${order.type}-${order.account}-${order.index}`;\r\n}\r\n\r\nexport function useAccountOrders(flagOrdersEnabled, overrideAccount) {\r\n  const { library, account: connectedAccount } = useWeb3React();\r\n  const active = true; // this is used in Actions.js so set active to always be true\r\n  const account = overrideAccount || connectedAccount;\r\n\r\n  const { chainId } = useChainId();\r\n  const shouldRequest = active && account && flagOrdersEnabled;\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const orderBookReaderAddress = getContract(chainId, \"OrderBookReader\");\r\n  const key = shouldRequest ? [active, chainId, orderBookAddress, account] : false;\r\n  const {\r\n    data: orders = [],\r\n    mutate: updateOrders,\r\n    error: ordersError,\r\n  } = useSWR(key, {\r\n    dedupingInterval: 5000,\r\n    fetcher: async (active, chainId, orderBookAddress, account) => {\r\n      const provider = getProvider(library, chainId);\r\n      const orderBookContract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n      const orderBookReaderContract = new ethers.Contract(orderBookReaderAddress, OrderBookReader.abi, provider);\r\n\r\n      const fetchIndexesFromServer = () => {\r\n        const ordersIndexesUrl = `${getServerBaseUrl(chainId)}/orders_indices?account=${account}`;\r\n        return fetch(ordersIndexesUrl)\r\n          .then(async (res) => {\r\n            const json = await res.json();\r\n            const ret = {};\r\n            for (const key of Object.keys(json)) {\r\n              ret[key.toLowerCase()] = json[key].map((val) => parseInt(val.value)).sort((a, b) => a - b);\r\n            }\r\n\r\n            return ret;\r\n          })\r\n          .catch(() => ({ swap: [], increase: [], decrease: [] }));\r\n      };\r\n\r\n      const fetchLastIndex = async (type) => {\r\n        const method = type.toLowerCase() + \"OrdersIndex\";\r\n        return await orderBookContract[method](account).then((res) => bigNumberify(res._hex).toNumber());\r\n      };\r\n\r\n      const fetchLastIndexes = async () => {\r\n        const [swap, increase, decrease] = await Promise.all([\r\n          fetchLastIndex(\"swap\"),\r\n          fetchLastIndex(\"increase\"),\r\n          fetchLastIndex(\"decrease\"),\r\n        ]);\r\n\r\n        return { swap, increase, decrease };\r\n      };\r\n\r\n      const getRange = (to, from) => {\r\n        const LIMIT = 10;\r\n        const _indexes = [];\r\n        from = from || Math.max(to - LIMIT, 0);\r\n        for (let i = to - 1; i >= from; i--) {\r\n          _indexes.push(i);\r\n        }\r\n        return _indexes;\r\n      };\r\n\r\n      const getIndexes = (knownIndexes, lastIndex) => {\r\n        if (knownIndexes.length === 0) {\r\n          return getRange(lastIndex);\r\n        }\r\n        return [\r\n          ...knownIndexes,\r\n          ...getRange(lastIndex, knownIndexes[knownIndexes.length - 1] + 1).sort((a, b) => b - a),\r\n        ];\r\n      };\r\n\r\n      const getOrders = async (method, knownIndexes, lastIndex, parseFunc) => {\r\n        const indexes = getIndexes(knownIndexes, lastIndex);\r\n        const ordersData = await orderBookReaderContract[method](orderBookAddress, account, indexes);\r\n        const orders = parseFunc(chainId, ordersData, account, indexes);\r\n\r\n        return orders;\r\n      };\r\n\r\n      try {\r\n        const [serverIndexes, lastIndexes] = await Promise.all([fetchIndexesFromServer(), fetchLastIndexes()]);\r\n        const [swapOrders = [], increaseOrders = [], decreaseOrders = []] = await Promise.all([\r\n          getOrders(\"getSwapOrders\", serverIndexes.swap, lastIndexes.swap, parseSwapOrdersData),\r\n          getOrders(\"getIncreaseOrders\", serverIndexes.increase, lastIndexes.increase, parseIncreaseOrdersData),\r\n          getOrders(\"getDecreaseOrders\", serverIndexes.decrease, lastIndexes.decrease, parseDecreaseOrdersData),\r\n        ]);\r\n        return [...swapOrders, ...increaseOrders, ...decreaseOrders];\r\n      } catch (ex) {\r\n        console.error(ex);\r\n      }\r\n    },\r\n  });\r\n\r\n  return [orders, updateOrders, ordersError];\r\n}\r\n\r\nexport const formatAmount = (amount, tokenDecimals, displayDecimals, useCommas, defaultValue) => {\r\n  if (amount === null) {\r\n    return;\r\n  }\r\n  \r\n  if (!defaultValue) {\r\n    defaultValue = \"...\";\r\n  }\r\n  if (amount === undefined || amount.toString().length === 0) {\r\n    return defaultValue;\r\n  }\r\n  if (displayDecimals === undefined) {\r\n    displayDecimals = 4;\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  if (displayDecimals !== 0) {\r\n    amountStr = padDecimals(amountStr, displayDecimals);\r\n  }\r\n  if (useCommas) {\r\n    return numberWithCommas(amountStr);\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatAmountFree = (amount, tokenDecimals, displayDecimals) => {\r\n  if (!amount) {\r\n    return \"...\";\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  return trimZeroDecimals(amountStr);\r\n};\r\n\r\nexport const parseValue = (value, tokenDecimals) => {\r\n  const pValue = parseFloat(value);\r\n  if (isNaN(pValue)) {\r\n    return undefined;\r\n  }\r\n  value = limitDecimals(value, tokenDecimals);\r\n  const amount = ethers.utils.parseUnits(value, tokenDecimals);\r\n  return bigNumberify(amount);\r\n};\r\n\r\nexport function numberWithCommas(x) {\r\n  if (!x) {\r\n    return \"...\";\r\n  }\r\n  var parts = x.toString().split(\".\");\r\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n  return parts.join(\".\");\r\n}\r\n\r\nexport function getExplorerUrl(chainId) {\r\n  if (chainId === 3) {\r\n    return \"https://ropsten.etherscan.io/\";\r\n  } else if (chainId === 42) {\r\n    return \"https://kovan.etherscan.io/\";\r\n  } else if (chainId === MAINNET) {\r\n    return \"https://bscscan.com/\";\r\n  } else if (chainId === TESTNET) {\r\n    return \"https://testnet.bscscan.com/\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://testnet.arbiscan.io/\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://arbiscan.io/\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://snowtrace.io/\";\r\n  }\r\n  return \"https://etherscan.io/\";\r\n}\r\n\r\nexport function getAccountUrl(chainId, account) {\r\n  if (!account) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"address/\" + account;\r\n}\r\n\r\nexport function getTokenUrl(chainId, address) {\r\n  if (!address) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"token/\" + address;\r\n}\r\n\r\nexport function usePrevious(value) {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n\r\nexport function approveTokens({\r\n  setIsApproving,\r\n  library,\r\n  tokenAddress,\r\n  spender,\r\n  chainId,\r\n  onApproveSubmitted,\r\n  getTokenInfo,\r\n  infoTokens,\r\n  pendingTxns,\r\n  setPendingTxns,\r\n  includeMessage,\r\n}) {\r\n  setIsApproving(true);\r\n  const contract = new ethers.Contract(tokenAddress, Token.abi, library.getSigner());\r\n  contract\r\n    .approve(spender, ethers.constants.MaxUint256)\r\n    .then(async (res) => {\r\n      const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\r\n      helperToast.success(\r\n        <div>\r\n          Approval submitted!{\" \"}\r\n          <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n            View status.\r\n          </a>\r\n          <br />\r\n        </div>\r\n      );\r\n      if (onApproveSubmitted) {\r\n        onApproveSubmitted();\r\n      }\r\n      if (getTokenInfo && infoTokens && pendingTxns && setPendingTxns) {\r\n        const token = getTokenInfo(infoTokens, tokenAddress);\r\n        const pendingTxn = {\r\n          hash: res.hash,\r\n          message: includeMessage ? `${token.symbol} Approved!` : false,\r\n        };\r\n        setPendingTxns([...pendingTxns, pendingTxn]);\r\n      }\r\n    })\r\n    .catch((e) => {\r\n      console.error(e);\r\n      let failMsg;\r\n      if (\r\n        [\"not enough funds for gas\", \"failed to execute call with revert code InsufficientGasFunds\"].includes(\r\n          e.data?.message\r\n        )\r\n      ) {\r\n        failMsg = (\r\n          <div>\r\n            There is not enough ETH in your account on Arbitrum to send this transaction.\r\n            <br />\r\n            <br />\r\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              Bridge ETH to Arbitrum\r\n            </a>\r\n          </div>\r\n        );\r\n      } else if (e.message?.includes(\"User denied transaction signature\")) {\r\n        failMsg = \"Approval was cancelled\";\r\n      } else {\r\n        failMsg = \"Approval failed\";\r\n      }\r\n      helperToast.error(failMsg);\r\n    })\r\n    .finally(() => {\r\n      setIsApproving(false);\r\n    });\r\n}\r\n\r\nexport const shouldRaiseGasError = (token, amount) => {\r\n  if (!amount) {\r\n    return false;\r\n  }\r\n  if (token.address !== AddressZero) {\r\n    return false;\r\n  }\r\n  if (!token.balance) {\r\n    return false;\r\n  }\r\n  if (amount.gte(token.balance)) {\r\n    return true;\r\n  }\r\n  if (token.balance.sub(amount).lt(DUST_BNB)) {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getTokenInfo = (infoTokens, tokenAddress, replaceNative, nativeTokenAddress) => {\r\n  if (replaceNative && tokenAddress === nativeTokenAddress) {\r\n    return infoTokens[AddressZero];\r\n  }\r\n  return infoTokens[tokenAddress];\r\n};\r\n\r\nconst NETWORK_METADATA = {\r\n  [MAINNET]: {\r\n    chainId: \"0x\" + MAINNET.toString(16),\r\n    chainName: \"BSC\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: BSC_RPC_PROVIDERS,\r\n    blockExplorerUrls: [\"https://bscscan.com\"],\r\n  },\r\n  [TESTNET]: {\r\n    chainId: \"0x\" + TESTNET.toString(16),\r\n    chainName: \"BSC Testnet\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://data-seed-prebsc-1-s1.binance.org:8545/\"],\r\n    blockExplorerUrls: [\"https://testnet.bscscan.com/\"],\r\n  },\r\n  [ARBITRUM_TESTNET]: {\r\n    chainId: \"0x\" + ARBITRUM_TESTNET.toString(16),\r\n    chainName: \"Arbitrum Testnet\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://rinkeby.arbitrum.io/rpc\"],\r\n    blockExplorerUrls: [\"https://rinkeby-explorer.arbitrum.io/\"],\r\n  },\r\n  [ARBITRUM]: {\r\n    chainId: \"0x\" + ARBITRUM.toString(16),\r\n    chainName: \"Arbitrum\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: ARBITRUM_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM)],\r\n  },\r\n  [AVALANCHE]: {\r\n    chainId: \"0x\" + AVALANCHE.toString(16),\r\n    chainName: \"Avalanche\",\r\n    nativeCurrency: {\r\n      name: \"AVAX\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: AVALANCHE_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(AVALANCHE)],\r\n  },\r\n};\r\n\r\nexport const addBscNetwork = async () => {\r\n  return addNetwork(NETWORK_METADATA[MAINNET]);\r\n};\r\n\r\nexport const addNetwork = async (metadata) => {\r\n  await window.ethereum.request({ method: \"wallet_addEthereumChain\", params: [metadata] }).catch();\r\n};\r\n\r\nexport const switchNetwork = async (chainId, active) => {\r\n  if (!active) {\r\n    // chainId in localStorage allows to switch network even if wallet is not connected\r\n    // or there is no wallet at all\r\n    localStorage.setItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY, chainId);\r\n    document.location.reload();\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const chainIdHex = \"0x\" + chainId.toString(16);\r\n    await window.ethereum.request({\r\n      method: \"wallet_switchEthereumChain\",\r\n      params: [{ chainId: chainIdHex }],\r\n    });\r\n    helperToast.success(\"Connected to \" + getChainName(chainId));\r\n    return getChainName(chainId);\r\n  } catch (ex) {\r\n    // https://docs.metamask.io/guide/rpc-api.html#other-rpc-methods\r\n    // This error code indicates that the chain has not been added to MetaMask.\r\n    // 4001 error means user has denied the request\r\n    // If the error code is not 4001, then we need to add the network\r\n    if (ex.code !== 4001) {\r\n      return await addNetwork(NETWORK_METADATA[chainId]);\r\n    }\r\n\r\n    console.error(\"error\", ex);\r\n  }\r\n};\r\n\r\nexport const getWalletConnectHandler = (activate, deactivate, setActivatingConnector) => {\r\n  const fn = async () => {\r\n    const walletConnect = getWalletConnectConnector();\r\n    setActivatingConnector(walletConnect);\r\n    activate(walletConnect, (ex) => {\r\n      if (ex instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\"Unsupported chain. Switch to Arbitrum network on your wallet and try again\");\r\n        console.warn(ex);\r\n      } else if (!(ex instanceof UserRejectedRequestErrorWalletConnect)) {\r\n        helperToast.error(ex.message);\r\n        console.warn(ex);\r\n      }\r\n      clearWalletConnectData();\r\n      deactivate();\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport const getInjectedHandler = (activate) => {\r\n  const fn = async () => {\r\n    activate(getInjectedConnector(), (e) => {\r\n      const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n\r\n      if (e instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\r\n          <div>\r\n            <div>Your wallet is not connected to {getChainName(chainId)}.</div>\r\n            <br />\r\n            <div className=\"clickable underline margin-bottom\" onClick={() => switchNetwork(chainId, true)}>\r\n              Switch to {getChainName(chainId)}\r\n            </div>\r\n            <div className=\"clickable underline\" onClick={() => switchNetwork(chainId, true)}>\r\n              Add {getChainName(chainId)}\r\n            </div>\r\n          </div>\r\n        );\r\n        return;\r\n      }\r\n      const errString = e.message ?? e.toString();\r\n      helperToast.error(errString);\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport function isMobileDevice(navigator) {\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n}\r\n\r\nexport function setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress) {\r\n  if (!indexPrices) {\r\n    // console.log('return');\r\n    return;\r\n  }\r\n\r\n  // console.log('-------------------WENT THROUGH')\r\n\r\n  const tokenAddress = token.isNative ? nativeTokenAddress : token.address;\r\n\r\n  const indexPrice = indexPrices[tokenAddress];\r\n  if (!indexPrice) {\r\n    return;\r\n  }\r\n\r\n  const indexPriceBn = bigNumberify(indexPrice);\r\n  if (indexPriceBn.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  const spread = token.maxPrice.sub(token.minPrice);\r\n  const spreadBps = spread.mul(BASIS_POINTS_DIVISOR).div(token.maxPrice.add(token.minPrice).div(2));\r\n\r\n  if (spreadBps.gt(MAX_PRICE_DEVIATION_BASIS_POINTS - 50)) {\r\n    // only set one of the values as there will be a spread between the index price and the Chainlink price\r\n    if (indexPriceBn.gt(token.minPrimaryPrice)) {\r\n      token.maxPrice = indexPriceBn;\r\n    } else {\r\n      token.minPrice = indexPriceBn;\r\n    }\r\n    return;\r\n  }\r\n\r\n  const halfSpreadBps = spreadBps.div(2).toNumber();\r\n  token.maxPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR + halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n  token.minPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR - halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n}\r\n\r\nexport function getInfoTokens(\r\n  tokens,\r\n  tokenBalances,\r\n  whitelistedTokens,\r\n  vaultTokenInfo,\r\n  fundingRateInfo,\r\n  vaultPropsLength,\r\n  indexPrices,\r\n  nativeTokenAddress\r\n) {\r\n  if (!vaultPropsLength) {\r\n    vaultPropsLength = 15;\r\n  }\r\n  const fundingRatePropsLength = 2;\r\n  const infoTokens = {};\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(tokens[i]));\r\n    if (tokenBalances) {\r\n      token.balance = tokenBalances[i];\r\n    }\r\n    if (token.address === USDG_ADDRESS) {\r\n      token.minPrice = expandDecimals(1, USD_DECIMALS);\r\n      token.maxPrice = expandDecimals(1, USD_DECIMALS);\r\n    }\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(whitelistedTokens[i]));\r\n    if (vaultTokenInfo) {\r\n      token.poolAmount = vaultTokenInfo[i * vaultPropsLength];\r\n      token.reservedAmount = vaultTokenInfo[i * vaultPropsLength + 1];\r\n      token.availableAmount = token.poolAmount.sub(token.reservedAmount);\r\n      token.usdgAmount = vaultTokenInfo[i * vaultPropsLength + 2];\r\n      token.redemptionAmount = vaultTokenInfo[i * vaultPropsLength + 3];\r\n      token.weight = vaultTokenInfo[i * vaultPropsLength + 4];\r\n      token.bufferAmount = vaultTokenInfo[i * vaultPropsLength + 5];\r\n      token.maxUsdgAmount = vaultTokenInfo[i * vaultPropsLength + 6];\r\n      token.globalShortSize = vaultTokenInfo[i * vaultPropsLength + 7];\r\n      token.maxGlobalShortSize = vaultTokenInfo[i * vaultPropsLength + 8];\r\n      token.maxGlobalLongSize = vaultTokenInfo[i * vaultPropsLength + 9];\r\n      token.minPrice = vaultTokenInfo[i * vaultPropsLength + 10];\r\n      token.maxPrice = vaultTokenInfo[i * vaultPropsLength + 11];\r\n      token.guaranteedUsd = vaultTokenInfo[i * vaultPropsLength + 12];\r\n      token.maxPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 13];\r\n      token.minPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 14];\r\n\r\n      // save minPrice and maxPrice as setTokenUsingIndexPrices may override it\r\n      token.contractMinPrice = token.minPrice;\r\n      token.contractMaxPrice = token.maxPrice;\r\n\r\n      token.maxAvailableShort = bigNumberify(0);\r\n      token.hasMaxAvailableShort = false;\r\n      if (token.maxGlobalShortSize.gt(0)) {\r\n        token.hasMaxAvailableShort = true;\r\n        if (token.maxGlobalShortSize.gt(token.globalShortSize)) {\r\n          token.maxAvailableShort = token.maxGlobalShortSize.sub(token.globalShortSize);\r\n        }\r\n      }\r\n\r\n      if (token.maxUsdgAmount.eq(0)) {\r\n        token.maxUsdgAmount = DEFAULT_MAX_USDG_AMOUNT;\r\n      }\r\n\r\n      token.availableUsd = token.isStable\r\n        ? token.poolAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals))\r\n        : token.availableAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals));\r\n\r\n      token.maxAvailableLong = bigNumberify(0);\r\n      token.hasMaxAvailableLong = false;\r\n      if (token.maxGlobalLongSize.gt(0)) {\r\n        token.hasMaxAvailableLong = true;\r\n\r\n        if (token.maxGlobalLongSize.gt(token.guaranteedUsd)) {\r\n          const remainingLongSize = token.maxGlobalLongSize.sub(token.guaranteedUsd);\r\n          token.maxAvailableLong = remainingLongSize.lt(token.availableUsd) ? remainingLongSize : token.availableUsd;\r\n        }\r\n      } else {\r\n        token.maxAvailableLong = token.availableUsd;\r\n      }\r\n\r\n      token.maxLongCapacity =\r\n        token.maxGlobalLongSize.gt(0) && token.maxGlobalLongSize.lt(token.availableUsd.add(token.guaranteedUsd))\r\n          ? token.maxGlobalLongSize\r\n          : token.availableUsd.add(token.guaranteedUsd);\r\n\r\n      token.managedUsd = token.availableUsd.add(token.guaranteedUsd);\r\n      token.managedAmount = token.managedUsd.mul(expandDecimals(1, token.decimals)).div(token.minPrice);\r\n\r\n      setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress);\r\n    }\r\n\r\n    if (fundingRateInfo) {\r\n      token.fundingRate = fundingRateInfo[i * fundingRatePropsLength];\r\n      token.cumulativeFundingRate = fundingRateInfo[i * fundingRatePropsLength + 1];\r\n    }\r\n\r\n    if (infoTokens[token.address]) {\r\n      token.balance = infoTokens[token.address].balance;\r\n    }\r\n\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  return infoTokens;\r\n}\r\n\r\nexport const CHART_PERIODS = {\r\n  \"5m\": 60 * 5,\r\n  \"15m\": 60 * 15,\r\n  \"1h\": 60 * 60,\r\n  \"4h\": 60 * 60 * 4,\r\n  \"1d\": 60 * 60 * 24,\r\n};\r\n\r\nexport function getTotalVolumeSum(volumes) {\r\n  if (!volumes || volumes.length === 0) {\r\n    return;\r\n  }\r\n\r\n  let volume = bigNumberify(0);\r\n  for (let i = 0; i < volumes.length; i++) {\r\n    volume = volume.add(volumes[i].data.volume);\r\n  }\r\n\r\n  return volume;\r\n}\r\n\r\nexport function getBalanceAndSupplyData(balances) {\r\n  if (!balances || balances.length === 0) {\r\n    return {};\r\n  }\r\n\r\n  const keys = [\"gmx\", \"esGmx\", \"glp\", \"stakedGmxTracker\"];\r\n  const balanceData = {};\r\n  const supplyData = {};\r\n  const propsLength = 2;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    balanceData[key] = balances[i * propsLength];\r\n    supplyData[key] = balances[i * propsLength + 1];\r\n  }\r\n\r\n  return { balanceData, supplyData };\r\n}\r\n\r\nexport function getDepositBalanceData(depositBalances) {\r\n  if (!depositBalances || depositBalances.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\r\n    \"gmxInStakedGmx\",\r\n    \"esGmxInStakedGmx\",\r\n    \"stakedGmxInBonusGmx\",\r\n    \"bonusGmxInFeeGmx\",\r\n    \"bnGmxInFeeGmx\",\r\n    \"glpInStakedGlp\",\r\n  ];\r\n  const data = {};\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = depositBalances[i];\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getVestingData(vestingInfo) {\r\n  if (!vestingInfo || vestingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"gmxVester\", \"glpVester\"];\r\n  const data = {};\r\n  const propsLength = 7;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      pairAmount: vestingInfo[i * propsLength],\r\n      vestedAmount: vestingInfo[i * propsLength + 1],\r\n      escrowedBalance: vestingInfo[i * propsLength + 2],\r\n      claimedAmounts: vestingInfo[i * propsLength + 3],\r\n      claimable: vestingInfo[i * propsLength + 4],\r\n      maxVestableAmount: vestingInfo[i * propsLength + 5],\r\n      averageStakedAmount: vestingInfo[i * propsLength + 6],\r\n    };\r\n\r\n    data[key + \"PairAmount\"] = data[key].pairAmount;\r\n    data[key + \"VestedAmount\"] = data[key].vestedAmount;\r\n    data[key + \"EscrowedBalance\"] = data[key].escrowedBalance;\r\n    data[key + \"ClaimSum\"] = data[key].claimedAmounts.add(data[key].claimable);\r\n    data[key + \"Claimable\"] = data[key].claimable;\r\n    data[key + \"MaxVestableAmount\"] = data[key].maxVestableAmount;\r\n    data[key + \"AverageStakedAmount\"] = data[key].averageStakedAmount;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getStakingData(stakingInfo) {\r\n  if (!stakingInfo || stakingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"stakedGmxTracker\", \"bonusGmxTracker\", \"feeGmxTracker\", \"stakedGlpTracker\", \"feeGlpTracker\"];\r\n  const data = {};\r\n  const propsLength = 5;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      claimable: stakingInfo[i * propsLength],\r\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\r\n      averageStakedAmounts: stakingInfo[i * propsLength + 2],\r\n      cumulativeRewards: stakingInfo[i * propsLength + 3],\r\n      totalSupply: stakingInfo[i * propsLength + 4],\r\n    };\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getProcessedData(\r\n  balanceData,\r\n  supplyData,\r\n  depositBalanceData,\r\n  stakingData,\r\n  vestingData,\r\n  aum,\r\n  nativeTokenPrice,\r\n  stakedGmxSupply,\r\n  gmxPrice,\r\n  gmxSupply\r\n) {\r\n  if (\r\n    !balanceData ||\r\n    !supplyData ||\r\n    !depositBalanceData ||\r\n    !stakingData ||\r\n    !vestingData ||\r\n    !aum ||\r\n    !nativeTokenPrice ||\r\n    !stakedGmxSupply ||\r\n    !gmxPrice ||\r\n    !gmxSupply\r\n  ) {\r\n    return {};\r\n  }\r\n\r\n  const data = {};\r\n\r\n  data.gmxBalance = balanceData.gmx;\r\n  data.gmxBalanceUsd = balanceData.gmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.gmxSupply = bigNumberify(gmxSupply);\r\n\r\n  data.gmxSupplyUsd = data.gmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedGmxSupply = stakedGmxSupply;\r\n  data.stakedGmxSupplyUsd = stakedGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.gmxInStakedGmx = depositBalanceData.gmxInStakedGmx;\r\n  data.gmxInStakedGmxUsd = depositBalanceData.gmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxBalance = balanceData.esGmx;\r\n  data.esGmxBalanceUsd = balanceData.esGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerSupply = supplyData.stakedGmxTracker;\r\n  data.stakedGmxTrackerSupplyUsd = supplyData.stakedGmxTracker.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedEsGmxSupply = data.stakedGmxTrackerSupply.sub(data.stakedGmxSupply);\r\n  data.stakedEsGmxSupplyUsd = data.stakedEsGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxInStakedGmx = depositBalanceData.esGmxInStakedGmx;\r\n  data.esGmxInStakedGmxUsd = depositBalanceData.esGmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bnGmxInFeeGmx = depositBalanceData.bnGmxInFeeGmx;\r\n  data.bonusGmxInFeeGmx = depositBalanceData.bonusGmxInFeeGmx;\r\n  data.feeGmxSupply = stakingData.feeGmxTracker.totalSupply;\r\n  data.feeGmxSupplyUsd = data.feeGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerRewards = stakingData.stakedGmxTracker.claimable;\r\n  data.stakedGmxTrackerRewardsUsd = stakingData.stakedGmxTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bonusGmxTrackerRewards = stakingData.bonusGmxTracker.claimable;\r\n\r\n  data.feeGmxTrackerRewards = stakingData.feeGmxTracker.claimable;\r\n  data.feeGmxTrackerRewardsUsd = stakingData.feeGmxTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.boostBasisPoints = bigNumberify(0);\r\n  if (data && data.bnGmxInFeeGmx && data.bonusGmxInFeeGmx && data.bonusGmxInFeeGmx.gt(0)) {\r\n    data.boostBasisPoints = data.bnGmxInFeeGmx.mul(BASIS_POINTS_DIVISOR).div(data.bonusGmxInFeeGmx);\r\n  }\r\n\r\n  data.stakedGmxTrackerAnnualRewardsUsd = stakingData.stakedGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForEsGmx =\r\n    data.stakedGmxTrackerSupplyUsd && data.stakedGmxTrackerSupplyUsd.gt(0)\r\n      ? data.stakedGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.stakedGmxTrackerSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGmxTrackerAnnualRewardsUsd = stakingData.feeGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForNativeToken =\r\n    data.feeGmxSupplyUsd && data.feeGmxSupplyUsd.gt(0)\r\n      ? data.feeGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.feeGmxSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.gmxBoostAprForNativeToken = data.gmxAprForNativeToken.mul(data.boostBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n  data.gmxAprTotal = data.gmxAprForNativeToken.add(data.gmxAprForEsGmx);\r\n  data.gmxAprTotalWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken).add(data.gmxAprForEsGmx);\r\n  data.gmxAprForNativeTokenWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken);\r\n\r\n  data.totalGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.feeGmxTrackerRewardsUsd);\r\n\r\n  data.glpSupply = supplyData.glp;\r\n  data.glpPrice =\r\n    data.glpSupply && data.glpSupply.gt(0)\r\n      ? aum.mul(expandDecimals(1, GLP_DECIMALS)).div(data.glpSupply)\r\n      : bigNumberify(0);\r\n\r\n  data.glpSupplyUsd = supplyData.glp.mul(data.glpPrice).div(expandDecimals(1, 18));\r\n\r\n  data.glpBalance = depositBalanceData.glpInStakedGlp;\r\n  data.glpBalanceUsd = depositBalanceData.glpInStakedGlp.mul(data.glpPrice).div(expandDecimals(1, GLP_DECIMALS));\r\n\r\n  data.stakedGlpTrackerRewards = stakingData.stakedGlpTracker.claimable;\r\n  data.stakedGlpTrackerRewardsUsd = stakingData.stakedGlpTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.feeGlpTrackerRewards = stakingData.feeGlpTracker.claimable;\r\n  data.feeGlpTrackerRewardsUsd = stakingData.feeGlpTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGlpTrackerAnnualRewardsUsd = stakingData.stakedGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForEsGmx =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.stakedGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGlpTrackerAnnualRewardsUsd = stakingData.feeGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForNativeToken =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.feeGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.glpAprTotal = data.glpAprForNativeToken.add(data.glpAprForEsGmx);\r\n\r\n  data.totalGlpRewardsUsd = data.stakedGlpTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalEsGmxRewards = data.stakedGmxTrackerRewards.add(data.stakedGlpTrackerRewards);\r\n  data.totalEsGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.stakedGlpTrackerRewardsUsd);\r\n\r\n  data.gmxVesterRewards = vestingData.gmxVester.claimable;\r\n  data.glpVesterRewards = vestingData.glpVester.claimable;\r\n  data.totalVesterRewards = data.gmxVesterRewards.add(data.glpVesterRewards);\r\n  data.totalVesterRewardsUsd = data.totalVesterRewards.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.totalNativeTokenRewards = data.feeGmxTrackerRewards.add(data.feeGlpTrackerRewards);\r\n  data.totalNativeTokenRewardsUsd = data.feeGmxTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalRewardsUsd = data.totalEsGmxRewardsUsd.add(data.totalNativeTokenRewardsUsd).add(data.totalVesterRewardsUsd);\r\n\r\n  return data;\r\n}\r\n\r\nexport async function addTokenToMetamask(token) {\r\n  try {\r\n    const wasAdded = await window.ethereum.request({\r\n      method: \"wallet_watchAsset\",\r\n      params: {\r\n        type: \"ERC20\",\r\n        options: {\r\n          address: token.address,\r\n          symbol: token.symbol,\r\n          decimals: token.decimals,\r\n          image: token.imageUrl,\r\n        },\r\n      },\r\n    });\r\n    if (wasAdded) {\r\n      // https://github.com/MetaMask/metamask-extension/issues/11377\r\n      // We can show a toast message when the token is added to metamask but because of the bug we can't. Once the bug is fixed we can show a toast message.\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nexport function sleep(ms) {\r\n  return new Promise((resolve) => resolve(), ms);\r\n}\r\n\r\nexport function getPageTitle(data) {\r\n  return `${data} | DeDeLend`;\r\n}\r\n\r\nexport function isHashZero(value) {\r\n  return value === ethers.constants.HashZero;\r\n}\r\nexport function isAddressZero(value) {\r\n  return value === ethers.constants.AddressZero;\r\n}\r\n\r\nexport function useDebounce(value, delay) {\r\n  // State and setters for debounced value\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n  useEffect(\r\n    () => {\r\n      // Update debounced value after delay\r\n      const handler = setTimeout(() => {\r\n        setDebouncedValue(value);\r\n      }, delay);\r\n      // Cancel the timeout if value changes (also on delay change or unmount)\r\n      // This is how we prevent debounced value from updating if value is changed ...\r\n      // .. within the delay period. Timeout gets cleared and restarted.\r\n      return () => {\r\n        clearTimeout(handler);\r\n      };\r\n    },\r\n    [value, delay] // Only re-call effect if value or delay changes\r\n  );\r\n  return debouncedValue;\r\n}\r\n\r\nexport function isDevelopment() {\r\n  return !window.location.host?.includes(\"gmx.io\") && !window.location.host?.includes(\"ipfs.io\");\r\n}\r\n\r\nexport function isLocal() {\r\n  return window.location.host?.includes(\"localhost\");\r\n}\r\n\r\nexport function getHomeUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3010\";\r\n  }\r\n\r\n  return \"https://gmx.io\";\r\n}\r\n\r\nexport function getAppBaseUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#\";\r\n}\r\n\r\nexport function getRootShareApiUrl() {\r\n  if (isLocal()) {\r\n    return \"https://gmxs.vercel.app\";\r\n  }\r\n\r\n  return \"https://share.gmx.io\";\r\n}\r\n\r\nexport function getTradePageUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#/trade\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#/trade\";\r\n}\r\n\r\nexport function importImage(name) {\r\n  let tokenImage = null;\r\n  try {\r\n    tokenImage = require(\"../img/\" + name);\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n  return tokenImage && tokenImage.default;\r\n}\r\n\r\nexport function getTwitterIntentURL(text, url = \"\", hashtag = \"\") {\r\n  let finalURL = \"https://twitter.com/intent/tweet?text=\";\r\n  if (text.length > 0) {\r\n    finalURL += encodeURIComponent(text.replace(/[\\r\\n]+/g, \" \"))\r\n      .replace(/\\*%7C/g, \"*|URL:\")\r\n      .replace(/%7C\\*/g, \"|*\");\r\n\r\n    if (hashtag.length > 0) {\r\n      finalURL += \"&hashtags=\" + encodeURIComponent(hashtag.replace(/#/g, \"\"));\r\n    }\r\n    if (url.length > 0) {\r\n      finalURL += \"&url=\" + encodeURIComponent(url);\r\n    }\r\n  }\r\n  return finalURL;\r\n}\r\n\r\nexport function isValidTimestamp(timestamp) {\r\n  return new Date(timestamp).getTime() > 0;\r\n}\r\n\r\nexport function getPositionForOrder(account, order, positionsMap) {\r\n  const key = getPositionKey(account, order.collateralToken, order.indexToken, order.isLong);\r\n  const position = positionsMap[key];\r\n  return position && position.size && position.size.gt(0) ? position : null;\r\n}\r\n\r\nexport function getOrderError(account, order, positionsMap, position) {\r\n  if (order.type !== DECREASE) {\r\n    return;\r\n  }\r\n\r\n  const positionForOrder = position ? position : getPositionForOrder(account, order, positionsMap);\r\n\r\n  if (!positionForOrder) {\r\n    return \"No open position, order cannot be executed unless a position is opened\";\r\n  }\r\n  if (positionForOrder.size.lt(order.sizeDelta)) {\r\n    return \"Order size is bigger than position, will only be executable if position increases\";\r\n  }\r\n\r\n  if (positionForOrder.size.gt(order.sizeDelta)) {\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(positionForOrder.collateral.sub(order.collateralDelta))) {\r\n      return \"Order cannot be executed as it would reduce the position's leverage below 1\";\r\n    }\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(expandDecimals(5, USD_DECIMALS))) {\r\n      return \"Order cannot be executed as the remaining position would be smaller than $5.00\";\r\n    }\r\n  }\r\n}\r\n\r\nexport function arrayURLFetcher(...urlArr) {\r\n  const fetcher = (url) => fetch(url).then((res) => res.json());\r\n  return Promise.all(urlArr.map(fetcher));\r\n}\r\n\r\nexport function shouldShowRedirectModal(timestamp) {\r\n  const thirtyDays = 1000 * 60 * 60 * 24 * 30;\r\n  const expiryTime = timestamp + thirtyDays;\r\n  return !isValidTimestamp(timestamp) || Date.now() > expiryTime;\r\n}\r\n","import { getExplorerUrl, helperToast } from './../../views/gmx-test/lib/legacy';\r\n\r\n\r\nexport const notifySuccess = (text, hash) => {\r\n\tconst url = getExplorerUrl(42161) + \"tx/\" + hash;\r\n\t\r\n\thelperToast.success(\r\n\t\t<div>\r\n\t\t\t{text}\r\n\t\t\t<br />\r\n\t\t\t{hash &&\r\n\t\t\t\t<a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\r\n\t\t\t\t\tView on Arbiscan\r\n\t\t\t\t</a>}\r\n\t\t\t<br />\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport const errAlert = (err, setIsLoading) => {\r\n\tconst msg = err.reason ?? err.message;\r\n\t\r\n\tconsole.log(err);\r\n\t// alert(`Error code: ${err.code}\\nError message: ${msg}\\n\\nCheck the console for details.`)\r\n\thelperToast.error(\r\n\t\t<div>\r\n\t\t\tError: {err.code}\r\n\t\t\t<br />\r\n\t\t\t{msg}\r\n\t\t\t<br /><br />\r\n\t\t\tCheck the console for details.\r\n\t\t</div>\r\n\t)\r\n\r\n\tif (setIsLoading) {\r\n\t\tsetIsLoading(false);\r\n\t}\r\n}","export const HOMEPAGE_HREF = \"/perpetuals\";\r\n\r\nexport const BORDER_COEF = 0.01;\r\nexport const APY = '10.00%';","import React, {useContext, useState, useEffect} from 'react';\r\nimport Modal from './Modal';\r\nimport { GlobalStatsContext } from './../../../context/context';\r\nimport Form from './../../Form';\r\nimport { OptManager, DDL_GMX, DDL_AccountManagerToken } from './../../utils/contracts';\r\nimport Loader from './../loader/Loader';\r\nimport { floor, formatForContract } from './../../utils/math';\r\nimport { sepToNumber, separateThousands } from './../../utils/sepThousands';\r\nimport { errAlert } from '../../utils/notifications';\r\nimport { USD_DECIMALS } from './../../../views/gmx-test/lib/legacy';\r\nimport { notifySuccess } from './../../utils/notifications';\r\nimport { APY, BORDER_COEF } from './../../utils/constants';\r\n\r\nconst BorrowModal = (props) => {\r\n\tconst {\r\n\t\tstate, \r\n\t\tsetVisible, \r\n\t\tisLoading, \r\n\t\tsetIsLoading,\r\n\t\tupdateOptionStats,\r\n\t} = props;\r\n\t\r\n\tconst option = state.option;\r\n\tconst contract = option?.contract;\r\n\tconst position = state.position;\r\n\r\n\t\r\n\tconst {globalStats} = useContext(GlobalStatsContext);\r\n\tconst [step, setStep] = [state.step ?? 0, state.setStep];\r\n\tconst [inputVal, setInputVal] = useState('');\r\n\tconst [liqPrice, setLiqPrice] = useState(null);\r\n\tconst [oldLiqPrice, setOldLiqPrice] = useState(null);\r\n\tconst [positionStats, setPositionStats] = useState({});\r\n\tconst [borrowLimit, setBorrowLimit] = useState(null);\r\n\tconst [borrowed, setBorrowed] = useState(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (position) {\r\n\t\t\tif (!Object.keys(position).length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tDDL_GMX.borrowedByCollateral(position.ddl.keyId)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tsetBorrowed(res.borrowed / 10**6);\r\n\t\t\t\t})\r\n\r\n\t\t\tDDL_GMX.maxBorrowLimit(position.ddl.keyId)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tsetBorrowLimit(res / 10**6);\r\n\t\t\t\t})\r\n\t\t}\r\n\t}, [state, isLoading, state.position]);\r\n\t\r\n\r\n\tuseEffect(() => {\r\n\t\tlet curInputVal = inputVal;\r\n\t\tif (sepToNumber(inputVal) > 0 && sepToNumber(inputVal) > (option ? available : positionStats.available)) {\r\n\t\t\tcurInputVal = option ? available : positionStats.available;\r\n\t\t\tsetInputVal(curInputVal);\r\n\t\t}\r\n\r\n\t\tif (option) {\r\n\t\t\tif (typeof option !== 'object' || !Object.keys(option).length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet classic, result;\r\n\t\t\tconst prior = option.priorLiqPrice;\r\n\t\t\tconst val = sepToNumber(inputVal);\r\n\t\r\n\t\t\tconst isCALL = option.name.includes('CALL')\r\n\t\r\n\t\t\tif (isCALL) {\r\n\t\t\t\tclassic = option.strike + (((option.borrowLimitUsed + val) / option.amount) * 1.2)\r\n\t\t\t\t\r\n\t\t\t\tresult = Math.max(prior, classic);\r\n\t\t\t} else {\r\n\t\t\t\tclassic = option.strike - (((option.borrowLimitUsed + val) / option.amount) * 1.2)\r\n\t\r\n\t\t\t\tresult = Math.min(prior, classic);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsetLiqPrice(floor(result))\r\n\t\t} else if (position) {\r\n\t\t\tif (!Object.keys(position).length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (borrowLimit === null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst positionProfit = (position.delta / 10**USD_DECIMALS);\r\n\t\t\t// const borrowLimit = position.hasProfit ? (positionProfit / 2) : 0;\r\n\t\t\tconst available = Math.max(borrowLimit - borrowed, 0);\r\n\r\n\t\t\t// Loan-To-Value\r\n\t\t\tconst input = sepToNumber(curInputVal ?? 0);\r\n\t\t\tconst loanToValue = borrowLimit !== 0 ? ((borrowed + input) / positionProfit) : 0;\r\n\r\n\t\t\t// Liq.Price\r\n\t\t\tlet liqPrice;\r\n\t\t\tlet oldLiqPrice;\r\n\t\t\tconst size = position.size / 10**30;\r\n\t\t\tconst entryPrice = position.averagePrice / 10**30;\r\n\t\t\tconst amount = size / entryPrice;\r\n\t\t\tif (position.isLong) {\r\n\t\t\t\tliqPrice = entryPrice + (((borrowed + input) / amount) * 1.2);\r\n\t\t\t\toldLiqPrice = entryPrice + ((borrowed / amount) * 1.2);\r\n\t\t\t} else {\r\n\t\t\t\tliqPrice = entryPrice - (((borrowed + input) / amount) * 1.2);\r\n\t\t\t\toldLiqPrice = entryPrice - ((borrowed / amount) * 1.2);\r\n\t\t\t}\r\n\r\n\t\t\tif (!isFinite(liqPrice) || isNaN(liqPrice)) {\r\n\t\t\t\tsetLiqPrice(null);\r\n\t\t\t\tsetOldLiqPrice(null);\r\n\t\t\t} else {\r\n\t\t\t\tsetLiqPrice(liqPrice);\r\n\t\t\t\tsetOldLiqPrice(oldLiqPrice);\r\n\t\t\t}\r\n\r\n\t\t\tsetPositionStats({\r\n\t\t\t\tavailable,\r\n\t\t\t\tloanToValue: Math.min(loanToValue, 1),\r\n\t\t\t});\r\n\t\t}\r\n\t}, [state, borrowed, borrowLimit, inputVal, state.position]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof liqPrice !== 'number') {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst borderCoef = BORDER_COEF;\r\n\t\tconst multiplier = position.isLong ? 1 + borderCoef : 1 - borderCoef;\r\n\t\tconst entryPrice = position.averagePrice / 10**30;\r\n\t\tconst borderPrice = entryPrice * multiplier;\r\n\t\tconst result = position.isLong ? Math.max(liqPrice, borderPrice) : Math.min(liqPrice, borderPrice)\r\n\t\tsetLiqPrice(result);\r\n\t}, [liqPrice])\r\n\r\n\tlet available;\r\n\tif (option) {\r\n\t\tavailable = floor(option.realVals?.borrowLimit - option.realVals?.borrowLimitUsed, 6);\r\n\t}\r\n\r\n\tconst setMaxVal = () => {\r\n\t\tsetInputVal(option ? available : positionStats.available);\r\n\t}\r\n\r\n\tconst steps = [\r\n\t\t{\r\n\t\t\ttitle: \"Approve\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsetIsLoading(true);\r\n\t\t\t\t\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tOptManager.approve(contract.address, option.id)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Approve transaction:', res);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tsetStep(step + 1);\r\n\t\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t} else if (position) {\r\n\t\t\t\t\t// setStep(step + 1);\r\n\t\t\t\t\t// setIsLoading(false);\r\n\r\n\t\t\t\t\tDDL_AccountManagerToken.approve(DDL_GMX.address, position.ddl.keyId)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Approve transaction:', res);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tsetStep(step + 1);\r\n\t\t\t\t\t\t\t\t\tsetIsLoading(false);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true,\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Lock Collateral\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsetIsLoading(true);\r\n\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tcontract.lockOption(option.id)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Lock Collateral transaction:', res);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tsetStep(step + 1);\r\n\t\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t} else if (position) {\r\n\t\t\t\t\tDDL_GMX.lockCollateral(position.ddl.keyId)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Lock Collateral transaction:', res);\r\n\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tsetStep(step + 1);\r\n\t\t\t\t\t\t\t\t\tsetIsLoading(false);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true,\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Borrow\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\tsetIsLoading(true);\r\n\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tcontract.borrow(option.id, formatForContract(inputVal))\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Borrow transaction:', res);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t} else if (position) {\r\n\t\t\t\t\tDDL_GMX.borrow(position.ddl.keyId, formatForContract(inputVal))\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Borrow transaction:', res);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tnotifySuccess(`Borrowed ${sepToNumber(inputVal).toFixed(2)} USDC`, res.hash);\r\n\t\t\t\t\t\t\t\t\tsetInputVal('');\r\n\t\t\t\t\t\t\t\t\tsetIsLoading(false);\r\n\t\t\t\t\t\t\t\t\tsetVisible(false);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: false,\r\n\t\t\t\tstate: {\r\n\t\t\t\t\tval: inputVal,\r\n\t\t\t\t\tsetVal: setInputVal\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\r\n\tlet tipText = '';\r\n\tif (option) {\r\n\t\ttipText = 'You have 30 minutes before the option expires to get your option back. 30 minutes before the expiration date DeDeLend will exercise this option and take 100% of the payoff from the option.';\r\n\t} else if (position && step === 2 && borrowed <= 0) {\r\n\t\ttipText = \"In case of liquidation, the position collateral and profits will be converted into USDC.\";\r\n\t}\r\n\r\n\treturn (\r\n\t\t<Modal className={'modal_borrow'} visible={state.isVisible} setVisible={setVisible}>\r\n\t\t\t<h1 className='modal__title'>Borrow USDC</h1>\r\n\t\t\t<div className=\"modal__body\">\r\n\t\t\t\t<div className=\"modal__steps steps\">\r\n\t\t\t\t\t{steps.map((el, i) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div className={i === step ? 'modal__step step current' : 'modal__step step'} key={i}>\r\n\t\t\t\t\t\t\t\t{el.title}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__info\">\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow APR:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{APY}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow Limit:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{(option ? separateThousands(option.borrowLimit) : separateThousands(borrowLimit?.toFixed(2))) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title nowrap\">Loan-To-Value:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">\r\n\t\t\t\t\t\t\t{(option ? floor((option.borrowLimitUsed / option.intrinsicValue) * 100) : (positionStats.loanToValue * 100).toFixed(2)) + '%'}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Available:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val highlighted\">{separateThousands(option ? floor(available) : positionStats.available?.toFixed(2)) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstep === 2 ?\r\n\t\t\t\t\t\t\t<div className=\"modal__info-field modal__info-field_hl\">\r\n\t\t\t\t\t\t\t\t<div className=\"modal__info-field-title\">Liquidation Price:</div>\r\n\t\t\t\t\t\t\t\t<div className=\"modal__info-field-val modal__info-field-val_complex\">\r\n\t\t\t\t\t\t\t\t\t{((oldLiqPrice !== null) && (oldLiqPrice !== liqPrice) \r\n\t\t\t\t\t\t\t\t\t? \r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<span className={'val_minor' + (borrowed <= 0 ? \" icon-infinity\" : \"\")}>\r\n\t\t\t\t\t\t\t\t\t\t\t{borrowed <= 0 ? \"\" : `$${separateThousands(oldLiqPrice?.toFixed(2))}`}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t<span className='icon_arrow' />\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t: '')}\r\n\t\t\t\t\t\t\t\t\t{liqPrice !== null ? `$${separateThousands(liqPrice?.toFixed(2))}` : ''}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__form-wrapper\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading ?\r\n\t\t\t\t\t\t\t<Loader />\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<Form maxVal={option ? available : position.ddl?.available} inputProps={steps[step].inputProps} btnText={steps[step].title} onSubmit={steps[step].onSubmit}\r\n\t\t\t\t\t\t\tmodalVisible={state.isVisible}\r\n\t\t\t\t\t\t\tbtnIsActive={steps[step].btnIsActive}\r\n\t\t\t\t\t\t\tmaxWarningMsg={'Limit is exceed'}\r\n\t\t\t\t\t\t\tisModal={true}\r\n\t\t\t\t\t\t\tmaxOnClick={setMaxVal}></Form>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{tipText && (\r\n\t\t\t\t<div className=\"modal__tip\">\r\n\t\t\t\t\t{tipText}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default BorrowModal;","import React, {useContext, useState, useEffect} from 'react';\r\nimport Modal from './Modal';\r\nimport { GlobalStatsContext } from './../../../context/context';\r\nimport Form from './../../Form';\r\nimport { USDC_signed, DDL_GMX } from '../../utils/contracts';\r\nimport Loader from './../loader/Loader';\r\nimport { sepToNumber, separateThousands } from './../../utils/sepThousands';\r\nimport { floor, formatForContract } from './../../utils/math';\r\nimport { errAlert } from '../../utils/notifications';\r\nimport { ethers } from \"ethers\";\r\nimport { formatAmount, USD_DECIMALS } from './../../../views/gmx-test/lib/legacy';\r\nimport { notifySuccess } from './../../utils/notifications';\r\nimport { APY, BORDER_COEF } from './../../utils/constants';\r\n\r\n\r\nconst RepayModal = (props) => {\r\n\tconst {\r\n\t\tstate, \r\n\t\tsetVisible, \r\n\t\tupdateOptionStats, \r\n\t\tisLoading, \r\n\t\tsetIsLoading,\r\n\t} = props;\r\n\r\n\tconst option = state.option;\r\n\tconst contract = option?.contract;\r\n\tconst position = state.position;\r\n\r\n\tconst {globalStats} = useContext(GlobalStatsContext)\r\n\tconst [inputVal, setInputVal] = useState('');\r\n\tconst [liqPrice, setLiqPrice] = useState(null);\r\n\tconst [oldLiqPrice, setOldLiqPrice] = useState(null);\r\n\tconst [step, setStep] = [state.step ?? 0, state.setStep];\r\n\tconst [positionStats, setPositionStats] = useState({});\r\n\tconst [borrowed, setBorrowed] = useState(null);\r\n\tconst [repay, setRepay] = useState(null);\r\n\tconst [borrowLimit, setBorrowLimit] = useState(null);\r\n\t\r\n\tuseEffect(() => {\r\n\t\tif (position) {\r\n\t\t\tif (!Object.keys(position).length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tDDL_GMX.borrowedByCollateral(position.ddl.keyId)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tconst borrowed = res.borrowed / 10**6;\r\n\t\t\t\t\tDDL_GMX.calculateUpcomingFee(position.ddl.keyId)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconst fee = res / 10**6;\r\n\t\t\t\t\t\t\tsetRepay(borrowed + fee);\r\n\t\t\t\t\t\t\tsetBorrowed(borrowed);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t})\r\n\r\n\t\t\tDDL_GMX.maxBorrowLimit(position.ddl.keyId)\r\n\t\t\t\t.then(res => {\r\n\t\t\t\t\tsetBorrowLimit(res / 10**6);\r\n\t\t\t\t})\r\n\t\t}\r\n\t}, [state, isLoading, state.position]);\r\n\r\n\tuseEffect(() => {\r\n\t\tlet curInputVal = inputVal;\r\n\t\tif (sepToNumber(inputVal) > 0 && sepToNumber(inputVal) > repay) {\r\n\t\t\tcurInputVal = repay;\r\n\t\t\tsetInputVal(curInputVal);\r\n\t\t}\r\n\r\n\t\tif (option) {\r\n\t\t\tif (typeof option !== 'object' || !Object.keys(option).length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tlet classic, result;\r\n\t\t\tconst prior = option.priorLiqPrice;\r\n\t\t\tconst val = sepToNumber(inputVal)\r\n\t\r\n\t\t\tconst isCALL = option.name.includes('CALL')\r\n\t\r\n\t\t\tif (isCALL) {\r\n\t\t\t\tclassic = option.strike + (((option.borrowLimitUsed - val) / option.amount) * 1.2)\r\n\t\t\t\t\r\n\t\t\t\tresult = Math.max(prior, classic);\r\n\t\t\t} else {\r\n\t\t\t\tclassic = option.strike - (((option.borrowLimitUsed - val) / option.amount) * 1.2)\r\n\t\r\n\t\t\t\tresult = Math.min(prior, classic);\r\n\t\t\t}\r\n\t\r\n\t\t\tif (result === prior && sepToNumber(inputVal) >= repay) {\r\n\t\t\t\tsetLiqPrice('')\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\tsetLiqPrice(floor(result))\r\n\t\t} else if (position) {\r\n\t\t\tif (!Object.keys(position).length) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (borrowLimit === null) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst positionProfit = (position.delta / 10**USD_DECIMALS);\r\n\t\t\t// const borrowLimit = position.hasProfit ? (positionProfit / 2) : 0;\r\n\r\n\t\t\t// Loan-To-Value\r\n\t\t\tconst input = sepToNumber(curInputVal ?? 0);\r\n\t\t\tconst loanToValue = borrowLimit !== 0 ? ((borrowed - input) / positionProfit) : 0;\r\n\r\n\t\t\t// Liq.Price\r\n\t\t\tlet liqPrice;\r\n\t\t\tlet oldLiqPrice;\r\n\t\t\tconst size = position.size / 10**USD_DECIMALS;\r\n\t\t\tconst entryPrice = position.averagePrice / 10**USD_DECIMALS;\r\n\t\t\tconst amount = size / entryPrice;\r\n\t\t\tif (position.isLong) {\r\n\t\t\t\tliqPrice = entryPrice + (((borrowed - input) / amount) * 1.2);\r\n\t\t\t\toldLiqPrice = entryPrice + ((borrowed / amount) * 1.2);\r\n\t\t\t} else {\r\n\t\t\t\tliqPrice = entryPrice - (((borrowed - input) / amount) * 1.2);\r\n\t\t\t\toldLiqPrice = entryPrice - ((borrowed / amount) * 1.2);\r\n\t\t\t}\r\n\t\t\tif (isNaN(liqPrice)) {\r\n\t\t\t\tsetLiqPrice(null);\r\n\t\t\t\tsetOldLiqPrice(null);\r\n\t\t\t} else {\r\n\t\t\t\tif (input >= borrowed) {\r\n\t\t\t\t\tsetLiqPrice(Infinity);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetLiqPrice(liqPrice);\r\n\t\t\t\t}\r\n\t\t\t\tsetOldLiqPrice(oldLiqPrice);\r\n\t\t\t}\r\n\r\n\t\t\tsetPositionStats({\r\n\t\t\t\tloanToValue: Math.min(loanToValue, 1),\r\n\t\t\t});\r\n\t\t}\r\n\t}, [state, borrowed, inputVal, state.position]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof liqPrice !== 'number' || !isFinite(liqPrice)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst borderCoef = BORDER_COEF;\r\n\t\tconst multiplier = position.isLong ? 1 + borderCoef : 1 - borderCoef;\r\n\t\tconst entryPrice = position.averagePrice / 10**30;\r\n\t\tconst borderPrice = entryPrice * multiplier;\r\n\t\tconst result = position.isLong ? Math.max(liqPrice, borderPrice) : Math.min(liqPrice, borderPrice)\r\n\t\tsetLiqPrice(result);\r\n\t}, [liqPrice])\r\n\t\r\n\tif (option) {\r\n\t\tsetRepay(option.realVals?.borrowLimitUsed);\r\n\t}\r\n\r\n\tconst setMaxVal = () => {\r\n\t\tsetInputVal(repay)\r\n\t}\r\n\t\r\n\r\n\tconst steps = [\r\n\t\t{\r\n\t\t\ttitle: \"Repay\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\t\r\n\t\t\t\tsetIsLoading(true);\r\n\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tcontract.repay(option.id, formatForContract(inputVal))\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Repay transaction:', res);\r\n\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tsetInputVal('');\r\n\t\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\tconsole.log(err);\r\n\r\n\t\t\t\t\t\t\tif (err.message.includes('transfer amount exceeds allowance')) {\r\n\t\t\t\t\t\t\t\tUSDC_signed.approve(contract.address, ethers.constants.MaxUint256)\r\n\t\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\t\tcontract.repay(option.id, formatForContract(inputVal))\r\n\t\t\t\t\t\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}, err => {\r\n\t\t\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t} else if (position) {\r\n\t\t\t\t\tconst proceedRepay = () => {\r\n\t\t\t\t\t\tDDL_GMX.repay(position.ddl.keyId, formatForContract(inputVal))\r\n\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\tconsole.log('Repay transaction:', res);\r\n\r\n\t\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\tnotifySuccess(`Repayed ${sepToNumber(inputVal).toFixed(2)} USDC`, res.hash);\r\n\t\t\t\t\t\t\t\t\t\tsetInputVal('');\r\n\t\t\t\t\t\t\t\t\t\tsetIsLoading(false);\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (err.message.includes('transfer amount exceeds allowance')) {\r\n\t\t\t\t\t\t\t\t\tapproveUSDC();\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\terrAlert(err);\r\n\t\t\t\t\t\t\t\t\tsetIsLoading(false);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst approveUSDC = () => {\r\n\t\t\t\t\t\tUSDC_signed.approve(DDL_GMX.address, ethers.constants.MaxUint256)\r\n\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\tproceedRepay();\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}, err => {\r\n\t\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tproceedRepay();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: false,\r\n\t\t\t\tstate: {\r\n\t\t\t\t\tval: inputVal,\r\n\t\t\t\t\tsetVal: setInputVal\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbtnIsActive: false\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Unlock Collateral\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\tsetIsLoading(true);\r\n\r\n\t\t\t\tif (option) {\r\n\t\t\t\t\tcontract.unlock(option.id)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Unlock transaction:', res);\r\n\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH, false)\r\n\t\t\t\t\t\t\t\t\tsetVisible(false)\r\n\t\t\t\t\t\t\t\t\tsetStep(0)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t} else if (position) {\r\n\t\t\t\t\tDDL_GMX.unlock(position.ddl.keyId)\r\n\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\tconsole.log('Unlock transaction:', res);\r\n\r\n\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\tsetVisible(false);\r\n\t\t\t\t\t\t\t\t\tsetStep(0);\r\n\t\t\t\t\t\t\t\t\tsetIsLoading(false);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true\r\n\t\t}\r\n\t]\r\n\r\n\r\n\treturn (\r\n\t\t<Modal className={'modal_borrow'} visible={state.isVisible} setVisible={setVisible}>\r\n\t\t\t<h1 className='modal__title'>Repay USDC</h1>\r\n\t\t\t<div className=\"modal__body\">\r\n\t\t\t\t<div className=\"modal__steps steps\">\r\n\t\t\t\t\t{steps.map((el, i) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div className={i === step ? 'modal__step step current' : 'modal__step step'} key={i}>\r\n\t\t\t\t\t\t\t\t{el.title}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__info\">\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow APR:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{APY}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow Limit:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{(option ? separateThousands(option.borrowLimit) : separateThousands(borrowLimit?.toFixed(2))) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title nowrap\">Loan-To-Value:</div>\r\n\t\t\t\t\t\t\t<div className=\"modal__info-field-val\">\r\n\t\t\t\t\t\t\t\t{(option ? floor((option.borrowLimitUsed / option.intrinsicValue) * 100) : floor((positionStats.loanToValue) * 100)) + '%'}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Repay:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val highlighted\">{separateThousands(option ? repay : repay?.toFixed(2)) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstep === 0 ?\r\n\t\t\t\t\t\t\t<div className=\"modal__info-field modal__info-field_hl\">\r\n\t\t\t\t\t\t\t\t<div className=\"modal__info-field-title\">Liquidation Price:</div>\r\n\t\t\t\t\t\t\t\t<div className={\"modal__info-field-val modal__info-field-val_complex\"}>\r\n\t\t\t\t\t\t\t\t\t{((oldLiqPrice !== null) && (oldLiqPrice !== liqPrice) \r\n\t\t\t\t\t\t\t\t\t? \r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className='val_minor'>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{`$${separateThousands(oldLiqPrice?.toFixed(2))}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className='icon_arrow' />\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t: '')}\r\n\t\t\t\t\t\t\t\t\t<span className={(isFinite(liqPrice) ? \"\" : \" icon-infinity\")}>\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\tisFinite(liqPrice) &&\r\n\t\t\t\t\t\t\t\t\t\t\t(liqPrice !== null ? `$${separateThousands(liqPrice?.toFixed(2))}` : '')\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__form-wrapper\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading ?\r\n\t\t\t\t\t\t\t<Loader />\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<Form maxVal={repay} inputProps={steps[step].inputProps} btnText={steps[step].title} onSubmit={steps[step].onSubmit}\r\n\t\t\t\t\t\t\tisStep={step < steps.length - 1}\r\n\t\t\t\t\t\t\tmodalVisible={state.isVisible}\r\n\t\t\t\t\t\t\tbtnIsActive={steps[step].btnIsActive}\r\n\t\t\t\t\t\t\tmaxWarningMsg={'Amount is too big'}\r\n\t\t\t\t\t\t\tisModal={true}\r\n\t\t\t\t\t\t\tmaxOnClick={setMaxVal}></Form>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default RepayModal;","import React from 'react';\r\nimport icon_usdc from '../img/icon-usdc.svg';\r\nimport { separateThousands } from './utils/sepThousands';\r\n\r\nconst Currency = ({ children }) => {\r\n\tconst val = children;\r\n\t\r\n\tif (typeof val !== 'string' && typeof val !== 'number') {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className=\"currency\">\r\n\t\t\t<img src={icon_usdc} alt=\"USDC Icon\" />\r\n\t\t\t<span>{separateThousands(val)}</span>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Currency;","import React, { useContext } from 'react';\r\nimport { GlobalStatsContext, UserStatsContext } from './../context/context';\r\nimport { separateThousands } from './utils/sepThousands';\r\nimport Currency from './Currency';\r\n\r\n\r\nconst MarketInfoBoard = () => {\r\n\tconst {globalStats} = useContext(GlobalStatsContext)\r\n\r\n\treturn (\r\n\t\t<div className=\"info-board app-box _mobile-fluid\">\r\n\t\t\t<div className=\"info-board__items\">\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Total Supplied</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">\r\n\t\t\t\t\t\t<Currency>{globalStats.totalSupplied}</Currency>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Total Borrowed</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">\r\n\t\t\t\t\t\t<Currency>{globalStats.totalBorrowed}</Currency>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Utilization Rate</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">\r\n\t\t\t\t\t\t{separateThousands(globalStats.utilRate, ',') + '%'}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Available to Borrow</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">\r\n\t\t\t\t\t\t<Currency>{globalStats.availToBorrow}</Currency>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Earn APR</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">\r\n\t\t\t\t\t\t{separateThousands(globalStats.borrowAPY, ',') + '%'}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MarketInfoBoard;","import React, { useContext, useState, useEffect } from 'react';\r\nimport { UserStatsContext, GlobalStatsContext } from './../context/context';\r\nimport Form from './Form';\r\nimport { DDL_POOL, DDL_POOL_signed, USDC_signed } from './utils/contracts';\r\nimport { sepToNumber } from './utils/sepThousands';\r\nimport Loader from './UI/loader/Loader';\r\nimport { getGlobalStats, getUserStats } from './utils/stats';\r\nimport { formatForContract } from './utils/math';\r\nimport { errAlert } from './utils/notifications';\r\nimport Currency from './Currency';\r\n\r\nconst SupplyCard = ({ step, setStep, ...props }) => {\r\n\tconst {userStats, setUserStats} = useContext(UserStatsContext);\r\n\tconst {setGlobalStats} = useContext(GlobalStatsContext);\r\n\tconst [inputVal, setInputVal] = useState('');\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (sepToNumber(inputVal) > userStats.balance) {\r\n\t\t\tsetInputVal(userStats.balance)\r\n\t\t}\r\n\t}, [inputVal]);\r\n\t\r\n\r\n\tconst steps = [\r\n\t\t{\r\n\t\t\ttitle: \"Approve\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsetIsLoading(true)\r\n\t\t\t\ttry {\r\n\t\t\t\t\tUSDC_signed.approve(DDL_POOL.address, (10**9 * 1e6).toFixed(0))\r\n\t\t\t\t\t.then(tsc => {\r\n\t\t\t\t\t\tconsole.log('Supply Approve transaction: ', tsc);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttsc.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tsetStep(step + 1)\r\n\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true,\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Supply\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\tsetIsLoading(true)\r\n\t\t\t\ttry {\r\n\t\t\t\t\tDDL_POOL_signed.provideFrom(formatForContract(inputVal), 0)\r\n\t\t\t\t\t.then(tsc => {\r\n\t\t\t\t\t\tconsole.log('Supply transaction:', tsc);\r\n\r\n\t\t\t\t\t\ttsc.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tgetUserStats(props.walletAddress)\r\n\t\t\t\t\t\t\t\t\t.then(stats => {\r\n\t\t\t\t\t\t\t\t\t\tsetUserStats({\r\n\t\t\t\t\t\t\t\t\t\t\t...userStats,\r\n\t\t\t\t\t\t\t\t\t\t\t...stats\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tgetGlobalStats()\r\n\t\t\t\t\t\t\t\t\t.then(stats => {\r\n\t\t\t\t\t\t\t\t\t\tsetGlobalStats(stats)\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: false,\r\n\t\t\t\tstate: {\r\n\t\t\t\t\tval: inputVal,\r\n\t\t\t\t\tsetVal: setInputVal\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\t\r\n\treturn (\r\n\t\t<div className={\"supply-card market-card App-box \" + props.className}>\r\n\t\t\t<h2>Supply USDC</h2>\r\n\t\t\t<div className=\"steps\">\r\n\t\t\t\t{steps.map((el, i) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div className={i === step ? 'step current' : 'step'} key={i}>\r\n\t\t\t\t\t\t\t{el.title}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t\t{\r\n\t\t\t\tisLoading ?\r\n\t\t\t\t\t<Loader />\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Form className=\"market-card__form\" maxVal={userStats.balance} inputProps={steps[step].inputProps} btnText={steps[step].title} onSubmit={steps[step].onSubmit}\r\n\t\t\t\t\tisStep={step < steps.length - 1}\r\n\t\t\t\t\tbtnIsActive={steps[step].btnIsActive}\r\n\t\t\t\t\tbtnIsDisabled={userStats.balance <= 0 || userStats.balance === undefined || props.walletAddress === ''}></Form>\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t<div className=\"market-card__info\">\r\n\t\t\t\t<div className=\"info-field\">\r\n\t\t\t\t\t<div className=\"info-field__name\">Balance: </div>\r\n\t\t\t\t\t<div className={\"info-field__val\" + (userStats.balance !== undefined ? '' : ' no-data')}>\r\n\t\t\t\t\t\t<Currency>{userStats.balance}</Currency>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SupplyCard;","import React, {useContext, useEffect, useState} from 'react';\r\nimport { separateThousands, sepToNumber } from './utils/sepThousands';\r\nimport { UserStatsContext, GlobalStatsContext } from './../context/context';\r\nimport Form from './Form';\r\nimport { DDL_POOL_signed } from './utils/contracts';\r\nimport Loader from './UI/loader/Loader';\r\nimport { getGlobalStats, getUserStats } from './utils/stats';\r\nimport { formatForContract } from './utils/math';\r\nimport { errAlert } from './utils/notifications';\r\nimport Currency from './Currency';\r\n\r\nconst WithdrawCard = (props) => {\r\n\tconst {userStats, setUserStats} = useContext(UserStatsContext);\r\n\tconst {setGlobalStats} = useContext(GlobalStatsContext);\r\n\tconst [inputVal, setInputVal] = useState('');\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\t\r\n\tconst inputProps = {\r\n\t\tplaceholder: 'Amount',\r\n\t\tdisabled: props.walletAddress === '',\r\n\t\tstate: {\r\n\t\t\tval: inputVal,\r\n\t\t\tsetVal: setInputVal\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (sepToNumber(inputVal) > userStats.avail) {\r\n\t\t\tsetInputVal(userStats.avail)\r\n\t\t}\r\n\t}, [inputVal])\r\n\r\n\tconst onSubmit = (e) => {\r\n\t\te.preventDefault()\r\n\t\tsetIsLoading(true)\r\n\t\t\r\n\t\ttry {\r\n\t\t\tDDL_POOL_signed.withdraw(formatForContract(inputVal))\r\n\t\t\t.then(tsc => {\r\n\t\t\t\tconsole.log('Withdraw transaction:', tsc);\r\n\r\n\t\t\t\ttsc.wait()\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tgetUserStats(props.walletAddress)\r\n\t\t\t\t\t\t\t.then(stats => {\r\n\t\t\t\t\t\t\t\tsetUserStats({\r\n\t\t\t\t\t\t\t\t\t...userStats,\r\n\t\t\t\t\t\t\t\t\t...stats\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\tgetGlobalStats()\r\n\t\t\t\t\t\t\t.then(stats => {\r\n\t\t\t\t\t\t\t\tsetGlobalStats(stats)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\terr => {\r\n\t\t\t\terrAlert(err)\r\n\t\t\t\tsetIsLoading(false)\r\n\t\t\t})\r\n\t\t} catch(err) {\r\n\t\t\terrAlert(err)\r\n\t\t\tsetIsLoading(false)\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className={\"withdraw-card market-card App-box \" + props.className}>\r\n\t\t\t<h2>Withdraw USDC</h2>\r\n\t\t\t\r\n\t\t\t{\r\n\t\t\t\tisLoading ?\r\n\t\t\t\t\t<Loader />\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Form className=\"market-card__form\" maxVal={userStats.avail} btnText={\"Withdraw\"} onSubmit={onSubmit} inputProps={inputProps} btnIsDisabled={userStats.avail <= 0 || userStats.avail === undefined || props.walletAddress === '' }></Form>\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t<div className=\"market-card__info\">\r\n\t\t\t\t<div className=\"info-field\">\r\n\t\t\t\t\t<div className=\"info-field__name\">Current Balance: </div>\r\n\t\t\t\t\t<div className={\"info-field__val\" + (userStats.curBalance !== undefined ? '' : ' no-data')}>\r\n\t\t\t\t\t\t<Currency>{userStats.curBalance}</Currency>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-field\">\r\n\t\t\t\t\t<div className=\"info-field__name\">Available: </div>\r\n\t\t\t\t\t<div className={\"info-field__val\" + (userStats.balance !== undefined ? '' : ' no-data')}>\r\n\t\t\t\t\t\t<Currency>{userStats.avail}</Currency>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default WithdrawCard;","import SupplyCard from './../../components/SupplyCard';\r\nimport WithdrawCard from './../../components/WithdrawCard';\r\nimport MarketInfoBoard from './../../components/MarketInfoBoard';\r\n\r\nconst SupplyMarket = ({ walletAddress, supplyStep, setSupplyStep }) => {\r\n\t\r\n\t\r\n\treturn (\r\n\t\t<div className='block supply-market'>\r\n\t\t\t<MarketInfoBoard />\r\n\t\t\t\r\n\t\t\t<div className=\"supply-market__functions\">\r\n\t\t\t\t<SupplyCard walletAddress={walletAddress} className=\"supply-market__function\" step={supplyStep} setStep={setSupplyStep}></SupplyCard>\r\n\t\t\t\t<WithdrawCard walletAddress={walletAddress} className=\"supply-market__function\" setSupplyStep={setSupplyStep}></WithdrawCard>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SupplyMarket;","import { ethers } from \"ethers\";\r\n\r\nimport { MAINNET, TESTNET, ARBITRUM_TESTNET, ARBITRUM, AVALANCHE } from \"../lib/legacy\";\r\n\r\nconst { parseEther } = ethers.utils;\r\n\r\nconst constants = {\r\n  [MAINNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [TESTNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [ARBITRUM_TESTNET]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [ARBITRUM]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    wrappedTokenSymbol: \"WETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [AVALANCHE]: {\r\n    nativeTokenSymbol: \"AVAX\",\r\n    wrappedTokenSymbol: \"WAVAX\",\r\n    defaultCollateralSymbol: \"MIM\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0100001\"),\r\n  },\r\n};\r\n\r\nexport const getConstant = (chainId, key) => {\r\n  if (!constants[chainId]) {\r\n    throw new Error(`Unsupported chainId ${chainId}`);\r\n  }\r\n  if (!(key in constants[chainId])) {\r\n    throw new Error(`Key ${key} does not exist for chainId ${chainId}`);\r\n  }\r\n  return constants[chainId][key];\r\n};\r\n","import { ApolloClient, InMemoryCache } from \"@apollo/client\";\r\n\r\nexport const chainlinkClient = createClient(\"https://api.thegraph.com/subgraphs/name/deividask/chainlink\");\r\nexport const arbitrumGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-stats\");\r\nexport const avalancheGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-stats\");\r\nexport const nissohGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/nissoh/gmx-vault\");\r\nexport const arbitrumReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-arbitrum-referrals\"\r\n);\r\nexport const avalancheReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-referrals\"\r\n);\r\n\r\nfunction createClient(uri) {\r\n  return new ApolloClient({\r\n    uri,\r\n    cache: new InMemoryCache(),\r\n  });\r\n}\r\n\r\nexport function get1InchSwapUrl(chainId, from, to) {\r\n  const rootUrl = `https://app.1inch.io/#/${chainId}/unified/swap`;\r\n  if (!from && !to) return rootUrl;\r\n  return `${rootUrl}/${from}/${to}`;\r\n}\r\n","// prettier-ignore\r\nimport {ethers} from \"ethers\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\nimport { getFallbackProvider, getProvider } from \"../legacy\";\r\n\r\nexport const fetcher =\r\n  (library: Web3Provider, contractInfo: any, additionalArgs: any[]) =>\r\n  (...args: any) => {\r\n    // eslint-disable-next-line\r\n    const [id, chainId, arg0, arg1, ...params] = args;\r\n    const provider = getProvider(library, chainId);\r\n\r\n    const method = ethers.utils.isAddress(arg0) ? arg1 : arg0;\r\n\r\n    const contractCall = getContractCall({\r\n      provider,\r\n      contractInfo,\r\n      arg0,\r\n      arg1,\r\n      method,\r\n      params,\r\n      additionalArgs,\r\n    });\r\n\r\n    let shouldCallFallback = true;\r\n\r\n    const handleFallback = async (resolve, reject, error) => {\r\n      if (!shouldCallFallback) {\r\n        return;\r\n      }\r\n      // prevent fallback from being called twice\r\n      shouldCallFallback = false;\r\n\r\n      const fallbackProvider = getFallbackProvider(chainId);\r\n      if (!fallbackProvider) {\r\n        reject(error);\r\n        return;\r\n      }\r\n\r\n      console.info(\"using fallbackProvider for\", method);\r\n      const fallbackContractCall = getContractCall({\r\n        provider: fallbackProvider,\r\n        contractInfo,\r\n        arg0,\r\n        arg1,\r\n        method,\r\n        params,\r\n        additionalArgs,\r\n      });\r\n\r\n      fallbackContractCall\r\n        .then((result) => resolve(result))\r\n        .catch((e) => {\r\n          console.error(\"fallback fetcher error\", id, contractInfo.contractName, method, e);\r\n          reject(e);\r\n        });\r\n    };\r\n\r\n    return new Promise(async (resolve, reject) => {\r\n      contractCall\r\n        .then((result) => {\r\n          shouldCallFallback = false;\r\n          resolve(result);\r\n        })\r\n        .catch((e) => {\r\n          console.error(\"fetcher error\", id, contractInfo.contractName, method, e);\r\n          handleFallback(resolve, reject, e);\r\n        });\r\n\r\n      setTimeout(() => {\r\n        handleFallback(resolve, reject, \"contractCall timeout\");\r\n      }, 2000);\r\n    });\r\n  };\r\n\r\nfunction getContractCall({ provider, contractInfo, arg0, arg1, method, params, additionalArgs }) {\r\n  if (ethers.utils.isAddress(arg0)) {\r\n    const address = arg0;\r\n    const contract = new ethers.Contract(address, contractInfo.abi, provider);\r\n\r\n    if (additionalArgs) {\r\n      return contract[method](...params.concat(additionalArgs));\r\n    }\r\n    return contract[method](...params);\r\n  }\r\n\r\n  if (!provider) {\r\n    return;\r\n  }\r\n\r\n  return provider[method](arg1, ...params);\r\n}\r\n","import { toast, ToastContent, ToastOptions } from \"react-toastify\";\r\n\r\nexport const helperToast = {\r\n  success: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n","import { useState } from \"react\";\r\n\r\nexport function ToastifyDebug(props) {\r\n  const [open, setOpen] = useState(false);\r\n  return (\r\n    <div className=\"Toastify-debug\">\r\n      <span className=\"Toastify-debug-button\" onClick={() => setOpen((old) => !old)}>\r\n        {open ? \"Hide error\" : \"Show error\"}\r\n      </span>\r\n      {open && <div className=\"Toastify-debug-content\">{props.children}</div>}\r\n    </div>\r\n  );\r\n}\r\n","export const NOT_ENOUGH_FUNDS = \"NOT_ENOUGH_FUNDS\";\r\nexport const USER_DENIED = \"USER_DENIED\";\r\nexport const SLIPPAGE = \"SLIPPAGE\";\r\nexport const RPC_ERROR = \"RPC_ERROR\";\r\n\r\ntype ErrorPattern = { msg?: string; code?: number };\r\n\r\nconst TX_ERROR_PATTERNS: { [key: string]: ErrorPattern[] } = {\r\n  [NOT_ENOUGH_FUNDS]: [\r\n    { msg: \"not enough funds for gas\" },\r\n    { msg: \"failed to execute call with revert code InsufficientGasFunds\" },\r\n  ],\r\n  [USER_DENIED]: [{ msg: \"User denied transaction signature\" }],\r\n  [SLIPPAGE]: [{ msg: \"Router: mark price lower than limit\" }, { msg: \"Router: mark price higher than limit\" }],\r\n  [RPC_ERROR]: [\r\n    // @see https://eips.ethereum.org/EIPS/eip-1474#error-codes\r\n    { code: -32005 },\r\n    { msg: \"Non-200 status code\" },\r\n    { msg: \"Request limit exceeded\" },\r\n    { msg: \"Internal JSON-RPC error\" },\r\n    { msg: \"Response has no error or result\" },\r\n    { msg: \"couldn't connect to the network\" },\r\n  ],\r\n};\r\n\r\ntype TxError = {\r\n  message?: string;\r\n  code?: number;\r\n  data?: any;\r\n};\r\n\r\nexport function extractError(ex: TxError) {\r\n  if (!ex) {\r\n    return [];\r\n  }\r\n\r\n  const message = ex.data?.message || ex.message;\r\n  const code = ex.code;\r\n\r\n  if (!message && !code) {\r\n    return [];\r\n  }\r\n\r\n  for (const [type, patterns] of Object.entries(TX_ERROR_PATTERNS)) {\r\n    for (const pattern of patterns) {\r\n      const matchCode = pattern.code && code === pattern.code;\r\n      const matchMessage = pattern.msg && message && message.includes(pattern.msg);\r\n\r\n      if (matchCode || matchMessage) {\r\n        return [message, type, ex.data];\r\n      }\r\n    }\r\n  }\r\n\r\n  return [message, null, ex.data];\r\n}\r\n","import { ARBITRUM, AVALANCHE } from \"../legacy\";\r\n\r\nexport const GAS_PRICE_ADJUSTMENT_MAP = {\r\n  [ARBITRUM]: \"0\",\r\n  [AVALANCHE]: \"3000000000\", // 3 gwei\r\n};\r\n\r\nexport const MAX_GAS_PRICE_MAP = {\r\n  [AVALANCHE]: \"200000000000\", // 200 gwei\r\n};","import { bigNumberify } from \"../legacy\";\r\nimport { GAS_PRICE_ADJUSTMENT_MAP, MAX_GAS_PRICE_MAP } from \"./constants\";\r\nimport { Provider } from \"@ethersproject/providers\";\r\nimport { Contract } from \"ethers\";\r\n\r\nexport async function setGasPrice(txnOpts: any, provider: Provider, chainId: number) {\r\n  let maxGasPrice = MAX_GAS_PRICE_MAP[chainId];\r\n  const premium = GAS_PRICE_ADJUSTMENT_MAP[chainId] || bigNumberify(0);\r\n\r\n  const gasPrice = await provider.getGasPrice();\r\n\r\n  if (maxGasPrice) {\r\n    if (gasPrice.gt(maxGasPrice)) {\r\n      maxGasPrice = gasPrice;\r\n    }\r\n\r\n    const feeData = await provider.getFeeData();\r\n\r\n    // the wallet provider might not return maxPriorityFeePerGas in feeData\r\n    // in which case we should fallback to the usual getGasPrice flow handled below\r\n    if (feeData && feeData.maxPriorityFeePerGas) {\r\n      txnOpts.maxFeePerGas = maxGasPrice;\r\n      txnOpts.maxPriorityFeePerGas = feeData.maxPriorityFeePerGas.add(premium);\r\n      return;\r\n    }\r\n  }\r\n\r\n  txnOpts.gasPrice = gasPrice.add(premium);\r\n  return;\r\n}\r\n\r\nexport async function getGasLimit(contract: Contract, method, params = [], value) {\r\n  const defaultValue = bigNumberify(0);\r\n\r\n  if (!value) {\r\n    value = defaultValue;\r\n  }\r\n\r\n  let gasLimit = await contract.estimateGas[method](...params, { value });\r\n\r\n  if (gasLimit.lt(22000)) {\r\n    gasLimit = bigNumberify(22000)!;\r\n  }\r\n\r\n  return gasLimit.mul(11000).div(10000); // add a 10% buffer\r\n}\r\n","import { BigNumber, Contract } from \"ethers\";\r\nimport { helperToast } from \"../helperToast\";\r\nimport { ToastifyDebug } from \"../../components/ToastifyDebug/ToastifyDebug\";\r\nimport { extractError, NOT_ENOUGH_FUNDS, RPC_ERROR, SLIPPAGE, USER_DENIED } from \"./transactionErrors\";\r\nimport { getExplorerUrl } from \"../legacy\";\r\nimport { getGasLimit, setGasPrice } from \"./utils\";\r\n\r\nexport async function callContract(\r\n  chainId: number,\r\n  contract: Contract,\r\n  method: string,\r\n  params: any,\r\n  opts: {\r\n    value?: BigNumber | number;\r\n    gasLimit?: BigNumber | number;\r\n    sentMsg?: string;\r\n    successMsg?: string;\r\n    hideSuccessMsg?: boolean;\r\n    failMsg?: string;\r\n    setPendingTxns?: (txns: any) => void;\r\n  }\r\n) {\r\n  try {\r\n    if (!Array.isArray(params) && typeof params === \"object\" && opts === undefined) {\r\n      opts = params;\r\n      params = [];\r\n    }\r\n\r\n    if (!opts) {\r\n      opts = {};\r\n    }\r\n\r\n    const txnOpts: any = {};\r\n\r\n    if (opts.value) {\r\n      txnOpts.value = opts.value;\r\n    }\r\n\r\n    txnOpts.gasLimit = opts.gasLimit ? opts.gasLimit : await getGasLimit(contract, method, params, opts.value);\r\n\r\n    await setGasPrice(txnOpts, contract.provider, chainId);\r\n\r\n    const res = await contract[method](...params, txnOpts);\r\n    const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\r\n    const sentMsg = opts.sentMsg || \"Transaction sent.\";\r\n\r\n    helperToast.success(\r\n      <div>\r\n        {sentMsg}{\" \"}\r\n        <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n          View status.\r\n        </a>\r\n        <br />\r\n      </div>\r\n    );\r\n\r\n    if (opts.setPendingTxns) {\r\n      const message = opts.hideSuccessMsg ? undefined : opts.successMsg || \"Transaction completed!\";\r\n      const pendingTxn = {\r\n        hash: res.hash,\r\n        message,\r\n      };\r\n      opts.setPendingTxns((pendingTxns) => [...pendingTxns, pendingTxn]);\r\n    }\r\n    return res;\r\n  } catch (e) {\r\n    let failMsg;\r\n\r\n    let autoCloseToast: number | boolean = 5000;\r\n\r\n    const [message, type, errorData] = extractError(e);\r\n    switch (type) {\r\n      case NOT_ENOUGH_FUNDS:\r\n        failMsg = (\r\n          <div>\r\n            There is not enough ETH in your account on Arbitrum to send this transaction.\r\n            <br />\r\n            <br />\r\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              Bridge ETH to Arbitrum\r\n            </a>\r\n          </div>\r\n        );\r\n        break;\r\n      case USER_DENIED:\r\n        failMsg = \"Transaction was cancelled.\";\r\n        break;\r\n      case SLIPPAGE:\r\n        failMsg =\r\n          'The mark price has changed, consider increasing your Allowed Slippage by clicking on the \"...\" icon next to your address.';\r\n        break;\r\n      case RPC_ERROR:\r\n        autoCloseToast = false;\r\n\r\n        const originalError = errorData?.error?.message || errorData?.message || message;\r\n\r\n        failMsg = (\r\n          <div>\r\n            Transaction failed due to RPC error.\r\n            <br />\r\n            <br />\r\n            Please try changing the RPC url in your wallet settings.{\" \"}\r\n            <a href=\"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              More info\r\n            </a>\r\n            <br />\r\n            {originalError && <ToastifyDebug>{originalError}</ToastifyDebug>}\r\n          </div>\r\n        );\r\n        break;\r\n      default:\r\n        autoCloseToast = false;\r\n\r\n        failMsg = (\r\n          <div>\r\n            {opts.failMsg || \"Transaction failed\"}\r\n            <br />\r\n            {message && <ToastifyDebug>{message}</ToastifyDebug>}\r\n          </div>\r\n        );\r\n    }\r\n\r\n    helperToast.error(failMsg, { autoClose: autoCloseToast });\r\n    throw e;\r\n  }\r\n}\r\n","import { useMemo } from \"react\";\r\nimport { gql } from \"@apollo/client\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { USD_DECIMALS, CHART_PERIODS, formatAmount, sleep } from \"../lib/legacy\";\r\nimport { chainlinkClient } from \"./common\";\r\n\r\nconst BigNumber = ethers.BigNumber;\r\n\r\n// Ethereum network, Chainlink Aggregator contracts\r\nconst FEED_ID_MAP = {\r\n  BTC_USD: \"0xae74faa92cb67a95ebcab07358bc222e33a34da7\",\r\n  ETH_USD: \"0x37bc7498f4ff12c19678ee8fe19d713b87f6a9e6\",\r\n  BNB_USD: \"0xc45ebd0f901ba6b2b8c7e70b717778f055ef5e6d\",\r\n  LINK_USD: \"0xdfd03bfc3465107ce570a0397b247f546a42d0fa\",\r\n  UNI_USD: \"0x68577f915131087199fe48913d8b416b3984fd38\",\r\n  SUSHI_USD: \"0x7213536a36094cd8a768a5e45203ec286cba2d74\",\r\n  AVAX_USD: \"0x0fc3657899693648bba4dbd2d8b33b82e875105d\",\r\n  AAVE_USD: \"0xe3f0dede4b499c07e12475087ab1a084b5f93bc0\",\r\n  YFI_USD: \"0x8a4d74003870064d41d4f84940550911fbfccf04\",\r\n  SPELL_USD: \"0x8640b23468815902e011948f3ab173e1e83f9879\",\r\n};\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nfunction fillGaps(prices, periodSeconds) {\r\n  if (prices.length < 2) {\r\n    return prices;\r\n  }\r\n\r\n  const newPrices = [prices[0]];\r\n  let prevTime = prices[0].time;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const { time, open } = prices[i];\r\n    if (prevTime) {\r\n      let j = (time - prevTime) / periodSeconds - 1;\r\n      while (j > 0) {\r\n        newPrices.push({\r\n          time: time - j * periodSeconds,\r\n          open,\r\n          close: open,\r\n          high: open * 1.0003,\r\n          low: open * 0.9996,\r\n        });\r\n        j--;\r\n      }\r\n    }\r\n\r\n    prevTime = time;\r\n    newPrices.push(prices[i]);\r\n  }\r\n\r\n  return newPrices;\r\n}\r\n\r\nasync function getChartPricesFromStats(chainId, symbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(symbol)) {\r\n    symbol = symbol.substr(1);\r\n  } else if (symbol === \"BTC.b\") {\r\n    symbol = \"BTC\";\r\n  }\r\n  const hostname = \"https://stats.gmx.io/\";\r\n  // const hostname = 'http://localhost:3113/'\r\n  const timeDiff = CHART_PERIODS[period] * 3000;\r\n  const from = Math.floor(Date.now() / 1000 - timeDiff);\r\n  const url = `${hostname}api/candles/${symbol}?preferableChainId=${chainId}&period=${period}&from=${from}&preferableSource=fast`;\r\n  const TIMEOUT = 5000;\r\n  const res = await new Promise(async (resolve, reject) => {\r\n    let done = false;\r\n    setTimeout(() => {\r\n      done = true;\r\n      reject(new Error(`request timeout ${url}`));\r\n    }, TIMEOUT);\r\n\r\n    let lastEx;\r\n    for (let i = 0; i < 3; i++) {\r\n      if (done) return;\r\n      try {\r\n        const res = await fetch(url);\r\n        resolve(res);\r\n        return;\r\n      } catch (ex) {\r\n        await sleep(300);\r\n        lastEx = ex;\r\n      }\r\n    }\r\n    reject(lastEx);\r\n  });\r\n  if (!res.ok) {\r\n    throw new Error(`request failed ${res.status} ${res.statusText}`);\r\n  }\r\n  const json = await res.json();\r\n  let prices = json?.prices;\r\n  if (!prices || prices.length < 10) {\r\n    throw new Error(`not enough prices data: ${prices?.length}`);\r\n  }\r\n\r\n  const OBSOLETE_THRESHOLD = Date.now() / 1000 - 60 * 30; // 30 min ago\r\n  const updatedAt = json?.updatedAt || 0;\r\n  if (updatedAt < OBSOLETE_THRESHOLD) {\r\n    throw new Error(\r\n      \"chart data is obsolete, last price record at \" +\r\n        new Date(updatedAt * 1000).toISOString() +\r\n        \" now: \" +\r\n        new Date().toISOString()\r\n    );\r\n  }\r\n\r\n  prices = prices.map(({ t, o: open, c: close, h: high, l: low }) => ({\r\n    time: t + timezoneOffset,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n  return prices;\r\n}\r\n\r\nfunction getCandlesFromPrices(prices, period) {\r\n  const periodTime = CHART_PERIODS[period];\r\n\r\n  if (prices.length < 2) {\r\n    return [];\r\n  }\r\n\r\n  const candles = [];\r\n  const first = prices[0];\r\n  let prevTsGroup = Math.floor(first[0] / periodTime) * periodTime;\r\n  let prevPrice = first[1];\r\n  let o = prevPrice;\r\n  let h = prevPrice;\r\n  let l = prevPrice;\r\n  let c = prevPrice;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const [ts, price] = prices[i];\r\n    const tsGroup = Math.floor(ts / periodTime) * periodTime;\r\n    if (prevTsGroup !== tsGroup) {\r\n      candles.push({ t: prevTsGroup + timezoneOffset, o, h, l, c });\r\n      o = c;\r\n      h = Math.max(o, c);\r\n      l = Math.min(o, c);\r\n    }\r\n    c = price;\r\n    h = Math.max(h, price);\r\n    l = Math.min(l, price);\r\n    prevTsGroup = tsGroup;\r\n  }\r\n\r\n  return candles.map(({ t: time, o: open, c: close, h: high, l: low }) => ({\r\n    time,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n}\r\n\r\nfunction getChainlinkChartPricesFromGraph(tokenSymbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(tokenSymbol)) {\r\n    tokenSymbol = tokenSymbol.substr(1);\r\n  }\r\n  const marketName = tokenSymbol + \"_USD\";\r\n  const feedId = FEED_ID_MAP[marketName];\r\n  if (!feedId) {\r\n    throw new Error(`undefined marketName ${marketName}`);\r\n  }\r\n\r\n  const PER_CHUNK = 1000;\r\n  const CHUNKS_TOTAL = 6;\r\n  const requests = [];\r\n  for (let i = 0; i < CHUNKS_TOTAL; i++) {\r\n    const query = gql(`{\r\n      rounds(\r\n        first: ${PER_CHUNK},\r\n        skip: ${i * PER_CHUNK},\r\n        orderBy: unixTimestamp,\r\n        orderDirection: desc,\r\n        where: {feed: \"${feedId}\"}\r\n      ) {\r\n        unixTimestamp,\r\n        value\r\n      }\r\n    }`);\r\n    requests.push(chainlinkClient.query({ query }));\r\n  }\r\n\r\n  return Promise.all(requests)\r\n    .then((chunks) => {\r\n      let prices = [];\r\n      const uniqTs = new Set();\r\n      chunks.forEach((chunk) => {\r\n        chunk.data.rounds.forEach((item) => {\r\n          if (uniqTs.has(item.unixTimestamp)) {\r\n            return;\r\n          }\r\n\r\n          uniqTs.add(item.unixTimestamp);\r\n          prices.push([item.unixTimestamp, Number(item.value) / 1e8]);\r\n        });\r\n      });\r\n\r\n      prices.sort(([timeA], [timeB]) => timeA - timeB);\r\n      prices = getCandlesFromPrices(prices, period);\r\n      return prices;\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n    });\r\n}\r\n\r\nexport function useChartPrices(chainId, symbol, isStable, period, currentAveragePrice) {\r\n  const swrKey = !isStable && symbol ? [\"getChartCandles\", chainId, symbol, period] : null;\r\n  let { data: prices, mutate: updatePrices } = useSWR(swrKey, {\r\n    fetcher: async (...args) => {\r\n      try {\r\n        return await getChartPricesFromStats(chainId, symbol, period);\r\n      } catch (ex) {\r\n        console.warn(ex);\r\n        console.warn(\"Switching to graph chainlink data\");\r\n        try {\r\n          return await getChainlinkChartPricesFromGraph(symbol, period);\r\n        } catch (ex2) {\r\n          console.warn(\"getChainlinkChartPricesFromGraph failed\");\r\n          console.warn(ex2);\r\n          return [];\r\n        }\r\n      }\r\n    },\r\n    dedupingInterval: 60000,\r\n    focusThrottleInterval: 60000 * 10,\r\n  });\r\n\r\n  const currentAveragePriceString = currentAveragePrice && currentAveragePrice.toString();\r\n  const retPrices = useMemo(() => {\r\n    if (isStable) {\r\n      return getStablePriceData(period);\r\n    }\r\n\r\n    if (!prices) {\r\n      return [];\r\n    }\r\n\r\n    let _prices = [...prices];\r\n    if (currentAveragePriceString && prices.length) {\r\n      _prices = appendCurrentAveragePrice(_prices, BigNumber.from(currentAveragePriceString), period);\r\n    }\r\n\r\n    return fillGaps(_prices, CHART_PERIODS[period]);\r\n  }, [prices, isStable, currentAveragePriceString, period]);\r\n\r\n  return [retPrices, updatePrices];\r\n}\r\n\r\nfunction appendCurrentAveragePrice(prices, currentAveragePrice, period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const currentCandleTime = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds + timezoneOffset;\r\n  const last = prices[prices.length - 1];\r\n  const averagePriceValue = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n  if (currentCandleTime === last.time) {\r\n    last.close = averagePriceValue;\r\n    last.high = Math.max(last.high, averagePriceValue);\r\n    last.low = Math.max(last.low, averagePriceValue);\r\n    return prices;\r\n  } else {\r\n    const newCandle = {\r\n      time: currentCandleTime,\r\n      open: last.close,\r\n      close: averagePriceValue,\r\n      high: averagePriceValue,\r\n      low: averagePriceValue,\r\n    };\r\n    return [...prices, newCandle];\r\n  }\r\n}\r\n\r\nfunction getStablePriceData(period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const now = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds;\r\n  let priceData = [];\r\n  for (let i = 100; i > 0; i--) {\r\n    priceData.push({\r\n      time: now - i * periodSeconds,\r\n      open: 1,\r\n      close: 1,\r\n      high: 1,\r\n      low: 1,\r\n    });\r\n  }\r\n  return priceData;\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Token as UniToken } from \"@uniswap/sdk-core\";\r\nimport { Pool } from \"@uniswap/v3-sdk\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\nimport PositionManager from \"../abis/PositionManager.json\";\r\nimport Vault from \"../abis/Vault.json\";\r\nimport Router from \"../abis/Router.json\";\r\nimport UniPool from \"../abis/UniPool.json\";\r\nimport UniswapV2 from \"../abis/UniswapV2.json\";\r\nimport Token from \"../abis/Token.json\";\r\nimport VaultReader from \"../abis/VaultReader.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { getConstant } from \"../config/chains\";\r\nimport {\r\n  ARBITRUM,\r\n  ARBITRUM_TESTNET,\r\n  AVALANCHE,\r\n  bigNumberify,\r\n  DECREASE,\r\n  expandDecimals,\r\n  getHighExecutionFee,\r\n  getInfoTokens,\r\n  getOrderKey,\r\n  getProvider,\r\n  getServerBaseUrl,\r\n  getServerUrl,\r\n  getUsd,\r\n  INCREASE,\r\n  parseValue,\r\n  replaceNativeTokenAddress,\r\n  SWAP,\r\n  UI_VERSION,\r\n  USD_DECIMALS,\r\n} from \"../lib/legacy\";\r\nimport { getTokenBySymbol, getTokens, getWhitelistedTokens } from \"../config/Tokens\";\r\n\r\nimport { arbitrumGraphClient, avalancheGraphClient, nissohGraphClient } from \"./common\";\r\nimport { groupBy } from \"lodash\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\nimport { DDL_AccountManager } from \"../../../components/utils/contracts\";\r\nimport { DDL_AccountManager_abi } from './../../../components/utils/contracts';\r\n\r\nexport * from \"./prices\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getGmxGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheGraphClient;\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return null;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function useAllOrdersStats(chainId) {\r\n  const query = gql(`{\r\n    orderStat(id: \"total\") {\r\n      openSwap\r\n      openIncrease\r\n      openDecrease\r\n      executedSwap\r\n      executedIncrease\r\n      executedDecrease\r\n      cancelledSwap\r\n      cancelledIncrease\r\n      cancelledDecrease\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    const graphClient = getGmxGraphClient(chainId);\r\n    if (graphClient) {\r\n      graphClient.query({ query }).then(setRes).catch(console.warn);\r\n    }\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.orderStat : null;\r\n}\r\n\r\nexport function useInfoTokens(library, chainId, active, tokenBalances, fundingRateInfo, vaultPropsLength) {\r\n  const tokens = getTokens(chainId);\r\n  const vaultReaderAddress = getContract(chainId, \"VaultReader\");\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n\r\n  const { data: vaultTokenInfo } = useSWR(\r\n    [`useInfoTokens:${active}`, chainId, vaultReaderAddress, \"getVaultTokenInfoV4\"],\r\n    {\r\n      fetcher: fetcher(library, VaultReader, [\r\n        vaultAddress,\r\n        positionRouterAddress,\r\n        nativeTokenAddress,\r\n        expandDecimals(1, 18),\r\n        whitelistedTokenAddresses,\r\n      ]),\r\n    }\r\n  );\r\n\r\n  const indexPricesUrl = getServerUrl(chainId, \"/prices\");\r\n  const { data: indexPrices } = useSWR([indexPricesUrl], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n    refreshInterval: 500,\r\n    refreshWhenHidden: true,\r\n  });\r\n  console.log();\r\n\r\n  return {\r\n    infoTokens: getInfoTokens(\r\n      tokens,\r\n      tokenBalances,\r\n      whitelistedTokens,\r\n      vaultTokenInfo,\r\n      fundingRateInfo,\r\n      vaultPropsLength,\r\n      indexPrices,\r\n      nativeTokenAddress\r\n    ),\r\n  };\r\n}\r\n\r\nexport function useUserStat(chainId) {\r\n  const query = gql(`{\r\n    userStat(id: \"total\") {\r\n      id\r\n      uniqueCount\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.userStat : null;\r\n}\r\n\r\nexport function useLiquidationsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  useEffect(() => {\r\n    if (account) {\r\n      const query = gql(`{\r\n         liquidatedPositions(\r\n           where: {account: \"${account.toLowerCase()}\"}\r\n           first: 100\r\n           orderBy: timestamp\r\n           orderDirection: desc\r\n         ) {\r\n           key\r\n           timestamp\r\n           borrowFee\r\n           loss\r\n           collateral\r\n           size\r\n           markPrice\r\n           type\r\n         }\r\n      }`);\r\n      const graphClient = getGmxGraphClient(chainId);\r\n      if (!graphClient) {\r\n        return;\r\n      }\r\n\r\n      graphClient\r\n        .query({ query })\r\n        .then((res) => {\r\n          const _data = res.data.liquidatedPositions.map((item) => {\r\n            return {\r\n              ...item,\r\n              size: bigNumberify(item.size),\r\n              collateral: bigNumberify(item.collateral),\r\n              markPrice: bigNumberify(item.markPrice),\r\n            };\r\n          });\r\n          setData(_data);\r\n        })\r\n        .catch(console.warn);\r\n    }\r\n  }, [setData, chainId, account]);\r\n\r\n  return data;\r\n}\r\n\r\nexport function useAllPositions(chainId, library) {\r\n  const count = 1000;\r\n  const query = gql(`{\r\n    aggregatedTradeOpens(\r\n      first: ${count}\r\n    ) {\r\n      account\r\n      initialPosition{\r\n        indexToken\r\n        collateralToken\r\n        isLong\r\n        sizeDelta\r\n      }\r\n      increaseList {\r\n        sizeDelta\r\n      }\r\n      decreaseList {\r\n        sizeDelta\r\n      }\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    nissohGraphClient.query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query]);\r\n\r\n  const key = res ? `allPositions${count}__` : false;\r\n  const { data: positions = [] } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const ret = await Promise.all(\r\n      res.data.aggregatedTradeOpens.map(async (dataItem) => {\r\n        try {\r\n          const { indexToken, collateralToken, isLong } = dataItem.initialPosition;\r\n          const positionData = await contract.getPosition(dataItem.account, collateralToken, indexToken, isLong);\r\n          const position = {\r\n            size: bigNumberify(positionData[0]),\r\n            collateral: bigNumberify(positionData[1]),\r\n            entryFundingRate: bigNumberify(positionData[3]),\r\n            account: dataItem.account,\r\n          };\r\n          position.fundingFee = await contract.getFundingFee(collateralToken, position.size, position.entryFundingRate);\r\n          position.marginFee = position.size.div(1000);\r\n          position.fee = position.fundingFee.add(position.marginFee);\r\n\r\n          const THRESHOLD = 5000;\r\n          const collateralDiffPercent = position.fee.mul(10000).div(position.collateral);\r\n          position.danger = collateralDiffPercent.gt(THRESHOLD);\r\n\r\n          return position;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n\r\n    return ret.filter(Boolean);\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nexport function useAllOrders(chainId, library) {\r\n  const query = gql(`{\r\n    orders(\r\n      first: 1000,\r\n      orderBy: createdTimestamp,\r\n      orderDirection: desc,\r\n      where: {status: \"open\"}\r\n    ) {\r\n      type\r\n      account\r\n      index\r\n      status\r\n      createdTimestamp\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes);\r\n  }, [setRes, query, chainId]);\r\n\r\n  const key = res ? res.data.orders.map((order) => `${order.type}-${order.account}-${order.index}`) : null;\r\n  const { data: orders = [] } = useSWR(key, () => {\r\n    const provider = getProvider(library, chainId);\r\n    const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n    const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n    return Promise.all(\r\n      res.data.orders.map(async (order) => {\r\n        try {\r\n          const type = order.type.charAt(0).toUpperCase() + order.type.substring(1);\r\n          const method = `get${type}Order`;\r\n          const orderFromChain = await contract[method](order.account, order.index);\r\n          const ret = {};\r\n          for (const [key, val] of Object.entries(orderFromChain)) {\r\n            ret[key] = val;\r\n          }\r\n          if (order.type === \"swap\") {\r\n            ret.path = [ret.path0, ret.path1, ret.path2].filter((address) => address !== AddressZero);\r\n          }\r\n          ret.type = type;\r\n          ret.index = order.index;\r\n          ret.account = order.account;\r\n          ret.createdTimestamp = order.createdTimestamp;\r\n          return ret;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n  });\r\n\r\n  return orders.filter(Boolean);\r\n}\r\n\r\nexport function usePositionsForOrders(chainId, library, orders) {\r\n  const key = orders ? orders.map((order) => getOrderKey(order) + \"____\") : null;\r\n  const { data: positions = {} } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const data = await Promise.all(\r\n      orders.map(async (order) => {\r\n        try {\r\n          const position = await contract.getPosition(\r\n            order.account,\r\n            order.collateralToken,\r\n            order.indexToken,\r\n            order.isLong\r\n          );\r\n          if (position[0].eq(0)) {\r\n            return [null, order];\r\n          }\r\n          return [position, order];\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n    return data.reduce((memo, [position, order]) => {\r\n      memo[getOrderKey(order)] = position;\r\n      return memo;\r\n    }, {});\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nfunction invariant(condition, errorMsg) {\r\n  if (!condition) {\r\n    throw new Error(errorMsg);\r\n  }\r\n}\r\n\r\nexport function useTrades(chainId, account, forSingleAccount, afterId) {\r\n  let url =\r\n    account && account.length > 0\r\n      ? `${getServerBaseUrl(chainId)}/actions?account=${account}`\r\n      : !forSingleAccount && `${getServerBaseUrl(chainId)}/actions`;\r\n\r\n  if (afterId && afterId.length > 0) {\r\n    const urlItem = new URL(url);\r\n    urlItem.searchParams.append(\"after\", afterId);\r\n    url = urlItem.toString();\r\n  }\r\n\r\n  const { data: trades, mutate: updateTrades } = useSWR(url && url, {\r\n    dedupingInterval: 10000,\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n  });\r\n\r\n  \r\n\r\n  if (trades) {\r\n    trades.sort((item0, item1) => {\r\n      const data0 = item0.data;\r\n      const data1 = item1.data;\r\n      const time0 = parseInt(data0.timestamp);\r\n      const time1 = parseInt(data1.timestamp);\r\n      if (time1 > time0) {\r\n        return 1;\r\n      }\r\n      if (time1 < time0) {\r\n        return -1;\r\n      }\r\n\r\n      const block0 = parseInt(data0.blockNumber);\r\n      const block1 = parseInt(data1.blockNumber);\r\n\r\n      if (isNaN(block0) && isNaN(block1)) {\r\n        return 0;\r\n      }\r\n\r\n      if (isNaN(block0)) {\r\n        return 1;\r\n      }\r\n\r\n      if (isNaN(block1)) {\r\n        return -1;\r\n      }\r\n\r\n      if (block1 > block0) {\r\n        return 1;\r\n      }\r\n\r\n      if (block1 < block0) {\r\n        return -1;\r\n      }\r\n\r\n      return 0;\r\n    });\r\n  }\r\n\r\n  return { trades, updateTrades };\r\n}\r\n\r\nexport function useMinExecutionFee(library, active, chainId, infoTokens) {\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n    fetcher: fetcher(library, PositionRouter),\r\n  });\r\n\r\n  const { data: gasPrice } = useSWR([\"gasPrice\", chainId], {\r\n    fetcher: () => {\r\n      return new Promise(async (resolve, reject) => {\r\n        const provider = getProvider(library, chainId);\r\n        if (!provider) {\r\n          resolve(undefined);\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const gasPrice = await provider.getGasPrice();\r\n          resolve(gasPrice);\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      });\r\n    },\r\n  });\r\n\r\n  let multiplier;\r\n\r\n  // if gas prices on Arbitrum are high, the main transaction costs would come from the L2 gas usage\r\n  // for executing positions this is around 65,000 gas\r\n  // if gas prices on Ethereum are high, than the gas usage might be higher, this calculation doesn't deal with that\r\n  // case yet\r\n  if (chainId === ARBITRUM || chainId === ARBITRUM_TESTNET) {\r\n    multiplier = 65000;\r\n  }\r\n\r\n  // multiplier for Avalanche is just the average gas usage\r\n  if (chainId === AVALANCHE) {\r\n    multiplier = 700000;\r\n  }\r\n\r\n  let finalExecutionFee = minExecutionFee;\r\n\r\n  if (gasPrice && minExecutionFee) {\r\n    const estimatedExecutionFee = gasPrice.mul(multiplier);\r\n    if (estimatedExecutionFee.gt(minExecutionFee)) {\r\n      finalExecutionFee = estimatedExecutionFee;\r\n    }\r\n  }\r\n\r\n  const finalExecutionFeeUSD = getUsd(finalExecutionFee, nativeTokenAddress, false, infoTokens);\r\n  const isFeeHigh = finalExecutionFeeUSD?.gt(expandDecimals(getHighExecutionFee(chainId), USD_DECIMALS));\r\n  const errorMessage =\r\n    isFeeHigh &&\r\n    `The network cost to send transactions is high at the moment, please check the \"Execution Fee\" value before proceeding.`;\r\n\r\n  return {\r\n    minExecutionFee: finalExecutionFee,\r\n    minExecutionFeeUSD: finalExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage: errorMessage,\r\n  };\r\n}\r\n\r\nexport function useStakedGmxSupply(library, active) {\r\n  const gmxAddressArb = getContract(ARBITRUM, \"GMX\");\r\n  const stakedGmxTrackerAddressArb = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n\r\n  const { data: arbData, mutate: arbMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, ARBITRUM, gmxAddressArb, \"balanceOf\", stakedGmxTrackerAddressArb],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const gmxAddressAvax = getContract(AVALANCHE, \"GMX\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n\r\n  const { data: avaxData, mutate: avaxMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, AVALANCHE, gmxAddressAvax, \"balanceOf\", stakedGmxTrackerAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  let data;\r\n  if (arbData && avaxData) {\r\n    data = arbData.add(avaxData);\r\n  }\r\n\r\n  const mutate = () => {\r\n    arbMutate();\r\n    avaxMutate();\r\n  };\r\n\r\n  return { data, mutate };\r\n}\r\n\r\nexport function useHasOutdatedUi() {\r\n  const url = getServerUrl(ARBITRUM, \"/ui_version\");\r\n  const { data, mutate } = useSWR([url], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  let hasOutdatedUi = false;\r\n\r\n  if (data && parseFloat(data) > parseFloat(UI_VERSION)) {\r\n    // hasOutdatedUi = true;\r\n    hasOutdatedUi = false;\r\n  }\r\n\r\n  return { data: hasOutdatedUi, mutate };\r\n}\r\n\r\nexport function useGmxPrice(chainId, libraries, active) {\r\n  const arbitrumLibrary = libraries && libraries.arbitrum ? libraries.arbitrum : undefined;\r\n  const { data: gmxPriceFromArbitrum, mutate: mutateFromArbitrum } = useGmxPriceFromArbitrum(arbitrumLibrary, active);\r\n  const { data: gmxPriceFromAvalanche, mutate: mutateFromAvalanche } = useGmxPriceFromAvalanche();\r\n\r\n  const gmxPrice = chainId === ARBITRUM ? gmxPriceFromArbitrum : gmxPriceFromAvalanche;\r\n  const mutate = useCallback(() => {\r\n    mutateFromAvalanche();\r\n    mutateFromArbitrum();\r\n  }, [mutateFromAvalanche, mutateFromArbitrum]);\r\n\r\n  return {\r\n    gmxPrice,\r\n    gmxPriceFromArbitrum,\r\n    gmxPriceFromAvalanche,\r\n    mutate,\r\n  };\r\n}\r\n\r\n// use only the supply endpoint on arbitrum, it includes the supply on avalanche\r\nexport function useTotalGmxSupply() {\r\n  const gmxSupplyUrlArbitrum = getServerUrl(ARBITRUM, \"/gmx_supply\");\r\n\r\n  const { data: gmxSupply, mutate: updateGmxSupply } = useSWR([gmxSupplyUrlArbitrum], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  return {\r\n    total: gmxSupply ? bigNumberify(gmxSupply) : undefined,\r\n    mutate: updateGmxSupply,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxStaked() {\r\n  const stakedGmxTrackerAddressArbitrum = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n  let totalStakedGmx = useRef(bigNumberify(0));\r\n  const { data: stakedGmxSupplyArbitrum, mutate: updateStakedGmxSupplyArbitrum } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${ARBITRUM}`,\r\n      ARBITRUM,\r\n      getContract(ARBITRUM, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressArbitrum,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: stakedGmxSupplyAvax, mutate: updateStakedGmxSupplyAvax } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${AVALANCHE}`,\r\n      AVALANCHE,\r\n      getContract(AVALANCHE, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressAvax,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  const mutate = useCallback(() => {\r\n    updateStakedGmxSupplyArbitrum();\r\n    updateStakedGmxSupplyAvax();\r\n  }, [updateStakedGmxSupplyArbitrum, updateStakedGmxSupplyAvax]);\r\n\r\n  if (stakedGmxSupplyArbitrum && stakedGmxSupplyAvax) {\r\n    let total = bigNumberify(stakedGmxSupplyArbitrum).add(stakedGmxSupplyAvax);\r\n    totalStakedGmx.current = total;\r\n  }\r\n\r\n  return {\r\n    avax: stakedGmxSupplyAvax,\r\n    arbitrum: stakedGmxSupplyArbitrum,\r\n    total: totalStakedGmx.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxInLiquidity() {\r\n  let poolAddressArbitrum = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  let poolAddressAvax = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n  let totalGMX = useRef(bigNumberify(0));\r\n\r\n  const { data: gmxInLiquidityOnArbitrum, mutate: mutateGMXInLiquidityOnArbitrum } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${ARBITRUM}`, ARBITRUM, getContract(ARBITRUM, \"GMX\"), \"balanceOf\", poolAddressArbitrum],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: gmxInLiquidityOnAvax, mutate: mutateGMXInLiquidityOnAvax } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${AVALANCHE}`, AVALANCHE, getContract(AVALANCHE, \"GMX\"), \"balanceOf\", poolAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const mutate = useCallback(() => {\r\n    mutateGMXInLiquidityOnArbitrum();\r\n    mutateGMXInLiquidityOnAvax();\r\n  }, [mutateGMXInLiquidityOnArbitrum, mutateGMXInLiquidityOnAvax]);\r\n\r\n  if (gmxInLiquidityOnAvax && gmxInLiquidityOnArbitrum) {\r\n    let total = bigNumberify(gmxInLiquidityOnArbitrum).add(gmxInLiquidityOnAvax);\r\n    totalGMX.current = total;\r\n  }\r\n  return {\r\n    avax: gmxInLiquidityOnAvax,\r\n    arbitrum: gmxInLiquidityOnArbitrum,\r\n    total: totalGMX.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nfunction useGmxPriceFromAvalanche() {\r\n  const poolAddress = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n\r\n  const { data, mutate: updateReserves } = useSWR([\"TraderJoeGmxAvaxReserves\", AVALANCHE, poolAddress, \"getReserves\"], {\r\n    fetcher: fetcher(undefined, UniswapV2),\r\n  });\r\n  const { _reserve0: gmxReserve, _reserve1: avaxReserve } = data || {};\r\n\r\n  const vaultAddress = getContract(AVALANCHE, \"Vault\");\r\n  const avaxAddress = getTokenBySymbol(AVALANCHE, \"WAVAX\").address;\r\n  const { data: avaxPrice, mutate: updateAvaxPrice } = useSWR(\r\n    [`StakeV2:avaxPrice`, AVALANCHE, vaultAddress, \"getMinPrice\", avaxAddress],\r\n    {\r\n      fetcher: fetcher(undefined, Vault),\r\n    }\r\n  );\r\n\r\n  const PRECISION = bigNumberify(10).pow(18);\r\n  let gmxPrice;\r\n  if (avaxReserve && gmxReserve && avaxPrice) {\r\n    gmxPrice = avaxReserve.mul(PRECISION).div(gmxReserve).mul(avaxPrice).div(PRECISION);\r\n  }\r\n\r\n  const mutate = useCallback(() => {\r\n    updateReserves(undefined, true);\r\n    updateAvaxPrice(undefined, true);\r\n  }, [updateReserves, updateAvaxPrice]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nfunction useGmxPriceFromArbitrum(library, active) {\r\n  const poolAddress = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  const { data: uniPoolSlot0, mutate: updateUniPoolSlot0 } = useSWR(\r\n    [`StakeV2:uniPoolSlot0:${active}`, ARBITRUM, poolAddress, \"slot0\"],\r\n    {\r\n      fetcher: fetcher(library, UniPool),\r\n    }\r\n  );\r\n\r\n  const vaultAddress = getContract(ARBITRUM, \"Vault\");\r\n  const ethAddress = getTokenBySymbol(ARBITRUM, \"WETH\").address;\r\n  const { data: ethPrice, mutate: updateEthPrice } = useSWR(\r\n    [`StakeV2:ethPrice:${active}`, ARBITRUM, vaultAddress, \"getMinPrice\", ethAddress],\r\n    {\r\n      fetcher: fetcher(library, Vault),\r\n    }\r\n  );\r\n\r\n  const gmxPrice = useMemo(() => {\r\n    if (uniPoolSlot0 && ethPrice) {\r\n      const tokenA = new UniToken(ARBITRUM, ethAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const gmxAddress = getContract(ARBITRUM, \"GMX\");\r\n      const tokenB = new UniToken(ARBITRUM, gmxAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const pool = new Pool(\r\n        tokenA, // tokenA\r\n        tokenB, // tokenB\r\n        10000, // fee\r\n        uniPoolSlot0.sqrtPriceX96, // sqrtRatioX96\r\n        1, // liquidity\r\n        uniPoolSlot0.tick, // tickCurrent\r\n        []\r\n      );\r\n\r\n      const poolTokenPrice = pool.priceOf(tokenB).toSignificant(6);\r\n      const poolTokenPriceAmount = parseValue(poolTokenPrice, 18);\r\n      return poolTokenPriceAmount.mul(ethPrice).div(expandDecimals(1, 18));\r\n    }\r\n  }, [ethPrice, uniPoolSlot0, ethAddress]);\r\n\r\n  const mutate = useCallback(() => {\r\n    updateUniPoolSlot0(undefined, true);\r\n    updateEthPrice(undefined, true);\r\n  }, [updateEthPrice, updateUniPoolSlot0]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nexport async function approvePlugin(\r\n  chainId,\r\n  pluginAddress,\r\n  { library, pendingTxns, setPendingTxns, sentMsg, failMsg }\r\n) {\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const contract = new ethers.Contract(routerAddress, Router.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"approvePlugin\", [pluginAddress], {\r\n    sentMsg,\r\n    failMsg,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function createSwapOrder(\r\n  chainId,\r\n  library,\r\n  path,\r\n  amountIn,\r\n  minOut,\r\n  triggerRatio,\r\n  nativeTokenAddress,\r\n  opts = {}\r\n) {\r\n  const executionFee = getConstant(chainId, \"SWAP_ORDER_EXECUTION_GAS_FEE\");\r\n  const triggerAboveThreshold = false;\r\n  let shouldWrap = false;\r\n  let shouldUnwrap = false;\r\n  opts.value = executionFee;\r\n\r\n  if (path[0] === AddressZero) {\r\n    shouldWrap = true;\r\n    opts.value = opts.value.add(amountIn);\r\n  }\r\n  if (path[path.length - 1] === AddressZero) {\r\n    shouldUnwrap = true;\r\n  }\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n\r\n  const params = [path, amountIn, minOut, triggerRatio, triggerAboveThreshold, executionFee, shouldWrap, shouldUnwrap];\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createSwapOrder\", params, opts);\r\n}\r\n\r\nexport async function createIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  nativeTokenAddress,\r\n  path,\r\n  amountIn,\r\n  indexTokenAddress,\r\n  minOut,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  isLong,\r\n  triggerPrice,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const fromETH = path[0] === AddressZero;\r\n\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n  const shouldWrap = fromETH;\r\n  const triggerAboveThreshold = !isLong;\r\n  const executionFee = getConstant(chainId, \"INCREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    path,\r\n    amountIn,\r\n    indexTokenAddress,\r\n    minOut,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n    executionFee,\r\n    shouldWrap,\r\n  ];\r\n\r\n  if (!opts.value) {\r\n    opts.value = fromETH ? amountIn.add(executionFee) : executionFee;\r\n  }\r\n\r\n  // const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  // const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createIncreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function createDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  indexTokenAddress,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  collateralDelta,\r\n  isLong,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const executionFee = getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    indexTokenAddress,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    collateralDelta,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n    executionFee,\r\n  ];\r\n  opts.value = executionFee;\r\n  // const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  // const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createDecreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function cancelSwapOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelDecreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelDecreaseOrder\";\r\n  // const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  // const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelIncreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelIncreaseOrder\";\r\n  // const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  // const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function handleCancelOrder(chainId, library, order, opts) {\r\n  let func;\r\n  if (order.type === SWAP) {\r\n    func = cancelSwapOrder;\r\n  } else if (order.type === INCREASE) {\r\n    func = cancelIncreaseOrder;\r\n  } else if (order.type === DECREASE) {\r\n    func = cancelDecreaseOrder;\r\n  }\r\n\r\n  return func(chainId, library, order.index, {\r\n    successMsg: \"Order cancelled.\",\r\n    failMsg: \"Cancel failed.\",\r\n    sentMsg: \"Cancel submitted.\",\r\n    pendingTxns: opts.pendingTxns,\r\n    setPendingTxns: opts.setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function cancelMultipleOrders(chainId, library, allIndexes = [], opts) {\r\n  const ordersWithTypes = groupBy(allIndexes, (v) => v.split(\"-\")[0]);\r\n  function getIndexes(key) {\r\n    if (!ordersWithTypes[key]) return;\r\n    return ordersWithTypes[key].map((d) => d.split(\"-\")[1]);\r\n  }\r\n  // params order => swap, increase, decrease\r\n  const params = [\"Swap\", \"Increase\", \"Decrease\"].map((key) => getIndexes(key) || []);\r\n  const method = \"cancelMultiple\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  collateralDelta,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, collateralDelta, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateDecreaseOrder\";\r\n  // const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  // const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateIncreaseOrder\";\r\n  // const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  // const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateSwapOrder(chainId, library, index, minOut, triggerRatio, triggerAboveThreshold, opts) {\r\n  const params = [index, minOut, triggerRatio, triggerAboveThreshold];\r\n  const method = \"updateSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function _executeOrder(chainId, library, method, account, index, feeReceiver, opts) {\r\n  const params = [account, index, feeReceiver];\r\n  const positionManagerAddress = getContract(chainId, \"PositionManager\");\r\n  const contract = new ethers.Contract(positionManagerAddress, PositionManager.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function executeSwapOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeSwapOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeIncreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeIncreaseOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeDecreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeDecreaseOrder\", account, index, feeReceiver, opts);\r\n}\r\n","import React from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Checkbox.scss\";\r\nimport { ImCheckboxUnchecked, ImCheckboxChecked } from \"react-icons/im\";\r\n\r\nexport default function Checkbox(props) {\r\n  const { isChecked, setIsChecked, disabled, className } = props;\r\n\r\n  return (\r\n    <div\r\n      className={cx(\"Checkbox\", { disabled, selected: isChecked }, className)}\r\n      onClick={() => setIsChecked(!isChecked)}\r\n    >\r\n      <span className=\"Checkbox-icon-wrapper\">\r\n        {isChecked && <ImCheckboxChecked className=\"App-icon Checkbox-icon active\" />}\r\n        {!isChecked && <ImCheckboxUnchecked className=\"App-icon Checkbox-icon inactive\" />}\r\n      </span>\r\n      <span className=\"Checkbox-label\">{props.children}</span>\r\n    </div>\r\n  );\r\n}\r\n","export const REDIRECT_POPUP_TIMESTAMP_KEY = \"redirect-popup-timestamp\";\r\n\r\nexport const IS_TOUCH = \"ontouchstart\" in window;\r\n","import cx from \"classnames\";\r\nimport { useCallback, useState, useRef } from \"react\";\r\nimport { IS_TOUCH } from \"../../config/ui\";\r\n\r\nconst OPEN_DELAY = 0;\r\nconst CLOSE_DELAY = 100;\r\n\r\nexport default function Tooltip(props) {\r\n  const { enabled } = props;\r\n  const [visible, setVisible] = useState(false);\r\n  const intervalCloseRef = useRef(null);\r\n  const intervalOpenRef = useRef(null);\r\n\r\n  const position = props.position ?? \"left-bottom\";\r\n  const trigger = props.trigger ?? \"hover\";\r\n\r\n  const onMouseEnter = useCallback(() => {\r\n    if (trigger !== \"hover\" || IS_TOUCH) return;\r\n\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (!intervalOpenRef.current) {\r\n      intervalOpenRef.current = setTimeout(() => {\r\n        if (enabled) {\r\n          setVisible(true)\r\n        }\r\n        intervalOpenRef.current = null;\r\n      }, OPEN_DELAY);\r\n    }\r\n  }, [setVisible, intervalCloseRef, intervalOpenRef, trigger]);\r\n\r\n  const onMouseClick = useCallback(() => {\r\n    if (trigger !== \"click\" && !IS_TOUCH) return;\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n\r\n    if (enabled) {\r\n      setVisible(true)\r\n    }\r\n  }, [setVisible, intervalCloseRef, trigger]);\r\n\r\n  const onMouseLeave = useCallback(() => {\r\n    intervalCloseRef.current = setTimeout(() => {\r\n      setVisible(false);\r\n      intervalCloseRef.current = null;\r\n    }, CLOSE_DELAY);\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n  }, [setVisible, intervalCloseRef]);\r\n\r\n  const className = cx(\"Tooltip\", props.className);\r\n\r\n  return (\r\n    <span className={className} style={props.style} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} onClick={onMouseClick} id={props.id}>\r\n      <span\r\n        className={cx({ \"Tooltip-handle\": !props.disableHandleStyle }, [props.handleClassName], { active: visible })}\r\n      >\r\n        {props.handle}\r\n      </span>\r\n      {visible && <div className={cx([\"Tooltip-popup\", position])}>{props.renderContent()}</div>}\r\n    </span>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Tab.css\";\r\nimport Tooltip from './../Tooltip/Tooltip';\r\n\r\nexport default function Tab(props) {\r\n  const { options, option, setOption, onChange, type = \"block\", className, optionLabels, icons, disabled, disabledTooltip } = props;\r\n  \r\n  const onClick = (opt) => {\r\n    if (disabled) {\r\n      return;\r\n    }\r\n    \r\n    if (setOption) {\r\n      setOption(opt);\r\n    }\r\n    if (onChange) {\r\n      onChange(opt);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cx(\"Tab\", type, className, disabled ? 'disabled' : '')}>\r\n      {options.map((opt) => {\r\n        const label = optionLabels && optionLabels[opt] ? optionLabels[opt] : opt;\r\n        let disabledNode;\r\n        \r\n        if (props.disabledList) {\r\n          props.disabledList.forEach(el => {\r\n            if (el.label === label && el.disabled) {\r\n              disabledNode = (\r\n                <div className={cx(\"Tab-option\", \"tab-tooltip-container\")} onClick={() => {return}} key={opt}>\r\n                  {disabledTooltip}\r\n                  {icons && icons[opt] && <img className=\"Tab-option-icon\" src={opt === option ? icons[opt + '_active'] : icons[opt]} alt={option} />}\r\n                  {label}\r\n                </div>\r\n              );\r\n            }\r\n          })\r\n        }\r\n\r\n        if (disabledNode) {\r\n          return disabledNode;\r\n        }\r\n        \r\n        return (\r\n          <div className={cx(\"Tab-option\", \"muted\", { active: opt === option })} onClick={() => onClick(opt)} key={opt}>\r\n            {icons && icons[opt] && <img className=\"Tab-option-icon\" src={opt === option ? icons[opt + '_active'] : icons[opt]} alt={option} />}\r\n            {label}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import { disableBodyScroll, enableBodyScroll, clearAllBodyScrollLocks } from \"body-scroll-lock\";\r\nimport { RefObject, useEffect } from \"react\";\r\n\r\nexport const TOUCH_MOVE_CONTAINER_CLASS_NAME = \"DiableScroll-touch-move-container\";\r\n\r\n// @see https://github.com/willmcpo/body-scroll-lock#allowtouchmove\r\nconst allowTouchMoveFn = (el: HTMLElement) => {\r\n  while (el && el !== document.body) {\r\n    if (el.className?.includes?.(TOUCH_MOVE_CONTAINER_CLASS_NAME)) return true;\r\n\r\n    el = el.parentElement as HTMLElement;\r\n  }\r\n};\r\n\r\nexport default function useLockBodyScroll(\r\n  ref: RefObject<HTMLElement>,\r\n  isVisible: boolean,\r\n  opts: {\r\n    disableLock?: boolean;\r\n    allowTouchMove?: boolean;\r\n  } = {}\r\n) {\r\n  useEffect(() => {\r\n    if (opts.disableLock) {\r\n      return;\r\n    }\r\n\r\n    if (ref.current) {\r\n      if (isVisible) {\r\n        disableBodyScroll(ref.current, {\r\n          allowTouchMove: opts.allowTouchMove ? allowTouchMoveFn : undefined,\r\n        });\r\n      } else {\r\n        enableBodyScroll(ref.current);\r\n      }\r\n    }\r\n\r\n    return () => clearAllBodyScrollLocks();\r\n\r\n    // needs ref.current in deps, not just ref\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [ref.current, opts.allowTouchMove, opts.disableLock, isVisible]);\r\n}\r\n","import React, { useRef, useEffect, useState } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\nimport { MdClose } from \"react-icons/md\";\r\n\r\nimport \"./Modal.scss\";\r\nimport useLockBodyScroll, { TOUCH_MOVE_CONTAINER_CLASS_NAME } from \"../../lib/useLockBodyScroll\";\r\n\r\nexport default function Modal(props) {\r\n  const { isVisible, setIsVisible, className, zIndex, onAfterOpen, disableBodyScrollLock, allowContentTouchMove, isNifty } =\r\n    props;\r\n\r\n  const modalRef = useRef(null);\r\n\r\n  const [isActive, setIsActive] = useState(isVisible);\r\n\r\n  function closeModal() {\r\n    setIsVisible(false);\r\n  }\r\n\r\n  useLockBodyScroll(modalRef, isVisible, {\r\n    disableLock: false,\r\n    allowTouchMove: allowContentTouchMove,\r\n  });\r\n\r\n\r\n  useEffect(() => {\r\n    function close(e) {\r\n      if (e.keyCode === 27) {\r\n        setIsVisible(false);\r\n      }\r\n    }\r\n    window.addEventListener(\"keydown\", close);\r\n    return () => window.removeEventListener(\"keydown\", close);\r\n  }, [setIsVisible]);\r\n\r\n  useEffect(() => {\r\n    if (typeof onAfterOpen === \"function\") onAfterOpen();\r\n  }, [onAfterOpen]);\r\n\r\n  const fadeVariants = {\r\n    hidden: { opacity: 0, visibility: 'hidden' },\r\n    visible: { opacity: 1, visibility: 'visible' },\r\n  };\r\n  const niftyFadeVariants = {\r\n    hidden: {\r\n      transform: 'rotateX(-60deg)',\r\n      opacity: 0,\r\n    },\r\n    visible: {\r\n      transform: 'rotateX(0)',\r\n      opacity: 1,\r\n    }\r\n  }\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isVisible && (\r\n        <motion.div\r\n          className={cx(\"Modal\", isNifty && \"Modal_nifty\", isNifty && isActive && \"active\", className)}\r\n          style={{ zIndex }}\r\n          initial=\"hidden\"\r\n          animate=\"visible\"\r\n          exit=\"hidden\"\r\n          variants={fadeVariants}\r\n          transition={{ duration: 0 }}\r\n        >\r\n          <div\r\n            className=\"Modal-backdrop\"\r\n            style={{\r\n              overflow: isVisible ? \"hidden\" : \"visible\",\r\n              position: \"fixed\",\r\n            }}\r\n            onClick={closeModal}\r\n          ></div>\r\n\r\n          {isNifty && (\r\n            <div className=\"Modal-close-button\" onClick={closeModal}>\r\n              <MdClose fontSize={20} className=\"Modal-close-icon\" />\r\n            </div>\r\n          )}\r\n          \r\n\r\n          <div className={isNifty && \"Modal-content-wrapper\"}>\r\n            <motion.div\r\n              className={cx(\"Modal-content\")}\r\n              style={{ transformStyle: 'preserve-3d', transformOrigin: '50% 0' }}\r\n              initial=\"hidden\"\r\n              animate=\"visible\"\r\n              exit=\"hidden\"\r\n              variants={isNifty && niftyFadeVariants}\r\n              transition={{ duration: 0 }}\r\n            >\r\n              <div className=\"Modal-title-bar\">\r\n                <div className=\"Modal-title\">{props.label}</div>\r\n              </div>\r\n              <div className=\"divider\" />\r\n              <div className={cx(\"Modal-body\", TOUCH_MOVE_CONTAINER_CLASS_NAME)} ref={modalRef}>\r\n                {props.children}\r\n              </div>\r\n            </motion.div>\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n","import { useEffect, useMemo } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\nexport default function Portal({ children }) {\r\n  const root = document.body;\r\n\r\n  const el = useMemo(() => document.createElement(\"div\"), []);\r\n\r\n  useEffect(() => {\r\n    root.appendChild(el);\r\n    return () => root.removeChild(el);\r\n  }, [root, el]);\r\n\r\n  return createPortal(children, el);\r\n}\r\n","import { useCallback, useRef, useState } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Tooltip.scss\";\r\nimport { IS_TOUCH } from \"../../config/ui\";\r\nimport Portal from \"../Common/Portal\";\r\n\r\nconst OPEN_DELAY = 0;\r\nconst CLOSE_DELAY = 100;\r\n\r\nexport default function TooltipWithPortal(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [coords, setCoords] = useState({});\r\n  const [tooltipWidth, setTooltipWidth] = useState();\r\n  const intervalCloseRef = useRef(null);\r\n  const intervalOpenRef = useRef(null);\r\n\r\n  const position = props.position ?? \"left-bottom\";\r\n  const trigger = props.trigger ?? \"hover\";\r\n  const handlerRef = useRef();\r\n\r\n  const updateTooltipCoords = useCallback(() => {\r\n    const rect = handlerRef.current.getBoundingClientRect();\r\n\r\n    setCoords({\r\n      height: rect.height,\r\n      width: rect.width,\r\n      left: rect.x,\r\n      top: rect.y + window.scrollY,\r\n    });\r\n\r\n    if (props.fitHandleWidth) {\r\n      setTooltipWidth(`${rect.width}px`);\r\n    }\r\n  }, [handlerRef, props.fitHandleWidth]);\r\n\r\n  const onMouseEnter = useCallback(() => {\r\n    if (trigger !== \"hover\" || IS_TOUCH) return;\r\n\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (!intervalOpenRef.current) {\r\n      intervalOpenRef.current = setTimeout(() => {\r\n        setVisible(true);\r\n        intervalOpenRef.current = null;\r\n      }, OPEN_DELAY);\r\n    }\r\n    updateTooltipCoords();\r\n  }, [setVisible, intervalCloseRef, intervalOpenRef, trigger, updateTooltipCoords]);\r\n\r\n  const onMouseClick = useCallback(() => {\r\n    if (trigger !== \"click\" && !IS_TOUCH) return;\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n    updateTooltipCoords();\r\n\r\n    if (props.closeOnDoubleClick) {\r\n      setVisible((old) => !old);\r\n    } else {\r\n      setVisible(true);\r\n    }\r\n  }, [setVisible, intervalCloseRef, trigger, updateTooltipCoords, props.closeOnDoubleClick]);\r\n\r\n  const onMouseLeave = useCallback(() => {\r\n    intervalCloseRef.current = setTimeout(() => {\r\n      setVisible(false);\r\n      intervalCloseRef.current = null;\r\n    }, CLOSE_DELAY);\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n    updateTooltipCoords();\r\n  }, [setVisible, intervalCloseRef, updateTooltipCoords]);\r\n\r\n  const className = cx(\"Tooltip\", props.className);\r\n\r\n  return (\r\n    <span className={className} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} onClick={onMouseClick}>\r\n      <span\r\n        className={cx({ \"Tooltip-handle\": !props.disableHandleStyle }, [props.handleClassName], { active: visible })}\r\n        ref={handlerRef}\r\n      >\r\n        {props.handle}\r\n      </span>\r\n      {visible && coords.left && (\r\n        <Portal>\r\n          <div style={{ ...coords, position: \"absolute\" }}>\r\n            <div className={cx([\"Tooltip-popup\", position])} style={{ width: tooltipWidth }}>\r\n              {props.renderContent()}\r\n            </div>\r\n          </div>\r\n        </Portal>\r\n      )}\r\n    </span>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { formatAmount, expandDecimals, bigNumberify } from \"../../lib/legacy\";\r\n\r\nimport { getToken } from \"../../config/Tokens\";\r\n\r\n// import { BiChevronDown } from \"react-icons/bi\";\r\n\r\nimport Modal from \"../Modal/Modal\";\r\n\r\nimport dropDownIcon from \"../../img/DROP_DOWN.svg\";\r\nimport \"./TokenSelector.scss\";\r\nimport TooltipWithPortal from \"../Tooltip/TooltipWithPortal\";\r\n\r\nexport default function TokenSelector(props) {\r\n  \r\n  const [isModalVisible, setIsModalVisible] = useState(false);\r\n  const [searchKeyword, setSearchKeyword] = useState(\"\");\r\n  const tokenInfo = getToken(props.chainId, props.tokenAddress);\r\n  const {\r\n    tokens,\r\n    mintingCap,\r\n    infoTokens,\r\n    showMintingCap,\r\n    disabled,\r\n    selectedTokenLabel,\r\n    showBalances = true,\r\n    showTokenImgInDropdown = false,\r\n    showSymbolImage = false,\r\n    showNewCaret = false,\r\n    getTokenState = () => ({ disabled: false, message: null }),\r\n    disableBodyScrollLock,\r\n  } = props;\r\n\r\n  const visibleTokens = tokens.filter((t) => !t.isTempHidden);\r\n\r\n  const onSelectToken = (token) => {\r\n    setIsModalVisible(false);\r\n    props.onSelectToken(token);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isModalVisible) {\r\n      setSearchKeyword(\"\");\r\n    }\r\n  }, [isModalVisible]);\r\n\r\n  if (!tokenInfo) {\r\n    return null;\r\n  }\r\n\r\n  var tokenImage = null;\r\n\r\n  try {\r\n    tokenImage = require(\"../../img/ic_\" + tokenInfo.symbol.toLowerCase() + \"_24.svg\");\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n\r\n  const onSearchKeywordChange = (e) => {\r\n    setSearchKeyword(e.target.value);\r\n  };\r\n\r\n  const filteredTokens = visibleTokens.filter((item) => {\r\n    return (\r\n      item.name.toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1 ||\r\n      item.symbol.toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1\r\n    );\r\n  });\r\n\r\n  const _handleKeyDown = (e) => {\r\n    if (e.key === \"Enter\" && filteredTokens.length > 0) {\r\n      onSelectToken(filteredTokens[0]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cx(\"TokenSelector\", { disabled }, props.className) + (isModalVisible ? ' opened' : '')}>\r\n      <Modal\r\n        disableBodyScrollLock={disableBodyScrollLock}\r\n        isVisible={isModalVisible}\r\n        setIsVisible={setIsModalVisible}\r\n        label={props.label}\r\n      >\r\n        <div className=\"TokenSelector-tokens\">\r\n          {/* <div className=\"TokenSelector-token-row TokenSelector-token-input-row\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search Token\"\r\n              value={searchKeyword}\r\n              onChange={(e) => onSearchKeywordChange(e)}\r\n              onKeyDown={_handleKeyDown}\r\n              autoFocus\r\n            />\r\n          </div> */}\r\n          {filteredTokens.map((token, tokenIndex) => {\r\n            let tokenPopupImage;\r\n            try {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_\" + token.symbol.toLowerCase() + \"_40.svg\");\r\n            } catch (error) {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_eth_40.svg\");\r\n            }\r\n            let info = infoTokens ? infoTokens[token.address] : {};\r\n            let mintAmount;\r\n            let balance = info.balance;\r\n            if (showMintingCap && mintingCap && info.usdgAmount) {\r\n              mintAmount = mintingCap.sub(info.usdgAmount);\r\n            }\r\n            if (mintAmount && mintAmount.lt(0)) {\r\n              mintAmount = bigNumberify(0);\r\n            }\r\n            let balanceUsd;\r\n            if (balance && info.maxPrice) {\r\n              balanceUsd = balance.mul(info.maxPrice).div(expandDecimals(1, token.decimals));\r\n            }\r\n\r\n            const tokenState = getTokenState(info) || {};\r\n\r\n            return (\r\n              <div\r\n                key={token.address}\r\n                className={cx(\"TokenSelector-token-row\", token.symbol === tokenInfo?.symbol ? 'chosen' : '' , { disabled: tokenState.disabled })}\r\n                onClick={() => !tokenState.disabled && onSelectToken(token)}\r\n              >\r\n                {tokenState.disabled && tokenState.message && (\r\n                  <TooltipWithPortal\r\n                    className=\"TokenSelector-tooltip\"\r\n                    portalClassName=\"TokenSelector-tooltip-portal\"\r\n                    handle={<div className=\"TokenSelector-tooltip-backing\" />}\r\n                    position={tokenIndex < filteredTokens.length / 2 ? \"center-bottom\" : \"center-top\"}\r\n                    disableHandleStyle\r\n                    closeOnDoubleClick\r\n                    fitHandleWidth\r\n                    renderContent={() => tokenState.message}\r\n                  />\r\n                )}\r\n                <div className=\"Token-info\">\r\n                  {showTokenImgInDropdown && (\r\n                    <img src={tokenPopupImage?.default} alt={token.name} className=\"token-logo\" />\r\n                  )}\r\n                  <div className=\"Token-symbol\">\r\n                    <div className=\"Token-text\">{token.symbol}</div>\r\n                    {/* <span className=\"text-accent\">{token.name}</span> */}\r\n                  </div>\r\n                </div>\r\n                {/* <div className=\"Token-balance\">\r\n                  {showBalances && balance && (\r\n                    <div className=\"Token-text\">\r\n                      {balance.gt(0) && formatAmount(balance, token.decimals, 4, true)}\r\n                      {balance.eq(0) && \"-\"}\r\n                    </div>\r\n                  )}\r\n                  <span className=\"text-accent\">\r\n                    {mintAmount && <div>Mintable: {formatAmount(mintAmount, token.decimals, 2, true)} USDG</div>}\r\n                    {showMintingCap && !mintAmount && <div>-</div>}\r\n                    {!showMintingCap && showBalances && balanceUsd && balanceUsd.gt(0) && (\r\n                      <div>${formatAmount(balanceUsd, 30, 2, true)}</div>\r\n                    )}\r\n                  </span>\r\n                </div> */}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </Modal>\r\n      {selectedTokenLabel ? (\r\n        <div className=\"TokenSelector-box\" onClick={(e) => {\r\n          setIsModalVisible(true)\r\n        }}>\r\n          {selectedTokenLabel}\r\n          {!showNewCaret && \r\n            <svg className=\"TokenSelector-caret\" xmlns=\"http://www.w3.org/2000/svg\" width=\"13\" height=\"13\" viewBox=\"0 0 13 13\" fill=\"none\">\r\n              <path d=\"M2.60001 4.76666L7.10001 8.76666L11.6 4.76666\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n          </svg>\r\n          }\r\n        </div>\r\n      ) : (\r\n        <div className=\"TokenSelector-box\" onClick={(e) => {\r\n          setIsModalVisible(true)\r\n        }}>\r\n          {tokenInfo.symbol}\r\n          {showSymbolImage && (\r\n            <img src={tokenImage && tokenImage.default} alt={tokenInfo.symbol} className=\"TokenSelector-box-symbol\" />\r\n          )}\r\n          {showNewCaret && <img src={dropDownIcon} alt=\"dropDownIcon\" className=\"TokenSelector-box-caret\" />}\r\n          {!showNewCaret &&\r\n            <svg className=\"TokenSelector-caret\" xmlns=\"http://www.w3.org/2000/svg\" width=\"13\" height=\"13\" viewBox=\"0 0 13 13\" fill=\"none\">\r\n              <path d=\"M2.60001 4.76666L7.10001 8.76666L11.6 4.76666\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n            </svg>\r\n          }\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import cx from \"classnames\";\r\n\r\nexport default function ExchangeInfoRow(props) {\r\n  const { label, children, value, isTop, isWarning } = props;\r\n\r\n  return (\r\n    <div className={cx(\"Exchange-info-row\", { \"top-line\": isTop }) + ' ' + props.className}>\r\n      <div className=\"Exchange-info-label\">{label}</div>\r\n      <div className={`align-right ${isWarning ? \"Exchange-info-value-warning\" : \"\"}`}>{children || value}</div>\r\n    </div>\r\n  );\r\n}\r\n","import \"./StatsTooltip.css\";\r\ntype Props = {\r\n  label: string;\r\n  value: number | [number];\r\n  showDollar?: boolean;\r\n};\r\n\r\nexport default function StatsTooltipRow({ label, value, showDollar = true }: Props) {\r\n  function renderValue() {\r\n    if (Array.isArray(value)) {\r\n      return (\r\n        <ul className=\"Tooltip-row-values\">\r\n          {value.map((v, i) => (\r\n            <li key={i}>{v}</li>\r\n          ))}\r\n        </ul>\r\n      );\r\n    }\r\n    return (\r\n      <span className=\"Tooltip-row-value\">\r\n        {showDollar && \"$\"}\r\n        {value}\r\n      </span>\r\n    );\r\n  }\r\n  return (\r\n    <div className=\"Tooltip-row\">\r\n      <span className=\"label\">{label}:</span>\r\n      {renderValue()}\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport './Slippage.scss';\r\nimport { convertInputNum, separateThousands, sepToNumber } from './../../../../components/utils/sepThousands';\r\n\r\nconst SlippageInput = ({ value, setValue }) => {\r\n\treturn (\r\n\t\t<div className=\"Exchange-swap-section Slippage-input-container\">\r\n\t\t\t<div className=\"Exchange-swap-section-bottom\">\r\n\t\t\t\t<div className=\"Exchange-swap-input-container\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\tplaceholder=\"Slippage (%)\"\r\n\t\t\t\t\t\tclassName=\"Exchange-swap-input Slippage-input\"\r\n\t\t\t\t\t\tvalue={value}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tconst val = (e.target.value).replace(/[^0-9]/g, '').replace(/^0\\d/, '');\r\n\t\t\t\t\t\t\t// const valStr = convertInputNum(e.target.value)\r\n\t\t\t\t\t\t\t// const val = sepToNumber(valStr);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (val > 100) {\r\n\t\t\t\t\t\t\t\tsetValue(100)\r\n\t\t\t\t\t\t\t} else if (val < 0) {\r\n\t\t\t\t\t\t\t\tsetValue(0)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tsetValue(val)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonFocus={(e) => {\r\n\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonBlur={(e) => {\r\n\t\t\t\t\t\t\te.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n};\r\n\r\nexport default SlippageInput;","import React, { useCallback, useState, useMemo } from \"react\";\r\nimport \"./ConfirmationBox.css\";\r\nimport {\r\n  USD_DECIMALS,\r\n  PRECISION,\r\n  BASIS_POINTS_DIVISOR,\r\n  LIMIT,\r\n  MIN_PROFIT_TIME,\r\n  INCREASE,\r\n  expandDecimals,\r\n  getExchangeRate,\r\n  getProfitPrice,\r\n  getTimeRemaining,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  useLocalStorageSerializeKey,\r\n  getExchangeRateDisplay,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  SLIPPAGE_BPS_KEY,\r\n  formatDateTime,\r\n  calculatePositionDelta,\r\n  DECREASE,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport { cancelDecreaseOrder, handleCancelOrder } from \"../../domain/legacy\";\r\nimport { getNativeToken, getToken, getWrappedToken } from \"../../config/Tokens\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport SlippageInput from './../SlippageInput/SlippageInput';\r\n\r\nconst HIGH_SPREAD_THRESHOLD = expandDecimals(1, USD_DECIMALS).div(100); // 1%;\r\n\r\nfunction getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress) {\r\n  if (fromTokenInfo && fromTokenInfo.maxPrice && toTokenInfo && toTokenInfo.minPrice) {\r\n    const fromDiff = fromTokenInfo.maxPrice.sub(fromTokenInfo.minPrice).div(2);\r\n    const fromSpread = fromDiff.mul(PRECISION).div(fromTokenInfo.maxPrice.add(fromTokenInfo.minPrice).div(2));\r\n    const toDiff = toTokenInfo.maxPrice.sub(toTokenInfo.minPrice).div(2);\r\n    const toSpread = toDiff.mul(PRECISION).div(toTokenInfo.maxPrice.add(toTokenInfo.minPrice).div(2));\r\n\r\n    let value = fromSpread.add(toSpread);\r\n\r\n    const fromTokenAddress = fromTokenInfo.isNative ? nativeTokenAddress : fromTokenInfo.address;\r\n    const toTokenAddress = toTokenInfo.isNative ? nativeTokenAddress : toTokenInfo.address;\r\n\r\n    if (isLong && fromTokenAddress === toTokenAddress) {\r\n      value = fromSpread;\r\n    }\r\n\r\n    return {\r\n      value,\r\n      isHigh: value.gt(HIGH_SPREAD_THRESHOLD),\r\n    };\r\n  }\r\n}\r\n\r\nexport default function ConfirmationBox(props) {\r\n  const {\r\n    fromToken,\r\n    fromTokenInfo,\r\n    toToken,\r\n    toTokenInfo,\r\n    isSwap,\r\n    isLong,\r\n    isMarketOrder,\r\n    orderOption,\r\n    isShort,\r\n    toAmount,\r\n    fromAmount,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    onConfirmationClick,\r\n    setIsConfirming,\r\n    shortCollateralAddress,\r\n    hasExistingPosition,\r\n    leverage,\r\n    existingPosition,\r\n    existingLiquidationPrice,\r\n    displayLiquidationPrice,\r\n    shortCollateralToken,\r\n    isPendingConfirmation,\r\n    triggerPriceUsd,\r\n    triggerRatio,\r\n    fees,\r\n    feesUsd,\r\n    isSubmitting,\r\n    fromUsdMin,\r\n    toUsdMax,\r\n    nextAveragePrice,\r\n    collateralTokenAddress,\r\n    feeBps,\r\n    chainId,\r\n    orders,\r\n    library,\r\n    setPendingTxns,\r\n    pendingTxns,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  } = props;\r\n\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n\r\n  // Default Slippage\r\n  // const [savedSlippageAmount] = useLocalStorageSerializeKey([chainId, SLIPPAGE_BPS_KEY], DEFAULT_SLIPPAGE_AMOUNT);\r\n  const [savedSlippageAmount] = useState(DEFAULT_SLIPPAGE_AMOUNT);\r\n  \r\n  const [isProfitWarningAccepted, setIsProfitWarningAccepted] = useState(false);\r\n  const [isTriggerWarningAccepted, setIsTriggerWarningAccepted] = useState(false);\r\n  const [isLimitOrdersVisible, setIsLimitOrdersVisible] = useState(false);\r\n\r\n  const onCancelOrderClick = useCallback(\r\n    (order) => {\r\n      handleCancelOrder(chainId, library, order, { pendingTxns, setPendingTxns });\r\n    },\r\n    [library, pendingTxns, setPendingTxns, chainId]\r\n  );\r\n\r\n  let minOut;\r\n  let fromTokenUsd;\r\n  let toTokenUsd;\r\n\r\n  let collateralAfterFees = fromUsdMin;\r\n  if (feesUsd) {\r\n    collateralAfterFees = fromUsdMin.sub(feesUsd);\r\n  }\r\n\r\n  if (isSwap) {\r\n    minOut = toAmount.mul(BASIS_POINTS_DIVISOR - savedSlippageAmount).div(BASIS_POINTS_DIVISOR);\r\n\r\n    fromTokenUsd = fromTokenInfo ? formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true) : 0;\r\n    toTokenUsd = toTokenInfo ? formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true) : 0;\r\n  }\r\n\r\n  const getTitle = () => {\r\n    if (!isMarketOrder) {\r\n      return \"Confirm Limit Order\";\r\n    }\r\n    if (isSwap) {\r\n      return \"Confirm Swap\";\r\n    }\r\n    return isLong ? \"Confirm Long\" : \"Confirm Short\";\r\n  };\r\n  const title = getTitle();\r\n\r\n  const existingOrder = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    for (const order of orders) {\r\n      if (order.type !== INCREASE) continue;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      if (order.isLong === isLong && sameToken) {\r\n        return order;\r\n      }\r\n    }\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const existingOrders = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    return orders.filter((order) => {\r\n      if (order.type !== INCREASE) return false;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      return order.isLong === isLong && sameToken;\r\n    });\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const existingTriggerOrders = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    return orders.filter((order) => {\r\n      if (order.type !== DECREASE) return false;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      return order.isLong === isLong && sameToken;\r\n    });\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const decreaseOrdersThatWillBeExecuted = useMemo(() => {\r\n    if (isSwap) return [];\r\n    return existingTriggerOrders.filter((order) => {\r\n      if (order.triggerAboveThreshold) {\r\n        return existingPosition?.markPrice.gte(order.triggerPrice);\r\n      } else {\r\n        return existingPosition?.markPrice.lte(order.triggerPrice);\r\n      }\r\n    });\r\n  }, [existingPosition, existingTriggerOrders, isSwap]);\r\n\r\n  const getError = () => {\r\n    if (!isSwap && hasExistingPosition && !isMarketOrder) {\r\n      const { delta, hasProfit } = calculatePositionDelta(triggerPriceUsd, existingPosition);\r\n      if (hasProfit && delta.eq(0)) {\r\n        return \"Invalid price, see warning\";\r\n      }\r\n    }\r\n    if (isMarketOrder && hasPendingProfit && !isProfitWarningAccepted) {\r\n      return \"Forfeit profit not checked\";\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (decreaseOrdersThatWillBeExecuted.length > 0 && !isTriggerWarningAccepted) {\r\n      return `Accept confirmation of trigger orders`;\r\n    }\r\n\r\n    if (!isPendingConfirmation) {\r\n      const error = getError();\r\n      if (error) {\r\n        return error;\r\n      }\r\n\r\n      if (isSwap) {\r\n        return title;\r\n      }\r\n      const action = isMarketOrder ? (isLong ? \"Long\" : \"Short\") : \"Create Order\";\r\n\r\n      if (\r\n        isMarketOrder &&\r\n        MIN_PROFIT_TIME > 0 &&\r\n        hasExistingPosition &&\r\n        existingPosition.delta.eq(0) &&\r\n        existingPosition.pendingDelta.gt(0)\r\n      ) {\r\n        return isLong ? `Forfeit profit and ${action}` : `Forfeit profit and Short`;\r\n      }\r\n\r\n      return isMarketOrder && MIN_PROFIT_TIME > 0 ? `Accept minimum and ${action}` : action;\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      return \"Creating Order...\";\r\n    }\r\n    if (isSwap) {\r\n      return \"Swapping...\";\r\n    }\r\n    if (isLong) {\r\n      return \"Longing...\";\r\n    }\r\n    return \"Shorting...\";\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (getError()) {\r\n      return false;\r\n    }\r\n    if (decreaseOrdersThatWillBeExecuted.length > 0 && !isTriggerWarningAccepted) {\r\n      return false;\r\n    }\r\n    return !isPendingConfirmation && !isSubmitting;\r\n  };\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const spread = getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress);\r\n  // it's meaningless for limit/stop orders to show spread based on current prices\r\n  const showSpread = isMarketOrder && !!spread;\r\n\r\n  const [userSlippage, setUserSlippage] = useState('')\r\n  let allowedSlippage = savedSlippageAmount;\r\n  // if (isHigherSlippageAllowed) {\r\n  //   allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  // }\r\n  if (userSlippage !== '') {\r\n    allowedSlippage = userSlippage * 100;\r\n  }\r\n\r\n  const renderSpreadWarning = useCallback(() => {\r\n    if (!isMarketOrder) {\r\n      return null;\r\n    }\r\n\r\n    if (spread && spread.isHigh) {\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          The spread is {`>`} 1%, please ensure the trade details are acceptable before comfirming\r\n        </div>\r\n      );\r\n    }\r\n  }, [isMarketOrder, spread]);\r\n\r\n  const renderFeeWarning = useCallback(() => {\r\n    if (orderOption === LIMIT || !feeBps || feeBps <= 60) {\r\n      return null;\r\n    }\r\n\r\n    if (isSwap) {\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          Fees are high to swap from {fromToken.symbol} to {toToken.symbol}.\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (!collateralTokenAddress) {\r\n      return null;\r\n    }\r\n\r\n    const collateralToken = getToken(chainId, collateralTokenAddress);\r\n    return (\r\n      <div className=\"Confirmation-box-warning\">\r\n        Fees are high to swap from {fromToken.symbol} to {collateralToken.symbol}. <br />\r\n        {collateralToken.symbol} is needed for collateral.\r\n      </div>\r\n    );\r\n  }, [feeBps, isSwap, collateralTokenAddress, chainId, fromToken.symbol, toToken.symbol, orderOption]);\r\n\r\n  const hasPendingProfit =\r\n    MIN_PROFIT_TIME > 0 && existingPosition && existingPosition.delta.eq(0) && existingPosition.pendingDelta.gt(0);\r\n\r\n  const renderMinProfitWarning = useCallback(() => {\r\n    if (MIN_PROFIT_TIME === 0) {\r\n      return null;\r\n    }\r\n    if (!isSwap) {\r\n      if (hasExistingPosition) {\r\n        const minProfitExpiration = existingPosition.lastIncreasedTime + MIN_PROFIT_TIME;\r\n        if (isMarketOrder && existingPosition.delta.eq(0) && existingPosition.pendingDelta.gt(0)) {\r\n          const profitPrice = getProfitPrice(existingPosition.markPrice, existingPosition);\r\n          return (\r\n            <div className=\"Confirmation-box-warning\">\r\n              Increasing this position at the current price will forfeit a&nbsp;\r\n              <a\r\n                href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                pending profit\r\n              </a>{\" \"}\r\n              of {existingPosition.deltaStr}.<br />\r\n              <br />\r\n              Profit price: {existingPosition.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}.\r\n              This rule only applies for the next {getTimeRemaining(minProfitExpiration)}, until{\" \"}\r\n              {formatDateTime(minProfitExpiration)}.\r\n            </div>\r\n          );\r\n        }\r\n        if (!isMarketOrder) {\r\n          const { delta, hasProfit } = calculatePositionDelta(triggerPriceUsd, existingPosition);\r\n          if (hasProfit && delta.eq(0)) {\r\n            const profitPrice = getProfitPrice(existingPosition.markPrice, existingPosition);\r\n            return (\r\n              <div className=\"Confirmation-box-warning\">\r\n                This order will forfeit a&nbsp;\r\n                <a\r\n                  href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                >\r\n                  profit\r\n                </a>{\" \"}\r\n                of {existingPosition.deltaStr}.<br />\r\n                Profit price: {existingPosition.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}.\r\n                This rule only applies for the next {getTimeRemaining(minProfitExpiration)}, until{\" \"}\r\n                {formatDateTime(minProfitExpiration)}.\r\n              </div>\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          A minimum price change of&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            1.5%\r\n          </a>{\" \"}\r\n          is required for a position to be in profit. This only applies for the first {MIN_PROFIT_TIME / 60 / 60} hours\r\n          after increasing a position.\r\n        </div>\r\n      );\r\n    }\r\n  }, [isSwap, hasExistingPosition, existingPosition, isMarketOrder, triggerPriceUsd]);\r\n\r\n  const renderExistingOrderWarning = useCallback(() => {\r\n    if (isSwap || !existingOrder) {\r\n      return;\r\n    }\r\n    const indexToken = getToken(chainId, existingOrder.indexToken);\r\n    const sizeInToken = formatAmount(\r\n      existingOrder.sizeDelta.mul(PRECISION).div(existingOrder.triggerPrice),\r\n      USD_DECIMALS,\r\n      4,\r\n      true\r\n    );\r\n    if (existingOrders?.length > 1) {\r\n      return (\r\n        <div>\r\n          <div className=\"Confirmation-box-info\">\r\n            <span>\r\n              You have multiple existing Increase {existingOrder.isLong ? \"Long\" : \"Short\"} {indexToken.symbol} limit\r\n              orders{\" \"}\r\n            </span>\r\n            <span onClick={() => setIsLimitOrdersVisible((p) => !p)} className=\"view-orders\">\r\n              ({isLimitOrdersVisible ? \"hide\" : \"view\"})\r\n            </span>\r\n          </div>\r\n          {isLimitOrdersVisible && (\r\n            <ul className=\"order-list\">\r\n              {existingOrders.map((order) => {\r\n                const { account, index, type, triggerAboveThreshold, triggerPrice } = order;\r\n                const id = `${account}-${index}`;\r\n                const triggerPricePrefix = triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n                const indexToken = getToken(chainId, order.indexToken);\r\n\r\n                return (\r\n                  <li key={id} className=\"font-sm\">\r\n                    <p>\r\n                      {type === INCREASE ? \"Increase\" : \"Decrease\"} {indexToken.symbol} {isLong ? \"Long\" : \"Short\"}{\" \"}\r\n                      &nbsp;{triggerPricePrefix} ${formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n                    </p>\r\n                    <button onClick={() => onCancelOrderClick(order)}>Cancel</button>\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"Confirmation-box-info\">\r\n        You have an active Limit Order to Increase {existingOrder.isLong ? \"Long\" : \"Short\"} {sizeInToken}{\" \"}\r\n        {indexToken.symbol} (${formatAmount(existingOrder.sizeDelta, USD_DECIMALS, 2, true)}) at price $\r\n        {formatAmount(existingOrder.triggerPrice, USD_DECIMALS, 2, true)}\r\n      </div>\r\n    );\r\n  }, [existingOrder, isSwap, chainId, existingOrders, isLong, isLimitOrdersVisible, onCancelOrderClick]);\r\n\r\n  const renderExistingTriggerErrors = useCallback(() => {\r\n    if (isSwap || decreaseOrdersThatWillBeExecuted?.length < 1) {\r\n      return;\r\n    }\r\n    const existingTriggerOrderLength = decreaseOrdersThatWillBeExecuted.length;\r\n    const orderText = existingTriggerOrderLength > 1 ? \"orders\" : \"order\";\r\n    return (\r\n      <>\r\n        <div className=\"Confirmation-box-warning\">\r\n          You have {existingTriggerOrderLength > 1 ? `${existingTriggerOrderLength}` : \"an\"} active trigger {orderText}{\" \"}\r\n          that might execute immediately after you open this position. Please cancel the {orderText} or accept the\r\n          confirmation to continue.\r\n        </div>\r\n        <ul className=\"order-list\">\r\n          {decreaseOrdersThatWillBeExecuted.map((order) => {\r\n            const { account, index, type, triggerAboveThreshold, triggerPrice } = order;\r\n            const id = `${account}-${index}`;\r\n            const triggerPricePrefix = triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n            const indexToken = getToken(chainId, order.indexToken);\r\n            return (\r\n              <li key={id} className=\"font-sm\">\r\n                <p>\r\n                  {type === INCREASE ? \"Increase\" : \"Decrease\"} {indexToken.symbol} {isLong ? \"Long\" : \"Short\"}\r\n                  &nbsp;{triggerPricePrefix} ${formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n                </p>\r\n                <button\r\n                  onClick={() =>\r\n                    cancelDecreaseOrder(chainId, library, index, {\r\n                      successMsg: \"Order cancelled\",\r\n                      failMsg: \"Cancel failed\",\r\n                      sentMsg: \"Cancel submitted\",\r\n                      pendingTxns,\r\n                      setPendingTxns,\r\n                    })\r\n                  }\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      </>\r\n    );\r\n  }, [decreaseOrdersThatWillBeExecuted, isSwap, chainId, library, pendingTxns, setPendingTxns, isLong]);\r\n\r\n  const renderExistingTriggerWarning = useCallback(() => {\r\n    if (\r\n      isSwap ||\r\n      existingTriggerOrders.length < 1 ||\r\n      decreaseOrdersThatWillBeExecuted.length > 0 ||\r\n      renderExistingOrderWarning()\r\n    ) {\r\n      return;\r\n    }\r\n    const existingTriggerOrderLength = existingTriggerOrders.length;\r\n    return (\r\n      <div className=\"Confirmation-box-info\">\r\n        You have {existingTriggerOrderLength > 1 ? `${existingTriggerOrderLength}` : \"an\"} active trigger{\" \"}\r\n        {existingTriggerOrderLength > 1 ? \"orders\" : \"order\"} that could impact this position.\r\n      </div>\r\n    );\r\n  }, [existingTriggerOrders, isSwap, decreaseOrdersThatWillBeExecuted, renderExistingOrderWarning]);\r\n\r\n  // TODO handle unaprproved order plugin (very unlikely case)\r\n  const renderMain = useCallback(() => {\r\n    if (isSwap) {\r\n      return (\r\n        <div className=\"Confirmation-box-main\">\r\n          <div className=\"Confirmation-box-main-label\">\r\n            <div className=\"label-title\">Pay</div>&nbsp;{formatAmount(fromAmount, fromToken.decimals, 4, true)} {fromToken.symbol} ($\r\n            {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)})\r\n          </div>\r\n          <div className=\"Confirmation-box-main-icon\"></div>\r\n          <div className=\"Confirmation-box-main-label\">\r\n            <div className=\"label-title\">Recieve</div>&nbsp;{formatAmount(toAmount, toToken.decimals, 4, true)} {toToken.symbol} ($\r\n            {formatAmount(toUsdMax, USD_DECIMALS, 2, true)})\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"Confirmation-box-main\">\r\n        <div className=\"Confirmation-box-main-label\">\r\n          <div className=\"label-title\">Pay</div>&nbsp;{formatAmount(fromAmount, fromToken.decimals, 4, true)} {fromToken.symbol} ($\r\n          {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)})\r\n        </div>\r\n        <div className=\"Confirmation-box-main-icon\"></div>\r\n        <div className=\"Confirmation-box-main-label\">\r\n          <div className=\"label-title\">{isLong ? \"Long\" : \"Short\"}</div>&nbsp;\r\n          {formatAmount(toAmount, toToken.decimals, 4, true)} {toToken.symbol} ($\r\n          {formatAmount(toUsdMax, USD_DECIMALS, 2, true)})\r\n        </div>\r\n      </div>\r\n    );\r\n  }, [isSwap, fromAmount, fromToken, toToken, fromUsdMin, toUsdMax, isLong, toAmount]);\r\n\r\n  const SWAP_ORDER_EXECUTION_GAS_FEE = getConstant(chainId, \"SWAP_ORDER_EXECUTION_GAS_FEE\");\r\n  const INCREASE_ORDER_EXECUTION_GAS_FEE = getConstant(chainId, \"INCREASE_ORDER_EXECUTION_GAS_FEE\");\r\n  const executionFee = isSwap ? SWAP_ORDER_EXECUTION_GAS_FEE : INCREASE_ORDER_EXECUTION_GAS_FEE;\r\n  const renderExecutionFee = useCallback(() => {\r\n    if (isMarketOrder) {\r\n      return null;\r\n    }\r\n    return (\r\n      <ExchangeInfoRow label=\"Execution Fee\">\r\n        {formatAmount(executionFee, 18, 4)} {getNativeToken(chainId).symbol}\r\n      </ExchangeInfoRow>\r\n    );\r\n  }, [isMarketOrder, executionFee, chainId]);\r\n\r\n  const renderAvailableLiquidity = useCallback(() => {\r\n    let availableLiquidity;\r\n    const riskThresholdBps = 5000;\r\n    let isLiquidityRisk;\r\n    const token = isSwap || isLong ? toTokenInfo : shortCollateralToken;\r\n\r\n    if (!token || !token.poolAmount || !token.availableAmount) {\r\n      return null;\r\n    }\r\n\r\n    if (isSwap) {\r\n      const poolWithoutBuffer = token.poolAmount.sub(token.bufferAmount);\r\n      availableLiquidity = token.availableAmount.gt(poolWithoutBuffer) ? poolWithoutBuffer : token.availableAmount;\r\n      isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(toAmount);\r\n    } else {\r\n      if (isShort) {\r\n        availableLiquidity = token.availableAmount;\r\n\r\n        let adjustedMaxGlobalShortSize;\r\n\r\n        if (toTokenInfo.maxAvailableShort && toTokenInfo.maxAvailableShort.gt(0)) {\r\n          adjustedMaxGlobalShortSize = toTokenInfo.maxAvailableShort\r\n            .mul(expandDecimals(1, token.decimals))\r\n            .div(expandDecimals(1, USD_DECIMALS));\r\n        }\r\n\r\n        if (adjustedMaxGlobalShortSize && adjustedMaxGlobalShortSize.lt(token.availableAmount)) {\r\n          availableLiquidity = adjustedMaxGlobalShortSize;\r\n        }\r\n\r\n        const sizeTokens = toUsdMax.mul(expandDecimals(1, token.decimals)).div(token.minPrice);\r\n        isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(sizeTokens);\r\n      } else {\r\n        availableLiquidity = token.availableAmount;\r\n        isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(toAmount);\r\n      }\r\n    }\r\n\r\n    if (!availableLiquidity) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <ExchangeInfoRow label=\"Available Liquidity\">\r\n        <Tooltip\r\n          position=\"right-bottom\"\r\n          handleClassName={isLiquidityRisk ? \"negative\" : null}\r\n          handle={\r\n            <>\r\n              {formatAmount(availableLiquidity, token.decimals, token.isStable ? 0 : 2, true)} {token.symbol}\r\n            </>\r\n          }\r\n          renderContent={() =>\r\n            isLiquidityRisk\r\n              ? \"There may not be sufficient liquidity to execute your order when the price conditions are met\"\r\n              : \"The order will only execute if the price conditions are met and there is sufficient liquidity\"\r\n          }\r\n        />\r\n      </ExchangeInfoRow>\r\n    );\r\n  }, [toTokenInfo, shortCollateralToken, isShort, isLong, isSwap, toAmount, toUsdMax]);\r\n\r\n  const renderMarginSection = useCallback(() => {\r\n    return (\r\n      <>\r\n        <div>\r\n          {renderMain()}\r\n          {renderFeeWarning()}\r\n          {renderMinProfitWarning()}\r\n          {renderExistingOrderWarning()}\r\n          {renderExistingTriggerErrors()}\r\n          {renderExistingTriggerWarning()}\r\n          {minExecutionFeeErrorMessage && <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>}\r\n          {hasPendingProfit && isMarketOrder && (\r\n            <div className=\"PositionEditor-accept-profit-warning\">\r\n              <Checkbox isChecked={isProfitWarningAccepted} setIsChecked={setIsProfitWarningAccepted}>\r\n                <span className=\"muted\">Forfeit profit</span>\r\n              </Checkbox>\r\n            </div>\r\n          )}\r\n          {orderOption === LIMIT && renderAvailableLiquidity()}\r\n          {isShort && (\r\n            <ExchangeInfoRow label=\"Collateral In\" isTop={true}>{getToken(chainId, shortCollateralAddress).symbol}</ExchangeInfoRow>\r\n          )}\r\n          {isLong && <ExchangeInfoRow label=\"Collateral In\" isTop={true} value={toTokenInfo.symbol} />}\r\n          <ExchangeInfoRow label=\"Leverage\">\r\n            {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n              <div className=\"inline-block muted\">\r\n                {formatAmount(existingPosition.leverage, 4, 2)}x\r\n                <BsArrowRight className=\"transition-arrow\" />\r\n              </div>\r\n            )}\r\n            {toAmount && leverage && leverage.gt(0) && `${formatAmount(leverage, 4, 2)}x`}\r\n            {!toAmount && leverage && leverage.gt(0) && `-`}\r\n            {leverage && leverage.eq(0) && `-`}\r\n          </ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Liq. Price\">\r\n            {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n              <div className=\"inline-block muted\">\r\n                ${formatAmount(existingLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                <BsArrowRight className=\"transition-arrow\" />\r\n              </div>\r\n            )}\r\n            {toAmount && displayLiquidationPrice && `$${formatAmount(displayLiquidationPrice, USD_DECIMALS, 2, true)}`}\r\n            {!toAmount && displayLiquidationPrice && `-`}\r\n            {!displayLiquidationPrice && `-`}\r\n          </ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Fees\">${formatAmount(feesUsd, USD_DECIMALS, 2, true)}</ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Collateral\">\r\n            <Tooltip\r\n              handle={`$${formatAmount(collateralAfterFees, USD_DECIMALS, 2, true)}`}\r\n              position=\"right-bottom\"\r\n              renderContent={() => {\r\n                return (\r\n                  <>\r\n                    Your position's collateral after deducting fees.\r\n                    <br />\r\n                    <br />\r\n                    <StatsTooltipRow label=\"Pay Amount\" value={formatAmount(fromUsdMin, USD_DECIMALS, 2, true)} />\r\n                    <StatsTooltipRow label=\"Fees\" value={formatAmount(feesUsd, USD_DECIMALS, 2, true)} />\r\n                    <div className=\"Tooltip-divider\" />\r\n                    <StatsTooltipRow\r\n                      label=\"Collateral\"\r\n                      value={formatAmount(collateralAfterFees, USD_DECIMALS, 2, true)}\r\n                    />\r\n                  </>\r\n                );\r\n              }}\r\n            />\r\n          </ExchangeInfoRow>\r\n          {showSpread && (\r\n            <ExchangeInfoRow label=\"Spread\" isWarning={spread.isHigh} isTop={true}>\r\n              {formatAmount(spread.value.mul(100), USD_DECIMALS, 2, true)}%\r\n            </ExchangeInfoRow>\r\n          )}\r\n          {isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Entry Price\">\r\n              {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                <div className=\"inline-block muted\">\r\n                  ${formatAmount(existingPosition.averagePrice, USD_DECIMALS, 2, true)}\r\n                  <BsArrowRight className=\"transition-arrow\" />\r\n                </div>\r\n              )}\r\n              {nextAveragePrice && `$${formatAmount(nextAveragePrice, USD_DECIMALS, 2, true)}`}\r\n              {!nextAveragePrice && `-`}\r\n            </ExchangeInfoRow>\r\n          )}\r\n          {!isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Limit Price\" isTop={true}>\r\n              ${formatAmount(triggerPriceUsd, USD_DECIMALS, 2, true)}\r\n            </ExchangeInfoRow>\r\n          )}\r\n          <ExchangeInfoRow label=\"Borrow Fee\">\r\n            {isLong && toTokenInfo && formatAmount(toTokenInfo.fundingRate, 4, 4)}\r\n            {isShort && shortCollateralToken && formatAmount(shortCollateralToken.fundingRate, 4, 4)}\r\n            {((isLong && toTokenInfo && toTokenInfo.fundingRate) ||\r\n              (isShort && shortCollateralToken && shortCollateralToken.fundingRate)) &&\r\n              \"% / 1h\"}\r\n          </ExchangeInfoRow>\r\n          {isMarketOrder && (\r\n            <div className=\"PositionEditor-allow-higher-slippage\">\r\n              <ExchangeInfoRow label=\"Execution Fee\">\r\n                <Tooltip\r\n                  handle={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol}`}\r\n                  position=\"right-top\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label=\"Network fee\"\r\n                          value={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol} ($${formatAmount(\r\n                            minExecutionFeeUSD,\r\n                            USD_DECIMALS,\r\n                            2\r\n                          )})`}\r\n                        />\r\n                        <br />\r\n                        This is the network cost required to execute the postion.{\" \"}\r\n                        <a\r\n                          href=\"https://gmxio.gitbook.io/gmx/trading#execution-fee\"\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                        >\r\n                          More Info\r\n                        </a>\r\n                      </>\r\n                    );\r\n                  }}\r\n                />\r\n              </ExchangeInfoRow>\r\n            </div>\r\n          )}\r\n          {isMarketOrder && (\r\n            <SlippageInput\r\n              value={userSlippage}\r\n              setValue={setUserSlippage}\r\n             />\r\n          )}\r\n          <ExchangeInfoRow label=\"Allowed Slippage\" className=\"Slippage-row\">\r\n            <Tooltip\r\n              handle={`${formatAmount(allowedSlippage, 2, 2)}%`}\r\n              position=\"right-top\"\r\n              renderContent={() => {\r\n                return (\r\n                  <>\r\n                    You can change this in the settings menu on the top right of the page.\r\n                    <br />\r\n                    <br />\r\n                    Note that a low allowed slippage, e.g. less than 0.5%, may result in failed orders if prices are\r\n                    volatile.\r\n                  </>\r\n                );\r\n              }}\r\n            />\r\n          </ExchangeInfoRow>\r\n          {decreaseOrdersThatWillBeExecuted.length > 0 && (\r\n            <div className=\"PositionEditor-allow-higher-slippage\">\r\n              <Checkbox isChecked={isTriggerWarningAccepted} setIsChecked={setIsTriggerWarningAccepted}>\r\n                <span className=\"muted font-sm\">I am aware of the trigger orders</span>\r\n              </Checkbox>\r\n            </div>\r\n          )}\r\n          {renderExecutionFee()}\r\n        </div>\r\n      </>\r\n    );\r\n  }, [\r\n    renderMain,\r\n    renderMinProfitWarning,\r\n    shortCollateralAddress,\r\n    isShort,\r\n    isLong,\r\n    toTokenInfo,\r\n    nextAveragePrice,\r\n    toAmount,\r\n    hasExistingPosition,\r\n    existingPosition,\r\n    isMarketOrder,\r\n    triggerPriceUsd,\r\n    showSpread,\r\n    spread,\r\n    displayLiquidationPrice,\r\n    existingLiquidationPrice,\r\n    feesUsd,\r\n    leverage,\r\n    renderExecutionFee,\r\n    shortCollateralToken,\r\n    chainId,\r\n    renderFeeWarning,\r\n    hasPendingProfit,\r\n    isProfitWarningAccepted,\r\n    renderAvailableLiquidity,\r\n    orderOption,\r\n    fromUsdMin,\r\n    collateralAfterFees,\r\n    renderExistingOrderWarning,\r\n    renderExistingTriggerWarning,\r\n    renderExistingTriggerErrors,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    allowedSlippage,\r\n    isTriggerWarningAccepted,\r\n    decreaseOrdersThatWillBeExecuted,\r\n    minExecutionFee,\r\n    nativeTokenSymbol,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  ]);\r\n\r\n  const renderSwapSection = useCallback(() => {\r\n    return (\r\n      <>\r\n        <div>\r\n          {renderMain()}\r\n          {renderFeeWarning()}\r\n          {renderSpreadWarning()}\r\n          {orderOption === LIMIT && renderAvailableLiquidity()}\r\n          <ExchangeInfoRow label=\"Min. Receive\">\r\n            {formatAmount(minOut, toTokenInfo.decimals, 4, true)} {toTokenInfo.symbol}\r\n          </ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Price\">\r\n            {getExchangeRateDisplay(getExchangeRate(fromTokenInfo, toTokenInfo), fromTokenInfo, toTokenInfo)}\r\n          </ExchangeInfoRow>\r\n          {!isMarketOrder && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">Limit Price</div>\r\n              <div className=\"align-right\">{getExchangeRateDisplay(triggerRatio, fromTokenInfo, toTokenInfo)}</div>\r\n            </div>\r\n          )}\r\n          {showSpread && (\r\n            <ExchangeInfoRow label=\"Spread\" isWarning={spread.isHigh}>\r\n              {formatAmount(spread.value.mul(100), USD_DECIMALS, 2, true)}%\r\n            </ExchangeInfoRow>\r\n          )}\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">Fees</div>\r\n            <div className=\"align-right\">\r\n              {formatAmount(feeBps, 2, 2, true)}% ({formatAmount(fees, fromTokenInfo.decimals, 4, true)}{\" \"}\r\n              {fromTokenInfo.symbol}: ${formatAmount(feesUsd, USD_DECIMALS, 2, true)})\r\n            </div>\r\n          </div>\r\n          {renderExecutionFee()}\r\n          {fromTokenUsd && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">{fromTokenInfo.symbol} Price</div>\r\n              <div className=\"align-right\">{fromTokenUsd} USD</div>\r\n            </div>\r\n          )}\r\n          {toTokenUsd && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">{toTokenInfo.symbol} Price</div>\r\n              <div className=\"align-right\">{toTokenUsd} USD</div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </>\r\n    );\r\n  }, [\r\n    renderMain,\r\n    renderSpreadWarning,\r\n    fromTokenInfo,\r\n    toTokenInfo,\r\n    orderOption,\r\n    showSpread,\r\n    spread,\r\n    feesUsd,\r\n    feeBps,\r\n    renderExecutionFee,\r\n    fromTokenUsd,\r\n    toTokenUsd,\r\n    triggerRatio,\r\n    fees,\r\n    isMarketOrder,\r\n    minOut,\r\n    renderFeeWarning,\r\n    renderAvailableLiquidity,\r\n  ]);\r\n\r\n  return (\r\n    <div className=\"Confirmation-box\">\r\n      <Modal isVisible={true} setIsVisible={() => setIsConfirming(false)} label={title} allowContentTouchMove isNifty={true}>\r\n        {isSwap && renderSwapSection()}\r\n        {!isSwap && renderMarginSection()}\r\n        <div className=\"Confirmation-box-row\">\r\n          <button\r\n            onClick={onConfirmationClick}\r\n            className=\"App-cta Confirmation-box-button hlight\"\r\n            disabled={!isPrimaryEnabled()}\r\n          >\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\n\r\nimport \"./OrdersToa.css\";\r\n\r\nexport default function OrdersToa(props) {\r\n  const { setIsVisible, isPluginApproving, approveOrderBook } = props;\r\n\r\n  const [isChecked, setIsChecked] = useState(false);\r\n\r\n  const onConfirmationClick = () => {\r\n    approveOrderBook().then(() => {\r\n      setIsVisible(false);\r\n    });\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (isPluginApproving) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (!isChecked) {\r\n      return t`Accept terms to enable orders`;\r\n    }\r\n    return t`Enable Orders`;\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (isPluginApproving) {\r\n      return false;\r\n    }\r\n    return isChecked;\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      setIsVisible={setIsVisible}\r\n      isVisible={true}\r\n      label={t`Enable Orders`}\r\n      className=\"Orders-toa Modal-scrollable\"\r\n      zIndex=\"1000\"\r\n    >\r\n      <Trans>\r\n        Note that orders are not guaranteed to be executed.\r\n        <br />\r\n        <br />\r\n        This can occur in a few situations including but not exclusive to:\r\n      </Trans>\r\n      <br />\r\n      <ul>\r\n        <Trans>\r\n          <li>Insufficient liquidity to execute the order</li>\r\n          <li>The mark price which is an aggregate of exchange prices did not reach the specified price</li>\r\n          <li>The specified price was reached but not long enough for it to be executed</li>\r\n          <li>No keeper picked up the order for execution</li>\r\n        </Trans>\r\n      </ul>\r\n      <div>\r\n        <Trans>\r\n          Additionally, trigger orders are market orders and are not guaranteed to settle at the trigger price.\r\n        </Trans>\r\n      </div>\r\n      <br />\r\n      <div className=\"Orders-toa-accept-rules\">\r\n        <Checkbox isChecked={isChecked} setIsChecked={setIsChecked}>\r\n          <span className=\"muted\">\r\n            <Trans>\r\n              Accept that orders are not guaranteed to execute and trigger orders may not settle at the trigger price\r\n            </Trans>\r\n          </span>\r\n        </Checkbox>\r\n      </div>\r\n      <button disabled={!isPrimaryEnabled()} className=\"App-cta Confirmation-box-button\" onClick={onConfirmationClick}>\r\n        {getPrimaryText()}\r\n      </button>\r\n    </Modal>\r\n  );\r\n}\r\n","import {\r\n  formatAmount,\r\n  bigNumberify,\r\n  isAddressZero,\r\n  USD_DECIMALS,\r\n  MAX_REFERRAL_CODE_LENGTH,\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n} from \"../../lib/legacy\";\r\nimport { encodeReferralCode, getReferralCodeOwner } from \"../../domain/referrals\";\r\n\r\nexport const REFERRAL_CODE_REGEX = /^\\w+$/; // only number, string and underscore is allowed\r\nexport const REGEX_VERIFY_BYTES32 = /^0x[0-9a-f]{64}$/;\r\n\r\nexport function isRecentReferralCodeNotExpired(referralCodeInfo) {\r\n  const REFERRAL_DATA_MAX_TIME = 60000 * 5; // 5 minutes\r\n  if (referralCodeInfo.time) {\r\n    return referralCodeInfo.time + REFERRAL_DATA_MAX_TIME > Date.now();\r\n  }\r\n}\r\n\r\nexport async function getReferralCodeTakenStatus(account, referralCode, chainId) {\r\n  const referralCodeBytes32 = encodeReferralCode(referralCode);\r\n  const [ownerArbitrum, ownerAvax] = await Promise.all([\r\n    getReferralCodeOwner(ARBITRUM, referralCodeBytes32),\r\n    getReferralCodeOwner(AVALANCHE, referralCodeBytes32),\r\n  ]);\r\n\r\n  const takenOnArb =\r\n    !isAddressZero(ownerArbitrum) && (ownerArbitrum !== account || (ownerArbitrum === account && chainId === ARBITRUM));\r\n  const takenOnAvax =\r\n    !isAddressZero(ownerAvax) && (ownerAvax !== account || (ownerAvax === account && chainId === AVALANCHE));\r\n\r\n  const referralCodeTakenInfo = {\r\n    [ARBITRUM]: takenOnArb,\r\n    [AVALANCHE]: takenOnAvax,\r\n    both: takenOnArb && takenOnAvax,\r\n    ownerArbitrum,\r\n    ownerAvax,\r\n  };\r\n\r\n  if (referralCodeTakenInfo.both) {\r\n    return { status: \"all\", info: referralCodeTakenInfo };\r\n  }\r\n  if (referralCodeTakenInfo[chainId]) {\r\n    return { status: \"current\", info: referralCodeTakenInfo };\r\n  }\r\n  if (chainId === AVALANCHE ? referralCodeTakenInfo[ARBITRUM] : referralCodeTakenInfo[AVALANCHE]) {\r\n    return { status: \"other\", info: referralCodeTakenInfo };\r\n  }\r\n  return { status: \"none\", info: referralCodeTakenInfo };\r\n}\r\n\r\nexport function getTierIdDisplay(tierId) {\r\n  return Number(tierId) + 1;\r\n}\r\n\r\nexport const tierRebateInfo = {\r\n  0: 5,\r\n  1: 10,\r\n  2: 15,\r\n};\r\n\r\nexport const tierDiscountInfo = {\r\n  0: 5,\r\n  1: 10,\r\n  2: 10,\r\n};\r\n\r\nfunction areObjectsWithSameKeys(obj1, obj2) {\r\n  return Object.keys(obj1).every((key) => key in obj2);\r\n}\r\n\r\nexport function deserializeSampleStats(input) {\r\n  const parsedData = JSON.parse(input);\r\n  if (!Array.isArray(parsedData)) return [];\r\n  return parsedData\r\n    .map((data) => {\r\n      if (!areObjectsWithSameKeys(getSampleReferrarStat(), data)) return null;\r\n      return Object.keys(data).reduce((acc, cv) => {\r\n        const currentValue = data[cv];\r\n        if (currentValue?.type === \"BigNumber\") {\r\n          acc[cv] = bigNumberify(currentValue.hex || 0);\r\n        } else {\r\n          acc[cv] = currentValue;\r\n        }\r\n        return acc;\r\n      }, {});\r\n    })\r\n    .filter(Boolean);\r\n}\r\n\r\nexport const getSampleReferrarStat = (code = \"\", ownerOnOtherNetwork = \"\", account = \"\") => {\r\n  return {\r\n    discountUsd: bigNumberify(0),\r\n    referralCode: code,\r\n    totalRebateUsd: bigNumberify(0),\r\n    tradedReferralsCount: 0,\r\n    registeredReferralsCount: 0,\r\n    trades: 0,\r\n    volume: bigNumberify(0),\r\n    time: Date.now(),\r\n    ownerOnOtherChain: {\r\n      code: encodeReferralCode(code),\r\n      codeString: code,\r\n      owner: undefined,\r\n      isTaken: !isAddressZero(ownerOnOtherNetwork),\r\n      isTakenByCurrentUser:\r\n        !isAddressZero(ownerOnOtherNetwork) && ownerOnOtherNetwork.toLowerCase() === account.toLowerCase(),\r\n    },\r\n  };\r\n};\r\n\r\nexport function getUSDValue(value, decimals = 2) {\r\n  return `$${formatAmount(value, USD_DECIMALS, decimals, true, \"0.00\")}`;\r\n}\r\n\r\nexport function getCodeError(value) {\r\n  const trimmedValue = value.trim();\r\n  if (!trimmedValue) return \"\";\r\n\r\n  if (trimmedValue.length > MAX_REFERRAL_CODE_LENGTH) {\r\n    return `The referral code can't be more than ${MAX_REFERRAL_CODE_LENGTH} characters.`;\r\n  }\r\n\r\n  if (!REFERRAL_CODE_REGEX.test(trimmedValue)) {\r\n    return \"Only letters, numbers and underscores are allowed.\";\r\n  }\r\n  return \"\";\r\n}\r\n\r\nexport function getTwitterShareUrl(referralCode) {\r\n  const message = \"Trying out trading on @GMX_IO, up to 30x leverage on $BTC, $ETH %0a%0aFor fee discounts use:\";\r\n\r\n  return `http://twitter.com/intent/tweet?text=${message}&url=https://gmx.io?ref=${referralCode}`;\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useState, useEffect, useMemo } from \"react\";\r\nimport useSWR from \"swr\";\r\n\r\nimport ReferralStorage from \"../abis/ReferralStorage.json\";\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  MAX_REFERRAL_CODE_LENGTH,\r\n  bigNumberify,\r\n  isAddressZero,\r\n  helperToast,\r\n  getProvider,\r\n  isHashZero,\r\n  REFERRAL_CODE_KEY,\r\n} from \"../lib/legacy\";\r\nimport { arbitrumReferralsGraphClient, avalancheReferralsGraphClient } from \"./common\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { REGEX_VERIFY_BYTES32 } from \"../components/Referrals/referralsHelper\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\n\r\nconst ACTIVE_CHAINS = [ARBITRUM, AVALANCHE];\r\nconst DISTRIBUTION_TYPE_REBATES = \"1\";\r\nconst DISTRIBUTION_TYPE_DISCOUNT = \"2\";\r\n\r\nfunction getGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumReferralsGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheReferralsGraphClient;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function decodeReferralCode(hexCode) {\r\n  try {\r\n    return ethers.utils.parseBytes32String(hexCode);\r\n  } catch (ex) {\r\n    let code = \"\";\r\n    hexCode = hexCode.substring(2);\r\n    for (let i = 0; i < 32; i++) {\r\n      code += String.fromCharCode(parseInt(hexCode.substring(i * 2, i * 2 + 2), 16));\r\n    }\r\n    return code.trim();\r\n  }\r\n}\r\n\r\nexport function encodeReferralCode(code) {\r\n  let final = code.replace(/[^\\w_]/g, \"\"); // replace everything other than numbers, string  and underscor to ''\r\n  if (final.length > MAX_REFERRAL_CODE_LENGTH) {\r\n    return ethers.constants.HashZero;\r\n  }\r\n  return ethers.utils.formatBytes32String(final);\r\n}\r\n\r\nasync function getCodeOwnersData(network, account, codes = []) {\r\n  if (codes.length === 0 || !account || !network) {\r\n    return undefined;\r\n  }\r\n  const query = gql`\r\n    query allCodes($codes: [String!]!) {\r\n      referralCodes(where: { code_in: $codes }) {\r\n        owner\r\n        id\r\n      }\r\n    }\r\n  `;\r\n  return getGraphClient(network)\r\n    .query({ query, variables: { codes } })\r\n    .then(({ data }) => {\r\n      const { referralCodes } = data;\r\n      const codeOwners = referralCodes.reduce((acc, cv) => {\r\n        acc[cv.id] = cv.owner;\r\n        return acc;\r\n      }, {});\r\n      return codes.map((code) => {\r\n        const owner = codeOwners[code];\r\n        return {\r\n          code,\r\n          codeString: decodeReferralCode(code),\r\n          owner,\r\n          isTaken: Boolean(owner),\r\n          isTakenByCurrentUser: owner && owner.toLowerCase() === account.toLowerCase(),\r\n        };\r\n      });\r\n    });\r\n}\r\n\r\nexport function useUserCodesOnAllChain(account) {\r\n  const [data, setData] = useState(null);\r\n  const query = gql`\r\n    query referralCodesOnAllChain($account: String!) {\r\n      referralCodes(first: 1000, where: { owner: $account }) {\r\n        code\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    async function main() {\r\n      const [arbitrumCodes, avalancheCodes] = await Promise.all(\r\n        ACTIVE_CHAINS.map((chainId) => {\r\n          return getGraphClient(chainId)\r\n            .query({ query, variables: { account: (account || \"\").toLowerCase() } })\r\n            .then(({ data }) => {\r\n              return data.referralCodes.map((c) => c.code);\r\n            });\r\n        })\r\n      );\r\n      const [codeOwnersOnAvax = [], codeOwnersOnArbitrum = []] = await Promise.all([\r\n        getCodeOwnersData(AVALANCHE, account, arbitrumCodes),\r\n        getCodeOwnersData(ARBITRUM, account, avalancheCodes),\r\n      ]);\r\n\r\n      setData({\r\n        [ARBITRUM]: codeOwnersOnAvax.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n        [AVALANCHE]: codeOwnersOnArbitrum.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n      });\r\n    }\r\n\r\n    main();\r\n  }, [account, query]);\r\n  return data;\r\n}\r\n\r\nexport function useReferralsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const ownerOnOtherChain = useUserCodesOnAllChain(account);\r\n  useEffect(() => {\r\n    if (!chainId || !account) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    const startOfDayTimestamp = Math.floor(parseInt(Date.now() / 1000) / 86400) * 86400;\r\n    const query = gql`\r\n      query referralData($typeIds: [String!]!, $account: String!, $timestamp: Int!, $referralTotalStatsId: String!) {\r\n        distributions(\r\n          first: 1000\r\n          orderBy: timestamp\r\n          orderDirection: desc\r\n          where: { receiver: $account, typeId_in: $typeIds }\r\n        ) {\r\n          receiver\r\n          amount\r\n          typeId\r\n          token\r\n          transactionHash\r\n          timestamp\r\n        }\r\n        referrerTotalStats: referrerStats(\r\n          first: 1000\r\n          orderBy: volume\r\n          orderDirection: desc\r\n          where: { period: total, referrer: $account }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referrerLastDayStats: referrerStats(\r\n          first: 1000\r\n          where: { period: daily, referrer: $account, timestamp: $timestamp }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referralCodes(first: 1000, where: { owner: $account }) {\r\n          code\r\n        }\r\n        referralTotalStats: referralStat(id: $referralTotalStatsId) {\r\n          volume\r\n          discountUsd\r\n        }\r\n        referrerTierInfo: referrer(id: $account) {\r\n          tierId\r\n          id\r\n          discountShare\r\n        }\r\n      }\r\n    `;\r\n    setLoading(true);\r\n\r\n    getGraphClient(chainId)\r\n      .query({\r\n        query,\r\n        variables: {\r\n          typeIds: [DISTRIBUTION_TYPE_REBATES, DISTRIBUTION_TYPE_DISCOUNT],\r\n          account: (account || \"\").toLowerCase(),\r\n          timestamp: startOfDayTimestamp,\r\n          referralTotalStatsId: account && `total:0:${account.toLowerCase()}`,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        const rebateDistributions = [];\r\n        const discountDistributions = [];\r\n        res.data.distributions.forEach((d) => {\r\n          const item = {\r\n            timestamp: parseInt(d.timestamp),\r\n            transactionHash: d.transactionHash,\r\n            receiver: ethers.utils.getAddress(d.receiver),\r\n            amount: bigNumberify(d.amount),\r\n            typeId: d.typeId,\r\n            token: ethers.utils.getAddress(d.token),\r\n          };\r\n          if (d.typeId === DISTRIBUTION_TYPE_REBATES) {\r\n            rebateDistributions.push(item);\r\n          } else {\r\n            discountDistributions.push(item);\r\n          }\r\n        });\r\n\r\n        function prepareStatsItem(e) {\r\n          return {\r\n            volume: bigNumberify(e.volume),\r\n            trades: parseInt(e.trades),\r\n            tradedReferralsCount: parseInt(e.tradedReferralsCount),\r\n            registeredReferralsCount: parseInt(e.registeredReferralsCount),\r\n            totalRebateUsd: bigNumberify(e.totalRebateUsd),\r\n            discountUsd: bigNumberify(e.discountUsd),\r\n            referralCode: decodeReferralCode(e.referralCode),\r\n            ownerOnOtherChain: ownerOnOtherChain?.[chainId][e.referralCode],\r\n          };\r\n        }\r\n\r\n        function getCumulativeStats(data = []) {\r\n          return data.reduce(\r\n            (acc, cv) => {\r\n              acc.totalRebateUsd = acc.totalRebateUsd.add(cv.totalRebateUsd);\r\n              acc.volume = acc.volume.add(cv.volume);\r\n              acc.discountUsd = acc.discountUsd.add(cv.discountUsd);\r\n              acc.trades = acc.trades + cv.trades;\r\n              acc.tradedReferralsCount = acc.tradedReferralsCount + cv.tradedReferralsCount;\r\n              acc.registeredReferralsCount = acc.registeredReferralsCount + cv.registeredReferralsCount;\r\n              return acc;\r\n            },\r\n            {\r\n              totalRebateUsd: bigNumberify(0),\r\n              volume: bigNumberify(0),\r\n              discountUsd: bigNumberify(0),\r\n              trades: 0,\r\n              tradedReferralsCount: 0,\r\n              registeredReferralsCount: 0,\r\n            }\r\n          );\r\n        }\r\n\r\n        let referrerTotalStats = res.data.referrerTotalStats.map(prepareStatsItem);\r\n        setData({\r\n          rebateDistributions,\r\n          discountDistributions,\r\n          referrerTotalStats,\r\n          referrerTierInfo: res.data.referrerTierInfo,\r\n          referrerLastDayStats: res.data.referrerLastDayStats.map(prepareStatsItem),\r\n          cumulativeStats: getCumulativeStats(referrerTotalStats),\r\n          codes: res.data.referralCodes.map((e) => decodeReferralCode(e.code)),\r\n          referralTotalStats: res.data.referralTotalStats\r\n            ? {\r\n                volume: bigNumberify(res.data.referralTotalStats.volume),\r\n                discountUsd: bigNumberify(res.data.referralTotalStats.discountUsd),\r\n              }\r\n            : {\r\n                volume: bigNumberify(0),\r\n                discountUsd: bigNumberify(0),\r\n              },\r\n        });\r\n      })\r\n      .catch(console.warn)\r\n      .finally(() => {\r\n        setLoading(false);\r\n      });\r\n  }, [setData, chainId, account, ownerOnOtherChain]);\r\n\r\n  return {\r\n    data: data || null,\r\n    loading,\r\n  };\r\n}\r\n\r\nexport async function registerReferralCode(chainId, referralCode, library, opts) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"registerCode\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function setTraderReferralCodeByUser(chainId, referralCode, library, opts) {\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  const codeOwner = await contract.codeOwners(referralCodeHex);\r\n  if (isAddressZero(codeOwner)) {\r\n    const errorMsg = \"Referral code does not exist\";\r\n    helperToast.error(errorMsg);\r\n    return Promise.reject(errorMsg);\r\n  }\r\n  return callContract(chainId, contract, \"setTraderReferralCodeByUser\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function getReferralCodeOwner(chainId, referralCode) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const provider = getProvider(null, chainId);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, provider);\r\n  const codeOwner = await contract.codeOwners(referralCode);\r\n  return codeOwner;\r\n}\r\n\r\nexport function useUserReferralCode(library, chainId, account) {\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: onChainCode } = useSWR(\r\n    account && [\"ReferralStorage\", chainId, referralStorageAddress, \"traderReferralCodes\", account],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const { data: localStorageCodeOwner } = useSWR(\r\n    localStorageCode &&\r\n      REGEX_VERIFY_BYTES32.test(localStorageCode) && [\r\n        \"ReferralStorage\",\r\n        chainId,\r\n        referralStorageAddress,\r\n        \"codeOwners\",\r\n        localStorageCode,\r\n      ],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const [attachedOnChain, userReferralCode, userReferralCodeString] = useMemo(() => {\r\n    if (onChainCode && !isHashZero(onChainCode)) {\r\n      return [true, onChainCode, decodeReferralCode(onChainCode)];\r\n    } else if (localStorageCodeOwner && !isAddressZero(localStorageCodeOwner)) {\r\n      return [false, localStorageCode, decodeReferralCode(localStorageCode)];\r\n    }\r\n    return [false];\r\n  }, [localStorageCode, localStorageCodeOwner, onChainCode]);\r\n\r\n  return {\r\n    userReferralCode,\r\n    userReferralCodeString,\r\n    attachedOnChain,\r\n  };\r\n}\r\n\r\nexport function useReferrerTier(library, chainId, account) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: referrerTier, mutate: mutateReferrerTier } = useSWR(\r\n    account && [`ReferralStorage:referrerTiers`, chainId, referralStorageAddress, \"referrerTiers\", account],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    referrerTier,\r\n    mutateReferrerTier,\r\n  };\r\n}\r\n\r\nexport function useCodeOwner(library, chainId, account, code) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: codeOwner, mutate: mutateCodeOwner } = useSWR(\r\n    account && code && [`ReferralStorage:codeOwners`, chainId, referralStorageAddress, \"codeOwners\", code],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    codeOwner,\r\n    mutateCodeOwner,\r\n  };\r\n}\r\n\r\nexport async function validateReferralCodeExists(referralCode, chainId) {\r\n  const referralCodeBytes32 = encodeReferralCode(referralCode);\r\n  const referralCodeOwner = await getReferralCodeOwner(chainId, referralCodeBytes32);\r\n  return !isAddressZero(referralCodeOwner);\r\n}\r\n\r\nexport function useAffiliateCodes(chainId, account) {\r\n  const [affiliateCodes, setAffiliateCodes] = useState({ code: null, success: false });\r\n  const query = gql`\r\n    query userReferralCodes($account: String!) {\r\n      referrerTotalStats: referrerStats(\r\n        first: 1000\r\n        orderBy: volume\r\n        orderDirection: desc\r\n        where: { period: total, referrer: $account }\r\n      ) {\r\n        referralCode\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    if (!chainId) return;\r\n    getGraphClient(chainId)\r\n      .query({ query, variables: { account: account?.toLowerCase() } })\r\n      .then((res) => {\r\n        const parsedAffiliateCodes = res?.data?.referrerTotalStats.map((c) => decodeReferralCode(c?.referralCode));\r\n        setAffiliateCodes({ code: parsedAffiliateCodes[0], success: true });\r\n      });\r\n    return () => {\r\n      setAffiliateCodes({ code: null, success: false });\r\n    };\r\n  }, [chainId, query, account]);\r\n  return affiliateCodes;\r\n}\r\n","import { getNativeToken } from \"../../config/Tokens\";\r\nimport { ethers } from \"ethers\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport { TokenInfo, Token } from \"../../domain/tokens/types\";\r\nimport { get1InchSwapUrl } from \"../../domain/common\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\ntype Props = {\r\n  chainId: number;\r\n  modalError: string;\r\n  isShort: boolean;\r\n  isLong: boolean;\r\n  fromToken: Token;\r\n  toToken: Token;\r\n  shortCollateralToken: TokenInfo;\r\n  setModalError: () => void;\r\n};\r\n\r\nexport default function NoLiquidityErrorModal({\r\n  chainId,\r\n  fromToken,\r\n  toToken,\r\n  shortCollateralToken,\r\n  isLong,\r\n  isShort,\r\n  modalError,\r\n  setModalError,\r\n}: Props) {\r\n  const nativeToken = getNativeToken(chainId);\r\n  const inputCurrency = fromToken.address === AddressZero ? nativeToken.symbol : fromToken.address;\r\n  let outputCurrency;\r\n  if (isLong) {\r\n    outputCurrency = toToken.address === AddressZero ? nativeToken.symbol : toToken.address;\r\n  } else {\r\n    outputCurrency = shortCollateralToken.address;\r\n  }\r\n  const swapTokenSymbol = isLong ? toToken.symbol : shortCollateralToken.symbol;\r\n  const oneInchSwapUrl = get1InchSwapUrl(chainId, inputCurrency, outputCurrency);\r\n  const label =\r\n    modalError === \"BUFFER\" ? `${shortCollateralToken.symbol} Required` : `${fromToken.symbol} Pool Capacity Reached`;\r\n\r\n  return (\r\n    <Modal isVisible={Boolean(modalError)} setIsVisible={setModalError} label={label} isNifty={true} className=\"Error-modal font-base\">\r\n      <div className=\"Modal__text\">\r\n        <div>\r\n          You need to select {swapTokenSymbol} as the \"Pay\" token to use it for collateral to initiate this trade.\r\n        </div>\r\n        <br />\r\n        <div>\r\n          As there is not enough liquidity in GLP to swap {fromToken.symbol} to {swapTokenSymbol}, you can use the option\r\n          below to do so:\r\n        </div>\r\n        <br />\r\n\r\n        <a className=\"Modal__link\" href={oneInchSwapUrl} target=\"_blank\" rel=\"noreferrer\">\r\n          Buy {swapTokenSymbol} on 1inch\r\n        </a>\r\n\r\n        {isShort && (\r\n          <div>\r\n            Alternatively you can select a different \"Collateral In\" token.\r\n            <br />\r\n            <br />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport { convertInputNum } from '../../utils/sepThousands';\r\nimport Button from './../button/Button';\r\n\r\nconst NumberInput_v2 = (props) => {\r\n\tconst {\r\n\t\tvalue,\r\n\t\tsetValue,\r\n\t\tsetBtnActive,\r\n\t\tcurrency,\r\n\t\thasError\r\n\t} = props;\r\n\r\n\tconst [hasFocus, setHasFocus] = useState('');\r\n\tconst cls = (props.className ?? '') + (hasError ? ' error' : (hasFocus ? ' hlight' : ''));\r\n\r\n\treturn (\r\n\t\t<div className=\"input-container input_default\">\r\n\t\t\t<input type=\"text\"\r\n\t\t\t\t{...props}\r\n\t\t\t\tclassName={cls}\r\n\t\t\t\tvalue={value}\r\n\t\t\t\tonChange={e => {\r\n\t\t\t\t\tif (setBtnActive) {\r\n\t\t\t\t\t\tsetBtnActive(true)\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetValue(convertInputNum(e.target.value))\r\n\t\t\t\t}}\r\n\t\t\t\t\r\n\t\t\t\tonFocus={() => {\r\n\t\t\t\t\tsetHasFocus(true);\r\n\t\t\t\t}}\r\n\t\t\t\tonBlur={() => {\r\n\t\t\t\t\tsetHasFocus(false);\r\n\r\n\t\t\t\t\tif(!value && setBtnActive) {\r\n\t\t\t\t\t\tsetBtnActive(false)\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t\t{currency ?\r\n\t\t\t\t<Button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tclassName=\"btn_plain currency-label\"\r\n\t\t\t\t\tdisabled={true}\r\n\t\t\t\t>\r\n\t\t\t\t\t{typeof currency === 'string' ?\r\n\t\t\t\t\t\tcurrency\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<img src={currency.icon} alt={currency.text + ' icon'} />\r\n\t\t\t\t\t\t\t{currency.text}\t\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Button>\r\n\t\t\t\t: ''}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default NumberInput_v2;","export default __webpack_public_path__ + \"static/media/icon-repay.87f9c036.svg\";","import React, { useEffect, useMemo, useState } from \"react\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport { t, Trans } from \"@lingui/macro\";\r\nimport Slider, { SliderTooltip } from \"rc-slider\";\r\nimport \"rc-slider/assets/index.css\";\r\nimport \"./SwapBox.css\";\r\n\r\nimport cx from \"classnames\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { IoMdSwap } from \"react-icons/io\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  adjustForDecimals,\r\n  approveTokens,\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  BASIS_POINTS_DIVISOR,\r\n  bigNumberify,\r\n  calculatePositionDelta,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  DUST_BNB,\r\n  expandDecimals,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  getChainName,\r\n  getExchangeRate,\r\n  getExchangeRateDisplay,\r\n  getLeverage,\r\n  getLiquidationPrice,\r\n  getMostAbundantStableToken,\r\n  getNextFromAmount,\r\n  getNextToAmount,\r\n  getPositionKey,\r\n  getTokenInfo,\r\n  getUsd,\r\n  helperToast,\r\n  IS_NETWORK_DISABLED,\r\n  isSupportedChain,\r\n  isTriggerRatioInverted,\r\n  LEVERAGE_ORDER_OPTIONS,\r\n  LIMIT,\r\n  LONG,\r\n  MARGIN_FEE_BASIS_POINTS,\r\n  MARKET,\r\n  parseValue,\r\n  PRECISION,\r\n  replaceNativeTokenAddress,\r\n  SHORT,\r\n  shouldRaiseGasError,\r\n  STOP,\r\n  SWAP,\r\n  SWAP_OPTIONS,\r\n  SWAP_ORDER_OPTIONS,\r\n  USD_DECIMALS,\r\n  USDG_ADDRESS,\r\n  USDG_DECIMALS,\r\n  useLocalStorageByChainId,\r\n  useLocalStorageSerializeKey,\r\n  usePrevious,\r\n  MAX_ALLOWED_LEVERAGE,\r\n  BORROW,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport * as Api from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport TokenSelector from \"./TokenSelector\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport ConfirmationBox from \"./ConfirmationBox\";\r\nimport OrdersToa from \"./OrdersToa\";\r\n\r\nimport { getToken, getTokenBySymbol, getTokens, getWhitelistedTokens } from \"../../config/Tokens\";\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Router from \"../../abis/Router.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport WETH from \"../../abis/WETH.json\";\r\n\r\nimport longImg from \"../../img/ddl/long.svg\";\r\nimport shortImg from \"../../img/ddl/short.svg\";\r\nimport swapImg from \"../../img/swap.svg\";\r\nimport longActiveImg from \"../../img/ddl/long_active.svg\";\r\nimport shortActiveImg from \"../../img/ddl/short_active.svg\";\r\n\r\nimport { useUserReferralCode } from \"../../domain/referrals\";\r\nimport NoLiquidityErrorModal from \"./NoLiquidityErrorModal\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\nimport { DDL_AccountManager, DDL_AccountManager_abi, USDC } from './../../../../components/utils/contracts';\r\nimport Currency from './../../../../components/Currency';\r\nimport NumberInput from './../../../../components/UI/input/NumberInput';\r\nimport NumberInput_v2 from './../../../../components/UI/input/NumberInput_v2';\r\nimport icon_repay from '../../../../img/icon-repay.svg';\r\n\r\nconst SWAP_ICONS = {\r\n  [LONG]: longImg,\r\n  [SHORT]: shortImg,\r\n  [SWAP]: swapImg,\r\n  Long_active: longActiveImg,\r\n  Short_active: shortActiveImg,\r\n};\r\nconst { AddressZero } = ethers.constants;\r\n\r\nconst leverageSliderHandle = (props) => {\r\n  const { value, dragging, index, ...restProps } = props;\r\n  return (\r\n    <SliderTooltip\r\n      prefixCls=\"rc-slider-tooltip\"\r\n      overlay={`${value}%`}\r\n      visible={dragging}\r\n      placement=\"top\"\r\n      key={index}\r\n    >\r\n      <Slider.Handle value={value} {...restProps} />\r\n    </SliderTooltip>\r\n  );\r\n};\r\n\r\nfunction getNextAveragePrice({ size, sizeDelta, hasProfit, delta, nextPrice, isLong }) {\r\n  if (!size || !sizeDelta || !delta || !nextPrice) {\r\n    return;\r\n  }\r\n  const nextSize = size.add(sizeDelta);\r\n  let divisor;\r\n  if (isLong) {\r\n    divisor = hasProfit ? nextSize.add(delta) : nextSize.sub(delta);\r\n  } else {\r\n    divisor = hasProfit ? nextSize.sub(delta) : nextSize.add(delta);\r\n  }\r\n  if (!divisor || divisor.eq(0)) {\r\n    return;\r\n  }\r\n  const nextAveragePrice = nextPrice.mul(nextSize).div(divisor);\r\n  return nextAveragePrice;\r\n}\r\n\r\nexport default function SwapBox(props) {\r\n  const {\r\n    positions,\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    infoTokens,\r\n    active,\r\n    library,\r\n    account,\r\n    fromTokenAddress,\r\n    setFromTokenAddress,\r\n    toTokenAddress,\r\n    setToTokenAddress,\r\n    swapOption,\r\n    setSwapOption,\r\n    positionsMap,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    tokenSelection,\r\n    setTokenSelection,\r\n    setIsConfirming,\r\n    isConfirming,\r\n    isPendingConfirmation,\r\n    setIsPendingConfirmation,\r\n    flagOrdersEnabled,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    savedSlippageAmount,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    orders,\r\n    savedIsPnlInLeverage,\r\n    orderBookApproved,\r\n    positionRouterApproved,\r\n    isWaitingForPluginApproval,\r\n    approveOrderBook,\r\n    approvePositionRouter,\r\n    setIsWaitingForPluginApproval,\r\n    isWaitingForPositionRouterApproval,\r\n    setIsWaitingForPositionRouterApproval,\r\n    isPluginApproving,\r\n    isPositionRouterApproving,\r\n    savedShouldDisableValidationForTesting,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n    ethShortExists,\r\n    ethLongExists,\r\n    setRegisterVisible\r\n  } = props;\r\n\r\n  \r\n\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [toValue, setToValue] = useState(\"\");\r\n  const [anchorOnFromAmount, setAnchorOnFromAmount] = useState(true);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isWaitingForApproval, setIsWaitingForApproval] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [modalError, setModalError] = useState(false);\r\n  const [isHigherSlippageAllowed, setIsHigherSlippageAllowed] = useState(false);\r\n  const { attachedOnChain, userReferralCode } = useUserReferralCode(library, chainId, account);\r\n\r\n  let allowedSlippage = savedSlippageAmount;\r\n  if (isHigherSlippageAllowed) {\r\n    allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  }\r\n\r\n  const defaultCollateralSymbol = getConstant(chainId, \"defaultCollateralSymbol\");\r\n  // TODO hack with useLocalStorageSerializeKey\r\n  const [shortCollateralAddress, setShortCollateralAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    \"Short-Collateral-Address\",\r\n    getTokenBySymbol(chainId, defaultCollateralSymbol).address\r\n  );\r\n  \r\n  const isLong = swapOption === LONG;\r\n  const isShort = swapOption === SHORT;\r\n  const isSwap = swapOption === SWAP;\r\n\r\n  const getLeaderboardLink = () => {\r\n    if (chainId === ARBITRUM) {\r\n      return \"https://www.gmx.house/arbitrum/leaderboard\";\r\n    }\r\n    if (chainId === AVALANCHE) {\r\n      return \"https://www.gmx.house/avalanche/leaderboard\";\r\n    }\r\n    return \"https://www.gmx.house\";\r\n  };\r\n\r\n  function getTokenLabel() {\r\n    switch (true) {\r\n      case isLong:\r\n        return t`Long`;\r\n      case isShort:\r\n        return t`Short`;\r\n      case isSwap:\r\n        return t`Receive`;\r\n      default:\r\n        return \"\";\r\n    }\r\n  }\r\n  const [leverageOption, setLeverageOption] = useLocalStorageSerializeKey(\r\n    [chainId, \"Exchange-swap-leverage-option\"],\r\n    \"20\"\r\n  );\r\n  const [isLeverageSliderEnabled, setIsLeverageSliderEnabled] = useLocalStorageSerializeKey(\r\n    [chainId, \"Exchange-swap-leverage-slider-enabled\"],\r\n    true\r\n  );\r\n\r\n  const hasLeverageOption = isLeverageSliderEnabled && !isNaN(parseFloat(leverageOption));\r\n\r\n  const [ordersToaOpen, setOrdersToaOpen] = useState(false);\r\n\r\n  // Market/Limit orders disabling\r\n  let [orderOption, setOrderOption] = useLocalStorageSerializeKey([chainId, \"Order-option\"], BORROW);\r\n  // let [orderOption, setOrderOption] = useState(BORROW);\r\n  \r\n  if (!flagOrdersEnabled) {\r\n    orderOption = MARKET;\r\n  }\r\n\r\n  const onOrderOptionChange = (option) => {\r\n    setOrderOption(option);\r\n  };\r\n\r\n  const isMarketOrder = orderOption === MARKET;\r\n  const isBorrow = orderOption === BORROW;\r\n\r\n  const [borrowValue, setBorrowValue] = useState(undefined);\r\n\r\n  \r\n  const orderOptions = isSwap ? SWAP_ORDER_OPTIONS : LEVERAGE_ORDER_OPTIONS;\r\n  const orderOptionLabels = { [STOP]: \"Trigger\" };\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(\"\");\r\n  const triggerPriceUsd = isMarketOrder ? 0 : parseValue(triggerPriceValue, USD_DECIMALS);\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const onTriggerRatioChange = (evt) => {\r\n    setTriggerRatioValue(evt.target.value || \"\");\r\n  };\r\n\r\n  let positionKey;\r\n  if (isLong) {\r\n    positionKey = getPositionKey(account, toTokenAddress, toTokenAddress, true, nativeTokenAddress);\r\n  }\r\n  if (isShort) {\r\n    positionKey = getPositionKey(account, shortCollateralAddress, toTokenAddress, false, nativeTokenAddress);\r\n  }\r\n\r\n  const existingPosition = positionKey ? positionsMap[positionKey] : undefined;\r\n  const hasExistingPosition = existingPosition && existingPosition.size && existingPosition.size.gt(0);\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  \r\n  // Tokens control\r\n  const tokens = getTokens(chainId);\r\n  // const fromTokens = tokens;\r\n  const fromTokens = [\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n  ]\r\n\r\n  const stableTokens = tokens.filter((token) => token.isStable);\r\n  const indexTokens = whitelistedTokens.filter((token) => !token.isStable && !token.isWrapped);\r\n  const shortableTokens = indexTokens.filter((token) => token.isShortable);\r\n\r\n  // let toTokens = tokens;\r\n  let toTokens = [\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f\",\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n  ]\r\n  // if (isLong) {\r\n  //   toTokens = indexTokens;\r\n  // }\r\n  // if (isShort) {\r\n  //   toTokens = shortableTokens;\r\n  // }\r\n\r\n  const needOrderBookApproval = !isMarketOrder && !orderBookApproved;\r\n  const prevNeedOrderBookApproval = usePrevious(needOrderBookApproval);\r\n\r\n  const needPositionRouterApproval = (isLong || isShort) && isMarketOrder && !positionRouterApproved;\r\n  const prevNeedPositionRouterApproval = usePrevious(needPositionRouterApproval);\r\n\r\n  useEffect(() => {\r\n    if (!needOrderBookApproval && prevNeedOrderBookApproval && isWaitingForPluginApproval) {\r\n      setIsWaitingForPluginApproval(false);\r\n      helperToast.success(<div>Orders enabled!</div>);\r\n    }\r\n  }, [needOrderBookApproval, prevNeedOrderBookApproval, setIsWaitingForPluginApproval, isWaitingForPluginApproval]);\r\n\r\n  useEffect(() => {\r\n    if (!needPositionRouterApproval && prevNeedPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      setIsWaitingForPositionRouterApproval(false);\r\n      helperToast.success(<div>Leverage enabled!</div>);\r\n    }\r\n  }, [\r\n    needPositionRouterApproval,\r\n    prevNeedPositionRouterApproval,\r\n    setIsWaitingForPositionRouterApproval,\r\n    isWaitingForPositionRouterApproval,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (!needOrderBookApproval && prevNeedOrderBookApproval && isWaitingForPluginApproval) {\r\n      setIsWaitingForPluginApproval(false);\r\n      helperToast.success(<div>Orders enabled!</div>);\r\n    }\r\n  }, [needOrderBookApproval, prevNeedOrderBookApproval, setIsWaitingForPluginApproval, isWaitingForPluginApproval]);\r\n\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const tokenAllowanceAddress = fromTokenAddress === AddressZero ? nativeTokenAddress : fromTokenAddress;\r\n  const { data: tokenAllowance } = useSWR(\r\n    active && [active, chainId, tokenAllowanceAddress, \"allowance\", account, DDL_AccountManager.address],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  \r\n  const { data: hasOutdatedUi } = Api.useHasOutdatedUi();\r\n  \r\n  const fromToken = getToken(chainId, fromTokenAddress);\r\n  const toToken = getToken(chainId, toTokenAddress);\r\n  const shortCollateralToken = getTokenInfo(infoTokens, shortCollateralAddress);\r\n\r\n  const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  const renderAvailableLongLiquidity = () => {\r\n    if (!isLong) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div className=\"Exchange-info-row\">\r\n        <div className=\"Exchange-info-label\">\r\n          <Trans>Available Liquidity</Trans>\r\n        </div>\r\n        <div className=\"align-right\">\r\n          <Tooltip\r\n            handle={`$${formatAmount(toTokenInfo.maxAvailableLong, USD_DECIMALS, 2, true)}`}\r\n            position=\"right-bottom\"\r\n            renderContent={() => {\r\n              return (\r\n                <>\r\n                  <StatsTooltipRow\r\n                    label={`Max ${toTokenInfo.symbol} long capacity`}\r\n                    value={formatAmount(toTokenInfo.maxLongCapacity, USD_DECIMALS, 0, true)}\r\n                  />\r\n                  <StatsTooltipRow\r\n                    label={`Current ${toTokenInfo.symbol} long`}\r\n                    value={formatAmount(toTokenInfo.guaranteedUsd, USD_DECIMALS, 0, true)}\r\n                  />\r\n                </>\r\n              );\r\n            }}\r\n          ></Tooltip>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const fromBalance = fromTokenInfo ? fromTokenInfo.balance : bigNumberify(0);\r\n  const toBalance = toTokenInfo ? toTokenInfo.balance : bigNumberify(0);\r\n\r\n  const fromAmount = parseValue(fromValue, fromToken && fromToken.decimals);\r\n  const toAmount = parseValue(toValue, toToken && toToken.decimals);\r\n\r\n  const isPotentialWrap = (fromToken.isNative && toToken.isWrapped) || (fromToken.isWrapped && toToken.isNative);\r\n  const isWrapOrUnwrap = isSwap && isPotentialWrap;\r\n  const needApproval =\r\n    fromTokenAddress !== AddressZero &&\r\n    tokenAllowance &&\r\n    fromAmount &&\r\n    fromAmount.gt(tokenAllowance) &&\r\n    !isWrapOrUnwrap;\r\n  \r\n  const prevFromTokenAddress = usePrevious(fromTokenAddress);\r\n  const prevNeedApproval = usePrevious(needApproval);\r\n  const prevToTokenAddress = usePrevious(toTokenAddress);\r\n\r\n  const fromUsdMin = getUsd(fromAmount, fromTokenAddress, false, infoTokens);\r\n  const toUsdMax = getUsd(toAmount, toTokenAddress, true, infoTokens, orderOption, triggerPriceUsd);\r\n\r\n  const indexTokenAddress = toTokenAddress === AddressZero ? nativeTokenAddress : toTokenAddress;\r\n  const collateralTokenAddress = isLong ? indexTokenAddress : shortCollateralAddress;\r\n  const collateralToken = getToken(chainId, collateralTokenAddress);\r\n\r\n  const [triggerRatioValue, setTriggerRatioValue] = useState(\"\");\r\n\r\n  const triggerRatioInverted = useMemo(() => {\r\n    return isTriggerRatioInverted(fromTokenInfo, toTokenInfo);\r\n  }, [toTokenInfo, fromTokenInfo]);\r\n\r\n  const maxToTokenOut = useMemo(() => {\r\n    const value = toTokenInfo.availableAmount?.gt(toTokenInfo.poolAmount?.sub(toTokenInfo.bufferAmount))\r\n      ? toTokenInfo.poolAmount?.sub(toTokenInfo.bufferAmount)\r\n      : toTokenInfo.availableAmount;\r\n\r\n    if (!value) {\r\n      return bigNumberify(0);\r\n    }\r\n\r\n    return value.gt(0) ? value : bigNumberify(0);\r\n  }, [toTokenInfo]);\r\n\r\n  const maxToTokenOutUSD = useMemo(() => {\r\n    return getUsd(maxToTokenOut, toTokenAddress, false, infoTokens);\r\n  }, [maxToTokenOut, toTokenAddress, infoTokens]);\r\n\r\n  const maxFromTokenInUSD = useMemo(() => {\r\n    const value = fromTokenInfo.maxUsdgAmount\r\n      ?.sub(fromTokenInfo.usdgAmount)\r\n      .mul(expandDecimals(1, USD_DECIMALS))\r\n      .div(expandDecimals(1, USDG_DECIMALS));\r\n\r\n    if (!value) {\r\n      return bigNumberify(0);\r\n    }\r\n\r\n    return value.gt(0) ? value : bigNumberify(0);\r\n  }, [fromTokenInfo]);\r\n\r\n  const maxFromTokenIn = useMemo(() => {\r\n    if (!fromTokenInfo.maxPrice) {\r\n      return bigNumberify(0);\r\n    }\r\n    return maxFromTokenInUSD?.mul(expandDecimals(1, fromTokenInfo.decimals)).div(fromTokenInfo.maxPrice).toString();\r\n  }, [maxFromTokenInUSD, fromTokenInfo]);\r\n\r\n  let maxSwapAmountUsd = bigNumberify(0);\r\n\r\n  if (maxToTokenOutUSD && maxFromTokenInUSD) {\r\n    maxSwapAmountUsd = maxToTokenOutUSD.lt(maxFromTokenInUSD) ? maxToTokenOutUSD : maxFromTokenInUSD;\r\n  }\r\n\r\n  const triggerRatio = useMemo(() => {\r\n    if (!triggerRatioValue) {\r\n      return bigNumberify(0);\r\n    }\r\n    let ratio = parseValue(triggerRatioValue, USD_DECIMALS);\r\n    if (ratio.eq(0)) {\r\n      return bigNumberify(0);\r\n    }\r\n    if (triggerRatioInverted) {\r\n      ratio = PRECISION.mul(PRECISION).div(ratio);\r\n    }\r\n    return ratio;\r\n  }, [triggerRatioValue, triggerRatioInverted]);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      fromToken &&\r\n      fromTokenAddress === prevFromTokenAddress &&\r\n      !needApproval &&\r\n      prevNeedApproval &&\r\n      isWaitingForApproval\r\n    ) {\r\n      setIsWaitingForApproval(false);\r\n      helperToast.success(<div>{fromToken.symbol} approved!</div>);\r\n    }\r\n  }, [\r\n    fromTokenAddress,\r\n    prevFromTokenAddress,\r\n    needApproval,\r\n    prevNeedApproval,\r\n    setIsWaitingForApproval,\r\n    fromToken.symbol,\r\n    isWaitingForApproval,\r\n    fromToken,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (!toTokens.find((token) => token.address === toTokenAddress)) {\r\n      setToTokenAddress(swapOption, toTokens[0].address);\r\n    }\r\n  }, [swapOption, toTokens, toTokenAddress, setToTokenAddress]);\r\n\r\n  useEffect(() => {\r\n    if (swapOption !== SHORT) {\r\n      return;\r\n    }\r\n    if (toTokenAddress === prevToTokenAddress) {\r\n      return;\r\n    }\r\n    for (let i = 0; i < stableTokens.length; i++) {\r\n      const stableToken = stableTokens[i];\r\n      const key = getPositionKey(account, stableToken.address, toTokenAddress, false, nativeTokenAddress);\r\n      const position = positionsMap[key];\r\n      if (position && position.size && position.size.gt(0)) {\r\n        setShortCollateralAddress(position.collateralToken.address);\r\n        return;\r\n      }\r\n    }\r\n  }, [\r\n    account,\r\n    toTokenAddress,\r\n    prevToTokenAddress,\r\n    swapOption,\r\n    positionsMap,\r\n    stableTokens,\r\n    nativeTokenAddress,\r\n    shortCollateralAddress,\r\n    setShortCollateralAddress,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const updateSwapAmounts = () => {\r\n      if (anchorOnFromAmount) {\r\n        if (!fromAmount) {\r\n          setToValue(\"\");\r\n          return;\r\n        }\r\n        if (toToken) {\r\n          const { amount: nextToAmount } = getNextToAmount(\r\n            chainId,\r\n            fromAmount,\r\n            fromTokenAddress,\r\n            toTokenAddress,\r\n            infoTokens,\r\n            undefined,\r\n            !isMarketOrder && triggerRatio,\r\n            usdgSupply,\r\n            totalTokenWeights,\r\n            isSwap\r\n          );\r\n\r\n          const nextToValue = formatAmountFree(nextToAmount, toToken.decimals, toToken.decimals);\r\n          setToValue(nextToValue);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!toAmount) {\r\n        setFromValue(\"\");\r\n        return;\r\n      }\r\n      if (fromToken) {\r\n        const { amount: nextFromAmount } = getNextFromAmount(\r\n          chainId,\r\n          toAmount,\r\n          fromTokenAddress,\r\n          toTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          !isMarketOrder && triggerRatio,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        const nextFromValue = formatAmountFree(nextFromAmount, fromToken.decimals, fromToken.decimals);\r\n        setFromValue(nextFromValue);\r\n      }\r\n    };\r\n\r\n    const updateLeverageAmounts = () => {\r\n      if (!hasLeverageOption) {\r\n        return;\r\n      }\r\n      if (anchorOnFromAmount) {\r\n        if (!fromAmount) {\r\n          setToValue(\"\");\r\n          return;\r\n        }\r\n\r\n        const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n        if (toTokenInfo && toTokenInfo.maxPrice && fromUsdMin && fromUsdMin.gt(0)) {\r\n          const leverageMultiplier = parseInt(leverageOption * BASIS_POINTS_DIVISOR);\r\n          const toTokenPriceUsd =\r\n            !isMarketOrder && triggerPriceUsd && triggerPriceUsd.gt(0) ? triggerPriceUsd : toTokenInfo.maxPrice;\r\n\r\n          const { feeBasisPoints } = getNextToAmount(\r\n            chainId,\r\n            fromAmount,\r\n            fromTokenAddress,\r\n            collateralTokenAddress,\r\n            infoTokens,\r\n            undefined,\r\n            undefined,\r\n            usdgSupply,\r\n            totalTokenWeights,\r\n            isSwap\r\n          );\r\n\r\n          let fromUsdMinAfterFee = fromUsdMin;\r\n          if (feeBasisPoints) {\r\n            fromUsdMinAfterFee = fromUsdMin.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n          }\r\n\r\n          const toNumerator = fromUsdMinAfterFee.mul(leverageMultiplier).mul(BASIS_POINTS_DIVISOR);\r\n          const toDenominator = bigNumberify(MARGIN_FEE_BASIS_POINTS)\r\n            .mul(leverageMultiplier)\r\n            .add(bigNumberify(BASIS_POINTS_DIVISOR).mul(BASIS_POINTS_DIVISOR));\r\n\r\n          const nextToUsd = toNumerator.div(toDenominator);\r\n\r\n          const nextToAmount = nextToUsd.mul(expandDecimals(1, toToken.decimals)).div(toTokenPriceUsd);\r\n\r\n          const nextToValue = formatAmountFree(nextToAmount, toToken.decimals, toToken.decimals);\r\n\r\n          setToValue(nextToValue);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!toAmount) {\r\n        setFromValue(\"\");\r\n        return;\r\n      }\r\n\r\n      const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n      if (fromTokenInfo && fromTokenInfo.minPrice && toUsdMax && toUsdMax.gt(0)) {\r\n        const leverageMultiplier = parseInt(leverageOption * BASIS_POINTS_DIVISOR);\r\n\r\n        const baseFromAmountUsd = toUsdMax.mul(BASIS_POINTS_DIVISOR).div(leverageMultiplier);\r\n\r\n        let fees = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n\r\n        const { feeBasisPoints } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          collateralTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n\r\n        if (feeBasisPoints) {\r\n          const swapFees = baseFromAmountUsd.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n          fees = fees.add(swapFees);\r\n        }\r\n\r\n        const nextFromUsd = baseFromAmountUsd.add(fees);\r\n\r\n        const nextFromAmount = nextFromUsd.mul(expandDecimals(1, fromToken.decimals)).div(fromTokenInfo.minPrice);\r\n\r\n        const nextFromValue = formatAmountFree(nextFromAmount, fromToken.decimals, fromToken.decimals);\r\n\r\n        setFromValue(nextFromValue);\r\n      }\r\n    };\r\n\r\n    if (isSwap) {\r\n      updateSwapAmounts();\r\n    }\r\n\r\n    if (isLong || isShort) {\r\n      updateLeverageAmounts();\r\n    }\r\n  }, [\r\n    anchorOnFromAmount,\r\n    fromAmount,\r\n    toAmount,\r\n    fromToken,\r\n    toToken,\r\n    fromTokenAddress,\r\n    toTokenAddress,\r\n    infoTokens,\r\n    isSwap,\r\n    isLong,\r\n    isShort,\r\n    leverageOption,\r\n    fromUsdMin,\r\n    toUsdMax,\r\n    isMarketOrder,\r\n    triggerPriceUsd,\r\n    triggerRatio,\r\n    hasLeverageOption,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    chainId,\r\n    collateralTokenAddress,\r\n    indexTokenAddress,\r\n  ]);\r\n\r\n  let entryMarkPrice;\r\n  let exitMarkPrice;\r\n  if (toTokenInfo) {\r\n    entryMarkPrice = swapOption === LONG ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n    exitMarkPrice = swapOption === LONG ? toTokenInfo.minPrice : toTokenInfo.maxPrice;\r\n  }\r\n\r\n  let leverage = bigNumberify(0);\r\n  if (fromUsdMin && toUsdMax && fromUsdMin.gt(0)) {\r\n    const fees = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    if (fromUsdMin.sub(fees).gt(0)) {\r\n      leverage = toUsdMax.mul(BASIS_POINTS_DIVISOR).div(fromUsdMin.sub(fees));\r\n    }\r\n  }\r\n\r\n  let nextAveragePrice = isMarketOrder ? entryMarkPrice : triggerPriceUsd;\r\n  if (hasExistingPosition) {\r\n    let nextDelta, nextHasProfit;\r\n\r\n    if (isMarketOrder) {\r\n      nextDelta = existingPosition.delta;\r\n      nextHasProfit = existingPosition.hasProfit;\r\n    } else {\r\n      const data = calculatePositionDelta(triggerPriceUsd || bigNumberify(0), existingPosition);\r\n      nextDelta = data.delta;\r\n      nextHasProfit = data.hasProfit;\r\n    }\r\n\r\n    nextAveragePrice = getNextAveragePrice({\r\n      size: existingPosition.size,\r\n      sizeDelta: toUsdMax,\r\n      hasProfit: nextHasProfit,\r\n      delta: nextDelta,\r\n      nextPrice: isMarketOrder ? entryMarkPrice : triggerPriceUsd,\r\n      isLong,\r\n    });\r\n  }\r\n\r\n  const liquidationPrice = getLiquidationPrice({\r\n    isLong,\r\n    size: hasExistingPosition ? existingPosition.size : bigNumberify(0),\r\n    collateral: hasExistingPosition ? existingPosition.collateral : bigNumberify(0),\r\n    averagePrice: nextAveragePrice,\r\n    entryFundingRate: hasExistingPosition ? existingPosition.entryFundingRate : bigNumberify(0),\r\n    cumulativeFundingRate: hasExistingPosition ? existingPosition.cumulativeFundingRate : bigNumberify(0),\r\n    sizeDelta: toUsdMax,\r\n    collateralDelta: fromUsdMin,\r\n    increaseCollateral: true,\r\n    increaseSize: true,\r\n  });\r\n\r\n  const existingLiquidationPrice = existingPosition ? getLiquidationPrice(existingPosition) : undefined;\r\n  let displayLiquidationPrice = liquidationPrice ? liquidationPrice : existingLiquidationPrice;\r\n\r\n  if (hasExistingPosition) {\r\n    const collateralDelta = fromUsdMin ? fromUsdMin : bigNumberify(0);\r\n    const sizeDelta = toUsdMax ? toUsdMax : bigNumberify(0);\r\n    leverage = getLeverage({\r\n      size: existingPosition.size,\r\n      sizeDelta,\r\n      collateral: existingPosition.collateral,\r\n      collateralDelta,\r\n      increaseCollateral: true,\r\n      entryFundingRate: existingPosition.entryFundingRate,\r\n      cumulativeFundingRate: existingPosition.cumulativeFundingRate,\r\n      increaseSize: true,\r\n      hasProfit: existingPosition.hasProfit,\r\n      delta: existingPosition.delta,\r\n      includeDelta: savedIsPnlInLeverage,\r\n    });\r\n  } else if (hasLeverageOption) {\r\n    leverage = bigNumberify(parseInt(leverageOption * BASIS_POINTS_DIVISOR));\r\n  }\r\n\r\n  const getSwapError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return [t`Swaps disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n\r\n    if (fromTokenAddress === toTokenAddress) {\r\n      return [t`Select different tokens`];\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      if ((toToken.isStable || toToken.isUsdg) && (fromToken.isStable || fromToken.isUsdg)) {\r\n        return [t`Select different tokens`];\r\n      }\r\n\r\n      if (fromToken.isNative && toToken.isWrapped) {\r\n        return [t`Select different tokens`];\r\n      }\r\n\r\n      if (toToken.isNative && fromToken.isWrapped) {\r\n        return [t`Select different tokens`];\r\n      }\r\n    }\r\n\r\n    if (!fromAmount || fromAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n    if (!toAmount || toAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n\r\n    const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n    if (!fromTokenInfo || !fromTokenInfo.minPrice) {\r\n      return [t`Incorrect network`];\r\n    }\r\n    if (\r\n      !savedShouldDisableValidationForTesting &&\r\n      fromTokenInfo &&\r\n      fromTokenInfo.balance &&\r\n      fromAmount &&\r\n      fromAmount.gt(fromTokenInfo.balance)\r\n    ) {\r\n      return [t`Insufficient ${fromTokenInfo.symbol} balance`];\r\n    }\r\n\r\n    const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n    if (!isMarketOrder) {\r\n      if (!triggerRatioValue || triggerRatio.eq(0)) {\r\n        return [t`Enter a price`];\r\n      }\r\n\r\n      const currentRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n      if (currentRate && currentRate.lt(triggerRatio)) {\r\n        return triggerRatioInverted ? [t`Price below Mark Price`] : [t`Price above Mark Price`];\r\n      }\r\n    }\r\n\r\n    if (\r\n      !isWrapOrUnwrap &&\r\n      toToken &&\r\n      toTokenAddress !== USDG_ADDRESS &&\r\n      toTokenInfo &&\r\n      toTokenInfo.availableAmount &&\r\n      toAmount.gt(toTokenInfo.availableAmount)\r\n    ) {\r\n      return [t`Insufficient liquidity`];\r\n    }\r\n    if (\r\n      !isWrapOrUnwrap &&\r\n      toAmount &&\r\n      toTokenInfo.bufferAmount &&\r\n      toTokenInfo.poolAmount &&\r\n      toTokenInfo.bufferAmount.gt(toTokenInfo.poolAmount.sub(toAmount))\r\n    ) {\r\n      return [t`Insufficient liquidity`];\r\n    }\r\n\r\n    if (\r\n      fromUsdMin &&\r\n      fromTokenInfo.maxUsdgAmount &&\r\n      fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n      fromTokenInfo.usdgAmount &&\r\n      fromTokenInfo.maxPrice\r\n    ) {\r\n      const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n      const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n      if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n        return [`${fromTokenInfo.symbol} pool exceeded`];\r\n      }\r\n    }\r\n\r\n    return [false];\r\n  };\r\n\r\n  const getLeverageError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return [t`Leverage disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (hasOutdatedUi) {\r\n      return [t`Page outdated, please refresh`];\r\n    }\r\n\r\n    if (!toAmount || toAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n\r\n    let toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n    if (toTokenInfo && toTokenInfo.isStable) {\r\n      return [t`${swapOption === LONG ? \"Longing\" : \"Shorting\"} ${toTokenInfo.symbol} not supported`];\r\n    }\r\n\r\n    const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n    if (\r\n      !savedShouldDisableValidationForTesting &&\r\n      fromTokenInfo &&\r\n      fromTokenInfo.balance &&\r\n      fromAmount &&\r\n      fromAmount.gt(fromTokenInfo.balance)\r\n    ) {\r\n      return [t`Insufficient ${fromTokenInfo.symbol} balance`];\r\n    }\r\n\r\n    if (leverage && leverage.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n    if (!isMarketOrder && (!triggerPriceValue || triggerPriceUsd.eq(0))) {\r\n      return [t`Enter a price`];\r\n    }\r\n\r\n    if (!hasExistingPosition && fromUsdMin && fromUsdMin.lt(expandDecimals(10, USD_DECIMALS))) {\r\n      return [t`Min order: 10 USD`];\r\n    }\r\n\r\n    if (leverage && leverage.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return [t`Min leverage: 1.1x`];\r\n    }\r\n\r\n    if (leverage && leverage.gt(MAX_ALLOWED_LEVERAGE)) {\r\n      return [t`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`];\r\n    }\r\n\r\n    if (!isMarketOrder && entryMarkPrice && triggerPriceUsd && !savedShouldDisableValidationForTesting) {\r\n      if (isLong && entryMarkPrice.lt(triggerPriceUsd)) {\r\n        return [t`Price above Mark Price`];\r\n      }\r\n      if (!isLong && entryMarkPrice.gt(triggerPriceUsd)) {\r\n        return [t`Price below Mark Price`];\r\n      }\r\n    }\r\n\r\n    if (isLong) {\r\n      let requiredAmount = toAmount;\r\n      if (fromTokenAddress !== toTokenAddress) {\r\n        const { amount: swapAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          toTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        requiredAmount = requiredAmount.add(swapAmount);\r\n\r\n        if (toToken && toTokenAddress !== USDG_ADDRESS) {\r\n          if (!toTokenInfo.availableAmount) {\r\n            return [t`Liquidity data not loaded`];\r\n          }\r\n          if (toTokenInfo.availableAmount && requiredAmount.gt(toTokenInfo.availableAmount)) {\r\n            return [t`Insufficient liquidity`];\r\n          }\r\n        }\r\n\r\n        if (\r\n          toTokenInfo.poolAmount &&\r\n          toTokenInfo.bufferAmount &&\r\n          toTokenInfo.bufferAmount.gt(toTokenInfo.poolAmount.sub(swapAmount))\r\n        ) {\r\n          return [t`Insufficient liquidity`, true, \"BUFFER\"];\r\n        }\r\n\r\n        if (\r\n          fromUsdMin &&\r\n          fromTokenInfo.maxUsdgAmount &&\r\n          fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n          fromTokenInfo.minPrice &&\r\n          fromTokenInfo.usdgAmount\r\n        ) {\r\n          const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n          const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n          if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n            return [t`${fromTokenInfo.symbol} pool exceeded, try different token`, true, \"MAX_USDG\"];\r\n          }\r\n        }\r\n      }\r\n\r\n      if (toTokenInfo && toTokenInfo.maxPrice) {\r\n        const sizeUsd = toAmount.mul(toTokenInfo.maxPrice).div(expandDecimals(1, toTokenInfo.decimals));\r\n        if (\r\n          toTokenInfo.maxGlobalLongSize &&\r\n          toTokenInfo.maxGlobalLongSize.gt(0) &&\r\n          toTokenInfo.maxAvailableLong &&\r\n          sizeUsd.gt(toTokenInfo.maxAvailableLong)\r\n        ) {\r\n          return [t`Max ${toTokenInfo.symbol} long exceeded`];\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isShort) {\r\n      let stableTokenAmount = bigNumberify(0);\r\n      if (fromTokenAddress !== shortCollateralAddress && fromAmount && fromAmount.gt(0)) {\r\n        const { amount: nextToAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          shortCollateralAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        stableTokenAmount = nextToAmount;\r\n        if (stableTokenAmount.gt(shortCollateralToken.availableAmount)) {\r\n          return [t`Insufficient liquidity, change \"Profits In\"`];\r\n        }\r\n\r\n        if (\r\n          shortCollateralToken.bufferAmount &&\r\n          shortCollateralToken.poolAmount &&\r\n          shortCollateralToken.bufferAmount.gt(shortCollateralToken.poolAmount.sub(stableTokenAmount))\r\n        ) {\r\n          // suggest swapping to collateralToken\r\n          return [t`Insufficient liquidity, change \"Profits In\"`, true, \"BUFFER\"];\r\n        }\r\n\r\n        if (\r\n          fromTokenInfo.maxUsdgAmount &&\r\n          fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n          fromTokenInfo.minPrice &&\r\n          fromTokenInfo.usdgAmount\r\n        ) {\r\n          const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n          const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n          if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n            return [t`${fromTokenInfo.symbol} pool exceeded, try different token`, true, \"MAX_USDG\"];\r\n          }\r\n        }\r\n      }\r\n      if (\r\n        !shortCollateralToken ||\r\n        !fromTokenInfo ||\r\n        !toTokenInfo ||\r\n        !toTokenInfo.maxPrice ||\r\n        !shortCollateralToken.availableAmount\r\n      ) {\r\n        return [t`Fetching token info...`];\r\n      }\r\n\r\n      const sizeUsd = toAmount.mul(toTokenInfo.maxPrice).div(expandDecimals(1, toTokenInfo.decimals));\r\n      const sizeTokens = sizeUsd\r\n        .mul(expandDecimals(1, shortCollateralToken.decimals))\r\n        .div(shortCollateralToken.minPrice);\r\n\r\n      if (!toTokenInfo.maxAvailableShort) {\r\n        return [t`Liquidity data not loaded`];\r\n      }\r\n\r\n      if (\r\n        toTokenInfo.maxGlobalShortSize &&\r\n        toTokenInfo.maxGlobalShortSize.gt(0) &&\r\n        toTokenInfo.maxAvailableShort &&\r\n        sizeUsd.gt(toTokenInfo.maxAvailableShort)\r\n      ) {\r\n        return [t`Max ${toTokenInfo.symbol} short exceeded`];\r\n      }\r\n\r\n      stableTokenAmount = stableTokenAmount.add(sizeTokens);\r\n      if (stableTokenAmount.gt(shortCollateralToken.availableAmount)) {\r\n        return [t`Insufficient liquidity, change \"Profits In\"`];\r\n      }\r\n    }\r\n\r\n    return [false];\r\n  };\r\n\r\n  const getToLabel = () => {\r\n    if (isSwap) {\r\n      return t`Receive`;\r\n    }\r\n    if (isLong) {\r\n      return t`Long`;\r\n    }\r\n    return t`Short`;\r\n  };\r\n\r\n  const getError = () => {\r\n    if (isSwap) {\r\n      return getSwapError();\r\n    }\r\n    return getLeverageError();\r\n  };\r\n\r\n  const renderOrdersToa = () => {\r\n    if (!ordersToaOpen) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <OrdersToa\r\n        setIsVisible={setOrdersToaOpen}\r\n        approveOrderBook={approveOrderBook}\r\n        isPluginApproving={isPluginApproving}\r\n      />\r\n    );\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return false;\r\n    }\r\n    if (isStopOrder) {\r\n      return true;\r\n    }\r\n    if (!active) {\r\n      return true;\r\n    }\r\n    if (!props.dgAddress) {\r\n      return true;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return false;\r\n    }\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return false;\r\n    }\r\n    if ((needApproval && isWaitingForApproval) || isApproving) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n    if (isApproving) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n\r\n  const getPrimaryText = () => {\r\n    if (isStopOrder) {\r\n      return t`Open a position`;\r\n    }\r\n    if (!active) {\r\n      return t`Connect Wallet`;\r\n    }\r\n    if (!props.dgAddress) {\r\n      return t`Create Trading Account`;\r\n    }\r\n    if (!isSupportedChain(chainId)) {\r\n      return t`Incorrect Network`;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return error;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (needApproval && isWaitingForApproval) {\r\n      return t`Waiting for Approval`;\r\n    }\r\n    if (isApproving) {\r\n      return t`Approving ${fromToken.symbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${fromToken.symbol}`;\r\n    }\r\n\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (isPluginApproving) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (needOrderBookApproval) {\r\n      return t`Enable Orders`;\r\n    }\r\n    \r\n    if (!isMarketOrder) return `Create ${orderOption.charAt(0) + orderOption.substring(1).toLowerCase()} Order`;\r\n\r\n    if (isSwap) {\r\n      if (toUsdMax && toUsdMax.lt(fromUsdMin.mul(95).div(100))) {\r\n        return t`High Slippage, Swap Anyway`;\r\n      }\r\n      return \"Swap\";\r\n    }\r\n\r\n    if (isLong) {\r\n      const indexTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n      if (indexTokenInfo && indexTokenInfo.minPrice) {\r\n        const { amount: nextToAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          indexTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        const nextToAmountUsd = nextToAmount\r\n          .mul(indexTokenInfo.minPrice)\r\n          .div(expandDecimals(1, indexTokenInfo.decimals));\r\n        if (fromTokenAddress === USDG_ADDRESS && nextToAmountUsd.lt(fromUsdMin.mul(98).div(100))) {\r\n          return t`High USDG Slippage, Long Anyway`;\r\n        }\r\n      }\r\n      return t`Long ${toToken.symbol}`;\r\n    }\r\n\r\n    return t`Short ${toToken.symbol}`;\r\n  };\r\n\r\n  const onSelectFromToken = (token) => {\r\n    setFromTokenAddress(swapOption, token.address);\r\n    setIsWaitingForApproval(false);\r\n\r\n    if (isShort && token.isStable) {\r\n      setShortCollateralAddress(token.address);\r\n    }\r\n  };\r\n\r\n  const onSelectShortCollateralAddress = (token) => {\r\n    setShortCollateralAddress(token.address);\r\n  };\r\n\r\n  const onSelectToToken = (token) => {\r\n    setToTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue, toValue])\r\n  \r\n  const onFromValueChange = (e) => {\r\n    setAnchorOnFromAmount(true);\r\n    setFromValue(e.target.value);\r\n  };\r\n\r\n  const onToValueChange = (e) => {\r\n    setAnchorOnFromAmount(false);\r\n    setToValue(e.target.value);\r\n  };\r\n\r\n  const switchTokens = () => {\r\n    if (fromAmount && toAmount) {\r\n      if (anchorOnFromAmount) {\r\n        setToValue(formatAmountFree(fromAmount, fromToken.decimals, 8));\r\n      } else {\r\n        setFromValue(formatAmountFree(toAmount, toToken.decimals, 8));\r\n      }\r\n      setAnchorOnFromAmount(!anchorOnFromAmount);\r\n    }\r\n    setIsWaitingForApproval(false);\r\n\r\n    const updatedTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n    updatedTokenSelection[swapOption] = {\r\n      from: toTokenAddress,\r\n      to: fromTokenAddress,\r\n    };\r\n    setTokenSelection(updatedTokenSelection);\r\n  };\r\n\r\n  const wrap = async () => {\r\n    setIsSubmitting(true);\r\n\r\n    const contract = new ethers.Contract(nativeTokenAddress, WETH.abi, library.getSigner());\r\n    callContract(chainId, contract, \"deposit\", {\r\n      value: fromAmount,\r\n      sentMsg: \"Swap submitted.\",\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      failMsg: \"Swap failed.\",\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const unwrap = async () => {\r\n    setIsSubmitting(true);\r\n\r\n    const contract = new ethers.Contract(nativeTokenAddress, WETH.abi, library.getSigner());\r\n    callContract(chainId, contract, \"withdraw\", [fromAmount], {\r\n      sentMsg: t`Swap submitted!`,\r\n      failMsg: t`Swap failed.`,\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const swap = async () => {\r\n    if (fromToken.isNative && toToken.isWrapped) {\r\n      wrap();\r\n      return;\r\n    }\r\n\r\n    if (fromTokenAddress.isWrapped && toToken.isNative) {\r\n      unwrap();\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    let path = [fromTokenAddress, toTokenAddress];\r\n    if (anchorOnFromAmount) {\r\n      const { path: multiPath } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (multiPath) {\r\n        path = multiPath;\r\n      }\r\n    } else {\r\n      const { path: multiPath } = getNextFromAmount(\r\n        chainId,\r\n        toAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (multiPath) {\r\n        path = multiPath;\r\n      }\r\n    }\r\n\r\n    let method;\r\n    let contract;\r\n    let value;\r\n    let params;\r\n    let minOut;\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, fromTokenAddress), fromAmount)) {\r\n      setIsSubmitting(false);\r\n      setIsPendingConfirmation(true);\r\n      helperToast.error(\r\n        `Leave at least ${formatAmount(DUST_BNB, 18, 3)} ${getConstant(chainId, \"nativeTokenSymbol\")} for gas`\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      minOut = toAmount;\r\n      Api.createSwapOrder(chainId, library, path, fromAmount, minOut, triggerRatio, nativeTokenAddress, {\r\n        sentMsg: t`Swap Order submitted!`,\r\n        successMsg: t`Swap Order created!`,\r\n        failMsg: t`Swap Order creation failed.`,\r\n        pendingTxns,\r\n        setPendingTxns,\r\n      })\r\n        .then(() => {\r\n          setIsConfirming(false);\r\n        })\r\n        .finally(() => {\r\n          setIsSubmitting(false);\r\n          setIsPendingConfirmation(false);\r\n        });\r\n      return;\r\n    }\r\n\r\n    path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n    method = \"swap\";\r\n    value = bigNumberify(0);\r\n    if (toTokenAddress === AddressZero) {\r\n      method = \"swapTokensToETH\";\r\n    }\r\n\r\n    minOut = toAmount.mul(BASIS_POINTS_DIVISOR - allowedSlippage).div(BASIS_POINTS_DIVISOR);\r\n    params = [path, fromAmount, minOut, account];\r\n    if (fromTokenAddress === AddressZero) {\r\n      method = \"swapETHToTokens\";\r\n      value = fromAmount;\r\n      params = [path, minOut, account];\r\n    }\r\n    contract = new ethers.Contract(routerAddress, Router.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: `Swap ${!isMarketOrder ? \" order \" : \"\"} submitted!`,\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      failMsg: t`Swap failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async () => {\r\n        setIsConfirming(false);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  const createIncreaseOrder = () => {\r\n    let path = [fromTokenAddress];\r\n\r\n    if (path[0] === USDG_ADDRESS) {\r\n      if (isLong) {\r\n        const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n        path.push(stableToken.address);\r\n      } else {\r\n        path.push(shortCollateralAddress);\r\n      }\r\n    }\r\n\r\n    const minOut = 0;\r\n    const indexToken = getToken(chainId, indexTokenAddress);\r\n    const successMsg = t`\r\n      Created limit order for ${indexToken.symbol} ${isLong ? \"Long\" : \"Short\"}: ${formatAmount(\r\n      toUsdMax,\r\n      USD_DECIMALS,\r\n      2\r\n    )} USD!\r\n    `;\r\n    return Api.createIncreaseOrder(\r\n      chainId,\r\n      library,\r\n      nativeTokenAddress,\r\n      path,\r\n      fromAmount,\r\n      indexTokenAddress,\r\n      minOut,\r\n      toUsdMax,\r\n      collateralTokenAddress,\r\n      isLong,\r\n      triggerPriceUsd,\r\n      {\r\n        pendingTxns,\r\n        setPendingTxns,\r\n        sentMsg: t`Limit order submitted!`,\r\n        successMsg,\r\n        failMsg: t`Limit order creation failed.`,\r\n      }\r\n    )\r\n      .then(() => {\r\n        setIsConfirming(false);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  let referralCode = ethers.constants.HashZero;\r\n  if (!attachedOnChain && userReferralCode) {\r\n    referralCode = userReferralCode;\r\n  }\r\n\r\n  const increasePosition = async () => {\r\n    setIsSubmitting(true);\r\n    const tokenAddress0 = fromTokenAddress === AddressZero ? nativeTokenAddress : fromTokenAddress;\r\n    const indexTokenAddress = toTokenAddress === AddressZero ? nativeTokenAddress : toTokenAddress;\r\n    let path = [indexTokenAddress]; // assume long\r\n    if (toTokenAddress !== fromTokenAddress) {\r\n      path = [tokenAddress0, indexTokenAddress];\r\n    }\r\n\r\n    if (fromTokenAddress === AddressZero && toTokenAddress === nativeTokenAddress) {\r\n      path = [nativeTokenAddress];\r\n    }\r\n\r\n    if (fromTokenAddress === nativeTokenAddress && toTokenAddress === AddressZero) {\r\n      path = [nativeTokenAddress];\r\n    }\r\n\r\n    if (isShort) {\r\n      path = [shortCollateralAddress];\r\n      if (tokenAddress0 !== shortCollateralAddress) {\r\n        path = [tokenAddress0, shortCollateralAddress];\r\n      }\r\n    }\r\n\r\n    const refPrice = isLong ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n    const priceBasisPoints = isLong ? BASIS_POINTS_DIVISOR + allowedSlippage : BASIS_POINTS_DIVISOR - allowedSlippage;\r\n    const priceLimit = refPrice.mul(priceBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n    const boundedFromAmount = fromAmount ? fromAmount : bigNumberify(0);\r\n\r\n    if (fromAmount && fromAmount.gt(0) && fromTokenAddress === USDG_ADDRESS && isLong) {\r\n      const { amount: nextToAmount, path: multiPath } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        indexTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (nextToAmount.eq(0)) {\r\n        helperToast.error(t`Insufficient liquidity`);\r\n        return;\r\n      }\r\n      if (multiPath) {\r\n        path = replaceNativeTokenAddress(multiPath);\r\n      }\r\n    }\r\n\r\n    let params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      boundedFromAmount, // _amountIn\r\n      0, // _minOut\r\n      toUsdMax, // _sizeDelta\r\n      isLong, // _isLong\r\n      priceLimit, // _acceptablePrice\r\n      minExecutionFee, // _executionFee\r\n      referralCode, // _referralCode\r\n      // AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    let method = \"createIncreasePosition\";\r\n    let value = minExecutionFee;\r\n    if (fromTokenAddress === AddressZero) {\r\n      method = \"createIncreasePositionETH\";\r\n      value = boundedFromAmount.add(minExecutionFee);\r\n      params = [\r\n        path, // _path\r\n        indexTokenAddress, // _indexToken\r\n        boundedFromAmount, // _amountIn\r\n        0, // _minOut\r\n        toUsdMax, // _sizeDelta\r\n        isLong, // _isLong\r\n        priceLimit, // _acceptablePrice\r\n        minExecutionFee, // _executionFee\r\n        referralCode, // _referralCode,\r\n        // AddressZero, // _callbackTarget\r\n      ];\r\n    }\r\n\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, fromTokenAddress), fromAmount)) {\r\n      setIsSubmitting(false);\r\n      setIsPendingConfirmation(false);\r\n      helperToast.error(\r\n        t`Leave at least ${formatAmount(DUST_BNB, 18, 3)} ${getConstant(chainId, \"nativeTokenSymbol\")} for gas`\r\n      );\r\n      return;\r\n    }\r\n\r\n    // const contractAddress = getContract(chainId, \"PositionRouter\");\r\n    // const contract = new ethers.Contract(contractAddress, PositionRouter.abi, library.getSigner());\r\n    // const contract = DDL_AccountManager;\r\n    const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n    \r\n    const indexToken = getTokenInfo(infoTokens, indexTokenAddress);\r\n    const tokenSymbol = indexToken.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexToken.symbol;\r\n    const successMsg = t`Requested increase of ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"} by ${formatAmount(\r\n      toUsdMax,\r\n      USD_DECIMALS,\r\n      2\r\n    )} USD.`;\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      setPendingTxns,\r\n      sentMsg: `${isLong ? \"Long\" : \"Short\"} submitted.`,\r\n      failMsg: `${isLong ? \"Long\" : \"Short\"} failed.`,\r\n      successMsg,\r\n      // for Arbitrum, sometimes the successMsg shows after the position has already been executed\r\n      // hide the success message for Arbitrum as a workaround\r\n      hideSuccessMsg: chainId === ARBITRUM,\r\n    })\r\n      .then(async () => {\r\n        setIsConfirming(false);\r\n\r\n        const key = getPositionKey(account, path[path.length - 1], indexTokenAddress, isLong);\r\n        let nextSize = toUsdMax;\r\n        if (hasExistingPosition) {\r\n          nextSize = existingPosition.size.add(toUsdMax);\r\n        }\r\n\r\n        pendingPositions[key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            size: nextSize,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  const onSwapOptionChange = (opt) => {\r\n    setSwapOption(opt);\r\n    if (orderOption === STOP) {\r\n      setOrderOption(MARKET);\r\n    }\r\n    setAnchorOnFromAmount(true);\r\n    setFromValue(\"\");\r\n    setToValue(\"\");\r\n    setTriggerPriceValue(\"\");\r\n    setTriggerRatioValue(\"\");\r\n\r\n    if (opt === SHORT && infoTokens) {\r\n      const fromToken = getToken(chainId, tokenSelection[opt].from);\r\n      if (fromToken && fromToken.isStable) {\r\n        setShortCollateralAddress(fromToken.address);\r\n      } else {\r\n        const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n        setShortCollateralAddress(stableToken.address);\r\n      }\r\n    }\r\n  };\r\n\r\n  const onConfirmationClick = () => {\r\n    if (!active) {\r\n      props.connectWallet();\r\n      return;\r\n    }\r\n\r\n    if (needOrderBookApproval) {\r\n      approveOrderBook();\r\n      return;\r\n    }\r\n\r\n    setIsPendingConfirmation(true);\r\n\r\n    if (isSwap) {\r\n      swap();\r\n      return;\r\n    }\r\n\r\n    if (orderOption === LIMIT) {\r\n      createIncreaseOrder();\r\n      return;\r\n    }\r\n\r\n    increasePosition();\r\n  };\r\n\r\n\r\n  function approveFromToken() {\r\n    approveTokens({\r\n      setIsApproving,\r\n      library,\r\n      tokenAddress: fromToken.address,\r\n      // spender: routerAddress,\r\n      spender: DDL_AccountManager.address,\r\n      chainId: chainId,\r\n      onApproveSubmitted: () => {\r\n        setIsWaitingForApproval(true);\r\n      },\r\n      infoTokens,\r\n      getTokenInfo,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n    });\r\n  }\r\n\r\n  const onClickPrimary = () => {\r\n    if (isStopOrder) {\r\n      setOrderOption(MARKET);\r\n      return;\r\n    }\r\n\r\n    if (!active) {\r\n      props.connectWallet();\r\n      return;\r\n    }\r\n    if (!props.dgAddress) {\r\n      setRegisterVisible(true);\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: t`Enable leverage sent.`,\r\n        failMsg: t`Enable leverage failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (needApproval) {\r\n      approveFromToken();\r\n      return;\r\n    }\r\n\r\n    if (needOrderBookApproval) {\r\n      setOrdersToaOpen(true);\r\n      return;\r\n    }\r\n\r\n    const [, modal, errorCode] = getError();\r\n\r\n    if (modal) {\r\n      setModalError(errorCode);\r\n      return;\r\n    }\r\n\r\n    if (isSwap) {\r\n      if (fromTokenAddress === AddressZero && toTokenAddress === nativeTokenAddress) {\r\n        wrap();\r\n        return;\r\n      }\r\n\r\n      if (fromTokenAddress === nativeTokenAddress && toTokenAddress === AddressZero) {\r\n        unwrap();\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsConfirming(true);\r\n    setIsHigherSlippageAllowed(false);\r\n  };\r\n\r\n  const isStopOrder = orderOption === STOP;\r\n  const showFromAndToSection = !isStopOrder && !isBorrow;\r\n  const showTriggerPriceSection = !isSwap && !isMarketOrder && !isStopOrder && !isBorrow;\r\n  const showTriggerRatioSection = isSwap && !isMarketOrder && !isStopOrder;\r\n\r\n  let fees;\r\n  let feesUsd;\r\n  let feeBps;\r\n  let swapFees;\r\n  let positionFee;\r\n  if (isSwap) {\r\n    if (fromAmount) {\r\n      const { feeBasisPoints } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (feeBasisPoints !== undefined) {\r\n        fees = fromAmount.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n        const feeTokenPrice =\r\n          fromTokenInfo.address === USDG_ADDRESS ? expandDecimals(1, USD_DECIMALS) : fromTokenInfo.maxPrice;\r\n        feesUsd = fees.mul(feeTokenPrice).div(expandDecimals(1, fromTokenInfo.decimals));\r\n      }\r\n      feeBps = feeBasisPoints;\r\n    }\r\n  } else if (toUsdMax) {\r\n    positionFee = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    feesUsd = positionFee;\r\n\r\n    const { feeBasisPoints } = getNextToAmount(\r\n      chainId,\r\n      fromAmount,\r\n      fromTokenAddress,\r\n      collateralTokenAddress,\r\n      infoTokens,\r\n      undefined,\r\n      undefined,\r\n      usdgSupply,\r\n      totalTokenWeights,\r\n      isSwap\r\n    );\r\n    if (feeBasisPoints) {\r\n      swapFees = fromUsdMin.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n      feesUsd = feesUsd.add(swapFees);\r\n    }\r\n    feeBps = feeBasisPoints;\r\n  }\r\n\r\n  if (!fromToken || !toToken) {\r\n    return null;\r\n  }\r\n\r\n  let hasZeroBorrowFee = false;\r\n  let borrowFeeText;\r\n  if (isLong && toTokenInfo && toTokenInfo.fundingRate) {\r\n    borrowFeeText = formatAmount(toTokenInfo.fundingRate, 4, 4) + \"% / 1h\";\r\n    if (toTokenInfo.fundingRate.eq(0)) {\r\n      // hasZeroBorrowFee = true\r\n    }\r\n  }\r\n  if (isShort && shortCollateralToken && shortCollateralToken.fundingRate) {\r\n    borrowFeeText = formatAmount(shortCollateralToken.fundingRate, 4, 4) + \"% / 1h\";\r\n    if (shortCollateralToken.fundingRate.eq(0)) {\r\n      // hasZeroBorrowFee = true\r\n    }\r\n  }\r\n\r\n  function setFromValueToMaximumAvailable() {\r\n    if (!fromToken || !fromBalance) {\r\n      return;\r\n    }\r\n\r\n    const maxAvailableAmount = fromToken.isNative ? fromBalance.sub(bigNumberify(DUST_BNB).mul(2)) : fromBalance;\r\n    setFromValue(formatAmountFree(maxAvailableAmount, fromToken.decimals, fromToken.decimals));\r\n    setAnchorOnFromAmount(true);\r\n  }\r\n\r\n  function shouldShowMaxButton() {\r\n    if (!fromToken || !fromBalance) {\r\n      return false;\r\n    }\r\n    const maxAvailableAmount = fromToken.isNative ? fromBalance.sub(bigNumberify(DUST_BNB).mul(2)) : fromBalance;\r\n    return fromValue !== formatAmountFree(maxAvailableAmount, fromToken.decimals, fromToken.decimals);\r\n  }\r\n\r\n  return (\r\n    <div className=\"Exchange-swap-box\">\r\n      {/* <div className=\"Exchange-swap-wallet-box App-box\">\r\n        {active && <div className=\"Exchange-swap-account\" >\r\n        </div>}\r\n      </div> */}\r\n      <div className=\"Exchange-swap-box-inner App-box-highlight\">\r\n        <div>\r\n          <Tab\r\n            icons={SWAP_ICONS}\r\n            options={SWAP_OPTIONS}\r\n            disabledList={[\r\n              {\r\n                label: \"Long\",\r\n                disabled: ethShortExists\r\n              },\r\n              {\r\n                label: \"Short\",\r\n                disabled: ethLongExists\r\n              }\r\n            ]}\r\n            disabledTooltip={\r\n              <Tooltip\r\n                className=\"tab-tooltip nowrap\"\r\n                position=\"right-bottom\"\r\n                enabled={true}\r\n                handle=\"\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      <span className='spacing'>Y</span>ou can't open<br className=\"br-mobile\" /> a long/short position<br /> at the same time\r\n                    </div>\r\n                  );\r\n                }} />\r\n            }\r\n            disabled={isBorrow}\r\n            option={isBorrow ? undefined : swapOption}\r\n            onChange={onSwapOptionChange}\r\n            className={\"Exchange-swap-option-tabs\"}\r\n          />\r\n          {flagOrdersEnabled && (\r\n            <div className=\"Tab-inline-container\">\r\n              <Tab\r\n                options={orderOptions}\r\n                optionLabels={orderOptionLabels}\r\n                className=\"Exchange-swap-order-type-tabs\"\r\n                type=\"inline\"\r\n                option={orderOption}\r\n                onChange={onOrderOptionChange}\r\n                disabledList={[\r\n                  {\r\n                    label: \"Limit\",\r\n                    disabled: true\r\n                  },\r\n                ]}\r\n                disabledTooltip={\r\n                  <Tooltip\r\n                    className=\"tab-tooltip nowrap\"\r\n                    position=\"right-bottom\"\r\n                    enabled={true}\r\n                    handle=\"\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          Limit orders will be added soon!\r\n                        </div>\r\n                      );\r\n                    }} />\r\n                }\r\n              />\r\n              <button className=\"btn_inline\">\r\n                <img className=\"btn__icon\" src={icon_repay} alt=\"Repay icon\" />\r\n                Repay\r\n              </button>\r\n            </div>\r\n            \r\n          )}\r\n        </div>\r\n        {showFromAndToSection && (\r\n          <React.Fragment>\r\n            <div className={\"Exchange-swap-section\"\r\n               + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  {fromUsdMin && (\r\n                    <div className=\"Exchange-swap-usd\">Pay: {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)} USD</div>\r\n                  )}\r\n                  {!fromUsdMin && \"Pay\"}\r\n                </div>\r\n                {fromBalance && (\r\n                  <div className=\"muted align-right clickable\" onClick={setFromValueToMaximumAvailable}>\r\n                    Balance: {formatAmount(fromBalance, fromToken.decimals, 4, true)}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div className=\"Exchange-swap-input-container\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={fromValue}\r\n                    onChange={onFromValueChange}\r\n                    onFocus={(e) => {\r\n                      setHasInputFocus(true);\r\n                    }}\r\n                    onBlur={(e) => {\r\n                      setHasInputFocus(false);\r\n                    }}\r\n                  />\r\n                  {shouldShowMaxButton() && (\r\n                    <div className=\"Exchange-swap-max\" onClick={setFromValueToMaximumAvailable}>\r\n                      Max\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div>\r\n                  {/* Tokens control */}\r\n                  {/* <TokenSelector\r\n                    label=\"Pay\"\r\n                    chainId={chainId}\r\n                    tokenAddress={fromTokenAddress}\r\n                    onSelectToken={onSelectFromToken}\r\n                    tokens={fromTokens}\r\n                    infoTokens={infoTokens}\r\n                    showMintingCap={false}\r\n                    showTokenImgInDropdown={true}\r\n                  /> */}\r\n                  <div className=\"TokenSelector-dummy\">USDC</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {/* <div className=\"Exchange-swap-ball-container\">\r\n              <div className=\"Exchange-swap-ball\" onClick={switchTokens}>\r\n                <IoMdSwap className=\"Exchange-swap-ball-icon\" />\r\n              </div>\r\n            </div> */}\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  {toUsdMax && (\r\n                    <div className=\"Exchange-swap-usd\">\r\n                      {getToLabel()}: {formatAmount(toUsdMax, USD_DECIMALS, 2, true)} USD\r\n                    </div>\r\n                  )}\r\n                  {!toUsdMax && getToLabel()}\r\n                </div>\r\n                {toBalance && isSwap && (\r\n                  <div className=\"muted align-right\">\r\n                    <Trans>Balance</Trans>: {formatAmount(toBalance, toToken.decimals, 4, true)}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div>\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={toValue}\r\n                    onChange={onToValueChange}\r\n                    onFocus={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                    }}\r\n                    onBlur={(e) => {\r\n                      e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <TokenSelector\r\n                    label={getTokenLabel()}\r\n                    chainId={chainId}\r\n                    tokenAddress={toTokenAddress}\r\n                    onSelectToken={onSelectToToken}\r\n                    tokens={toTokens}\r\n                    infoTokens={infoTokens}\r\n                    showTokenImgInDropdown={true}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </React.Fragment>\r\n        )}\r\n        {showTriggerRatioSection && (\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              {fromTokenInfo && toTokenInfo && (\r\n                <div\r\n                  className=\"muted align-right clickable\"\r\n                  onClick={() => {\r\n                    setTriggerRatioValue(\r\n                      formatAmountFree(\r\n                        getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted),\r\n                        USD_DECIMALS,\r\n                        10\r\n                      )\r\n                    );\r\n                  }}\r\n                >\r\n                  {formatAmount(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 4)}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input small\"\r\n                  value={triggerRatioValue}\r\n                  onChange={onTriggerRatioChange}\r\n                  onFocus={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                  }}\r\n                />\r\n              </div>\r\n              {(() => {\r\n                if (!toTokenInfo) return;\r\n                if (!fromTokenInfo) return;\r\n                const [tokenA, tokenB] = triggerRatioInverted\r\n                  ? [toTokenInfo, fromTokenInfo]\r\n                  : [fromTokenInfo, toTokenInfo];\r\n                return (\r\n                  <div className=\"PositionEditor-token-symbol\">\r\n                    {tokenA.symbol}&nbsp;per&nbsp;{tokenB.symbol}\r\n                  </div>\r\n                );\r\n              })()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {showTriggerPriceSection && (\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div\r\n                className=\"muted align-right clickable\"\r\n                onClick={() => {\r\n                  setTriggerPriceValue(formatAmountFree(entryMarkPrice, USD_DECIMALS, 2));\r\n                }}\r\n              >\r\n                Mark: {formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={triggerPriceValue}\r\n                  onChange={onTriggerPriceChange}\r\n                  onFocus={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">USD</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {isSwap && (\r\n          <div className=\"Exchange-swap-box-info\">\r\n            <ExchangeInfoRow label=\"Fees\">\r\n              <div>\r\n                {!fees && \"-\"}\r\n                {fees && (\r\n                  <div>\r\n                    {formatAmount(feeBps, 2, 2, false)}%&nbsp; ({formatAmount(fees, fromToken.decimals, 4, true)}{\" \"}\r\n                    {fromToken.symbol}: ${formatAmount(feesUsd, USD_DECIMALS, 2, true)})\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </ExchangeInfoRow>\r\n          </div>\r\n        )}\r\n        {(isLong || isShort) && !isStopOrder && !isBorrow && (\r\n          <div className=\"Exchange-leverage-box\">\r\n            <div className=\"Buying-power\">\r\n              <div className=\"Exchange-leverage-slider-settings\">\r\n                <div>\r\n                  <Tooltip\r\n                    className=\"buying-power-tooltip has-hint-tooltip nowrap\"\r\n                    handle=\"Buying Power\"\r\n                    position=\"left-bottom\"\r\n                    enabled={true}\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          Amount ofUSDC you can spend <br />onopening new positions\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                </div>\r\n                <div className=\"Buying-power__available\">\r\n                  <div className=\"muted-dark\">Available:</div>\r\n                  <Currency>1000000.33</Currency>\r\n                </div>\r\n              </div>\r\n              <div\r\n                className={cx(\"Exchange-leverage-slider\", \"App-slider\", {\r\n                  positive: isLong,\r\n                  negative: isShort,\r\n                })}\r\n              >\r\n                <Slider\r\n                  min={0}\r\n                  max={100}\r\n                  step={10}\r\n                  // marks={leverageMarks}\r\n                  // handle={leverageSliderHandle}\r\n                  onChange={(value) => setLeverageOption(value)}\r\n                  value={leverageOption}\r\n                  defaultValue={leverageOption}\r\n                />\r\n              </div>\r\n              {(isLong || isShort) && hasLeverageOption && (\r\n                <div className=\"Exchange-leverage-value\">\r\n                  {leverageOption}% of Buying Power\r\n                </div>\r\n              )}\r\n            </div>\r\n            \r\n            {/* {isShort && (\r\n              <div className=\"Exchange-info-row Exchange-info-row_relative\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Collateral In</Trans>\r\n                </div>\r\n\r\n                <div className=\"align-right\">\r\n                  <TokenSelector\r\n                    label=\"Collateral In\"\r\n                    chainId={chainId}\r\n                    tokenAddress={shortCollateralAddress}\r\n                    onSelectToken={onSelectShortCollateralAddress}\r\n                    tokens={stableTokens}\r\n                    showTokenImgInDropdown={true}\r\n                    disabled={false}\r\n                  />\r\n                  USDC\r\n                </div>\r\n              </div>\r\n            )}\r\n            {isLong && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Collateral In</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  <Tooltip\r\n                    position=\"right-bottom\"\r\n                    handle=\"USD\"\r\n                    renderContent={() => (\r\n                      <span className=\"SwapBox-collateral-tooltip-text\">\r\n                        <Trans>\r\n                          A snapshot of the USD value of your {existingPosition?.collateralToken?.symbol} collateral is\r\n                          taken when the position is opened.\r\n                        </Trans>\r\n                        <br />\r\n                        <br />\r\n                        <Trans>\r\n                          When closing the position, you can select which token you would like to receive the profits\r\n                          in.\r\n                        </Trans>\r\n                      </span>\r\n                    )}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )} */}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Entry Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                  <div className=\"inline-block muted\">\r\n                    ${formatAmount(existingPosition.averagePrice, USD_DECIMALS, 2, true)}\r\n                    <BsArrowRight className=\"transition-arrow\" />\r\n                  </div>\r\n                )}\r\n                {nextAveragePrice && `$${formatAmount(nextAveragePrice, USD_DECIMALS, 2, true)}`}\r\n                {!nextAveragePrice && `-`}\r\n              </div>\r\n            </div>\r\n            {/* <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Liq. Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                  <div className=\"inline-block muted\">\r\n                    ${formatAmount(existingLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                    <BsArrowRight className=\"transition-arrow\" />\r\n                  </div>\r\n                )}\r\n                {toAmount &&\r\n                  displayLiquidationPrice &&\r\n                  `$${formatAmount(displayLiquidationPrice, USD_DECIMALS, 2, true)}`}\r\n                {!toAmount && displayLiquidationPrice && `-`}\r\n                {!displayLiquidationPrice && `-`}\r\n              </div>\r\n            </div> */}\r\n            <ExchangeInfoRow label=\"Fees\">\r\n              <div>\r\n                {!feesUsd && \"-\"}\r\n                {feesUsd && (\r\n                  <Tooltip\r\n                    handle={`$${formatAmount(feesUsd, USD_DECIMALS, 2, true)}`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          {swapFees && (\r\n                            <div>\r\n                              {collateralToken.symbol} is required for collateral. <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Swap ${fromToken.symbol} to ${collateralToken.symbol} Fee`}\r\n                                value={formatAmount(swapFees, USD_DECIMALS, 2, true)}\r\n                              />\r\n                              <br />\r\n                            </div>\r\n                          )}\r\n                          <div>\r\n                            <StatsTooltipRow\r\n                              label={`Position Fee (0.1% of position size)`}\r\n                              value={formatAmount(positionFee, USD_DECIMALS, 2, true)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                )}\r\n              </div>\r\n            </ExchangeInfoRow>\r\n          </div>\r\n        )}\r\n        {isBorrow && (\r\n          <div className=\"borrow-list\">\r\n            <NumberInput_v2\r\n              placeholder=\"Amount\" \r\n              value={borrowValue}\r\n              setValue={setBorrowValue}\r\n              currency='USDC'\r\n            />\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Available:</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Currency>10000</Currency>\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Borrow APY: </Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                5%\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {isStopOrder && (\r\n          <div className=\"Exchange-swap-section Exchange-trigger-order-info\">\r\n            Take-profit and stop-loss orders can be set after opening a position. <br />\r\n            <br />\r\n            There will be a \"Close\" button on each position row, clicking this will display the option to set trigger\r\n            orders. <br />\r\n            <br />\r\n            For screenshots and more information, please see the{\" \"}\r\n            <a\r\n              href=\"https://gmxio.gitbook.io/gmx/trading#stop-loss-take-profit-orders\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              docs\r\n            </a>\r\n            .\r\n          </div>\r\n        )}\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className={\"Exchange-swap-button btn\" + (isPrimaryEnabled() ? \" btn_hlight\" : \"\")} onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {isSwap && (\r\n        <div className=\"Exchange-swap-market-box App-box App-box-border\">\r\n          <div className=\"Exchange-swap-market-box-title\">\r\n            <Trans>Swap</Trans>\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">{fromToken.symbol} Price</div>\r\n            <div className=\"align-right\">\r\n              ${fromTokenInfo && formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">{toToken.symbol} Price</div>\r\n            <div className=\"align-right\">\r\n              ${toTokenInfo && formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Available Liquidity</Trans>\r\n            </div>\r\n\r\n            <div className=\"align-right al-swap\">\r\n              <Tooltip\r\n                handle={`$${formatAmount(maxSwapAmountUsd, USD_DECIMALS, 2, true)}`}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      <StatsTooltipRow\r\n                        label={`Max ${fromTokenInfo.symbol} in`}\r\n                        value={[\r\n                          `${formatAmount(maxFromTokenIn, fromTokenInfo.decimals, 0, true)} ${fromTokenInfo.symbol}`,\r\n                          `($${formatAmount(maxFromTokenInUSD, USD_DECIMALS, 0, true)})`,\r\n                        ]}\r\n                      />\r\n                      <StatsTooltipRow\r\n                        label={`Max ${toTokenInfo.symbol} out`}\r\n                        value={[\r\n                          `${formatAmount(maxToTokenOut, toTokenInfo.decimals, 0, true)} ${toTokenInfo.symbol}`,\r\n                          `($${formatAmount(maxToTokenOutUSD, USD_DECIMALS, 0, true)})`,\r\n                        ]}\r\n                      />\r\n                    </div>\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          {!isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Price\">\r\n              {getExchangeRateDisplay(getExchangeRate(fromTokenInfo, toTokenInfo), fromToken, toToken)}\r\n            </ExchangeInfoRow>\r\n          )}\r\n        </div>\r\n      )}\r\n      {/* (isLong || isShort) && (\r\n        <div className=\"Exchange-swap-market-box App-box App-box-border\">\r\n          <div className=\"Exchange-swap-market-box-title\">\r\n            {isLong ? \"Long\" : \"Short\"}&nbsp;{toToken.symbol}\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Entry Price</Trans>\r\n            </div>\r\n            <div className=\"align-right\">\r\n              <Tooltip\r\n                handle={`$${formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)}`}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      The position will be opened at {formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)} USD with a\r\n                      max slippage of {parseFloat(savedSlippageAmount / 100.0).toFixed(2)}%.\r\n                      <br />\r\n                      <br />\r\n                      The slippage amount can be configured under Settings, found by clicking on your address at the top\r\n                      right of the page after connecting your wallet.\r\n                      <br />\r\n                      <br />\r\n                      <a\r\n                        href=\"https://gmxio.gitbook.io/gmx/trading#opening-a-position\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        More Info\r\n                      </a>\r\n                    </div>\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Exit Price</Trans>\r\n            </div>\r\n            <div className=\"align-right\">\r\n              <Tooltip\r\n                handle={`$${formatAmount(exitMarkPrice, USD_DECIMALS, 2, true)}`}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      If you have an existing position, the position will be closed at{\" \"}\r\n                      {formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)} USD.\r\n                      <br />\r\n                      <br />\r\n                      This exit price will change with the price of the asset.\r\n                      <br />\r\n                      <br />\r\n                      <a\r\n                        href=\"https://gmxio.gitbook.io/gmx/trading#opening-a-position\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        More Info\r\n                      </a>\r\n                    </div>\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Borrow Fee</Trans>\r\n            </div>\r\n            <div className=\"align-right\">\r\n              <Tooltip\r\n                handle={borrowFeeText}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      {hasZeroBorrowFee && (\r\n                        <div>\r\n                          {isLong && \"There are more shorts than longs, borrow fees for longing is currently zero\"}\r\n                          {isShort && \"There are more longs than shorts, borrow fees for shorting is currently zero\"}\r\n                        </div>\r\n                      )}\r\n                      {!hasZeroBorrowFee && (\r\n                        <div>\r\n                          The borrow fee is calculated as (assets borrowed) / (total assets in pool) * 0.01% per hour.\r\n                          <br />\r\n                          <br />\r\n                          {isShort && `You can change the \"Collateral In\" token above to find lower fees`}\r\n                        </div>\r\n                      )}\r\n                      <br />\r\n                      <a\r\n                        href=\"https://gmxio.gitbook.io/gmx/trading#opening-a-position\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        More Info\r\n                      </a>\r\n                    </div>\r\n                  );\r\n                }}\r\n              >\r\n                {!hasZeroBorrowFee && null}\r\n              </Tooltip>\r\n            </div>\r\n          </div>\r\n          {renderAvailableLongLiquidity()}\r\n          {isShort && toTokenInfo.hasMaxAvailableShort && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Available Liquidity</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  handle={`$${formatAmount(toTokenInfo.maxAvailableShort, USD_DECIMALS, 2, true)}`}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label={`Max ${toTokenInfo.symbol} short capacity`}\r\n                          value={formatAmount(toTokenInfo.maxGlobalShortSize, USD_DECIMALS, 0, true)}\r\n                        />\r\n                        <StatsTooltipRow\r\n                          label={`Current ${toTokenInfo.symbol} shorts`}\r\n                          value={formatAmount(toTokenInfo.globalShortSize, USD_DECIMALS, 0, true)}\r\n                        />\r\n                      </>\r\n                    );\r\n                  }}\r\n                ></Tooltip>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      ) */}\r\n      <NoLiquidityErrorModal\r\n        chainId={chainId}\r\n        fromToken={fromToken}\r\n        toToken={toToken}\r\n        shortCollateralToken={shortCollateralToken}\r\n        isLong={isLong}\r\n        isShort={isShort}\r\n        modalError={modalError}\r\n        setModalError={setModalError}\r\n      />\r\n      {renderOrdersToa()}\r\n      {isConfirming && (\r\n        <ConfirmationBox\r\n          library={library}\r\n          isHigherSlippageAllowed={isHigherSlippageAllowed}\r\n          setIsHigherSlippageAllowed={setIsHigherSlippageAllowed}\r\n          orders={orders}\r\n          isSwap={isSwap}\r\n          isLong={isLong}\r\n          isMarketOrder={isMarketOrder}\r\n          orderOption={orderOption}\r\n          isShort={isShort}\r\n          fromToken={fromToken}\r\n          fromTokenInfo={fromTokenInfo}\r\n          toToken={toToken}\r\n          toTokenInfo={toTokenInfo}\r\n          toAmount={toAmount}\r\n          fromAmount={fromAmount}\r\n          feeBps={feeBps}\r\n          onConfirmationClick={onConfirmationClick}\r\n          setIsConfirming={setIsConfirming}\r\n          hasExistingPosition={hasExistingPosition}\r\n          shortCollateralAddress={USDC.address}\r\n          shortCollateralToken={shortCollateralToken}\r\n          leverage={leverage}\r\n          existingPosition={existingPosition}\r\n          existingLiquidationPrice={existingLiquidationPrice}\r\n          displayLiquidationPrice={displayLiquidationPrice}\r\n          nextAveragePrice={nextAveragePrice}\r\n          triggerPriceUsd={triggerPriceUsd}\r\n          triggerRatio={triggerRatio}\r\n          fees={fees}\r\n          feesUsd={feesUsd}\r\n          isSubmitting={isSubmitting}\r\n          isPendingConfirmation={isPendingConfirmation}\r\n          fromUsdMin={fromUsdMin}\r\n          toUsdMax={toUsdMax}\r\n          collateralTokenAddress={collateralTokenAddress}\r\n          infoTokens={infoTokens}\r\n          chainId={chainId}\r\n          setPendingTxns={setPendingTxns}\r\n          pendingTxns={pendingTxns}\r\n          minExecutionFee={minExecutionFee}\r\n          minExecutionFeeUSD={minExecutionFeeUSD}\r\n          minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Menu } from \"@headlessui/react\";\r\nimport { FaChevronDown } from \"react-icons/fa\";\r\nimport cx from \"classnames\";\r\nimport \"./ChartTokenSelector.scss\";\r\nimport \"../AddressDropdown/AddressDropdown.css\";\r\nimport { getTokens, getWhitelistedTokens } from \"../../config/Tokens\";\r\nimport { LONG, SHORT, SWAP } from \"../../lib/legacy\";\r\nimport { ethers } from 'ethers';\r\n\r\nexport default function ChartTokenSelector(props) {\r\n  const { chainId, selectedToken, onSelectToken, swapOption } = props;\r\n\r\n  const isLong = swapOption === LONG;\r\n  const isShort = swapOption === SHORT;\r\n  const isSwap = swapOption === SWAP;\r\n\r\n  // Available tokens limitation\r\n  // let options = getTokens(chainId);\r\n  // const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  let options = [\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f\",\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n  ]\r\n  const whitelistedTokens = options;\r\n\r\n\r\n  const indexTokens = whitelistedTokens.filter((token) => !token.isStable && !token.isWrapped);\r\n  const shortableTokens = indexTokens.filter((token) => token.isShortable);\r\n\r\n  if (isLong) {\r\n    options = indexTokens;\r\n  }\r\n  if (isShort) {\r\n    options = shortableTokens;\r\n  }\r\n\r\n  const onSelect = async (token) => {\r\n    onSelectToken(token);\r\n  };\r\n\r\n  const value = selectedToken;\r\n  let icon;\r\n  if (value.symbol) {\r\n    icon = require(\"../../img/ddl/ic_\" + value.symbol.toLowerCase() + \"_40.svg\")?.default;\r\n  }\r\n\r\n  return (\r\n    <Menu>\r\n      <Menu.Button as=\"div\" disabled={isSwap}>\r\n        <button className={cx(\"App-cta small transparent chart-token-selector\", { \"default-cursor\": isSwap /* \"default-cursor\": \"default\" */ })}>\r\n          <div className=\"chart-token-selector--name\">\r\n            <img src={icon} className=\"chart-token-selector--icon\" alt={value.symbol + ' icon'} />\r\n            <span className=\"chart-token-selector--current\">{value.symbol}/USD</span>\r\n          </div>\r\n          \r\n          {!isSwap && (\r\n            <svg className=\"chevron-down\" xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"21\" viewBox=\"0 0 20 21\" fill=\"none\">\r\n              <path d=\"M4 8L10 13L16 8\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n            </svg>\r\n          )}\r\n        </button>\r\n      </Menu.Button>\r\n      <div className=\"chart-token-menu\">\r\n        <Menu.Items as=\"div\" className=\"menu-items chart-token-menu-items divided\">\r\n          {options.map((option, index) => {\r\n            let icon;\r\n            try {\r\n              icon = require(\"../../img/ddl/ic_\" + option.symbol.toLowerCase() + \"_40.svg\");\r\n            } catch (error) {\r\n              icon = require(\"../../img/ddl/ic_eth_40.svg\");\r\n            }\r\n\r\n            return (\r\n              <Menu.Item key={index}>\r\n                <div\r\n                  className={\"menu-item\" + (option.symbol === value.symbol ? ' chosen' : '')}\r\n                  onClick={() => {\r\n                    onSelect(option);\r\n                  }}\r\n                >\r\n                  <img src={icon.default} alt={option.symbol + ' icon'} className=\"token-icon\" />\r\n                  <span style={{ marginLeft: 7, marginRight: 35 }} className=\"token-label\">\r\n                    {option.symbol} / USD\r\n                  </span>\r\n                </div>\r\n              </Menu.Item>\r\n            )\r\n          })}\r\n        </Menu.Items>\r\n      </div>\r\n    </Menu>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useRef, useCallback, useMemo } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { createChart } from \"krasulya-lightweight-charts\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  SWAP,\r\n  INCREASE,\r\n  CHART_PERIODS,\r\n  getTokenInfo,\r\n  formatAmount,\r\n  formatDateTime,\r\n  usePrevious,\r\n  getLiquidationPrice,\r\n  useLocalStorageSerializeKey,\r\n  numberWithCommas,\r\n} from \"../../lib/legacy\";\r\nimport { useChartPrices } from \"../../domain/legacy\";\r\nimport Tab from \"../Tab/Tab\";\r\n\r\nimport { getTokens, getToken } from \"../../config/Tokens\";\r\nimport ChartTokenSelector from \"./ChartTokenSelector\";\r\n\r\nconst PRICE_LINE_TEXT_WIDTH = 15;\r\n\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nexport function getChartToken(swapOption, fromToken, toToken, chainId) {\r\n  if (!fromToken || !toToken) {\r\n    return;\r\n  }\r\n\r\n  if (swapOption !== SWAP) {\r\n    return toToken;\r\n  }\r\n\r\n  if (fromToken.isUsdg && toToken.isUsdg) {\r\n    return getTokens(chainId).find((t) => t.isStable);\r\n  }\r\n  if (fromToken.isUsdg) {\r\n    return toToken;\r\n  }\r\n  if (toToken.isUsdg) {\r\n    return fromToken;\r\n  }\r\n\r\n  if (fromToken.isStable && toToken.isStable) {\r\n    return toToken;\r\n  }\r\n  if (fromToken.isStable) {\r\n    return toToken;\r\n  }\r\n  if (toToken.isStable) {\r\n    return fromToken;\r\n  }\r\n\r\n  return toToken;\r\n}\r\n\r\nconst DEFAULT_PERIOD = \"4h\";\r\n\r\nconst RED_COLOR = \"#C75E4B\";\r\nconst GREEN_COLOR = \"#46956A\";\r\n\r\nconst getSeriesOptions = () => ({\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/area-series.md\r\n  lineColor: \"#5472cc\",\r\n  topColor: \"rgba(49, 69, 131, 0.4)\",\r\n  bottomColor: \"rgba(42, 64, 103, 0.0)\",\r\n  lineWidth: 2,\r\n  priceLineColor: \"#384263\",\r\n  downColor: RED_COLOR,\r\n  wickDownColor: RED_COLOR,\r\n  upColor: GREEN_COLOR,\r\n  wickUpColor: GREEN_COLOR,\r\n  borderVisible: false,\r\n});\r\n\r\nconst getChartOptions = (width, height) => ({\r\n  width,\r\n  height,\r\n  layout: {\r\n    backgroundColor: \"rgba(255, 255, 255, 0)\",\r\n    textColor: \"#747FA6\",\r\n    fontFamily: \"Gantari\",\r\n  },\r\n  localization: {\r\n    // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#time-format\r\n    timeFormatter: (businessDayOrTimestamp) => {\r\n      return formatDateTime(businessDayOrTimestamp - timezoneOffset);\r\n    },\r\n  },\r\n  grid: {\r\n    vertLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n    horzLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/time-scale.md#time-scale\r\n  timeScale: {\r\n    rightOffset: 5,\r\n    borderVisible: false,\r\n    barSpacing: 5,\r\n    timeVisible: true,\r\n    fixLeftEdge: true,\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#price-axis\r\n  priceScale: {\r\n    borderVisible: false,\r\n  },\r\n  crosshair: {\r\n    horzLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    vertLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    mode: 0,\r\n  },\r\n});\r\n\r\nexport default function ExchangeTVChart(props) {\r\n  const {\r\n    swapOption,\r\n    fromTokenAddress,\r\n    toTokenAddress,\r\n    infoTokens,\r\n    chainId,\r\n    positions,\r\n    savedShouldShowPositionLines,\r\n    orders,\r\n    setToTokenAddress,\r\n  } = props;\r\n  const [currentChart, setCurrentChart] = useState();\r\n  const [currentSeries, setCurrentSeries] = useState();\r\n\r\n  let [period, setPeriod] = useLocalStorageSerializeKey([chainId, \"Chart-period\"], DEFAULT_PERIOD);\r\n  if (!(period in CHART_PERIODS)) {\r\n    period = DEFAULT_PERIOD;\r\n  }\r\n\r\n  const [hoveredCandlestick, setHoveredCandlestick] = useState();\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  const [chartToken, setChartToken] = useState({\r\n    maxPrice: null,\r\n    minPrice: null,\r\n  });\r\n  useEffect(() => {\r\n    const tmp = getChartToken(swapOption, fromToken, toToken, chainId);\r\n    setChartToken(tmp);\r\n  }, [swapOption, fromToken, toToken, chainId]);\r\n\r\n  const symbol = chartToken ? (chartToken.isWrapped ? chartToken.baseSymbol : chartToken.symbol) : undefined;\r\n  const marketName = chartToken ? symbol + \"_USD\" : undefined;\r\n  const previousMarketName = usePrevious(marketName);\r\n\r\n  const currentOrders = useMemo(() => {\r\n    if (swapOption === SWAP || !chartToken) {\r\n      return [];\r\n    }\r\n\r\n    return orders.filter((order) => {\r\n      if (order.type === SWAP) {\r\n        // we can't show non-stable to non-stable swap orders with existing charts\r\n        // so to avoid users confusion we'll show only long/short orders\r\n        return false;\r\n      }\r\n\r\n      const indexToken = getToken(chainId, order.indexToken);\r\n      return order.indexToken === chartToken.address || (chartToken.isNative && indexToken.isWrapped);\r\n    });\r\n  }, [orders, chartToken, swapOption, chainId]);\r\n\r\n  const ref = useRef(null);\r\n  const chartRef = useRef(null);\r\n\r\n  const currentAveragePrice =\r\n    chartToken.maxPrice && chartToken.minPrice ? chartToken.maxPrice.add(chartToken.minPrice).div(2) : null;\r\n  const [priceData, updatePriceData] = useChartPrices(\r\n    chainId,\r\n    chartToken.symbol,\r\n    chartToken.isStable,\r\n    period,\r\n    currentAveragePrice\r\n  );\r\n\r\n  const [chartInited, setChartInited] = useState(false);\r\n  useEffect(() => {\r\n    if (marketName !== previousMarketName) {\r\n      setChartInited(false);\r\n    }\r\n  }, [marketName, previousMarketName]);\r\n\r\n  const scaleChart = useCallback(() => {\r\n    const from = Date.now() / 1000 - (7 * 24 * CHART_PERIODS[period]) / 2 + timezoneOffset;\r\n    const to = Date.now() / 1000 + timezoneOffset;\r\n    currentChart.timeScale().setVisibleRange({ from, to });\r\n  }, [currentChart, period]);\r\n\r\n  const onCrosshairMove = useCallback(\r\n    (evt) => {\r\n      if (!evt.time) {\r\n        setHoveredCandlestick(null);\r\n        return;\r\n      }\r\n\r\n      for (const point of evt.seriesPrices.values()) {\r\n        setHoveredCandlestick((hoveredCandlestick) => {\r\n          if (hoveredCandlestick && hoveredCandlestick.time === evt.time) {\r\n            // rerender optimisations\r\n            return hoveredCandlestick;\r\n          }\r\n          return {\r\n            time: evt.time,\r\n            ...point,\r\n          };\r\n        });\r\n        break;\r\n      }\r\n    },\r\n    [setHoveredCandlestick]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!ref.current || !priceData || !priceData.length || currentChart) {\r\n      return;\r\n    }\r\n\r\n    const chart = createChart(\r\n      chartRef.current,\r\n      getChartOptions(chartRef.current.offsetWidth, chartRef.current.offsetHeight)\r\n    );\r\n\r\n    chart.subscribeCrosshairMove(onCrosshairMove);\r\n\r\n    const series = chart.addCandlestickSeries(getSeriesOptions());\r\n\r\n    setCurrentChart(chart);\r\n    setCurrentSeries(series);\r\n  }, [ref, priceData, currentChart, onCrosshairMove]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      updatePriceData(undefined, true);\r\n    }, 60 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [updatePriceData]);\r\n\r\n  useEffect(() => {\r\n    if (!currentChart) {\r\n      return;\r\n    }\r\n    const resizeChart = () => {\r\n      currentChart.resize(chartRef.current.offsetWidth, chartRef.current.offsetHeight);\r\n    };\r\n    window.addEventListener(\"resize\", resizeChart);\r\n    return () => window.removeEventListener(\"resize\", resizeChart);\r\n  }, [currentChart]);\r\n\r\n  useEffect(() => {\r\n    if (currentSeries && priceData && priceData.length) {\r\n      currentSeries.setData(priceData);\r\n\r\n      if (!chartInited) {\r\n        scaleChart();\r\n        setChartInited(true);\r\n      }\r\n    }\r\n  }, [priceData, currentSeries, chartInited, scaleChart]);\r\n\r\n  useEffect(() => {\r\n    const lines = [];\r\n    if (currentSeries && savedShouldShowPositionLines) {\r\n      if (currentOrders && currentOrders.length > 0) {\r\n        currentOrders.forEach((order) => {\r\n          const indexToken = getToken(chainId, order.indexToken);\r\n          let tokenSymbol;\r\n          if (indexToken && indexToken.symbol) {\r\n            tokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n          }\r\n          const title = `${order.type === INCREASE ? \"Inc.\" : \"Dec.\"} ${tokenSymbol} ${\r\n            order.isLong ? \"Long\" : \"Short\"\r\n          }`;\r\n          const color = \"#3a3e5e\";\r\n          lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(order.triggerPrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: title.padEnd(PRICE_LINE_TEXT_WIDTH, \" \"),\r\n            })\r\n          );\r\n        });\r\n      }\r\n      if (positions && positions.length > 0) {\r\n        const color = \"#3a3e5e\";\r\n\r\n        positions.forEach((position) => {\r\n          lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(position.averagePrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: `Open ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}`.padEnd(\r\n                PRICE_LINE_TEXT_WIDTH,\r\n                \" \"\r\n              ),\r\n            })\r\n          );\r\n\r\n          const liquidationPrice = getLiquidationPrice(position);\r\n          lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(liquidationPrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: `Liq. ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}`.padEnd(\r\n                PRICE_LINE_TEXT_WIDTH,\r\n                \" \"\r\n              ),\r\n            })\r\n          );\r\n        });\r\n      }\r\n    }\r\n    return () => {\r\n      lines.forEach((line) => currentSeries.removePriceLine(line));\r\n    };\r\n  }, [currentOrders, positions, currentSeries, chainId, savedShouldShowPositionLines]);\r\n\r\n  const candleStatsHtml = useMemo(() => {\r\n    if (!priceData) {\r\n      return null;\r\n    }\r\n    const candlestick = hoveredCandlestick || priceData[priceData.length - 1];\r\n    if (!candlestick) {\r\n      return null;\r\n    }\r\n\r\n    const className = cx({\r\n      \"ExchangeChart-bottom-stats\": true,\r\n      positive: candlestick.open <= candlestick.close,\r\n      negative: candlestick.open > candlestick.close,\r\n      [`length-${String(parseInt(candlestick.close)).length}`]: true,\r\n    });\r\n\r\n    const toFixedNumbers = 2;\r\n\r\n    return (\r\n      <div className={className}>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">O</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.open.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">H</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.high.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">L</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.low.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">C</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.close.toFixed(toFixedNumbers)}</span>\r\n      </div>\r\n    );\r\n  }, [hoveredCandlestick, priceData]);\r\n\r\n  let high;\r\n  let low;\r\n  let deltaPrice;\r\n  let delta;\r\n  let deltaPercentage;\r\n  let deltaPercentageStr;\r\n\r\n  const now = parseInt(Date.now() / 1000);\r\n  const timeThreshold = now - 24 * 60 * 60;\r\n\r\n  if (priceData) {\r\n    for (let i = priceData.length - 1; i > 0; i--) {\r\n      const price = priceData[i];\r\n      if (price.time < timeThreshold) {\r\n        break;\r\n      }\r\n      if (!low) {\r\n        low = price.low;\r\n      }\r\n      if (!high) {\r\n        high = price.high;\r\n      }\r\n\r\n      if (price.high > high) {\r\n        high = price.high;\r\n      }\r\n      if (price.low < low) {\r\n        low = price.low;\r\n      }\r\n\r\n      deltaPrice = price.open;\r\n    }\r\n  }\r\n\r\n  if (deltaPrice && currentAveragePrice) {\r\n    const average = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n    delta = average - deltaPrice;\r\n    deltaPercentage = (delta * 100) / average;\r\n    if (deltaPercentage > 0) {\r\n      deltaPercentageStr = `+${deltaPercentage.toFixed(2)}%`;\r\n    } else {\r\n      deltaPercentageStr = `${deltaPercentage.toFixed(2)}%`;\r\n    }\r\n    if (deltaPercentage === 0) {\r\n      deltaPercentageStr = \"0.00\";\r\n    }\r\n  }\r\n\r\n  if (!chartToken) {\r\n    return null;\r\n  }\r\n\r\n  const onSelectToken = (token) => {\r\n    const tmp = getTokenInfo(infoTokens, token.address);\r\n    setChartToken(tmp);\r\n    setToTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"ExchangeChart tv\" ref={ref}>\r\n      <div className=\"ExchangeChart-top App-box App-box-border\">\r\n        <div className=\"ExchangeChart-top-inner\">\r\n          <div>\r\n            <div className=\"ExchangeChart-title\">\r\n              <ChartTokenSelector\r\n                chainId={chainId}\r\n                selectedToken={chartToken}\r\n                swapOption={swapOption}\r\n                infoTokens={infoTokens}\r\n                onSelectToken={onSelectToken}\r\n                className=\"chart-token-selector pos-relative\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"ExchangeChart-stats-container\">\r\n            <div>\r\n              <div className=\"ExchangeChart-info-label\">\r\n                Current Price\r\n              </div>\r\n              <div className=\"ExchangeChart-main-price\">\r\n                ${chartToken.maxPrice && formatAmount(chartToken.maxPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div>\r\n              <div className=\"ExchangeChart-info-label\">24h Change</div>\r\n              <div className={cx({ positive: deltaPercentage > 0, negative: deltaPercentage < 0 })}>\r\n                {!deltaPercentageStr && \"-\"}\r\n                {deltaPercentageStr && deltaPercentageStr}\r\n              </div>\r\n            </div>\r\n            <div className=\"ExchangeChart-additional-info\">\r\n              <div className=\"ExchangeChart-info-label\">24h High</div>\r\n              <div>\r\n                {!high && \"-\"}\r\n                {high && numberWithCommas(high.toFixed(2))}\r\n              </div>\r\n            </div>\r\n            <div className=\"ExchangeChart-additional-info\">\r\n              <div className=\"ExchangeChart-info-label\">24h Low</div>\r\n              <div>\r\n                {!low && \"-\"}\r\n                {low && numberWithCommas(low.toFixed(2))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"ExchangeChart-bottom App-box App-box-border\">\r\n        <div className=\"ExchangeChart-bottom-header\">\r\n          <div className=\"ExchangeChart-bottom-controls\">\r\n            <Tab options={Object.keys(CHART_PERIODS)} option={period} setOption={setPeriod} />\r\n          </div>\r\n          {candleStatsHtml}\r\n        </div>\r\n        <div className=\"ExchangeChart-bottom-content\" ref={chartRef}></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useCallback, useEffect, useMemo } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  formatAmount,\r\n  bigNumberify,\r\n  ARBITRUM,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  USD_DECIMALS,\r\n  DUST_USD,\r\n  BASIS_POINTS_DIVISOR,\r\n  USDG_ADDRESS,\r\n  SLIPPAGE_BPS_KEY,\r\n  TRIGGER_PREFIX_BELOW,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  MIN_PROFIT_TIME,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  getLeverage,\r\n  getMarginFee,\r\n  PRECISION,\r\n  MARKET,\r\n  STOP,\r\n  DECREASE,\r\n  useLocalStorageSerializeKey,\r\n  calculatePositionDelta,\r\n  getDeltaStr,\r\n  getProfitPrice,\r\n  formatDateTime,\r\n  getTimeRemaining,\r\n  getNextToAmount,\r\n  getUsd,\r\n  USDG_DECIMALS,\r\n  CLOSE_POSITION_RECEIVE_TOKEN_KEY,\r\n  useLocalStorageByChainId,\r\n  adjustForDecimals,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n  MAX_ALLOWED_LEVERAGE,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { createDecreaseOrder, useHasOutdatedUi } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport TokenSelector from \"./TokenSelector\";\r\nimport { getTokens } from \"../../config/Tokens\";\r\nimport \"./PositionSeller.css\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport marketImg from '../../img/ddl/icon_market.svg'\r\nimport marketActiveImg from '../../img/ddl/icon_market_active.svg'\r\nimport triggerImg from '../../img/ddl/icon_trigger.svg'\r\nimport triggerActiveImg from '../../img/ddl/icon_trigger_active.svg'\r\nimport SlippageInput from './../SlippageInput/SlippageInput';\r\nimport { DDL_AccountManager } from \"../../../../components/utils/contracts\";\r\nimport { DDL_AccountManager_abi } from './../../../../components/utils/contracts';\r\n\r\nconst CLOSE_ICONS = {\r\n  Market: marketImg,\r\n  Market_active: marketActiveImg,\r\n  Stop: triggerImg,\r\n  Stop_active: triggerActiveImg,\r\n}\r\n\r\nconst { AddressZero } = ethers.constants;\r\nconst ORDER_SIZE_DUST_USD = expandDecimals(1, USD_DECIMALS - 1); // $0.10\r\n\r\nconst orderOptionLabels = {\r\n  [MARKET]: \"Market\",\r\n  [STOP]: \"Trigger\",\r\n};\r\n\r\nfunction getTokenAmount(usdAmount, tokenAddress, max, infoTokens) {\r\n  if (!usdAmount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return usdAmount.mul(expandDecimals(1, 18)).div(PRECISION);\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n\r\n  return usdAmount.mul(expandDecimals(1, info.decimals)).div(max ? info.minPrice : info.maxPrice);\r\n}\r\n\r\nfunction shouldSwap(collateralToken, receiveToken) {\r\n  // If position collateral is WETH in contract, then position.collateralToken is { symbol: ETH, isNative: true,  }\r\n  // @see https://github.com/gmx-io/gmx-interface/blob/master/src/pages/Exchange/Exchange.js#L162\r\n  // meaning if collateralToken.isNative === true in reality position has WETH as a collateral\r\n  // and if collateralToken.isNative === true and receiveToken.isNative === true then positions WETH will be unwrapped and user will receive native ETH\r\n  const isCollateralWrapped = collateralToken.isNative;\r\n\r\n  const isSameToken =\r\n    collateralToken.address === receiveToken.address || (isCollateralWrapped && receiveToken.isWrapped);\r\n\r\n  const isUnwrap = isCollateralWrapped && receiveToken.isNative;\r\n\r\n  return !isSameToken && !isUnwrap;\r\n}\r\n\r\nfunction getSwapLimits(infoTokens, fromTokenAddress, toTokenAddress) {\r\n  const fromInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  let maxInUsd;\r\n  let maxIn;\r\n  let maxOut;\r\n  let maxOutUsd;\r\n\r\n  if (!fromInfo?.maxUsdgAmount) {\r\n    maxInUsd = bigNumberify(0);\r\n    maxIn = bigNumberify(0);\r\n  } else {\r\n    maxInUsd = fromInfo.maxUsdgAmount\r\n      .sub(fromInfo.usdgAmount)\r\n      .mul(expandDecimals(1, USD_DECIMALS))\r\n      .div(expandDecimals(1, USDG_DECIMALS));\r\n\r\n    maxIn = maxInUsd.mul(expandDecimals(1, fromInfo.decimals)).div(fromInfo.maxPrice).toString();\r\n  }\r\n\r\n  if (!toInfo?.poolAmount || !toInfo?.bufferAmount) {\r\n    maxOut = bigNumberify(0);\r\n    maxOutUsd = bigNumberify(0);\r\n  } else {\r\n    maxOut = toInfo.availableAmount.gt(toInfo.poolAmount.sub(toInfo.bufferAmount))\r\n      ? toInfo.poolAmount.sub(toInfo.bufferAmount)\r\n      : toInfo.availableAmount;\r\n\r\n    maxOutUsd = getUsd(maxOut, toInfo.address, false, infoTokens);\r\n  }\r\n\r\n  return {\r\n    maxIn,\r\n    maxInUsd,\r\n    maxOut,\r\n    maxOutUsd,\r\n  };\r\n}\r\n\r\nexport default function PositionSeller(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    account,\r\n    library,\r\n    infoTokens,\r\n    setPendingTxns,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    isWaitingForPluginApproval,\r\n    isPluginApproving,\r\n    orderBookApproved,\r\n    setOrdersToaOpen,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    minExecutionFee,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n  } = props;\r\n\r\n  const [savedSlippageAmount] = useLocalStorageSerializeKey([chainId, SLIPPAGE_BPS_KEY], DEFAULT_SLIPPAGE_AMOUNT);\r\n\r\n  const [keepLeverage, setKeepLeverage] = useLocalStorageSerializeKey([chainId, \"Exchange-keep-leverage\"], true);\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n\r\n  const [userSlippage, setUserSlippage] = useState('')\r\n  \r\n  const [isProfitWarningAccepted, setIsProfitWarningAccepted] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n  const toTokens = getTokens(chainId);\r\n\r\n  const [savedRecieveTokenAddress, setSavedRecieveTokenAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    `${CLOSE_POSITION_RECEIVE_TOKEN_KEY}-${position.indexToken.symbol}-${position?.isLong ? \"long\" : \"short\"}`\r\n  );\r\n\r\n  const [swapToToken, setSwapToToken] = useState(() =>\r\n    savedRecieveTokenAddress ? toTokens.find((token) => token.address === savedRecieveTokenAddress) : undefined\r\n  );\r\n\r\n  // Slippage Edit\r\n  // let allowedSlippage = savedSlippageAmount;\r\n  let allowedSlippage = DEFAULT_SLIPPAGE_AMOUNT;\r\n  // if (isHigherSlippageAllowed) {\r\n  //   allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  // }\r\n  if (userSlippage !== '') {\r\n    allowedSlippage = userSlippage * 100;\r\n  }\r\n\r\n  // const orderOptions = [MARKET, STOP];\r\n  const orderOptions = [];\r\n  let [orderOption, setOrderOption] = useState(MARKET);\r\n\r\n  if (!flagOrdersEnabled) {\r\n    orderOption = MARKET;\r\n  }\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved && orderOption === MARKET;\r\n\r\n  const onOrderOptionChange = (option) => {\r\n    setOrderOption(option);\r\n  };\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(\"\");\r\n  const triggerPriceUsd = orderOption === MARKET ? 0 : parseValue(triggerPriceValue, USD_DECIMALS);\r\n\r\n  const [nextDelta, nextHasProfit = bigNumberify(0)] = useMemo(() => {\r\n    if (!position) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    if (orderOption !== STOP) {\r\n      return [position.delta, position.hasProfit, position.deltaPercentage];\r\n    }\r\n\r\n    if (!triggerPriceUsd) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    const { delta, hasProfit, deltaPercentage } = calculatePositionDelta(triggerPriceUsd, position);\r\n    return [delta, hasProfit, deltaPercentage];\r\n  }, [position, orderOption, triggerPriceUsd]);\r\n\r\n  const existingOrders = useMemo(() => {\r\n    if (orderOption === STOP && (!triggerPriceUsd || triggerPriceUsd.eq(0))) {\r\n      return [];\r\n    }\r\n    if (!orders || !position) {\r\n      return [];\r\n    }\r\n\r\n    const ret = [];\r\n    for (const order of orders) {\r\n      // only Stop orders can't be executed without corresponding opened position\r\n      if (order.type !== DECREASE) continue;\r\n\r\n      // if user creates Stop-Loss we need only Stop-Loss orders and vice versa\r\n      if (orderOption === STOP) {\r\n        const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n        if (triggerAboveThreshold !== order.triggerAboveThreshold) continue;\r\n      }\r\n\r\n      const sameToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      if (order.isLong === position.isLong && sameToken) {\r\n        ret.push(order);\r\n      }\r\n    }\r\n    return ret;\r\n  }, [position, orders, triggerPriceUsd, orderOption, nativeTokenAddress]);\r\n\r\n  const existingOrder = existingOrders[0];\r\n\r\n  const needOrderBookApproval = orderOption === STOP && !orderBookApproved;\r\n\r\n  const isSwapAllowed = orderOption === MARKET;\r\n\r\n  const { data: hasOutdatedUi } = useHasOutdatedUi();\r\n\r\n  let collateralToken;\r\n  let receiveToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let isClosing;\r\n  let sizeDelta;\r\n\r\n  let nextCollateral;\r\n  let collateralDelta = bigNumberify(0);\r\n  let receiveAmount = bigNumberify(0);\r\n  let convertedReceiveAmount = bigNumberify(0);\r\n  let adjustedDelta = bigNumberify(0);\r\n\r\n  let isNotEnoughReceiveTokenLiquidity;\r\n  let isCollateralPoolCapacityExceeded;\r\n\r\n  let title;\r\n  let fundingFee;\r\n  let positionFee;\r\n  let swapFeeToken;\r\n  let swapFee;\r\n  let totalFees = bigNumberify(0);\r\n\r\n  let executionFee = orderOption === STOP ? getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\") : minExecutionFee;\r\n\r\n  let executionFeeUsd = getUsd(executionFee, nativeTokenAddress, false, infoTokens) || bigNumberify(0);\r\n\r\n  if (position) {\r\n    fundingFee = position.fundingFee;\r\n    fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n    sizeDelta = fromAmount;\r\n\r\n    title = `Close ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (fromAmount) {\r\n      isClosing = position.size.sub(fromAmount).lt(DUST_USD);\r\n      positionFee = getMarginFee(fromAmount);\r\n    }\r\n\r\n    if (isClosing) {\r\n      sizeDelta = position.size;\r\n      receiveAmount = position.collateral;\r\n    } else if (orderOption === STOP && sizeDelta && existingOrders.length > 0) {\r\n      let residualSize = position.size;\r\n      for (const order of existingOrders) {\r\n        residualSize = residualSize.sub(order.sizeDelta);\r\n      }\r\n      if (residualSize.sub(sizeDelta).abs().lt(ORDER_SIZE_DUST_USD)) {\r\n        sizeDelta = residualSize;\r\n      }\r\n    }\r\n\r\n    if (sizeDelta) {\r\n      adjustedDelta = nextDelta.mul(sizeDelta).div(position.size);\r\n    }\r\n\r\n    if (nextHasProfit) {\r\n      receiveAmount = receiveAmount.add(adjustedDelta);\r\n    } else {\r\n      if (receiveAmount.gt(adjustedDelta)) {\r\n        receiveAmount = receiveAmount.sub(adjustedDelta);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    if (keepLeverage && sizeDelta && !isClosing) {\r\n      collateralDelta = sizeDelta.mul(position.collateral).div(position.size);\r\n      // if the position will be realising a loss then reduce collateralDelta by the realised loss\r\n      if (!nextHasProfit) {\r\n        const deductions = adjustedDelta.add(positionFee).add(fundingFee);\r\n        if (collateralDelta.gt(deductions)) {\r\n          collateralDelta = collateralDelta = collateralDelta.sub(deductions);\r\n        } else {\r\n          collateralDelta = bigNumberify(0);\r\n        }\r\n      }\r\n    }\r\n\r\n    maxAmount = position.size;\r\n    maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n    maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n\r\n    if (fromAmount && collateralToken.maxPrice) {\r\n      convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n      convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n    }\r\n\r\n    totalFees = totalFees.add(positionFee || bigNumberify(0)).add(fundingFee || bigNumberify(0));\r\n\r\n    receiveAmount = receiveAmount.add(collateralDelta);\r\n\r\n    if (sizeDelta) {\r\n      if (receiveAmount.gt(totalFees)) {\r\n        receiveAmount = receiveAmount.sub(totalFees);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    receiveToken = isSwapAllowed && swapToToken ? swapToToken : collateralToken;\r\n\r\n    // Calculate swap fees\r\n    if (isSwapAllowed && swapToToken) {\r\n      const { feeBasisPoints } = getNextToAmount(\r\n        chainId,\r\n        convertedAmount,\r\n        collateralToken.address,\r\n        receiveToken.address,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        true\r\n      );\r\n\r\n      if (feeBasisPoints) {\r\n        swapFee = receiveAmount.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n        swapFeeToken = getTokenAmount(swapFee, collateralToken.address, false, infoTokens);\r\n        totalFees = totalFees.add(swapFee || bigNumberify(0));\r\n        receiveAmount = receiveAmount.sub(swapFee);\r\n      }\r\n    }\r\n\r\n    convertedReceiveAmount = getTokenAmount(receiveAmount, receiveToken.address, false, infoTokens);\r\n\r\n    // Check swap limits (max in / max out)\r\n    if (isSwapAllowed && shouldSwap(collateralToken, receiveToken)) {\r\n      const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n      const receiveTokenInfo = getTokenInfo(infoTokens, receiveToken.address);\r\n\r\n      isNotEnoughReceiveTokenLiquidity =\r\n        receiveTokenInfo.availableAmount.lt(convertedReceiveAmount) ||\r\n        receiveTokenInfo.bufferAmount.gt(receiveTokenInfo.poolAmount.sub(convertedReceiveAmount));\r\n\r\n      if (\r\n        collateralInfo.maxUsdgAmount &&\r\n        collateralInfo.maxUsdgAmount.gt(0) &&\r\n        collateralInfo.usdgAmount &&\r\n        collateralInfo.maxPrice\r\n      ) {\r\n        const usdgFromAmount = adjustForDecimals(receiveAmount, USD_DECIMALS, USDG_DECIMALS);\r\n        const nextUsdgAmount = collateralInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n        if (nextUsdgAmount.gt(collateralInfo.maxUsdgAmount)) {\r\n          isCollateralPoolCapacityExceeded = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isClosing) {\r\n      nextCollateral = bigNumberify(0);\r\n    } else {\r\n      if (position.collateral) {\r\n        nextCollateral = position.collateral;\r\n        if (collateralDelta && collateralDelta.gt(0)) {\r\n          nextCollateral = position.collateral.sub(collateralDelta);\r\n        } else if (position.delta && position.delta.gt(0) && sizeDelta) {\r\n          if (!position.hasProfit) {\r\n            nextCollateral = nextCollateral.sub(adjustedDelta);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (fromAmount) {\r\n      if (!isClosing && !keepLeverage) {\r\n        nextLeverage = getLeverage({\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          hasProfit: nextHasProfit,\r\n          delta: nextDelta,\r\n          includeDelta: savedIsPnlInLeverage,\r\n        });\r\n        nextLiquidationPrice = getLiquidationPrice({\r\n          isLong: position.isLong,\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          averagePrice: position.averagePrice,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          delta: nextDelta,\r\n          hasProfit: nextHasProfit,\r\n          includeDelta: true,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  const [deltaStr, deltaPercentageStr] = useMemo(() => {\r\n    if (!position || !position.markPrice) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n    if (orderOption !== STOP) {\r\n      const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n        position.markPrice,\r\n        position,\r\n        fromAmount\r\n      );\r\n      const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n        delta: pendingDelta,\r\n        deltaPercentage: pendingDeltaPercentage,\r\n        hasProfit,\r\n      });\r\n      return [deltaStr, deltaPercentageStr];\r\n    }\r\n    if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n\r\n    const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n      triggerPriceUsd,\r\n      position,\r\n      fromAmount\r\n    );\r\n\r\n    const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n      delta: pendingDelta,\r\n      deltaPercentage: pendingDeltaPercentage,\r\n      hasProfit,\r\n    });\r\n    return [deltaStr, deltaPercentageStr];\r\n  }, [position, triggerPriceUsd, orderOption, fromAmount]);\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (orderOption === STOP) return [t`Trigger order disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Position close disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (hasOutdatedUi) {\r\n      return t`Page outdated, please refresh`;\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (orderOption === STOP) {\r\n      if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n        return t`Enter Price`;\r\n      }\r\n      if (position.isLong && triggerPriceUsd.lte(liquidationPrice)) {\r\n        return t`Price below Liq. Price`;\r\n      }\r\n      if (!position.isLong && triggerPriceUsd.gte(liquidationPrice)) {\r\n        return t`Price above Liq. Price`;\r\n      }\r\n\r\n      if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n        return t`Invalid price, see warning`;\r\n      }\r\n    }\r\n\r\n    if (isNotEnoughReceiveTokenLiquidity) {\r\n      return \"Insufficient receive token liquidity\";\r\n    }\r\n\r\n    if (isCollateralPoolCapacityExceeded) {\r\n      return `${collateralToken.symbol} pool exceeded, can only Receive ${collateralToken.symbol}`;\r\n    }\r\n\r\n    if (!isClosing && position && position.size && fromAmount) {\r\n      if (position.size.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Leftover position below 10 USD`;\r\n      }\r\n      if (nextCollateral && nextCollateral.lt(expandDecimals(5, USD_DECIMALS))) {\r\n        return t`Leftover collateral below 5 USD`;\r\n      }\r\n    }\r\n\r\n    if (position && position.size && position.size.lt(fromAmount)) {\r\n      return t`Max close amount exceeded`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.gt(MAX_ALLOWED_LEVERAGE)) {\r\n      return t`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`;\r\n    }\r\n\r\n    if (hasPendingProfit && orderOption !== STOP && !isProfitWarningAccepted) {\r\n      return t`Forfeit profit not checked`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return false;\r\n    }\r\n    if (isPluginApproving) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const hasPendingProfit = MIN_PROFIT_TIME > 0 && position.delta.eq(0) && position.pendingDelta.gt(0);\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (orderOption === STOP) {\r\n      if (isSubmitting) return t`Creating Order...`;\r\n\r\n      if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (isPluginApproving) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (needOrderBookApproval) {\r\n        return t`Enable Orders`;\r\n      }\r\n\r\n      return t`Create Order`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (hasPendingProfit) {\r\n      return t`Close without profit`;\r\n    }\r\n    return isSubmitting ? t`Closing...` : t`Close`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n    setIsProfitWarningAccepted(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const onClickPrimary = async () => {\r\n    if (needOrderBookApproval) {\r\n      setOrdersToaOpen(true);\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: t`Enable leverage sent.`,\r\n        failMsg: t`Enable leverage failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    const collateralTokenAddress = position.collateralToken.isNative\r\n      ? nativeTokenAddress\r\n      : position.collateralToken.address;\r\n    const indexTokenAddress = position.indexToken.isNative ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    if (orderOption === STOP) {\r\n      const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n\r\n      createDecreaseOrder(\r\n        chainId,\r\n        library,\r\n        indexTokenAddress,\r\n        sizeDelta,\r\n        collateralTokenAddress,\r\n        collateralDelta,\r\n        position.isLong,\r\n        triggerPriceUsd,\r\n        triggerAboveThreshold,\r\n        {\r\n          sentMsg: t`Order submitted!`,\r\n          successMsg: t`Order created!`,\r\n          failMsg: t`Order creation failed.`,\r\n          setPendingTxns,\r\n        }\r\n      )\r\n        .then(() => {\r\n          setFromValue(\"\");\r\n          setIsVisible(false);\r\n        })\r\n        .finally(() => {\r\n          setIsSubmitting(false);\r\n        });\r\n      return;\r\n    }\r\n\r\n    const priceBasisPoints = position.isLong\r\n      ? BASIS_POINTS_DIVISOR - allowedSlippage\r\n      : BASIS_POINTS_DIVISOR + allowedSlippage;\r\n    const refPrice = position.isLong ? position.indexToken.minPrice : position.indexToken.maxPrice;\r\n    let priceLimit = refPrice.mul(priceBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n    const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n    const minProfitTimeExpired = parseInt(Date.now() / 1000) > minProfitExpiration;\r\n\r\n    if (nextHasProfit && !minProfitTimeExpired && !isProfitWarningAccepted) {\r\n      if ((position.isLong && priceLimit.lt(profitPrice)) || (!position.isLong && priceLimit.gt(profitPrice))) {\r\n        priceLimit = profitPrice;\r\n      }\r\n    }\r\n\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n\r\n    const path = [tokenAddress0];\r\n\r\n    const isUnwrap = receiveToken.address === AddressZero;\r\n    const isSwap = receiveToken.address !== tokenAddress0;\r\n\r\n    if (isSwap) {\r\n      if (isUnwrap && tokenAddress0 !== nativeTokenAddress) {\r\n        path.push(nativeTokenAddress);\r\n      } else if (!isUnwrap) {\r\n        path.push(receiveToken.address);\r\n      }\r\n    }\r\n\r\n    const withdrawETH = isUnwrap;\r\n\r\n    const params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      collateralDelta, // _collateralDelta\r\n      sizeDelta, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      // account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n      // AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    const successMsg = t`Requested decrease of ${position.indexToken.symbol} ${\r\n      position.isLong ? \"Long\" : \"Short\"\r\n    } by ${formatAmount(sizeDelta, USD_DECIMALS, 2)} USD.`;\r\n\r\n    // const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, \"createDecreasePosition\", params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Close submitted!`,\r\n      successMsg,\r\n      failMsg: t`Close failed.`,\r\n      setPendingTxns,\r\n      // for Arbitrum, sometimes the successMsg shows after the position has already been executed\r\n      // hide the success message for Arbitrum as a workaround\r\n      hideSuccessMsg: chainId === ARBITRUM,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        let nextSize = position.size.sub(sizeDelta);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            size: nextSize,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const renderExistingOrderWarning = useCallback(() => {\r\n    if (!existingOrder) {\r\n      return;\r\n    }\r\n    const indexToken = getTokenInfo(infoTokens, existingOrder.indexToken);\r\n    const sizeInToken = formatAmount(\r\n      existingOrder.sizeDelta.mul(PRECISION).div(existingOrder.triggerPrice),\r\n      USD_DECIMALS,\r\n      4,\r\n      true\r\n    );\r\n    const prefix = existingOrder.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n    return (\r\n      <div className=\"Confirmation-box-warning\">\r\n        You have an active order to decrease {existingOrder.isLong ? \"Long\" : \"Short\"} {sizeInToken} {indexToken.symbol}{\" \"}\r\n        ($\r\n        {formatAmount(existingOrder.sizeDelta, USD_DECIMALS, 2, true)}) at {prefix}{\" \"}\r\n        {formatAmount(existingOrder.triggerPrice, USD_DECIMALS, 2, true)}\r\n      </div>\r\n    );\r\n  }, [existingOrder, infoTokens]);\r\n\r\n  function renderMinProfitWarning() {\r\n    if (MIN_PROFIT_TIME === 0) {\r\n      return null;\r\n    }\r\n\r\n    if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n      const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n\r\n      if (orderOption === MARKET) {\r\n        return (\r\n          <div className=\"Confirmation-box-warning\">\r\n            Reducing the position at the current price will forfeit a&nbsp;\r\n            <a\r\n              href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              pending profit\r\n            </a>{\" \"}\r\n            of {deltaStr}. <br />\r\n            <br />\r\n            Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n            applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n          </div>\r\n        );\r\n      }\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          This order will forfeit a&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            profit\r\n          </a>{\" \"}\r\n          of {deltaStr}. <br />\r\n          Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n          applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  const profitPrice = getProfitPrice(orderOption === MARKET ? position.markPrice : triggerPriceUsd, position);\r\n\r\n  let triggerPricePrefix;\r\n  if (triggerPriceUsd) {\r\n    triggerPricePrefix = triggerPriceUsd.gt(position.markPrice) ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n  }\r\n\r\n  const shouldShowExistingOrderWarning = false;\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue])\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal\r\n          className=\"PositionSeller-modal\"\r\n          isVisible={isVisible}\r\n          setIsVisible={setIsVisible}\r\n          label={title}\r\n          allowContentTouchMove\r\n          isNifty={true}\r\n        >\r\n          {/* {flagOrdersEnabled && (\r\n            <Tab\r\n              options={orderOptions}\r\n              option={orderOption}\r\n              optionLabels={orderOptionLabels}\r\n              onChange={onOrderOptionChange}\r\n              icons={CLOSE_ICONS}\r\n            />\r\n          )} */}\r\n          <div className={\"Exchange-swap-section\"\r\n            + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                {convertedAmountFormatted && (\r\n                  <div className=\"Exchange-swap-usd\">\r\n                    Close: {convertedAmountFormatted} {position.collateralToken.symbol}\r\n                  </div>\r\n                )}\r\n                {!convertedAmountFormatted && \"Close\"}\r\n              </div>\r\n              {maxAmount && (\r\n                <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                  Max: {maxAmountFormatted}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={fromValue}\r\n                  onChange={(e) => setFromValue(e.target.value)}\r\n                  onFocus={(e) => {\r\n                    setHasInputFocus(true);\r\n                  }}\r\n                  onBlur={(e) => {\r\n                    setHasInputFocus(false);\r\n                  }}\r\n                />\r\n                {fromValue !== maxAmountFormattedFree && (\r\n                  <div\r\n                    className=\"Exchange-swap-max\"\r\n                    onClick={() => {\r\n                      setFromValue(maxAmountFormattedFree);\r\n                    }}\r\n                  >\r\n                    MAX\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">USD</div>\r\n            </div>\r\n          </div>\r\n          {orderOption === MARKET && (\r\n            <SlippageInput \r\n              value={userSlippage}\r\n              setValue={setUserSlippage} \r\n            />\r\n          )}\r\n          {orderOption === STOP && (\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  <Trans>Price</Trans>\r\n                </div>\r\n                <div\r\n                  className=\"muted align-right clickable\"\r\n                  onClick={() => {\r\n                    setTriggerPriceValue(formatAmountFree(position.markPrice, USD_DECIMALS, 2));\r\n                  }}\r\n                >\r\n                  Mark: {formatAmount(position.markPrice, USD_DECIMALS, 2, true)}\r\n                </div>\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div className=\"Exchange-swap-input-container\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={triggerPriceValue}\r\n                    onChange={onTriggerPriceChange}\r\n                  />\r\n                </div>\r\n                <div className=\"PositionEditor-token-symbol\">USD</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {renderMinProfitWarning()}\r\n          {shouldShowExistingOrderWarning && renderExistingOrderWarning()}\r\n          <div className=\"PositionEditor-info-box\">\r\n            {minExecutionFeeErrorMessage && (\r\n              <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n            )}\r\n            {hasPendingProfit && orderOption !== STOP && (\r\n              <div className=\"PositionEditor-accept-profit-warning\">\r\n                <Checkbox isChecked={isProfitWarningAccepted} setIsChecked={setIsProfitWarningAccepted}>\r\n                  <span className=\"muted\">Forfeit profit</span>\r\n                </Checkbox>\r\n              </div>\r\n            )}\r\n            {/* <div className=\"PositionEditor-keep-leverage-settings\">\r\n              <Checkbox isChecked={keepLeverage} setIsChecked={setKeepLeverage}>\r\n                <span className=\"muted font-sm\">Keep leverage at {formatAmount(position.leverage, 4, 2)}x</span>\r\n              </Checkbox>\r\n            </div> */}\r\n            {/* {orderOption === MARKET && (\r\n              <div className=\"PositionEditor-allow-higher-slippage\">\r\n                <Checkbox isChecked={isHigherSlippageAllowed} setIsChecked={setIsHigherSlippageAllowed}>\r\n                  <span className=\"muted font-sm\">Allow up to 1% slippage</span>\r\n                </Checkbox>\r\n              </div>\r\n            )} */}\r\n            {orderOption === MARKET && (\r\n              <div>\r\n                <ExchangeInfoRow label=\"Allowed Slippage\" className=\"Slippage-row\">\r\n                  <Tooltip\r\n                    handle={`${formatAmount(allowedSlippage, 2, 2)}%`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          You can change this in the settings menu on the top right of the page.\r\n                          <br />\r\n                          <br />\r\n                          Note that a low allowed slippage, e.g. less than 0.5%, may result in failed orders if prices\r\n                          are volatile.\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </ExchangeInfoRow>\r\n              </div>\r\n            )}\r\n            {orderOption === STOP && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Trigger Price</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {!triggerPriceUsd && \"-\"}\r\n                  {triggerPriceUsd && `${triggerPricePrefix} ${formatAmount(triggerPriceUsd, USD_DECIMALS, 2, true)}`}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Entry Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Liq. Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {isClosing && orderOption !== STOP && \"-\"}\r\n                {(!isClosing || orderOption === STOP) && (\r\n                  <div>\r\n                    {(!nextLiquidationPrice || nextLiquidationPrice.eq(liquidationPrice)) && (\r\n                      <div>{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}</div>\r\n                    )}\r\n                    {nextLiquidationPrice && !nextLiquidationPrice.eq(liquidationPrice) && (\r\n                      <div>\r\n                        <div className=\"inline-block muted\">\r\n                          ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                          <BsArrowRight className=\"transition-arrow\" />\r\n                        </div>\r\n                        ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Size</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {position && position.size && fromAmount && (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.size, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(position.size.sub(fromAmount), USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                )}\r\n                {position && position.size && !fromAmount && (\r\n                  <div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Collateral ({collateralToken.symbol})</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {nextCollateral && !nextCollateral.eq(position.collateral) ? (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                ) : (\r\n                  `$${formatAmount(position.collateral, USD_DECIMALS, 4, true)}`\r\n                )}\r\n              </div>\r\n            </div>\r\n            {!keepLeverage && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Leverage</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {isClosing && \"-\"}\r\n                  {!isClosing && (\r\n                    <div>\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>PnL</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {deltaStr} ({deltaPercentageStr})\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Fees</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  position=\"right-top\"\r\n                  className=\"PositionSeller-fees-tooltip\"\r\n                  handle={\r\n                    <div>\r\n                      {totalFees ? `$${formatAmount(totalFees.add(executionFeeUsd), USD_DECIMALS, 2, true)}` : \"-\"}\r\n                    </div>\r\n                  }\r\n                  renderContent={() => (\r\n                    <div>\r\n                      {fundingFee && (\r\n                        <StatsTooltipRow label=\"Borrow fee\" value={formatAmount(fundingFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {positionFee && (\r\n                        <StatsTooltipRow label=\"Closing fee\" value={formatAmount(positionFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {swapFee && (\r\n                        <StatsTooltipRow\r\n                          label=\"Swap fee\"\r\n                          showDollar={false}\r\n                          value={`${formatAmount(swapFeeToken, collateralToken.decimals, 5)}${collateralToken.symbol}\r\n                          ($${formatAmount(swapFee, USD_DECIMALS, 2, true)})`}\r\n                        />\r\n                      )}\r\n\r\n                      <StatsTooltipRow\r\n                        label=\"Execution fee\"\r\n                        showDollar={false}\r\n                        value={`${formatAmount(executionFee, 18, 5, true)}${nativeTokenSymbol}($${formatAmount(\r\n                          executionFeeUsd,\r\n                          USD_DECIMALS,\r\n                          2\r\n                        )})`}\r\n                      />\r\n\r\n                      <br />\r\n\r\n                      <div className=\"PositionSeller-fee-item\">\r\n                        <a href=\"https://gmxio.gitbook.io/gmx/trading#fees\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          More Info\r\n                        </a>{\" \"}\r\n                        about fees.\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row PositionSeller-receive-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Receive</Trans>\r\n              </div>\r\n\r\n              {!isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right PositionSelector-selected-receive-token\">\r\n                  {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;{receiveToken.symbol} ($\r\n                  {formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                </div>\r\n              )}\r\n\r\n              {isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right\">\r\n                  <TokenSelector\r\n                    // Scroll lock lead to side effects\r\n                    // if it applied on modal inside another modal\r\n                    disableBodyScrollLock={true}\r\n                    className={cx(\"PositionSeller-token-selector\", {\r\n                      warning: isNotEnoughReceiveTokenLiquidity || isCollateralPoolCapacityExceeded,\r\n                    })}\r\n                    label={\"Receive\"}\r\n                    showBalances={false}\r\n                    chainId={chainId}\r\n                    tokenAddress={receiveToken.address}\r\n                    onSelectToken={(token) => {\r\n                      setSwapToToken(token);\r\n                      setSavedRecieveTokenAddress(token.address);\r\n                    }}\r\n                    tokens={toTokens}\r\n                    getTokenState={(tokenOptionInfo) => {\r\n                      if (!shouldSwap(collateralToken, tokenOptionInfo)) {\r\n                        return;\r\n                      }\r\n\r\n                      const convertedTokenAmount = getTokenAmount(\r\n                        receiveAmount,\r\n                        tokenOptionInfo.address,\r\n                        false,\r\n                        infoTokens\r\n                      );\r\n\r\n                      const isNotEnoughLiquidity =\r\n                        tokenOptionInfo.availableAmount.lt(convertedTokenAmount) ||\r\n                        tokenOptionInfo.bufferAmount.gt(tokenOptionInfo.poolAmount.sub(convertedTokenAmount));\r\n\r\n                      if (isNotEnoughLiquidity) {\r\n                        const { maxIn, maxOut, maxInUsd, maxOutUsd } = getSwapLimits(\r\n                          infoTokens,\r\n                          collateralToken.address,\r\n                          tokenOptionInfo.address\r\n                        );\r\n\r\n                        const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n\r\n                        return {\r\n                          disabled: true,\r\n                          message: (\r\n                            <div>\r\n                              Insufficient Available Liquidity to swap to {tokenOptionInfo.symbol}:\r\n                              <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${collateralInfo.symbol} in`}\r\n                                value={[\r\n                                  `${formatAmount(maxIn, collateralInfo.decimals, 0, true)} ${collateralInfo.symbol}`,\r\n                                  `($${formatAmount(maxInUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${tokenOptionInfo.symbol} out`}\r\n                                value={[\r\n                                  `${formatAmount(maxOut, tokenOptionInfo.decimals, 0, true)} ${\r\n                                    tokenOptionInfo.symbol\r\n                                  }`,\r\n                                  `($${formatAmount(maxOutUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                            </div>\r\n                          ),\r\n                        };\r\n                      }\r\n                    }}\r\n                    infoTokens={infoTokens}\r\n                    showTokenImgInDropdown={true}\r\n                    selectedTokenLabel={\r\n                      <span className=\"PositionSelector-selected-receive-token\">\r\n                        {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;\r\n                        {receiveToken.symbol} (${formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                      </span>\r\n                    }\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-button-container\">\r\n            <button className={\"App-cta Exchange-swap-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")} onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n              {getPrimaryText()}\r\n            </button>\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport useSWR from \"swr\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { ethers } from \"ethers\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  BASIS_POINTS_DIVISOR,\r\n  DEPOSIT_FEE,\r\n  DUST_BNB,\r\n  helperToast,\r\n  formatAmount,\r\n  bigNumberify,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  shouldRaiseGasError,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  approveTokens,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n  MAX_ALLOWED_LEVERAGE,\r\n} from \"../../lib/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport Modal from \"../Modal/Modal\";\r\n\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\n\r\nimport { getConstant } from \"../../config/chains\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport depositImg from '../../img/ddl/icon_dollar.svg'\r\nimport depositActiveImg from '../../img/ddl/icon_dollar_active.svg'\r\nimport withdrawImg from '../../img/ddl/icon_withdraw.svg'\r\nimport withdrawActiveImg from '../../img/ddl/icon_withdraw_active.svg'\r\nimport { DDL_AccountManager } from \"../../../../components/utils/contracts\";\r\nimport { DDL_AccountManager_abi } from './../../../../components/utils/contracts';\r\n\r\nconst DEPOSIT = t`Deposit`;\r\nconst WITHDRAW = t`Withdraw`;\r\nconst EDIT_OPTIONS = [DEPOSIT, WITHDRAW];\r\nconst EDIT_ICONS = {\r\n  [DEPOSIT]: depositImg,\r\n  [WITHDRAW]: withdrawImg,\r\n  [DEPOSIT + '_active']: depositActiveImg,\r\n  [WITHDRAW + '_active']: withdrawActiveImg,\r\n\r\n}\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport default function PositionEditor(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    collateralTokenAddress,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    getUsd,\r\n    getLeverage,\r\n    savedIsPnlInLeverage,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    chainId,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  } = props;\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [option, setOption] = useState(DEPOSIT);\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isSwapping, setIsSwapping] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  const { data: tokenAllowance } = useSWR(\r\n    [active, chainId, collateralTokenAddress, \"allowance\", account, routerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  // const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n  //   fetcher: fetcher(library, PositionRouter),\r\n  // });\r\n\r\n  const isDeposit = option === DEPOSIT;\r\n  const isWithdrawal = option === WITHDRAW;\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved;\r\n\r\n  let collateralToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n  let needApproval;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let nextLeverageExcludingPnl;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let nextCollateral;\r\n\r\n  let title;\r\n  let collateralDelta;\r\n  if (position) {\r\n    title = `Edit ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (isDeposit) {\r\n      fromAmount = parseValue(fromValue, collateralToken.decimals);\r\n      maxAmount = collateralToken ? collateralToken.balance : bigNumberify(0);\r\n      maxAmountFormatted = formatAmount(maxAmount, collateralToken.decimals, 4, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, collateralToken.decimals, 8);\r\n      if (fromAmount) {\r\n        convertedAmount = getUsd(fromAmount, position.collateralToken.address, false, infoTokens);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, USD_DECIMALS, 2);\r\n      }\r\n    } else {\r\n      fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n      maxAmount = position.collateral;\r\n      maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n      if (fromAmount) {\r\n        convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n      }\r\n    }\r\n    needApproval = isDeposit && tokenAllowance && fromAmount && fromAmount.gt(tokenAllowance);\r\n\r\n    if (fromAmount) {\r\n      collateralDelta = isDeposit ? convertedAmount : fromAmount;\r\n      if (position.isLong) {\r\n        collateralDelta = collateralDelta.mul(BASIS_POINTS_DIVISOR - DEPOSIT_FEE).div(BASIS_POINTS_DIVISOR);\r\n      }\r\n      nextLeverage = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: savedIsPnlInLeverage,\r\n      });\r\n      nextLeverageExcludingPnl = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: false,\r\n      });\r\n\r\n      nextLiquidationPrice = getLiquidationPrice({\r\n        isLong: position.isLong,\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        averagePrice: position.averagePrice,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n      });\r\n\r\n      nextCollateral = isDeposit ? position.collateral.add(collateralDelta) : position.collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (isDeposit) return [t`Deposit disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Withdraw disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n\r\n    if (!isDeposit && fromAmount) {\r\n      if (fromAmount.gte(position.collateral)) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n      if (position.collateral.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n    }\r\n\r\n    if (!isDeposit && fromAmount && nextLiquidationPrice) {\r\n      if (position.isLong && position.markPrice.lt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n      if (!position.isLong && position.markPrice.gt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.gt(MAX_ALLOWED_LEVERAGE)) {\r\n      return t`Max leverage: ${(MAX_ALLOWED_LEVERAGE / BASIS_POINTS_DIVISOR).toFixed(1)}x`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSwapping) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isSwapping) {\r\n      if (isDeposit) {\r\n        return t`Depositing...`;\r\n      }\r\n      return t`Withdrawing...`;\r\n    }\r\n\r\n    if (isApproving) {\r\n      return t`Approving ${position.collateralToken.symbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${position.collateralToken.symbol}`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      return t`Deposit`;\r\n    }\r\n\r\n    return t`Withdraw`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const depositCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const path = [tokenAddress0];\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    const priceBasisPoints = position.isLong ? 11000 : 9000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const referralCode = ethers.constants.HashZero;\r\n    let params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _amountIn\r\n      0, // _minOut\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      priceLimit, // _acceptablePrice\r\n      minExecutionFee, // _executionFee\r\n      referralCode, // _referralCode\r\n      // AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    let method = \"createIncreasePosition\";\r\n    let value = minExecutionFee;\r\n    if (collateralTokenAddress === AddressZero) {\r\n      method = \"createIncreasePositionETH\";\r\n      value = fromAmount.add(minExecutionFee);\r\n      params = [\r\n        path, // _path\r\n        indexTokenAddress, // _indexToken\r\n        fromAmount, // _amountIn (added)\r\n        0, // _minOut\r\n        0, // _sizeDelta\r\n        position.isLong, // _isLong\r\n        priceLimit, // _acceptablePrice\r\n        minExecutionFee, // _executionFee\r\n        referralCode, // _referralCode\r\n        // AddressZero, // _callbackTarget\r\n      ];\r\n    }\r\n\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, collateralTokenAddress), fromAmount)) {\r\n      setIsSwapping(false);\r\n      helperToast.error(`Leave at least ${formatAmount(DUST_BNB, 18, 3)} ETH for gas`);\r\n      return;\r\n    }\r\n\r\n    // const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: t`Deposit submitted.`,\r\n      successMsg: t`Requested deposit of ${formatAmount(fromAmount, position.collateralToken.decimals, 4)} ${\r\n        position.collateralToken.symbol\r\n      } into ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Deposit failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const withdrawCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n    const priceBasisPoints = position.isLong ? 9000 : 11000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const withdrawETH = collateralTokenAddress === AddressZero || collateralTokenAddress === nativeTokenAddress;\r\n    const params = [\r\n      [tokenAddress0], // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _collateralDelta\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      // account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n      // AddressZero, // _callbackTarget\r\n    ];\r\n\r\n    const method = \"createDecreasePosition\";\r\n\r\n    // const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    const contract = new ethers.Contract(DDL_AccountManager.address, DDL_AccountManager_abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Withdrawal submitted.`,\r\n      successMsg: t`Requested withdrawal of ${formatAmount(fromAmount, USD_DECIMALS, 2)} USD from ${\r\n        position.indexToken.symbol\r\n      } ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Withdrawal failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (needApproval) {\r\n      approveTokens({\r\n        setIsApproving,\r\n        library,\r\n        tokenAddress: collateralTokenAddress,\r\n        spender: routerAddress,\r\n        chainId: chainId,\r\n        infoTokens,\r\n        getTokenInfo,\r\n        pendingTxns,\r\n        setPendingTxns,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: isDeposit ? t`Enable deposit sent.` : t`Enable withdraw sent.`,\r\n        failMsg: isDeposit ? t`Enable deposit failed.` : t`Enable withdraw failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      depositCollateral();\r\n      return;\r\n    }\r\n\r\n    withdrawCollateral();\r\n  };\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n\r\n\r\n  const [hasInputFocus, setHasInputFocus] = useState(false);\r\n  const [hasInputError, setHasInputError] = useState(false);\r\n  const checkInputError = (inputVal) => {\r\n    if (!isPrimaryEnabled() && inputVal !== '') {\r\n      setHasInputError(true);\r\n    } else {\r\n      setHasInputError(false);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkInputError(fromValue);\r\n  }, [fromValue])\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title} isNifty={true}>\r\n          <div>\r\n            <Tab options={EDIT_OPTIONS} option={option} setOption={setOption} onChange={resetForm}\r\n              icons={EDIT_ICONS} />\r\n            {(isDeposit || isWithdrawal) && (\r\n              <div>\r\n                <div className={\"Exchange-swap-section\"\r\n                  + (hasInputError ? \" error\" : \"\") + (hasInputFocus ? \" hlight\" : \"\")}>\r\n                  <div className=\"Exchange-swap-section-top\">\r\n                    <div className=\"muted\">\r\n                      {convertedAmountFormatted && (\r\n                        <div className=\"Exchange-swap-usd\">\r\n                          {isDeposit ? t`Deposit` : t`Withdraw`}: {convertedAmountFormatted}{\" \"}\r\n                          {isDeposit ? \"USD\" : position.collateralToken.symbol}\r\n                        </div>\r\n                      )}\r\n                      {!convertedAmountFormatted && `${isDeposit ? t`Deposit` : t`Withdraw`}`}\r\n                    </div>\r\n                    {maxAmount && (\r\n                      <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                        Max: {maxAmountFormatted}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"Exchange-swap-section-bottom\">\r\n                    <div className=\"Exchange-swap-input-container\">\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"0\"\r\n                        placeholder=\"0.0\"\r\n                        className=\"Exchange-swap-input\"\r\n                        value={fromValue}\r\n                        onChange={(e) => setFromValue(e.target.value)}\r\n                        onFocus={(e) => {\r\n                          setHasInputFocus(true);\r\n                        }}\r\n                        onBlur={(e) => {\r\n                          setHasInputFocus(false);\r\n                        }}\r\n                      />\r\n                      {fromValue !== maxAmountFormattedFree && (\r\n                        <div\r\n                          className=\"Exchange-swap-max\"\r\n                          onClick={() => {\r\n                            setFromValue(maxAmountFormattedFree);\r\n                          }}\r\n                        >\r\n                          MAX\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"PositionEditor-token-symbol\">\r\n                      {isDeposit ? position.collateralToken.symbol : \"USD\"}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"PositionEditor-info-box\">\r\n                  {minExecutionFeeErrorMessage && (\r\n                    <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n                  )}\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Size</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">{formatAmount(position.size, USD_DECIMALS, 2, true)} USD</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Collateral</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextCollateral && <div>${formatAmount(position.collateral, USD_DECIMALS, 2, true)}</div>}\r\n                      {nextCollateral && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Leverage</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2, true)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2, true)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2, true)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Mark Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Liq. Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLiquidationPrice && (\r\n                        <div>\r\n                          {!fromAmount && `$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}\r\n                          {fromAmount && \"-\"}\r\n                        </div>\r\n                      )}\r\n                      {nextLiquidationPrice && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Execution Fee</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      <Tooltip\r\n                        handle={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol}`}\r\n                        position=\"right-top\"\r\n                        renderContent={() => {\r\n                          return (\r\n                            <>\r\n                              <StatsTooltipRow\r\n                                label=\"Network fee\"\r\n                                showDollar={false}\r\n                                value={`${formatAmountFree(\r\n                                  minExecutionFee,\r\n                                  18,\r\n                                  5\r\n                                )} ${nativeTokenSymbol} ($${formatAmount(minExecutionFeeUSD, USD_DECIMALS, 2)})`}\r\n                              />\r\n                              <br />\r\n                              This is the network cost required to execute the {isDeposit\r\n                                ? \"deposit\"\r\n                                : \"withdrawal\"}.{\" \"}\r\n                              <a\r\n                                href=\"https://gmxio.gitbook.io/gmx/trading#execution-fee\"\r\n                                target=\"_blank\"\r\n                                rel=\"noopener noreferrer\"\r\n                              >\r\n                                More Info\r\n                              </a>\r\n                            </>\r\n                          );\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"Exchange-swap-button-container\">\r\n                  <button\r\n                    className={\"App-cta Exchange-swap-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")}\r\n                    onClick={onClickPrimary}\r\n                    disabled={!isPrimaryEnabled()}\r\n                  >\r\n                    {getPrimaryText()}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import \"./SpinningLoader.css\";\r\n\r\nimport { ImSpinner2 } from \"react-icons/im\";\r\n\r\nfunction SpinningLoader({ size = \"1.25rem\" }) {\r\n  return <ImSpinner2 className=\"spin spinning-loader\" style={{ fontSize: size }} />;\r\n}\r\n\r\nexport default SpinningLoader;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { Trans } from \"@lingui/macro\";\r\nimport { toJpeg } from \"html-to-image\";\r\nimport cx from \"classnames\";\r\nimport { BiCopy } from \"react-icons/bi\";\r\nimport { RiFileDownloadLine } from \"react-icons/ri\";\r\nimport { FiTwitter } from \"react-icons/fi\";\r\nimport { useCopyToClipboard } from \"react-use\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport gmxLogo from \"../../img/gmx-logo-with-name.svg\";\r\nimport \"./PositionShare.css\";\r\nimport { QRCodeSVG } from \"qrcode.react\";\r\nimport {\r\n  formatAmount,\r\n  getHomeUrl,\r\n  getRootShareApiUrl,\r\n  getTwitterIntentURL,\r\n  helperToast,\r\n  USD_DECIMALS,\r\n} from \"../../lib/legacy\";\r\nimport { useAffiliateCodes } from \"../../domain/referrals\";\r\nimport SpinningLoader from \"../Common/SpinningLoader\";\r\nimport useLoadImage from \"../../lib/useLoadImage\";\r\nimport shareBgImg from \"../../img/position-share-bg.png\";\r\n\r\nconst ROOT_SHARE_URL = getRootShareApiUrl();\r\nconst UPLOAD_URL = ROOT_SHARE_URL + \"/api/upload\";\r\nconst UPLOAD_SHARE = ROOT_SHARE_URL + \"/api/s\";\r\nconst config = { quality: 0.95, canvasWidth: 1036, canvasHeight: 584 };\r\n\r\nfunction getShareURL(imageInfo, ref) {\r\n  if (!imageInfo) return;\r\n  let url = `${UPLOAD_SHARE}?id=${imageInfo.id}`;\r\n  if (ref.success) {\r\n    url = url + `&ref=${ref.code}`;\r\n  }\r\n  return url;\r\n}\r\n\r\nfunction PositionShare({ setIsPositionShareModalOpen, isPositionShareModalOpen, positionToShare, account, chainId }) {\r\n  const userAffiliateCode = useAffiliateCodes(chainId, account);\r\n  const [uploadedImageInfo, setUploadedImageInfo] = useState();\r\n  const [uploadedImageError, setUploadedImageError] = useState();\r\n  const [, copyToClipboard] = useCopyToClipboard();\r\n  const sharePositionBgImg = useLoadImage(shareBgImg);\r\n  const positionRef = useRef();\r\n  const tweetLink = getTwitterIntentURL(\r\n    `Latest $${positionToShare?.indexToken?.symbol} trade on @GMX_IO`,\r\n    getShareURL(uploadedImageInfo, userAffiliateCode)\r\n  );\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      const element = positionRef.current;\r\n      if (element && userAffiliateCode.success && sharePositionBgImg && positionToShare) {\r\n        const image = await toJpeg(element, config);\r\n        try {\r\n          const imageInfo = await fetch(UPLOAD_URL, { method: \"POST\", body: image }).then((res) => res.json());\r\n          setUploadedImageInfo(imageInfo);\r\n        } catch {\r\n          setUploadedImageInfo(null);\r\n          setUploadedImageError(\"Image generation error, please refresh and try again.\");\r\n        }\r\n      }\r\n    })();\r\n  }, [userAffiliateCode, sharePositionBgImg, positionToShare]);\r\n\r\n  async function handleDownload() {\r\n    const { indexToken, isLong } = positionToShare;\r\n    const element = positionRef.current;\r\n    if (!element) return;\r\n    const dataUrl = await toJpeg(element, config);\r\n    const link = document.createElement(\"a\");\r\n    link.download = `${indexToken.symbol}-${isLong ? \"long\" : \"short\"}.jpeg`;\r\n    link.href = dataUrl;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n  }\r\n\r\n  function handleCopy() {\r\n    if (!uploadedImageInfo) return;\r\n    const url = getShareURL(uploadedImageInfo, userAffiliateCode);\r\n    copyToClipboard(url);\r\n    helperToast.success(\"Link copied to clipboard.\");\r\n  }\r\n  return (\r\n    <Modal\r\n      className=\"position-share-modal\"\r\n      isVisible={isPositionShareModalOpen}\r\n      setIsVisible={setIsPositionShareModalOpen}\r\n      label=\"Share Position\"\r\n    >\r\n      <PositionShareCard\r\n        userAffiliateCode={userAffiliateCode}\r\n        positionRef={positionRef}\r\n        position={positionToShare}\r\n        chainId={chainId}\r\n        account={account}\r\n        uploadedImageInfo={uploadedImageInfo}\r\n        uploadedImageError={uploadedImageError}\r\n        sharePositionBgImg={sharePositionBgImg}\r\n      />\r\n      {uploadedImageError && <span className=\"error\">{uploadedImageError}</span>}\r\n\r\n      <div className=\"actions\">\r\n        <button disabled={!uploadedImageInfo} className=\"mr-base App-button-option\" onClick={handleCopy}>\r\n          <BiCopy className=\"icon\" />\r\n          <Trans>Copy</Trans>\r\n        </button>\r\n        <button className=\"mr-base App-button-option\" onClick={handleDownload}>\r\n          <RiFileDownloadLine className=\"icon\" />\r\n          <Trans>Download</Trans>\r\n        </button>\r\n        <div className={cx(\"tweet-link-container\", { disabled: !uploadedImageInfo })}>\r\n          <a\r\n            target=\"_blank\"\r\n            className={cx(\"tweet-link App-button-option\", { disabled: !uploadedImageInfo })}\r\n            rel=\"noreferrer\"\r\n            href={tweetLink}\r\n          >\r\n            <FiTwitter className=\"icon\" />\r\n            <Trans>Tweet</Trans>\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nfunction PositionShareCard({\r\n  positionRef,\r\n  position,\r\n  userAffiliateCode,\r\n  uploadedImageInfo,\r\n  uploadedImageError,\r\n  sharePositionBgImg,\r\n}) {\r\n  const { code, success } = userAffiliateCode;\r\n  const { deltaAfterFeesPercentageStr, isLong, leverage, indexToken, averagePrice, markPrice } = position;\r\n  const homeURL = getHomeUrl();\r\n  return (\r\n    <div className=\"relative\">\r\n      <div ref={positionRef} className=\"position-share\" style={{ backgroundImage: `url(${sharePositionBgImg})` }}>\r\n        <img className=\"logo\" src={gmxLogo} alt=\"GMX Logo\" />\r\n        <ul className=\"info\">\r\n          <li className=\"side\">{isLong ? \"LONG\" : \"SHORT\"}</li>\r\n          <li>{formatAmount(leverage, 4, 2, true)}x&nbsp;</li>\r\n          <li>{indexToken.symbol} USD</li>\r\n        </ul>\r\n        <h3 className=\"pnl\">{deltaAfterFeesPercentageStr}</h3>\r\n        <div className=\"prices\">\r\n          <div>\r\n            <p>Entry Price</p>\r\n            <p className=\"price\">${formatAmount(averagePrice, USD_DECIMALS, 2, true)}</p>\r\n          </div>\r\n          <div>\r\n            <p>Index Price</p>\r\n            <p className=\"price\">${formatAmount(markPrice, USD_DECIMALS, 2, true)}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"referral-code\">\r\n          <div>\r\n            <QRCodeSVG size={32} value={success ? `${homeURL}/#/?ref=${code}` : `${homeURL}`} />\r\n          </div>\r\n          <div className=\"referral-code-info\">\r\n            {success ? (\r\n              <>\r\n                <p className=\"label\">Referral Code:</p>\r\n                <p className=\"code\">{code}</p>\r\n              </>\r\n            ) : (\r\n              <p className=\"code\">https://gmx.io</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {!uploadedImageInfo && !uploadedImageError && (\r\n        <div className=\"image-overlay-wrapper\">\r\n          <div className=\"image-overlay\">\r\n            <SpinningLoader />\r\n            <p className=\"loading-text\">Generating shareable image...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PositionShare;\r\n","import { useEffect, useState } from \"react\";\r\n\r\nexport default function useLoadImage(src) {\r\n  const [sourceLoaded, setSourceLoaded] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const img = new Image();\r\n    img.src = src;\r\n    img.onload = () => setSourceLoaded(src);\r\n  }, [src]);\r\n\r\n  return sourceLoaded;\r\n}\r\n","import { Menu } from \"@headlessui/react\";\r\nimport { Trans } from \"@lingui/macro\";\r\nimport { HiDotsVertical } from \"react-icons/hi\";\r\nimport { AiOutlineEdit } from \"react-icons/ai\";\r\nimport { BiSelectMultiple } from \"react-icons/bi\";\r\nimport { RiShareBoxFill } from \"react-icons/ri\";\r\nimport \"./PositionDropdown.css\";\r\n\r\nfunction PositionDropdown({ handleEditCollateral, handleShare, handleMarketSelect }) {\r\n  return (\r\n    <Menu>\r\n      <Menu.Button as=\"div\">\r\n        <button className=\"PositionDropdown-dots-icon\">\r\n          <HiDotsVertical fontSize={20} fontWeight={700} />\r\n        </button>\r\n      </Menu.Button>\r\n      <div className=\"PositionDropdown-extra-options\">\r\n        <Menu.Items as=\"div\" className=\"menu-items\">\r\n          <Menu.Item>\r\n            <div className=\"menu-item\" onClick={handleEditCollateral}>\r\n              <AiOutlineEdit fontSize={16} />\r\n              <p>\r\n                <Trans>Edit Collateral</Trans>\r\n              </p>\r\n            </div>\r\n          </Menu.Item>\r\n          <Menu.Item>\r\n            <div className=\"menu-item\" onClick={handleMarketSelect}>\r\n              <BiSelectMultiple fontSize={16} />\r\n              <p>\r\n                <Trans>Select Market</Trans>\r\n              </p>\r\n            </div>\r\n          </Menu.Item>\r\n          <Menu.Item>\r\n            <div className=\"menu-item\" onClick={handleShare}>\r\n              <RiShareBoxFill fontSize={16} />\r\n              <p>\r\n                <Trans>Share Position</Trans>\r\n              </p>\r\n            </div>\r\n          </Menu.Item>\r\n        </Menu.Items>\r\n      </div>\r\n    </Menu>\r\n  );\r\n}\r\n\r\nexport default PositionDropdown;\r\n","import React from 'react';\r\nimport Tooltip from './../Tooltip/Tooltip';\r\n\r\nconst CollateralLocked = () => {\r\n\treturn (\r\n\t\t<Tooltip\r\n\t\t\tclassName=\"collateral-locked-icon nowrap\"\r\n\t\t\tposition=\"right-bottom\"\r\n\t\t\tenabled={true}\r\n\t\t\thandle=\"\"\r\n\t\t\trenderContent={() => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span className='spacing'>Y</span>our position is locked as collateral\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t}} />\r\n\t);\r\n};\r\n\r\nexport default CollateralLocked;","import React from 'react';\r\nimport Tooltip from './../Tooltip/Tooltip';\r\nimport { formatAmount } from '../../lib/legacy';\r\nimport { ImSpinner2 } from 'react-icons/im';\r\nimport { t } from '@lingui/macro';\r\nimport { USD_DECIMALS, INCREASE } from './../../lib/legacy';\r\nimport StatsTooltipRow from '../StatsTooltip/StatsTooltipRow';\r\nimport { floor } from './../../../../components/utils/math';\r\nimport CollateralLocked from './CollateralLocked';\r\nimport { DDL_AccountManagerToken, getDgContract, WETH_address } from '../../../../components/utils/contracts';\r\nimport { DDL_GMX } from './../../../../components/utils/contracts';\r\nimport { useState, useEffect } from 'react';\r\nimport { Trans } from '@lingui/macro';\r\nimport { BigNumber } from 'ethers';\r\nimport { ADDRESS_ZERO } from '@uniswap/v3-sdk';\r\n\r\nconst PositionsItem = (props) => {\r\n\tconst {\r\n\t\tposition,\r\n\t\tonPositionClick,\r\n\t\tsetListSection,\r\n\t\tpositionOrders,\r\n\t\tshowPnlAfterFees,\r\n\t\thasPositionProfit,\r\n\t\tpositionDelta,\r\n\t\thasOrderError,\r\n\t\tliquidationPrice,\r\n\t\tcx,\r\n\t\tborrowFeeUSD,\r\n\t\teditPosition,\r\n\t\tsellPosition,\r\n\t\tdgAddress,\r\n\t\tisLarge,\r\n\t} = props;\r\n\r\n\tconst [isLocked, setIsLocked] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tconst DG = getDgContract(dgAddress);\r\n\t\tif (!DG) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tDG.keyByIndexToken((position.indexToken.address === ADDRESS_ZERO ? WETH_address : position.indexToken.address), position.isLong)\r\n\t\t\t.then(id => {\r\n\t\t\t\tDDL_AccountManagerToken.ownerOf(id)\r\n\t\t\t\t\t.then(owner => {\r\n\t\t\t\t\t\tsetIsLocked(owner === DDL_GMX.address);\r\n\t\t\t\t\t});\r\n\t\t\t})\r\n\t}, [dgAddress, position])\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{isLarge ?\r\n\t\t\t\t<tr>\r\n\t\t\t\t\t<td className=\"clickable\" onClick={() => onPositionClick(position)}>\r\n\t\t\t\t\t\t<div className=\"Exchange-list-title\">\r\n\t\t\t\t\t\t\t{position.indexToken.symbol}\r\n\t\t\t\t\t\t\t{position.hasPendingChanges && <ImSpinner2 className=\"spin position-loading-icon\" />}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"Exchange-list-info-label\">\r\n\t\t\t\t\t\t\t{position.leverage && (\r\n\t\t\t\t\t\t\t\t<span className=\"muted\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<span className={cx({ positive: position.isLong, negative: !position.isLong })}>\r\n\t\t\t\t\t\t\t\t{position.isLong ? \"Long\" : \"Short\"}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td style={{width: 150, display: 'block'}}>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{!position.netValue && \"Opening...\"}\r\n\t\t\t\t\t\t\t{position.netValue && (\r\n\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\thandle={`$${formatAmount(position.netValue, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\t\thandleClassName=\"plain\"\r\n\t\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\tNet Value:{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{showPnlAfterFees\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? t`Initial Collateral - Fees + PnL`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: t`Initial Collateral - Borrow Fee + PnL`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={t`Initial Collateralt`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow label={`PnL`} value={position.deltaBeforeFeesStr} showDollar={false} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={t`Borrow Fee`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={`Open + Close fee`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.positionFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={`PnL After Fees`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={`${position.deltaAfterFeesStr} (${position.deltaAfterFeesPercentageStr})`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowDollar={false}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{position.deltaStr && (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName={cx(\"Exchange-list-info-label\", {\r\n\t\t\t\t\t\t\t\t\tpositive: hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\t\tnegative: !hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\t\tmuted: positionDelta.eq(0),\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{position.deltaStr} ({position.deltaPercentageStr})\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t\t{positionOrders.length > 0 && (\r\n\t\t\t\t\t\t\t<div onClick={() => setListSection && setListSection(\"Orders\")}>\r\n\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\thandle={`Orders (${positionOrders.length})`}\r\n\t\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\t\thandleClassName={cx(\r\n\t\t\t\t\t\t\t\t\t\t[\"Exchange-list-info-label\", \"Exchange-position-list-orders\", \"plain\", \"clickable\"],\r\n\t\t\t\t\t\t\t\t\t\t{ muted: !hasOrderError, negative: hasOrderError }\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<strong>Active Orders</strong>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{positionOrders.map((order) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`${order.isLong}-${order.type}-${order.index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"Position-list-order\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.triggerAboveThreshold ? \">\" : \"<\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatAmount(order.triggerPrice, 30, 2, true)}:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.type === INCREASE ? \" +\" : \" -\"}${formatAmount(order.sizeDelta, 30, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.error && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t, <span className=\"negative\">{order.error}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td>\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\thandle={`$${formatAmount(position.collateralAfterFee, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\thandleClassName={cx(\"plain\", { negative: position.hasLowCollateral })}\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t{position.hasLowCollateral && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Trans>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tWARNING: This position has a low amount of collateral after deducting borrowing fees,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdeposit more collateral to reduce the position's liquidation risk.\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Trans>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={t`Initial Collateral`}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\tlabel={t`Borrow Fee`}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow label={t`Borrow Fee / Day`} value={borrowFeeUSD} />\r\n\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t<Trans>Use the \"Edit\" button to deposit or withdraw collateral.</Trans>\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td onClick={() => {\r\n\t\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tstyle={{width: 75, display: 'block'}}\r\n\t\t\t\t\t\t\thandle={`$${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\thandleClassName=\"plain\"\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tClick on a row to select the position's market, then use the swap box to increase your\r\n\t\t\t\t\t\t\t\t\t\tposition size if needed.\r\n\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\tUse the \"Close\" button to reduce your position size, or to set stop-loss / take-profit orders.\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td className=\"\" onClick={() => {\r\n\t\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t\t${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td className=\"\" onClick={() => {\r\n\t\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t\t${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t</td>\r\n\r\n\t\t\t\t\t<td className=\"td-btn pos-relative\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName={\"btn-tooltip nowrap\" + (isLocked ? \"\" : \" hidden\")}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\thandle=\"\"\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tRepay your debt to manage<br className='br-mobile' /> the position\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\t\tonClick={() => editPosition(position)}\r\n\t\t\t\t\t\t\tdisabled={position.size.eq(0) || isLocked}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tEdit\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td className=\"td-btn pos-relative\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName={\"btn-tooltip nowrap\" + (isLocked ? \"\" : \" hidden\")}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\thandle=\"\"\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tRepay your debt to manage<br className='br-mobile' /> the position\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\t\tonClick={() => sellPosition(position)}\r\n\t\t\t\t\t\t\tdisabled={position.size.eq(0) || isLocked}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tClose\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t{/* <PositionDropdown\r\n\t\t\t\t\t\t\thandleEditCollateral={() => {\r\n\t\t\t\t\t\t\t\teditPosition(position);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\thandleShare={() => {\r\n\t\t\t\t\t\t\t\tsetPositionToShare(position);\r\n\t\t\t\t\t\t\t\tsetIsPositionShareModalOpen(true);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\thandleMarketSelect={() => {\r\n\t\t\t\t\t\t\t\tonPositionClick(position);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/> */}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td className=\"td-btn\">\r\n\t\t\t\t\t\t{isLocked &&\r\n\t\t\t\t\t\t\t<CollateralLocked />}\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t:\r\n\t\t\t<div className=\"App-card\">\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-content\">\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Position</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div className=\"Exchange-list-token\">{position.indexToken.symbol}</div>\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tclassName={cx(\"Exchange-list-side\", {\r\n\t\t\t\t\t\t\t\t\tpositive: position.isLong,\r\n\t\t\t\t\t\t\t\t\tnegative: !position.isLong,\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t><span className=\"Exchange-list-leverage\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n\t\t\t\t\t\t\t\t{position.isLong ? t`Long` : t`Short`}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Net Value</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\thandle={`$${formatAmount(position.netValue, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\t\tposition=\"right-bottom\"\r\n\t\t\t\t\t\t\t\thandleClassName=\"plain\"\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\tNet Value:{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{showPnlAfterFees\r\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Initial Collateral - Fees + PnL\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Initial Collateral - Borrow Fee + PnL\"}\r\n\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Initial Collateral\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow label=\"PnL\" value={position.deltaBeforeFeesStr} showDollar={false} />\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Borrow Fee\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Open + Close fee\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.positionFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"PnL After Fees\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={`${position.deltaAfterFeesStr} (${position.deltaAfterFeesPercentageStr})`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowDollar={false}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\tclassName=\"has-hint-tooltip nowrap\"\r\n\t\t\t\t\t\t\t\thandle=\"IM\"\r\n\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\tThe margin reserved for your <br />open positions and open orders\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\tclassName=\"has-hint-tooltip nowrap\"\r\n\t\t\t\t\t\t\t\thandle=\"MM\"\r\n\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\tThe margin required tomaintain your current <br />positions. Ifyour current margin balance falls <br />belowMin. Maintenance Margin, your margin <br />account will beliquidated torepay the debt\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\thandle={`$${formatAmount(position.collateralAfterFee, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\t\tposition=\"right-bottom\"\r\n\t\t\t\t\t\t\t\thandleClassName={cx(\"plain\", { negative: position.hasLowCollateral })}\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t{position.hasLowCollateral && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tWARNING: This position has a low amount of collateral after deducting borrowing\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfees, deposit more collateral to reduce the position's liquidation risk.\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Initial Collateral\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Borrow Fee\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow label={t`Borrow Fee / Day`} value={borrowFeeUSD} />\r\n\t\t\t\t\t\t\t\t\t\t\t<span>Use the \"Edit\" button to deposit or withdraw collateral.</span>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-content\">\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Mark Price</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Entry Price</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Liq. Price</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-options\">\r\n\t\t\t\t\t<div className=\"App-button-option pos-relative\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName={\"btn-tooltip nowrap\" + (isLocked ? \"\" : \" hidden\")}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\thandle=\"\"\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tRepay your debt to manage<br className='br-mobile' /> the position\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"App-button-option App-card-option\"\r\n\t\t\t\t\t\t\tdisabled={position.size.eq(0) || isLocked}\r\n\t\t\t\t\t\t\tonClick={() => editPosition(position)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Trans>Edit</Trans>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-button-option pos-relative\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName={\"btn-tooltip nowrap\" + (isLocked ? \"\" : \" hidden\")}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\thandle=\"\"\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tRepay your debt to manage<br className='br-mobile' /> the position\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"App-button-option App-card-option\"\r\n\t\t\t\t\t\t\tdisabled={position.size.eq(0) || isLocked}\r\n\t\t\t\t\t\t\tonClick={() => sellPosition(position)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tClose\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{isLocked &&\r\n\t\t\t\t\t\t<CollateralLocked />}\r\n\t\t\t\t</div>\r\n\t\t\t</div>}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default PositionsItem;","import React, { useState } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport PositionSeller from \"./PositionSeller\";\r\nimport PositionEditor from \"./PositionEditor\";\r\nimport OrdersToa from \"./OrdersToa\";\r\n\r\nimport { ImSpinner2 } from \"react-icons/im\";\r\n\r\nimport {\r\n  helperToast,\r\n  bigNumberify,\r\n  getLiquidationPrice,\r\n  getUsd,\r\n  getLeverage,\r\n  formatAmount,\r\n  getOrderError,\r\n  USD_DECIMALS,\r\n  FUNDING_RATE_PRECISION,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  INCREASE,\r\n  DECREASE,\r\n} from \"../../lib/legacy\";\r\nimport PositionShare from \"./PositionShare\";\r\nimport PositionDropdown from \"./PositionDropdown\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport CollateralLocked from './CollateralLocked';\r\nimport { getDgContract, DDL_GMX, DDL_AccountManagerToken } from './../../../../components/utils/contracts';\r\nimport PositionsItem from './PositionsItem';\r\n\r\nconst getOrdersForPosition = (account, position, orders, nativeTokenAddress) => {\r\n  if (!orders || orders.length === 0) {\r\n    return [];\r\n  }\r\n  /* eslint-disable array-callback-return */\r\n  return orders\r\n    .filter((order) => {\r\n      if (order.type === SWAP) {\r\n        return false;\r\n      }\r\n      const hasMatchingIndexToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      const hasMatchingCollateralToken =\r\n        order.collateralToken === nativeTokenAddress\r\n          ? position.collateralToken.isNative\r\n          : order.collateralToken === position.collateralToken.address;\r\n      if (order.isLong === position.isLong && hasMatchingIndexToken && hasMatchingCollateralToken) {\r\n        return true;\r\n      }\r\n    })\r\n    .map((order) => {\r\n      order.error = getOrderError(account, order, undefined, position);\r\n      if (order.type === DECREASE && order.sizeDelta.gt(position.size)) {\r\n        order.error = \"Order size is bigger than position, will only be executable if position increases\";\r\n      }\r\n      return order;\r\n    });\r\n};\r\n\r\nexport default function PositionsList(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positions,\r\n    positionsDataIsLoading,\r\n    positionsMap,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    setListSection,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    setIsWaitingForPluginApproval,\r\n    approveOrderBook,\r\n    isPluginApproving,\r\n    isWaitingForPluginApproval,\r\n    orderBookApproved,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    showPnlAfterFees,\r\n    setMarket,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    dgAddress,\r\n  } = props;\r\n  \r\n\r\n  const [positionToEditKey, setPositionToEditKey] = useState(undefined);\r\n  const [positionToSellKey, setPositionToSellKey] = useState(undefined);\r\n  const [positionToShare, setPositionToShare] = useState(null);\r\n  const [isPositionEditorVisible, setIsPositionEditorVisible] = useState(undefined);\r\n  const [isPositionSellerVisible, setIsPositionSellerVisible] = useState(undefined);\r\n  const [collateralTokenAddress, setCollateralTokenAddress] = useState(undefined);\r\n  const [isPositionShareModalOpen, setIsPositionShareModalOpen] = useState(false);\r\n  const [ordersToaOpen, setOrdersToaOpen] = useState(false);\r\n  const [isHigherSlippageAllowed, setIsHigherSlippageAllowed] = useState(false);\r\n\r\n  const editPosition = (position) => {\r\n    setCollateralTokenAddress(position.collateralToken.address);\r\n    setPositionToEditKey(position.key);\r\n    setIsPositionEditorVisible(true);\r\n  };\r\n\r\n  const sellPosition = (position) => {\r\n    setPositionToSellKey(position.key);\r\n    setIsPositionSellerVisible(true);\r\n    setIsHigherSlippageAllowed(false);\r\n  };\r\n\r\n  const onPositionClick = (position) => {\r\n    helperToast.success(`${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol} market selected`);\r\n    setMarket(position.isLong ? LONG : SHORT, position.indexToken.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"PositionsList\">\r\n      <PositionEditor\r\n        pendingPositions={pendingPositions}\r\n        setPendingPositions={setPendingPositions}\r\n        positionsMap={positionsMap}\r\n        positionKey={positionToEditKey}\r\n        isVisible={isPositionEditorVisible}\r\n        setIsVisible={setIsPositionEditorVisible}\r\n        infoTokens={infoTokens}\r\n        active={active}\r\n        account={account}\r\n        library={library}\r\n        collateralTokenAddress={collateralTokenAddress}\r\n        pendingTxns={pendingTxns}\r\n        setPendingTxns={setPendingTxns}\r\n        getUsd={getUsd}\r\n        getLeverage={getLeverage}\r\n        savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n        positionRouterApproved={positionRouterApproved}\r\n        isPositionRouterApproving={isPositionRouterApproving}\r\n        isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n        approvePositionRouter={approvePositionRouter}\r\n        chainId={chainId}\r\n        minExecutionFee={minExecutionFee}\r\n        minExecutionFeeUSD={minExecutionFeeUSD}\r\n        minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n      />\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionShareModalOpen && (\r\n        <PositionShare\r\n          setIsPositionShareModalOpen={setIsPositionShareModalOpen}\r\n          isPositionShareModalOpen={isPositionShareModalOpen}\r\n          positionToShare={positionToShare}\r\n          chainId={chainId}\r\n          account={account}\r\n        />\r\n      )}\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionSellerVisible && (\r\n        <PositionSeller\r\n          pendingPositions={pendingPositions}\r\n          setPendingPositions={setPendingPositions}\r\n          setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n          isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n          orderBookApproved={orderBookApproved}\r\n          positionsMap={positionsMap}\r\n          positionKey={positionToSellKey}\r\n          isVisible={isPositionSellerVisible}\r\n          setIsVisible={setIsPositionSellerVisible}\r\n          infoTokens={infoTokens}\r\n          active={active}\r\n          account={account}\r\n          orders={orders}\r\n          library={library}\r\n          pendingTxns={pendingTxns}\r\n          setPendingTxns={setPendingTxns}\r\n          flagOrdersEnabled={flagOrdersEnabled}\r\n          savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n          chainId={chainId}\r\n          nativeTokenAddress={nativeTokenAddress}\r\n          setOrdersToaOpen={setOrdersToaOpen}\r\n          positionRouterApproved={positionRouterApproved}\r\n          isPositionRouterApproving={isPositionRouterApproving}\r\n          isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n          approvePositionRouter={approvePositionRouter}\r\n          isHigherSlippageAllowed={isHigherSlippageAllowed}\r\n          setIsHigherSlippageAllowed={setIsHigherSlippageAllowed}\r\n          minExecutionFee={minExecutionFee}\r\n          minExecutionFeeUSD={minExecutionFeeUSD}\r\n          minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n          usdgSupply={usdgSupply}\r\n          totalTokenWeights={totalTokenWeights}\r\n        />\r\n      )}\r\n      {positions && (\r\n        <div className=\"Exchange-list small\">\r\n          <div>\r\n            {positions.length === 0 && positionsDataIsLoading && (\r\n              <div className=\"Exchange-empty-positions-list-note App-card\">\r\n                <Trans>Loading...</Trans>\r\n              </div>\r\n            )}\r\n            {positions.length === 0 && !positionsDataIsLoading && (\r\n              <div className=\"Exchange-empty-positions-list-note App-card Exchange-list-empty-note\">\r\n                <Trans>No open positions</Trans>\r\n              </div>\r\n            )}\r\n            {positions.map((position) => {\r\n              const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n              const liquidationPrice = getLiquidationPrice(position);\r\n              const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n              const positionDelta =\r\n                position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n              let borrowFeeUSD;\r\n              if (position.collateralToken && position.collateralToken.fundingRate) {\r\n                const borrowFeeRate = position.collateralToken.fundingRate\r\n                  .mul(position.size)\r\n                  .mul(24)\r\n                  .div(FUNDING_RATE_PRECISION);\r\n                borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n              }\r\n\r\n              return (\r\n                <PositionsItem\r\n                  key={position.key}\r\n                  position={position}\r\n                  onPositionClick={onPositionClick}\r\n                  setListSection={setListSection}\r\n                  positionOrders={positionOrders}\r\n                  showPnlAfterFees={showPnlAfterFees}\r\n                  hasPositionProfit={hasPositionProfit}\r\n                  positionDelta={positionDelta}\r\n                  liquidationPrice={liquidationPrice}\r\n                  cx={cx}\r\n                  borrowFeeUSD={borrowFeeUSD}\r\n                  editPosition={editPosition}\r\n                  sellPosition={sellPosition}\r\n                  dgAddress={dgAddress}\r\n                  isLarge={false}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      <table className=\"Exchange-list large App-box\">\r\n        <tbody>\r\n          {positions.length > 0 && (\r\n            <tr className=\"Exchange-list-header\">\r\n              <th>\r\n                <Trans>Position</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Net Value</Trans>\r\n              </th>\r\n              <th>\r\n                <Tooltip\r\n                  className=\"has-hint-tooltip nowrap\"\r\n                  handle=\"IM\"\r\n                  position=\"left-bottom\"\r\n                  enabled={true}\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div>\r\n                        The margin reserved for your <br />open positions and open orders\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </th>\r\n              <th>\r\n                <Tooltip\r\n                  className=\"has-hint-tooltip nowrap\"\r\n                  handle=\"MM\"\r\n                  position=\"left-bottom\"\r\n                  enabled={true}\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div>\r\n                        The margin required tomaintain your current <br />positions. Ifyour current margin balance falls <br />belowMin. Maintenance Margin, your margin <br />account will beliquidated torepay the debt\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </th>\r\n              <th>\r\n                <Trans>Mark Price</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Entry Price</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Liq. Price</Trans>\r\n              </th>\r\n              <th></th>\r\n            </tr>\r\n          )}\r\n          {positions.length === 0 && positionsDataIsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\">\r\n                <div className=\"Exchange-empty-positions-list-note\">Loading...</div>\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {positions.length === 0 && !positionsDataIsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\" className=\"Exchange-list-empty-note\">\r\n                No open positions\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {positions.map((position) => {\r\n            const liquidationPrice = getLiquidationPrice(position) || bigNumberify(0);\r\n            const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n            const hasOrderError = !!positionOrders.find((order) => order.error);\r\n            const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n            const positionDelta =\r\n              position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n            let borrowFeeUSD;\r\n            if (position.collateralToken && position.collateralToken.fundingRate) {\r\n              const borrowFeeRate = position.collateralToken.fundingRate\r\n                .mul(position.size)\r\n                .mul(24)\r\n                .div(FUNDING_RATE_PRECISION);\r\n              borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n            }\r\n\r\n\r\n            return (\r\n              <PositionsItem\r\n                key={position.key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={positionDelta}\r\n                liquidationPrice={liquidationPrice}\r\n                cx={cx}\r\n                borrowFeeUSD={borrowFeeUSD}\r\n                editPosition={editPosition}\r\n                sellPosition={sellPosition}\r\n                dgAddress={dgAddress}\r\n                isLarge={true}\r\n              />\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useMemo } from \"react\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  PRECISION,\r\n  USD_DECIMALS,\r\n  SWAP,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n  MIN_PROFIT_TIME,\r\n  DECREASE,\r\n  INCREASE,\r\n  useChainId,\r\n  getTokenInfo,\r\n  isTriggerRatioInverted,\r\n  bigNumberify,\r\n  formatAmountFree,\r\n  parseValue,\r\n  getNextToAmount,\r\n  getExchangeRate,\r\n  formatAmount,\r\n  getExchangeRateDisplay,\r\n  calculatePositionDelta,\r\n  getLiquidationPrice,\r\n  formatDateTime,\r\n  getDeltaStr,\r\n  getProfitPrice,\r\n  getTimeRemaining,\r\n} from \"../../lib/legacy\";\r\nimport { updateSwapOrder, updateIncreaseOrder, updateDecreaseOrder } from \"../../domain/legacy\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nexport default function OrderEditor(props) {\r\n  const {\r\n    account,\r\n    order,\r\n    setEditingOrder,\r\n    infoTokens,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    library,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    getPositionForOrder,\r\n    positionsMap,\r\n    savedShouldDisableValidationForTesting,\r\n  } = props;\r\n\r\n  const { chainId } = useChainId();\r\n\r\n  const position = order.type !== SWAP ? getPositionForOrder(account, order, positionsMap) : null;\r\n  const liquidationPrice = order.type === DECREASE && position ? getLiquidationPrice(position) : null;\r\n\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const fromTokenInfo = order.type === SWAP ? getTokenInfo(infoTokens, order.path[0], true, nativeTokenAddress) : null;\r\n  const toTokenInfo =\r\n    order.type === SWAP\r\n      ? getTokenInfo(infoTokens, order.path[order.path.length - 1], order.shouldUnwrap, nativeTokenAddress)\r\n      : null;\r\n\r\n  const triggerRatioInverted = useMemo(() => {\r\n    if (order.type !== SWAP) {\r\n      return null;\r\n    }\r\n\r\n    return isTriggerRatioInverted(fromTokenInfo, toTokenInfo);\r\n  }, [toTokenInfo, fromTokenInfo, order.type]);\r\n\r\n  let initialRatio = 0;\r\n  if (order.triggerRatio) {\r\n    initialRatio = triggerRatioInverted ? PRECISION.mul(PRECISION).div(order.triggerRatio) : order.triggerRatio;\r\n  }\r\n  const [triggerRatioValue, setTriggerRatioValue] = useState(formatAmountFree(initialRatio, USD_DECIMALS, 6));\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(formatAmountFree(order.triggerPrice, USD_DECIMALS, 4));\r\n  const triggerPrice = useMemo(() => {\r\n    return triggerPriceValue ? parseValue(triggerPriceValue, USD_DECIMALS) : 0;\r\n  }, [triggerPriceValue]);\r\n\r\n  const triggerRatio = useMemo(() => {\r\n    if (!triggerRatioValue) {\r\n      return bigNumberify(0);\r\n    }\r\n    let ratio = parseValue(triggerRatioValue, USD_DECIMALS);\r\n    if (triggerRatioInverted) {\r\n      ratio = PRECISION.mul(PRECISION).div(ratio);\r\n    }\r\n    return ratio;\r\n  }, [triggerRatioValue, triggerRatioInverted]);\r\n\r\n  const indexTokenMarkPrice = useMemo(() => {\r\n    if (order.type === SWAP) {\r\n      return;\r\n    }\r\n    const toTokenInfo = getTokenInfo(infoTokens, order.indexToken);\r\n    return order.isLong ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n  }, [infoTokens, order]);\r\n\r\n  let toAmount;\r\n  if (order.type === SWAP) {\r\n    const { amount } = getNextToAmount(\r\n      chainId,\r\n      order.amountIn,\r\n      order.path[0],\r\n      order.path[order.path.length - 1],\r\n      infoTokens,\r\n      undefined,\r\n      triggerRatio,\r\n      usdgSupply,\r\n      totalTokenWeights\r\n    );\r\n    toAmount = amount;\r\n  }\r\n\r\n  const onClickPrimary = () => {\r\n    setIsSubmitting(true);\r\n\r\n    let func;\r\n    let params;\r\n\r\n    if (order.type === SWAP) {\r\n      func = updateSwapOrder;\r\n      params = [chainId, library, order.index, toAmount, triggerRatio, order.triggerAboveThreshold];\r\n    } else if (order.type === DECREASE) {\r\n      func = updateDecreaseOrder;\r\n      params = [\r\n        chainId,\r\n        library,\r\n        order.index,\r\n        order.collateralDelta,\r\n        order.sizeDelta,\r\n        triggerPrice,\r\n        order.triggerAboveThreshold,\r\n      ];\r\n    } else if (order.type === INCREASE) {\r\n      func = updateIncreaseOrder;\r\n      params = [chainId, library, order.index, order.sizeDelta, triggerPrice, order.triggerAboveThreshold];\r\n    }\r\n\r\n    params.push({\r\n      successMsg: \"Order updated!\",\r\n      failMsg: \"Order update failed.\",\r\n      sentMsg: \"Order update submitted!\",\r\n      pendingTxns,\r\n      setPendingTxns,\r\n    });\r\n\r\n    return func(...params)\r\n      .then(() => {\r\n        setEditingOrder(null);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const onTriggerRatioChange = (evt) => {\r\n    setTriggerRatioValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const getError = () => {\r\n    if ((!triggerRatio || triggerRatio.eq(0)) && (!triggerPrice || triggerPrice.eq(0))) {\r\n      return \"Enter Price\";\r\n    }\r\n    if (order.type === SWAP && triggerRatio.eq(order.triggerRatio)) {\r\n      return \"Enter new Price\";\r\n    }\r\n    if (order.type !== SWAP && triggerPrice.eq(order.triggerPrice)) {\r\n      return \"Enter new Price\";\r\n    }\r\n    if (position) {\r\n      if (order.type === DECREASE) {\r\n        if (position.isLong && triggerPrice.lte(liquidationPrice)) {\r\n          return \"Price below Liq. Price\";\r\n        }\r\n        if (!position.isLong && triggerPrice.gte(liquidationPrice)) {\r\n          return \"Price above Liq. Price\";\r\n        }\r\n      }\r\n\r\n      const { delta, hasProfit } = calculatePositionDelta(triggerPrice, position);\r\n      if (hasProfit && delta.eq(0)) {\r\n        return \"Invalid price, see warning\";\r\n      }\r\n    }\r\n\r\n    if (order.type !== SWAP && indexTokenMarkPrice && !savedShouldDisableValidationForTesting) {\r\n      if (order.triggerAboveThreshold && indexTokenMarkPrice.gt(triggerPrice)) {\r\n        return \"Price below Mark Price\";\r\n      }\r\n      if (!order.triggerAboveThreshold && indexTokenMarkPrice.lt(triggerPrice)) {\r\n        return \"Price above Mark Price\";\r\n      }\r\n    }\r\n\r\n    if (order.type === SWAP) {\r\n      const currentRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n      if (currentRate && !currentRate.gte(triggerRatio)) {\r\n        return `Price is ${triggerRatioInverted ? \"below\" : \"above\"} Mark Price`;\r\n      }\r\n    }\r\n  };\r\n\r\n  const renderMinProfitWarning = () => {\r\n    if (MIN_PROFIT_TIME === 0 || order.type === SWAP || !position || !triggerPrice || triggerPrice.eq(0)) {\r\n      return null;\r\n    }\r\n\r\n    const { delta, pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(triggerPrice, position);\r\n    if (hasProfit && delta.eq(0)) {\r\n      const { deltaStr } = getDeltaStr({\r\n        delta: pendingDelta,\r\n        deltaPercentage: pendingDeltaPercentage,\r\n        hasProfit,\r\n      });\r\n      const profitPrice = getProfitPrice(triggerPrice, position);\r\n      const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          This order will forfeit a&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            profit\r\n          </a>{\" \"}\r\n          of {deltaStr}. <br />\r\n          Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n          only applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}\r\n          .\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (isSubmitting) {\r\n      return \"Updating Order...\";\r\n    }\r\n    return \"Update Order\";\r\n  };\r\n\r\n  if (order.type !== SWAP) {\r\n    const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n    return (\r\n      <Modal\r\n        isVisible={true}\r\n        className=\"Exchange-list-modal\"\r\n        setIsVisible={() => setEditingOrder(null)}\r\n        label=\"Edit order\"\r\n\r\n        isNifty={true}\r\n      >\r\n        {renderMinProfitWarning()}\r\n        <div className=\"Exchange-swap-section\">\r\n          <div className=\"Exchange-swap-section-top\">\r\n            <div className=\"muted\">Price</div>\r\n            <div\r\n              className=\"muted align-right clickable\"\r\n              onClick={() => {\r\n                setTriggerPriceValue(formatAmountFree(indexTokenMarkPrice, USD_DECIMALS, 2));\r\n              }}\r\n            >\r\n              Mark: {formatAmount(indexTokenMarkPrice, USD_DECIMALS, 2)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-section-bottom\">\r\n            <div className=\"Exchange-swap-input-container\">\r\n              <input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                placeholder=\"0.0\"\r\n                className=\"Exchange-swap-input\"\r\n                value={triggerPriceValue}\r\n                onChange={onTriggerPriceChange}\r\n                onFocus={(e) => {\r\n                  e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n                }}\r\n                onBlur={(e) => {\r\n                  e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n                }}\r\n              />\r\n            </div>\r\n            <div className=\"PositionEditor-token-symbol\">USD</div>\r\n          </div>\r\n        </div>\r\n        <ExchangeInfoRow label=\"Price\">\r\n          {triggerPrice && !triggerPrice.eq(order.triggerPrice) ? (\r\n            <>\r\n              <span className=\"muted\">\r\n                {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n              </span>\r\n              &nbsp;\r\n              <BsArrowRight />\r\n              &nbsp;\r\n              {triggerPricePrefix} {formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n            </>\r\n          ) : (\r\n            <span>\r\n              {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n            </span>\r\n          )}\r\n        </ExchangeInfoRow>\r\n        {liquidationPrice && (\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">Liq. Price</div>\r\n            <div className=\"align-right\">{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}</div>\r\n          </div>\r\n        )}\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button\r\n            className={\"App-cta Exchange-swap-button Exchange-list-modal-button\" + (isPrimaryEnabled() ? \" hlight\" : \"\")}\r\n            onClick={onClickPrimary}\r\n            disabled={!isPrimaryEnabled()}\r\n          >\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      isVisible={true}\r\n      className=\"Exchange-list-modal\"\r\n      setIsVisible={() => setEditingOrder(null)}\r\n      label=\"Edit order\"\r\n      isNifty={true}\r\n    >\r\n      <div className=\"Exchange-swap-section\">\r\n        <div className=\"Exchange-swap-section-top\">\r\n          <div className=\"muted\">Price</div>\r\n          {fromTokenInfo && toTokenInfo && (\r\n            <div\r\n              className=\"muted align-right clickable\"\r\n              onClick={() => {\r\n                setTriggerRatioValue(\r\n                  formatAmountFree(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 10)\r\n                );\r\n              }}\r\n            >\r\n              Mark Price:{\" \"}\r\n              {formatAmount(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 2)}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"Exchange-swap-section-bottom\">\r\n          <div className=\"Exchange-swap-input-container\">\r\n            <input\r\n              type=\"number\"\r\n              min=\"0\"\r\n              placeholder=\"0.0\"\r\n              className=\"Exchange-swap-input\"\r\n              value={triggerRatioValue}\r\n              onChange={onTriggerRatioChange}\r\n              onFocus={(e) => {\r\n                e.target.parentElement.parentElement.parentElement.classList.add('hlight');\r\n              }}\r\n              onBlur={(e) => {\r\n                e.target.parentElement.parentElement.parentElement.classList.remove('hlight');\r\n              }}\r\n            />\r\n          </div>\r\n          {(() => {\r\n            if (!toTokenInfo) return;\r\n            if (!fromTokenInfo) return;\r\n            const [tokenA, tokenB] = triggerRatioInverted ? [toTokenInfo, fromTokenInfo] : [fromTokenInfo, toTokenInfo];\r\n            return (\r\n              <div className=\"PositionEditor-token-symbol\">\r\n                {tokenA.symbol}&nbsp;/&nbsp;{tokenB.symbol}\r\n              </div>\r\n            );\r\n          })()}\r\n        </div>\r\n      </div>\r\n      <ExchangeInfoRow label=\"Minimum received\">\r\n        {triggerRatio && !triggerRatio.eq(order.triggerRatio) ? (\r\n          <>\r\n            <span className=\"muted\">{formatAmount(order.minOut, toTokenInfo.decimals, 4, true)}</span>\r\n            &nbsp;\r\n            <BsArrowRight />\r\n            &nbsp;\r\n            {formatAmount(toAmount, toTokenInfo.decimals, 4, true)}\r\n          </>\r\n        ) : (\r\n          formatAmount(order.minOut, toTokenInfo.decimals, 4, true)\r\n        )}\r\n        &nbsp;{toTokenInfo.symbol}\r\n      </ExchangeInfoRow>\r\n      <ExchangeInfoRow label=\"Price\">\r\n        {triggerRatio && !triggerRatio.eq(0) && !triggerRatio.eq(order.triggerRatio) ? (\r\n          <>\r\n            <span className=\"muted\">\r\n              {getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo, {\r\n                omitSymbols: !triggerRatio || !triggerRatio.eq(order.triggerRatio),\r\n              })}\r\n            </span>\r\n            &nbsp;\r\n            <BsArrowRight />\r\n            &nbsp;\r\n            {getExchangeRateDisplay(triggerRatio, fromTokenInfo, toTokenInfo)}\r\n          </>\r\n        ) : (\r\n          getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo, {\r\n            omitSymbols: !triggerRatio || !triggerRatio.eq(order.triggerRatio),\r\n          })\r\n        )}\r\n      </ExchangeInfoRow>\r\n      {fromTokenInfo && (\r\n        <div className=\"Exchange-info-row\">\r\n          <div className=\"Exchange-info-label\">{fromTokenInfo.symbol} price</div>\r\n          <div className=\"align-right\">{formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true)} USD</div>\r\n        </div>\r\n      )}\r\n      {toTokenInfo && (\r\n        <div className=\"Exchange-info-row\">\r\n          <div className=\"Exchange-info-label\">{toTokenInfo.symbol} price</div>\r\n          <div className=\"align-right\">{formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true)} USD</div>\r\n        </div>\r\n      )}\r\n      <div className=\"Exchange-swap-button-container\">\r\n        <button\r\n          className=\"App-cta Exchange-swap-button Exchange-list-modal-button\"\r\n          onClick={onClickPrimary}\r\n          disabled={!isPrimaryEnabled()}\r\n        >\r\n          {getPrimaryText()}\r\n        </button>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useState, useCallback } from \"react\";\r\nimport { Trans } from \"@lingui/macro\";\r\n\r\nimport {\r\n  SWAP,\r\n  INCREASE,\r\n  DECREASE,\r\n  USD_DECIMALS,\r\n  formatAmount,\r\n  getOrderError,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n  getExchangeRateDisplay,\r\n  getTokenInfo,\r\n  getExchangeRate,\r\n  getPositionForOrder,\r\n  getUsd,\r\n} from \"../../lib/legacy.js\";\r\nimport { handleCancelOrder } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport OrderEditor from \"./OrderEditor\";\r\n\r\nimport \"./OrdersList.css\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\n\r\nexport default function OrdersList(props) {\r\n  const {\r\n    account,\r\n    library,\r\n    setPendingTxns,\r\n    pendingTxns,\r\n    infoTokens,\r\n    positionsMap,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    orders,\r\n    hideActions,\r\n    chainId,\r\n    savedShouldDisableValidationForTesting,\r\n    cancelOrderIdList,\r\n    setCancelOrderIdList,\r\n  } = props;\r\n\r\n  const [editingOrder, setEditingOrder] = useState(null);\r\n\r\n  const onCancelClick = useCallback(\r\n    (order) => {\r\n      handleCancelOrder(chainId, library, order, { pendingTxns, setPendingTxns });\r\n    },\r\n    [library, pendingTxns, setPendingTxns, chainId]\r\n  );\r\n\r\n  const onEditClick = useCallback(\r\n    (order) => {\r\n      setEditingOrder(order);\r\n    },\r\n    [setEditingOrder]\r\n  );\r\n\r\n  const renderHead = useCallback(() => {\r\n    if (!orders.length) {\r\n      return;\r\n    }\r\n    \r\n    const isAllOrdersSelected = cancelOrderIdList?.length > 0 && cancelOrderIdList?.length === orders.length;\r\n    return (\r\n      <tr className=\"Exchange-list-header\">\r\n        {/* {orders.length > 0 && (\r\n          <th>\r\n            <div className=\"checkbox-inline \">\r\n              <Checkbox\r\n                isChecked={isAllOrdersSelected}\r\n                setIsChecked={() => {\r\n                  if (isAllOrdersSelected) {\r\n                    setCancelOrderIdList([]);\r\n                  } else {\r\n                    const allOrderIds = orders.map((o) => `${o.type}-${o.index}`);\r\n                    setCancelOrderIdList(allOrderIds);\r\n                  }\r\n                }}\r\n              />\r\n            </div>\r\n          </th>\r\n        )} */}\r\n\r\n        <th>\r\n          <div>\r\n            <Trans>Type</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Order</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Price</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Mark Price</Trans>\r\n          </div>\r\n        </th>\r\n      </tr>\r\n    );\r\n  }, [cancelOrderIdList, orders, setCancelOrderIdList]);\r\n\r\n  const renderEmptyRow = useCallback(() => {\r\n    if (orders && orders.length) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <tr>\r\n        <td colSpan=\"5\" className=\"Exchange-list-empty-note\">\r\n          <Trans>No open orders</Trans>\r\n        </td>\r\n      </tr>\r\n    );\r\n  }, [orders]);\r\n\r\n  const renderActions = useCallback(\r\n    (order) => {\r\n      return (\r\n        <>\r\n          <td>\r\n            <button className=\"Exchange-list-action\" onClick={() => onEditClick(order)}>\r\n              <Trans>Edit</Trans>\r\n            </button>\r\n          </td>\r\n          <td>\r\n            <button className=\"Exchange-list-action\" onClick={() => onCancelClick(order)}>\r\n              <Trans>Cancel</Trans>\r\n            </button>\r\n          </td>\r\n        </>\r\n      );\r\n    },\r\n    [onEditClick, onCancelClick]\r\n  );\r\n\r\n  const renderLargeList = useCallback(() => {\r\n    if (!orders || !orders.length) {\r\n      return null;\r\n    }\r\n    return orders.map((order) => {\r\n      if (order.type === SWAP) {\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromTokenInfo = getTokenInfo(infoTokens, order.path[0], true, nativeTokenAddress);\r\n        const toTokenInfo = getTokenInfo(\r\n          infoTokens,\r\n          order.path[order.path.length - 1],\r\n          order.shouldUnwrap,\r\n          nativeTokenAddress\r\n        );\r\n\r\n        const markExchangeRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n        const orderId = `${order.type}-${order.index}`;\r\n\r\n        return (\r\n          <tr className=\"Exchange-list-item\" key={orderId}>\r\n            {/* <td>\r\n              <div className=\"checkbox-inline \">\r\n                <Checkbox\r\n                  isChecked={cancelOrderIdList?.includes(orderId)}\r\n                  setIsChecked={() => {\r\n                    setCancelOrderIdList((prevState) => {\r\n                      if (prevState.includes(orderId)) {\r\n                        return prevState.filter((i) => i !== orderId);\r\n                      } else {\r\n                        return prevState.concat(orderId);\r\n                      }\r\n                    });\r\n                  }}\r\n                />\r\n              </div>\r\n            </td> */}\r\n            <td className=\"Exchange-list-item-type\">Limit</td>\r\n            <td>\r\n              Swap{\" \"}\r\n              {formatAmount(\r\n                order.amountIn,\r\n                fromTokenInfo.decimals,\r\n                fromTokenInfo.isStable || fromTokenInfo.isUsdg ? 2 : 4,\r\n                true\r\n              )}{\" \"}\r\n              {fromTokenInfo.symbol} for{\" \"}\r\n              {formatAmount(\r\n                order.minOut,\r\n                toTokenInfo.decimals,\r\n                toTokenInfo.isStable || toTokenInfo.isUsdg ? 2 : 4,\r\n                true\r\n              )}{\" \"}\r\n              {toTokenInfo.symbol}\r\n            </td>\r\n            <td>\r\n              <Tooltip\r\n                handle={getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo)}\r\n                renderContent={() => `\r\n                  You will receive at least ${formatAmount(\r\n                    order.minOut,\r\n                    toTokenInfo.decimals,\r\n                    toTokenInfo.isStable || toTokenInfo.isUsdg ? 2 : 4,\r\n                    true\r\n                  )} ${\r\n                  toTokenInfo.symbol\r\n                } if this order is executed. The execution price may vary depending on swap fees at the time the order is executed.\r\n                `}\r\n              />\r\n            </td>\r\n            <td>{getExchangeRateDisplay(markExchangeRate, fromTokenInfo, toTokenInfo, true)}</td>\r\n            {!hideActions && renderActions(order)}\r\n          </tr>\r\n        );\r\n      }\r\n\r\n      const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n\r\n      // Longs Increase: max price\r\n      // Longs Decrease: min price\r\n      // Short Increase: min price\r\n      // Short Decrease: max price\r\n      const maximisePrice = (order.type === INCREASE && order.isLong) || (order.type === DECREASE && !order.isLong);\r\n\r\n      const markPrice = maximisePrice ? indexToken.contractMaxPrice : indexToken.contractMinPrice;\r\n      const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n      const indexTokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n\r\n      const error = getOrderError(account, order, positionsMap);\r\n      const orderId = `${order.type}-${order.index}`;\r\n      const orderText = (\r\n        <>\r\n          {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n          &nbsp;by ${formatAmount(order.sizeDelta, USD_DECIMALS, 2, true)}\r\n          {error && <div className=\"Exchange-list-item-error\">{error}</div>}\r\n        </>\r\n      );\r\n\r\n      return (\r\n        <tr className=\"Exchange-list-item\" key={`${order.isLong}-${order.type}-${order.index}`}>\r\n          {/* <td className=\"Exchange-list-item-type\">\r\n            <div>\r\n              <Checkbox\r\n                isChecked={cancelOrderIdList?.includes(orderId)}\r\n                setIsChecked={() => {\r\n                  setCancelOrderIdList((prevState) => {\r\n                    if (prevState.includes(orderId)) {\r\n                      return prevState.filter((i) => i !== orderId);\r\n                    } else {\r\n                      return prevState.concat(orderId);\r\n                    }\r\n                  });\r\n                }}\r\n              />\r\n            </div>\r\n          </td> */}\r\n          <td className=\"Exchange-list-item-type\">{order.type === INCREASE ? \"Limit\" : \"Trigger\"}</td>\r\n          <td>\r\n            {order.type === DECREASE ? (\r\n              orderText\r\n            ) : (\r\n              <Tooltip\r\n                handle={orderText}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  const collateralTokenInfo = getTokenInfo(infoTokens, order.purchaseToken);\r\n                  const collateralUSD = getUsd(order.purchaseTokenAmount, order.purchaseToken, false, infoTokens);\r\n                  return (\r\n                    <StatsTooltipRow\r\n                      label=\"Collateral\"\r\n                      value={`${formatAmount(collateralUSD, USD_DECIMALS, 2, true)} (${formatAmount(\r\n                        order.purchaseTokenAmount,\r\n                        collateralTokenInfo.decimals,\r\n                        4,\r\n                        true\r\n                      )}\r\n                      ${collateralTokenInfo.baseSymbol || collateralTokenInfo.symbol})`}\r\n                    />\r\n                  );\r\n                }}\r\n              />\r\n            )}\r\n          </td>\r\n          <td className=\"nowrap\">\r\n            {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n          </td>\r\n          <td>\r\n            <Tooltip\r\n              handle={formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n              position=\"right-bottom\"\r\n              renderContent={() => {\r\n                return (\r\n                  <Trans>\r\n                    The price that orders can be executed at may differ slightly from the chart price, as market orders\r\n                    update oracle prices, while limit/trigger orders do not.\r\n                  </Trans>\r\n                );\r\n              }}\r\n            />\r\n          </td>\r\n          {!hideActions && renderActions(order)}\r\n        </tr>\r\n      );\r\n    });\r\n  }, [\r\n    orders,\r\n    renderActions,\r\n    infoTokens,\r\n    positionsMap,\r\n    hideActions,\r\n    chainId,\r\n    account,\r\n    cancelOrderIdList,\r\n    setCancelOrderIdList,\r\n  ]);\r\n\r\n  const renderSmallList = useCallback(() => {\r\n    if (!orders || !orders.length) {\r\n      return null;\r\n    }\r\n\r\n    return orders.map((order) => {\r\n      if (order.type === SWAP) {\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromTokenInfo = getTokenInfo(infoTokens, order.path[0], true, nativeTokenAddress);\r\n        const toTokenInfo = getTokenInfo(\r\n          infoTokens,\r\n          order.path[order.path.length - 1],\r\n          order.shouldUnwrap,\r\n          nativeTokenAddress\r\n        );\r\n        const markExchangeRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n\r\n        return (\r\n          <div key={`${order.type}-${order.index}`} className=\"App-card\">\r\n            <div className=\"App-card-title-small\">\r\n              Swap {formatAmount(order.amountIn, fromTokenInfo.decimals, fromTokenInfo.isStable ? 2 : 4, true)}{\" \"}\r\n              {fromTokenInfo.symbol} for{\" \"}\r\n              {formatAmount(order.minOut, toTokenInfo.decimals, toTokenInfo.isStable ? 2 : 4, true)}{\" \"}\r\n              {toTokenInfo.symbol}\r\n            </div>\r\n            <div className=\"App-card-divider\"></div>\r\n            <div className=\"App-card-content\">\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">Price</div>\r\n                <div>\r\n                  <Tooltip\r\n                    position=\"right-bottom\"\r\n                    handle={getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo)}\r\n                    renderContent={() => `\r\n                    You will receive at least ${formatAmount(\r\n                      order.minOut,\r\n                      toTokenInfo.decimals,\r\n                      toTokenInfo.isStable || toTokenInfo.isUsdg ? 2 : 4,\r\n                      true\r\n                    )} ${\r\n                      toTokenInfo.symbol\r\n                    } if this order is executed. The exact execution price may vary depending on fees at the time the order is executed.\r\n                  `}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Mark Price</Trans>\r\n                </div>\r\n                <div>{getExchangeRateDisplay(markExchangeRate, fromTokenInfo, toTokenInfo)}</div>\r\n              </div>\r\n              {!hideActions && (\r\n                <>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-options\">\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => onEditClick(order)}>\r\n                      <Trans>Edit</Trans>\r\n                    </button>\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => onCancelClick(order)}>\r\n                      <Trans>Cancel</Trans>\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n      const maximisePrice = (order.type === INCREASE && order.isLong) || (order.type === DECREASE && !order.isLong);\r\n      const markPrice = maximisePrice ? indexToken.contractMaxPrice : indexToken.contractMinPrice;\r\n      const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n      const indexTokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n\r\n      const collateralTokenInfo = getTokenInfo(infoTokens, order.purchaseToken);\r\n      const collateralUSD = getUsd(order.purchaseTokenAmount, order.purchaseToken, true, infoTokens);\r\n\r\n      const error = getOrderError(account, order, positionsMap);\r\n\r\n      return (\r\n        <div key={`${order.isLong}-${order.type}-${order.index}`} className=\"App-card\">\r\n          <div className=\"App-card-title-small\">\r\n            {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n            &nbsp;by ${formatAmount(order.sizeDelta, USD_DECIMALS, 2, true)}\r\n            {error && <div className=\"Exchange-list-item-error\">{error}</div>}\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"App-card-content\">\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div>\r\n                {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div>\r\n                <Tooltip\r\n                  handle={formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <Trans>\r\n                        The price that the order can be executed at may differ slightly from the chart price as market\r\n                        orders can change the price while limit / trigger orders cannot.\r\n                      </Trans>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            {order.type === INCREASE && (\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Collateral</Trans>\r\n                </div>\r\n                <div>\r\n                  ${formatAmount(collateralUSD, USD_DECIMALS, 2, true)} (\r\n                  {formatAmount(order.purchaseTokenAmount, collateralTokenInfo.decimals, 4, true)}{\" \"}\r\n                  {collateralTokenInfo.baseSymbol || collateralTokenInfo.symbol})\r\n                </div>\r\n              </div>\r\n            )}\r\n            {!hideActions && (\r\n              <>\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onEditClick(order)}>\r\n                    <Trans>Edit</Trans>\r\n                  </button>\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onCancelClick(order)}>\r\n                    <Trans>Cancel</Trans>\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  }, [orders, onEditClick, onCancelClick, infoTokens, positionsMap, hideActions, chainId, account]);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <table className=\"Exchange-list Orders App-box large\">\r\n        <tbody>\r\n          {renderHead()}\r\n          {renderEmptyRow()}\r\n          {renderLargeList()}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"Exchange-list Orders small\">\r\n        {(!orders || orders.length === 0) && (\r\n          <div className=\"Exchange-empty-positions-list-note App-card\">No open orders</div>\r\n        )}\r\n        {renderSmallList()}\r\n      </div>\r\n      {editingOrder && (\r\n        <OrderEditor\r\n          account={account}\r\n          order={editingOrder}\r\n          setEditingOrder={setEditingOrder}\r\n          infoTokens={infoTokens}\r\n          pendingTxns={pendingTxns}\r\n          setPendingTxns={setPendingTxns}\r\n          getPositionForOrder={getPositionForOrder}\r\n          positionsMap={positionsMap}\r\n          library={library}\r\n          totalTokenWeights={totalTokenWeights}\r\n          usdgSupply={usdgSupply}\r\n          savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n        />\r\n      )}\r\n    </React.Fragment>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useCallback, useMemo } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Tooltip from \"../../components/Tooltip/Tooltip\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  MAX_LEVERAGE,\r\n  BASIS_POINTS_DIVISOR,\r\n  LIQUIDATION_FEE,\r\n  TRADES_PAGE_SIZE,\r\n  formatAmount,\r\n  getExplorerUrl,\r\n  formatDateTime,\r\n  deserialize,\r\n  getExchangeRateDisplay,\r\n  bigNumberify,\r\n} from \"../../lib/legacy\";\r\nimport { useTrades, useLiquidationsData } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport \"./TradeHistory.css\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getPositionDisplay(increase, indexToken, isLong, sizeDelta) {\r\n  const symbol = indexToken ? (indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol) : \"\";\r\n  return `\r\n    ${increase ? \"Increase\" : \"Decrease\"} ${symbol} ${isLong ? \"Long\" : \"Short\"}\r\n    ${increase ? \"+\" : \"-\"}${formatAmount(sizeDelta, USD_DECIMALS, 2, true)} USD`;\r\n}\r\n\r\nfunction getOrderActionTitle(action) {\r\n  let actionDisplay;\r\n\r\n  if (action.startsWith(\"Create\")) {\r\n    actionDisplay = \"Create\";\r\n  } else if (action.startsWith(\"Cancel\")) {\r\n    actionDisplay = \"Cancel\";\r\n  } else {\r\n    actionDisplay = \"Update\";\r\n  }\r\n\r\n  return `${actionDisplay} Order`;\r\n}\r\n\r\nfunction renderLiquidationTooltip(liquidationData, label) {\r\n  const minCollateral = liquidationData.size.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE);\r\n  const text =\r\n    liquidationData.type === \"full\"\r\n      ? \"This position was liquidated as the max leverage of 100x was exceeded\"\r\n      : \"Max leverage of 100x was exceeded, the remaining collateral after deducting losses and fees have been sent back to your account\";\r\n  return (\r\n    <Tooltip\r\n      position=\"left-top\"\r\n      handle={label}\r\n      renderContent={() => (\r\n        <>\r\n          {text}\r\n          <br />\r\n          <br />\r\n          Initial collateral: ${formatAmount(liquidationData.collateral, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          Min required collateral: ${formatAmount(minCollateral, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          Borrow fee: ${formatAmount(liquidationData.borrowFee, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          PnL: -${formatAmount(liquidationData.loss, USD_DECIMALS, 2, true)}\r\n          {liquidationData.type === \"full\" && <div>Liquidation fee: ${formatAmount(LIQUIDATION_FEE, 30, 2, true)}</div>}\r\n        </>\r\n      )}\r\n    />\r\n  );\r\n}\r\n\r\nfunction getLiquidationData(liquidationsDataMap, key, timestamp) {\r\n  return liquidationsDataMap && liquidationsDataMap[`${key}:${timestamp}`];\r\n}\r\n\r\nexport default function TradeHistory(props) {\r\n  const { account, infoTokens, getTokenInfo, chainId, nativeTokenAddress, shouldShowPaginationButtons } = props;\r\n  const [pageIds, setPageIds] = useState({});\r\n  const [pageIndex, setPageIndex] = useState(0);\r\n\r\n  const getAfterId = () => {\r\n    return pageIds[pageIndex];\r\n  };\r\n\r\n  const { trades, updateTrades } = useTrades(chainId, props.dgAddress, props.forSingleAccount, getAfterId());\r\n\r\n  const liquidationsData = useLiquidationsData(chainId, props.dgAddress);\r\n  const liquidationsDataMap = useMemo(() => {\r\n    if (!liquidationsData) {\r\n      return null;\r\n    }\r\n    return liquidationsData.reduce((memo, item) => {\r\n      const liquidationKey = `${item.key}:${item.timestamp}`;\r\n      memo[liquidationKey] = item;\r\n      return memo;\r\n    }, {});\r\n  }, [liquidationsData]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      updateTrades(undefined, true);\r\n    }, 10 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [updateTrades]);\r\n\r\n  const loadNextPage = () => {\r\n    if (!trades || trades.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const lastTrade = trades[trades.length - 1];\r\n    pageIds[pageIndex + 1] = lastTrade.id;\r\n    setPageIds(pageIds);\r\n    setPageIndex(pageIndex + 1);\r\n  };\r\n\r\n  const loadPrevPage = () => {\r\n    setPageIndex(pageIndex - 1);\r\n  };\r\n\r\n  const getMsg = useCallback(\r\n    (trade) => {\r\n      const tradeData = trade.data;\r\n      const params = JSON.parse(tradeData.params);\r\n      const defaultMsg = \"\";\r\n\r\n      if (tradeData.action === \"BuyUSDG\") {\r\n        const token = getTokenInfo(infoTokens, params.token, true, nativeTokenAddress);\r\n        if (!token) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.tokenAmount, token.decimals, 4, true)} ${token.symbol} for ${formatAmount(\r\n          params.usdgAmount,\r\n          18,\r\n          4,\r\n          true\r\n        )} USDG`;\r\n      }\r\n\r\n      if (tradeData.action === \"SellUSDG\") {\r\n        const token = getTokenInfo(infoTokens, params.token, true, nativeTokenAddress);\r\n        if (!token) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.usdgAmount, 18, 4, true)} USDG for ${formatAmount(\r\n          params.tokenAmount,\r\n          token.decimals,\r\n          4,\r\n          true\r\n        )} ${token.symbol}`;\r\n      }\r\n\r\n      if (tradeData.action === \"Swap\") {\r\n        const tokenIn = getTokenInfo(infoTokens, params.tokenIn, true, nativeTokenAddress);\r\n        const tokenOut = getTokenInfo(infoTokens, params.tokenOut, true, nativeTokenAddress);\r\n        if (!tokenIn || !tokenOut) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.amountIn, tokenIn.decimals, 4, true)} ${tokenIn.symbol} for ${formatAmount(\r\n          params.amountOut,\r\n          tokenOut.decimals,\r\n          4,\r\n          true\r\n        )} ${tokenOut.symbol}`;\r\n      }\r\n\r\n      if (tradeData.action === \"CreateIncreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Request deposit into ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return `Request increase ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, Acceptable Price: ${params.isLong ? \"<\" : \">\"} ${formatAmount(\r\n          params.acceptablePrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"CreateDecreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Request withdrawal from ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return `Request decrease ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, -${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, Acceptable Price: ${params.isLong ? \">\" : \"<\"} ${formatAmount(\r\n          params.acceptablePrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"CancelIncreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return (\r\n            <>\r\n              Could not execute deposit into {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"}\r\n            </>\r\n          );\r\n        }\r\n\r\n        return (\r\n          <>\r\n            Could not increase {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"},\r\n            {`+${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)}`} USD, Acceptable Price:&nbsp;\r\n            {params.isLong ? \"<\" : \">\"}&nbsp;\r\n            <Tooltip\r\n              position=\"left-top\"\r\n              handle={`${formatAmount(params.acceptablePrice, USD_DECIMALS, 2, true)} USD`}\r\n              renderContent={() => <>Try increasing the \"Allowed Slippage\", under the Settings menu on the top right</>}\r\n            />\r\n          </>\r\n        );\r\n      }\r\n\r\n      if (tradeData.action === \"CancelDecreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Could not execute withdrawal from ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return (\r\n          <>\r\n            Could not decrease {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"},\r\n            {`+${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)}`} USD, Acceptable Price:&nbsp;\r\n            {params.isLong ? \">\" : \"<\"}&nbsp;\r\n            <Tooltip\r\n              position=\"left-top\"\r\n              handle={`${formatAmount(params.acceptablePrice, USD_DECIMALS, 2, true)} USD`}\r\n              renderContent={() => <>Try increasing the \"Allowed Slippage\", under the Settings menu on the top right</>}\r\n            />\r\n          </>\r\n        );\r\n      }\r\n\r\n      if (tradeData.action === \"IncreasePosition-Long\" || tradeData.action === \"IncreasePosition-Short\") {\r\n        if (params.flags?.isOrderExecution) {\r\n          return;\r\n        }\r\n\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Deposit ${formatAmount(params.collateralDelta, USD_DECIMALS, 2, true)} USD into ${\r\n            indexToken.symbol\r\n          } ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n        return `Increase ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, ${indexToken.symbol} Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"DecreasePosition-Long\" || tradeData.action === \"DecreasePosition-Short\") {\r\n        if (params.flags?.isOrderExecution) {\r\n          return;\r\n        }\r\n\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Withdraw ${formatAmount(params.collateralDelta, USD_DECIMALS, 2, true)} USD from ${\r\n            indexToken.symbol\r\n          } ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n        const isLiquidation = params.flags?.isLiquidation;\r\n        const liquidationData = getLiquidationData(liquidationsDataMap, params.key, tradeData.timestamp);\r\n\r\n        if (isLiquidation && liquidationData) {\r\n          return (\r\n            <>\r\n              {renderLiquidationTooltip(liquidationData, \"Partial Liquidation\")} {indexToken.symbol}{\" \"}\r\n              {params.isLong ? \"Long\" : \"Short\"}, -{formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)} USD,{\" \"}\r\n              {indexToken.symbol}&nbsp; Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD\r\n            </>\r\n          );\r\n        }\r\n        const actionDisplay = isLiquidation ? \"Partially Liquidated\" : \"Decreased\";\r\n        return `\r\n        ${actionDisplay} ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"},\r\n        -${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)} USD,\r\n        ${indexToken.symbol} Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD\r\n      `;\r\n      }\r\n\r\n      if (tradeData.action === \"LiquidatePosition-Long\" || tradeData.action === \"LiquidatePosition-Short\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const liquidationData = getLiquidationData(liquidationsDataMap, params.key, tradeData.timestamp);\r\n        if (liquidationData) {\r\n          return (\r\n            <>\r\n              {renderLiquidationTooltip(liquidationData, \"Liquidated\")} {indexToken.symbol}{\" \"}\r\n              {params.isLong ? \"Long\" : \"Short\"}, -{formatAmount(params.size, USD_DECIMALS, 2, true)} USD,&nbsp;\r\n              {indexToken.symbol} Price: ${formatAmount(params.markPrice, USD_DECIMALS, 2, true)} USD\r\n            </>\r\n          );\r\n        }\r\n        return `\r\n        Liquidated ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"},\r\n        -${formatAmount(params.size, USD_DECIMALS, 2, true)} USD,\r\n        ${indexToken.symbol} Price: ${formatAmount(params.markPrice, USD_DECIMALS, 2, true)} USD\r\n      `;\r\n      }\r\n\r\n      if ([\"ExecuteIncreaseOrder\", \"ExecuteDecreaseOrder\"].includes(tradeData.action)) {\r\n        const order = deserialize(params.order);\r\n        const indexToken = getTokenInfo(infoTokens, order.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const longShortDisplay = order.isLong ? \"Long\" : \"Short\";\r\n        const executionPriceDisplay = formatAmount(order.executionPrice, USD_DECIMALS, 2, true);\r\n        const sizeDeltaDisplay = `${order.type === \"Increase\" ? \"+\" : \"-\"}${formatAmount(\r\n          order.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )}`;\r\n\r\n        return `\r\n        Execute Order: ${order.type} ${indexToken.symbol} ${longShortDisplay}\r\n        ${sizeDeltaDisplay} USD, Price: ${executionPriceDisplay} USD\r\n      `;\r\n      }\r\n\r\n      if (\r\n        [\r\n          \"CreateIncreaseOrder\",\r\n          \"CancelIncreaseOrder\",\r\n          \"UpdateIncreaseOrder\",\r\n          \"CreateDecreaseOrder\",\r\n          \"CancelDecreaseOrder\",\r\n          \"UpdateDecreaseOrder\",\r\n        ].includes(tradeData.action)\r\n      ) {\r\n        const order = deserialize(params.order);\r\n        const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const increase = tradeData.action.includes(\"Increase\");\r\n        const priceDisplay = `${order.triggerAboveThreshold ? \">\" : \"<\"} ${formatAmount(\r\n          order.triggerPrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )}`;\r\n        return `\r\n        ${getOrderActionTitle(tradeData.action)}:\r\n        ${getPositionDisplay(increase, indexToken, order.isLong, order.sizeDelta)},\r\n        Price: ${priceDisplay}\r\n      `;\r\n      }\r\n\r\n      if (tradeData.action === \"ExecuteSwapOrder\") {\r\n        const order = deserialize(params.order);\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromToken = getTokenInfo(infoTokens, order.path[0] === nativeTokenAddress ? AddressZero : order.path[0]);\r\n        const toToken = getTokenInfo(infoTokens, order.shouldUnwrap ? AddressZero : order.path[order.path.length - 1]);\r\n        if (!fromToken || !toToken) {\r\n          return defaultMsg;\r\n        }\r\n        const fromAmountDisplay = formatAmount(order.amountIn, fromToken.decimals, fromToken.isStable ? 2 : 4, true);\r\n        const toAmountDisplay = formatAmount(order.amountOut, toToken.decimals, toToken.isStable ? 2 : 4, true);\r\n        return `\r\n        Execute Order: Swap ${fromAmountDisplay} ${fromToken.symbol} for ${toAmountDisplay} ${toToken.symbol}\r\n      `;\r\n      }\r\n\r\n      if ([\"CreateSwapOrder\", \"UpdateSwapOrder\", \"CancelSwapOrder\"].includes(tradeData.action)) {\r\n        const order = deserialize(params.order);\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromToken = getTokenInfo(infoTokens, order.path[0] === nativeTokenAddress ? AddressZero : order.path[0]);\r\n        const toToken = getTokenInfo(infoTokens, order.shouldUnwrap ? AddressZero : order.path[order.path.length - 1]);\r\n        if (!fromToken || !toToken) {\r\n          return defaultMsg;\r\n        }\r\n        const amountInDisplay = fromToken\r\n          ? formatAmount(order.amountIn, fromToken.decimals, fromToken.isStable ? 2 : 4, true)\r\n          : \"\";\r\n        const minOutDisplay = toToken\r\n          ? formatAmount(order.minOut, toToken.decimals, toToken.isStable ? 2 : 4, true)\r\n          : \"\";\r\n\r\n        return `\r\n        ${getOrderActionTitle(tradeData.action)}:\r\n        Swap ${amountInDisplay} ${fromToken?.symbol || \"\"} for ${minOutDisplay} ${toToken?.symbol || \"\"},\r\n        Price: ${getExchangeRateDisplay(order.triggerRatio, fromToken, toToken)}`;\r\n      }\r\n    },\r\n    [getTokenInfo, infoTokens, nativeTokenAddress, chainId, liquidationsDataMap]\r\n  );\r\n\r\n  const tradesWithMessages = useMemo(() => {\r\n    if (!trades) {\r\n      return [];\r\n    }\r\n\r\n    return trades\r\n      .map((trade) => ({\r\n        msg: getMsg(trade),\r\n        ...trade,\r\n      }))\r\n      .filter((trade) => trade.msg);\r\n  }, [trades, getMsg]);\r\n\r\n  return (\r\n    <div className=\"TradeHistory\">\r\n      {tradesWithMessages.length === 0 && <div className=\"TradeHistory-row App-box App-box_no-border Exchange-list-empty-note\">No trades yet</div>}\r\n      {tradesWithMessages.length > 0 &&\r\n        tradesWithMessages.map((trade, index) => {\r\n          const tradeData = trade.data;\r\n          const txUrl = getExplorerUrl(chainId) + \"tx/\" + tradeData.txhash;\r\n\r\n          let msg = getMsg(trade);\r\n\r\n          if (!msg) {\r\n            return null;\r\n          }\r\n\r\n          return (\r\n            <div className=\"TradeHistory-row App-box App-box-border\" key={index}>\r\n              <div>\r\n                <div className=\"muted TradeHistory-time\">\r\n                  {formatDateTime(tradeData.timestamp)}\r\n                  {(!props.dgAddress || props.dgAddress.length === 0) && (\r\n                    <span>\r\n                      {\" \"}\r\n                      (<Link to={`/actions/${tradeData.props.dgAddress}`}>{tradeData.props.dgAddress}</Link>)\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                <a className=\"plain\" href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  {msg}\r\n                </a>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      {shouldShowPaginationButtons && (\r\n        <div>\r\n          {pageIndex > 0 && (\r\n            <button className=\"App-button-option App-card-option\" onClick={loadPrevPage}>\r\n              Prev\r\n            </button>\r\n          )}\r\n          {trades && trades.length >= TRADES_PAGE_SIZE && (\r\n            <button className=\"App-button-option App-card-option\" onClick={loadNextPage}>\r\n              Next\r\n            </button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport \"./ExchangeBanner.css\";\r\n\r\nexport default function ExchangeBanner(props) {\r\n  const { hideBanner } = props;\r\n\r\n  return (\r\n    <div className=\"ExchangeBanner\">\r\n      <p className=\"ExchangeBanner-text\">\r\n        Trade on GMX and win <span className=\"ExchangeBanner-price\">$250.000</span> in prizes! Live until November 30th,{\" \"}\r\n        <a\r\n          href=\"https://medium.com/@gmx.io/gmx-trading-competition-win-250-000-usd-in-prizes-1346504b96f6\"\r\n          target=\"_blank\"\r\n          className=\"ExchangeBanner-link\"\r\n          rel=\"noreferrer\"\r\n        >\r\n          click here\r\n        </a>{\" \"}\r\n        to learn more.\r\n      </p>\r\n      <span\r\n        className=\"ExchangeBanner-close\"\r\n        onClick={(e) => {\r\n          hideBanner();\r\n        }}\r\n      >\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"11.25\" height=\"11.25\" viewBox=\"0 0 11.25 11.25\">\r\n          <path\r\n            id=\"ic_close\"\r\n            d=\"M11-2.565,6.818-6.75,11-10.935a.844.844,0,0,0,0-1.193.844.844,0,0,0-1.193,0L5.625-7.943,1.44-12.128a.844.844,0,0,0-1.193,0,.844.844,0,0,0,0,1.193L4.432-6.75.247-2.565a.844.844,0,0,0,0,1.193.844.844,0,0,0,1.193,0L5.625-5.557,9.81-1.372a.844.844,0,0,0,1.193,0A.844.844,0,0,0,11-2.565Z\"\r\n            transform=\"translate(0 12.375)\"\r\n            fill=\"#fff\"\r\n          />\r\n        </svg>\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport cx from \"classnames\";\r\nimport { t } from \"@lingui/macro\";\r\nimport \"./Footer.css\";\r\nimport logoImg from \"../../img/ic_gmx_footer.svg\";\r\nimport twitterIcon from \"../../img/ic_twitter.svg\";\r\nimport discordIcon from \"../../img/ic_discord.svg\";\r\nimport telegramIcon from \"../../img/ic_telegram.svg\";\r\nimport githubIcon from \"../../img/ic_github.svg\";\r\nimport mediumIcon from \"../../img/ic_medium.svg\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { isHomeSite, getAppBaseUrl, shouldShowRedirectModal } from \"../../lib/legacy\";\r\n\r\nconst footerLinks = {\r\n  home: [\r\n    { text: t`Terms and Conditions`, link: \"/terms-and-conditions\" },\r\n    { text: t`Referral Terms`, link: \"/referral-terms\" },\r\n    { text: t`Media Kit`, link: \"https://gmxio.gitbook.io/gmx/media-kit\", external: true },\r\n    // { text: \"Jobs\", link: \"/jobs\", isAppLink: true },\r\n  ],\r\n  app: [\r\n    { text: t`Media Kit`, link: \"https://gmxio.gitbook.io/gmx/media-kit\", external: true },\r\n    // { text: \"Jobs\", link: \"/jobs\" },\r\n  ],\r\n};\r\n\r\nconst socialLinks = [\r\n  { link: \"https://twitter.com/GMX_IO\", name: \"Twitter\", icon: twitterIcon },\r\n  { link: \"https://medium.com/@gmx.io\", name: \"Medium\", icon: mediumIcon },\r\n  { link: \"https://github.com/gmx-io\", name: \"Github\", icon: githubIcon },\r\n  { link: \"https://t.me/GMX_IO\", name: \"Telegram\", icon: telegramIcon },\r\n  { link: \"https://discord.gg/cxjZYR4gQK\", name: \"Discord\", icon: discordIcon },\r\n];\r\n\r\nexport default function Footer({ showRedirectModal, redirectPopupTimestamp }) {\r\n  const isHome = isHomeSite();\r\n\r\n  return (\r\n    <div className=\"Footer\">\r\n      <div className={cx(\"Footer-wrapper\", { home: isHome })}>\r\n        <div className=\"Footer-logo\">\r\n          <img src={logoImg} alt=\"MetaMask\" />\r\n        </div>\r\n        <div className=\"Footer-social-link-block\">\r\n          {socialLinks.map((platform) => {\r\n            return (\r\n              <a\r\n                key={platform.name}\r\n                className=\"App-social-link\"\r\n                href={platform.link}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                <img src={platform.icon} alt={platform.name} />\r\n              </a>\r\n            );\r\n          })}\r\n        </div>\r\n        <div className=\"Footer-links\">\r\n          {footerLinks[isHome ? \"home\" : \"app\"].map(({ external, text, link, isAppLink }) => {\r\n            if (external) {\r\n              return (\r\n                <a key={text} target=\"_blank\" href={link} className=\"Footer-link\" rel=\"noopener noreferrer\">\r\n                  {text}\r\n                </a>\r\n              );\r\n            }\r\n            if (isAppLink) {\r\n              if (shouldShowRedirectModal(redirectPopupTimestamp)) {\r\n                return (\r\n                  <div key={text} className=\"Footer-link a\" onClick={() => showRedirectModal(link)}>\r\n                    {text}\r\n                  </div>\r\n                );\r\n              } else {\r\n                const baseUrl = getAppBaseUrl();\r\n                return (\r\n                  <a key={text} href={baseUrl + link} className=\"Footer-link\">\r\n                    {text}\r\n                  </a>\r\n                );\r\n              }\r\n            }\r\n            return (\r\n              <NavLink key={link} to={link} className=\"Footer-link\" activeClassName=\"active\">\r\n                {text}\r\n              </NavLink>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport Tooltip from './../Tooltip/Tooltip';\r\nimport { formatAmount } from '../../lib/legacy';\r\nimport { ImSpinner2 } from 'react-icons/im';\r\nimport { t } from '@lingui/macro';\r\nimport { USD_DECIMALS, INCREASE } from './../../lib/legacy';\r\nimport StatsTooltipRow from '../StatsTooltip/StatsTooltipRow';\r\nimport CollateralLocked from './CollateralLocked';\r\nimport { DDL_AccountManagerToken, getDgContract } from '../../../../components/utils/contracts';\r\nimport { DDL_GMX, WETH_address } from './../../../../components/utils/contracts';\r\nimport { useState, useEffect } from 'react';\r\nimport { Trans } from '@lingui/macro';\r\nimport { ethers, BigNumber } from 'ethers';\r\nimport { ADDRESS_ZERO } from '@uniswap/v3-sdk';\r\nimport { separateThousands } from './../../../../components/utils/sepThousands';\r\nimport { BORDER_COEF } from './../../../../components/utils/constants';\r\n\r\nconst BorrowsItem = (props) => {\r\n\tconst {\r\n\t\tposition,\r\n\t\tonPositionClick,\r\n\t\tsetListSection,\r\n\t\tpositionOrders,\r\n\t\tshowPnlAfterFees,\r\n\t\thasPositionProfit,\r\n\t\tpositionDelta,\r\n\t\tborrowState, \r\n\t\tsetBorrowState,\r\n\t\trepayState, \r\n\t\tsetRepayState,\r\n\t\thasOrderError,\r\n\t\tcx,\r\n\t\tdgAddress,\r\n\t\tisModalLoading,\r\n\t\tisLarge,\r\n\t} = props;\r\n\r\n\tconst [curPosition, setCurPosition] = useState(position);\r\n\tconst [borrowed, setBorrowed] = useState(undefined);\r\n\tconst [isLocked, setIsLocked] = useState(false);\r\n\tconst [borrowStep, setBorrowStep] = useState(0);\r\n\tconst [repayStep, setRepayStep] = useState(0);\r\n\tconst [available, setAvailable] = useState(0);\r\n\tconst [liqPrice, setLiqPrice] = useState(null);\r\n\t\r\n\tconst borrowPosition = () => {\r\n\t\tsetBorrowState({\r\n\t\t\tisVisible: true,\r\n\t\t\tposition: curPosition,\r\n\t\t\tstep: borrowStep,\r\n\t\t\tsetStep: setBorrowStep,\r\n\t\t})\r\n\t}\r\n\tconst repayPosition = () => {\r\n\t\tsetRepayState({\r\n\t\t\tisVisible: true,\r\n\t\t\tposition: curPosition,\r\n\t\t\tstep: repayStep,\r\n\t\t\tsetStep: setRepayStep,\r\n\t\t})\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof borrowed !== 'undefined') {\r\n\t\t\tsetBorrowState({\r\n\t\t\t\t...borrowState,\r\n\t\t\t\tstep: borrowStep,\r\n\t\t\t\tposition: curPosition,\r\n\t\t\t})\r\n\t\t\tsetRepayState({\r\n\t\t\t\t...repayState,\r\n\t\t\t\tstep: repayStep,\r\n\t\t\t\tposition: curPosition,\r\n\t\t\t})\r\n\t\t}\r\n\t}, [repayStep, borrowStep])\r\n\r\n\r\n\t// Key id for positions\r\n\tconst DG = getDgContract(dgAddress);\r\n\tuseEffect(() => {\r\n\t\tif (!DG) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tDG.keyByIndexToken((position.indexToken.address === ADDRESS_ZERO ? WETH_address : position.indexToken.address), position.isLong)\r\n\t\t\t.then(id => {\r\n\t\t\t\tposition.ddl.keyId = id;\r\n\r\n\t\t\t\t// Steps\r\n\t\t\t\tDDL_AccountManagerToken.ownerOf(id)\r\n\t\t\t\t\t.then(owner => {\r\n\t\t\t\t\t\tconst isLocked = owner === DDL_GMX.address;\r\n\t\t\t\t\t\tsetIsLocked(isLocked);\r\n\t\t\t\t\t\tif (isLocked) {\r\n\t\t\t\t\t\t\t// Borrowed\r\n\t\t\t\t\t\t\tDDL_GMX.borrowedByCollateral(id)\r\n\t\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t\tposition.ddl.borrowed = res.borrowed;\r\n\t\t\t\t\t\t\t\t\tDDL_GMX.maxBorrowLimit(id)\r\n\t\t\t\t\t\t\t\t\t\t.then(borrowLimit => {\r\n\t\t\t\t\t\t\t\t\t\t\tlet availableRaw = borrowLimit / 10**6 - res.borrowed / 10**6;\r\n\t\t\t\t\t\t\t\t\t\t\tconst multiplier = position.isLong ? 1 + BORDER_COEF : 1 - BORDER_COEF;\r\n\t\t\t\t\t\t\t\t\t\t\tconst entryPrice = position.averagePrice / 10**30;\r\n\t\t\t\t\t\t\t\t\t\t\tconst borderPrice = entryPrice * multiplier;\r\n\t\t\t\t\t\t\t\t\t\t\tconst curPrice = position.markPrice / 10**USD_DECIMALS;\r\n\t\t\t\t\t\t\t\t\t\t\tif (position.isLong) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (curPrice < borderPrice) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavailableRaw = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (curPrice > borderPrice) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavailableRaw = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tconst available = Math.max(availableRaw, 0);\r\n\t\t\t\t\t\t\t\t\t\t\tposition.ddl.available = available;\r\n\t\t\t\t\t\t\t\t\t\t\tsetAvailable(available);\r\n\t\t\t\t\t\t\t\t\t\t\tsetCurPosition(position);\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t// const borrowLimit = (position.hasProfit ? (position.delta / 10**USD_DECIMALS) : 0) / 2;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// Liq.Price\r\n\t\t\t\t\t\t\t\t\tif (res.borrowed.gt(0)) {\r\n\t\t\t\t\t\t\t\t\t\t/* let liqPrice;\r\n\t\t\t\t\t\t\t\t\t\tconst borrowed = res.borrowed / 10**6;\r\n\t\t\t\t\t\t\t\t\t\tconst size = position.size / 10**30;\r\n\t\t\t\t\t\t\t\t\t\tconst entryPrice = position.averagePrice / 10**30;\r\n\t\t\t\t\t\t\t\t\t\tconst amount = size / entryPrice;\r\n\t\t\t\t\t\t\t\t\t\tif (position.isLong) {\r\n\t\t\t\t\t\t\t\t\t\t\tliqPrice = entryPrice + ((borrowed / amount) * 1.2);\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tliqPrice = entryPrice - ((borrowed / amount) * 1.2);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tsetLiqPrice(liqPrice); */\r\n\r\n\t\t\t\t\t\t\t\t\t\tDDL_GMX.currentTriggerPrice(position.ddl.keyId)\r\n\t\t\t\t\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetLiqPrice(res / 10**8)\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tsetLiqPrice(null);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (res.borrowed.gt(0)) {\r\n\t\t\t\t\t\t\t\t\t\tsetRepayStep(0);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tsetRepayStep(1);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tsetBorrowStep(2);\r\n\t\t\t\t\t\t\t\t\tsetBorrowed(res.borrowed);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsetLiqPrice(null);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tDDL_AccountManagerToken.getApproved(id)\r\n\t\t\t\t\t\t\t\t.then(addr => {\r\n\t\t\t\t\t\t\t\t\tposition.ddl.borrowed = BigNumber.from(0);\r\n\t\t\t\t\t\t\t\t\t// const borrowLimit = (position.hasProfit ? (position.delta / 10**USD_DECIMALS) : 0) / 2;\r\n\t\t\t\t\t\t\t\t\tDDL_GMX.maxBorrowLimit(id)\r\n\t\t\t\t\t\t\t\t\t\t.then(borrowLimit => {\r\n\t\t\t\t\t\t\t\t\t\t\tlet availableRaw = borrowLimit / 10**6;\r\n\t\t\t\t\t\t\t\t\t\t\tconst multiplier = position.isLong ? 1 + BORDER_COEF : 1 - BORDER_COEF;\r\n\t\t\t\t\t\t\t\t\t\t\tconst entryPrice = position.averagePrice / 10**30;\r\n\t\t\t\t\t\t\t\t\t\t\tconst borderPrice = entryPrice * multiplier;\r\n\t\t\t\t\t\t\t\t\t\t\tconst curPrice = position.markPrice / 10**USD_DECIMALS;\r\n\t\t\t\t\t\t\t\t\t\t\tif (position.isLong) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (curPrice < borderPrice) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavailableRaw = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (curPrice > borderPrice) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tavailableRaw = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tconst available = Math.max(availableRaw, 0);\r\n\t\t\t\t\t\t\t\t\t\t\tposition.ddl.available = available;\r\n\t\t\t\t\t\t\t\t\t\t\tsetAvailable(available);\r\n\t\t\t\t\t\t\t\t\t\t\tsetCurPosition(position);\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t\t\t\tif (addr === DDL_GMX.address) {\r\n\t\t\t\t\t\t\t\t\t\tsetBorrowStep(1);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tsetBorrowStep(0);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tsetBorrowed(BigNumber.from(0));\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t}, [dgAddress, borrowState, repayState, isModalLoading, position]);\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{isLarge ?\r\n\t\t\t\t<tr>\r\n\t\t\t\t<td className=\"clickable\" onClick={() => onPositionClick(position)}>\r\n\t\t\t\t\t<div className=\"Exchange-list-title\">\r\n\t\t\t\t\t\t{position.indexToken.symbol}\r\n\t\t\t\t\t\t{position.hasPendingChanges && <ImSpinner2 className=\"spin position-loading-icon\" />}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"Exchange-list-info-label\">\r\n\t\t\t\t\t\t{position.leverage && (\r\n\t\t\t\t\t\t\t<span className=\"muted\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<span className={cx({ positive: position.isLong, negative: !position.isLong })}>\r\n\t\t\t\t\t\t\t{position.isLong ? \"Long\" : \"Short\"}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td style={{width: 150, display: 'block'}}>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t{!position.netValue && \"Opening...\"}\r\n\t\t\t\t\t\t{position.netValue && (\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\thandle={`$${formatAmount(position.netValue, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\thandleClassName=\"plain\"\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\tNet Value:{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{showPnlAfterFees\r\n\t\t\t\t\t\t\t\t\t\t\t\t? t`Initial Collateral - Fees + PnL`\r\n\t\t\t\t\t\t\t\t\t\t\t\t: t`Initial Collateral - Borrow Fee + PnL`}\r\n\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel={t`Initial Collateralt`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow label={`PnL`} value={position.deltaBeforeFeesStr} showDollar={false} />\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel={t`Borrow Fee`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel={`Open + Close fee`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.positionFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel={`PnL After Fees`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={`${position.deltaAfterFeesStr} (${position.deltaAfterFeesPercentageStr})`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowDollar={false}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{position.deltaStr && (\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclassName={cx(\"Exchange-list-info-label\", {\r\n\t\t\t\t\t\t\t\tpositive: hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\tnegative: !hasPositionProfit && positionDelta.gt(0),\r\n\t\t\t\t\t\t\t\tmuted: positionDelta.eq(0),\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{position.deltaStr} ({position.deltaPercentageStr})\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t<div>${available.toFixed(2)}</div>\r\n\t\t\t\t\t{positionOrders.length > 0 && (\r\n\t\t\t\t\t\t<div onClick={() => setListSection && setListSection(\"Orders\")}>\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\thandle={`Orders (${positionOrders.length})`}\r\n\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\thandleClassName={cx(\r\n\t\t\t\t\t\t\t\t\t[\"Exchange-list-info-label\", \"Exchange-position-list-orders\", \"plain\", \"clickable\"],\r\n\t\t\t\t\t\t\t\t\t{ muted: !hasOrderError, negative: hasOrderError }\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<strong>Active Orders</strong>\r\n\t\t\t\t\t\t\t\t\t\t\t{positionOrders.map((order) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`${order.isLong}-${order.type}-${order.index}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"Position-list-order\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.triggerAboveThreshold ? \">\" : \"<\"}{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatAmount(order.triggerPrice, 30, 2, true)}:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.type === INCREASE ? \" +\" : \" -\"}${formatAmount(order.sizeDelta, 30, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{order.error && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t, <span className=\"negative\">{order.error}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</td>\r\n\t\t\t\t<td>\r\n\t\t\t\t\t${borrowed ? formatAmount(borrowed, 6, 2, true) : '...'}\r\n\t\t\t\t</td>\r\n\t\t\t\t<td className=\"\" onClick={() => {\r\n\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\thandle={`$${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\thandleClassName=\"plain\"\r\n\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\tClick on a row to select the position's market, then use the swap box to increase your\r\n\t\t\t\t\t\t\t\t\tposition size if needed.\r\n\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\tUse the \"Close\" button to reduce your position size, or to set stop-loss / take-profit orders.\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td className=\"\" onClick={() => {\r\n\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}}>\r\n\t\t\t\t\t{liqPrice ? `$${separateThousands(liqPrice.toFixed(2))}` : ''}\r\n\t\t\t\t</td>\r\n\t\t\t\t<td className=\"\" onClick={() => {\r\n\t\t\t\t\t// onPositionClick(position)\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}}>\r\n\t\t\t\t\t{'10.00%'}\r\n\t\t\t\t</td>\r\n\t\r\n\t\t\t\t<td className=\"td-btn pos-relative\">\r\n\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\tclassName={\"btn-tooltip nowrap\" + ((typeof borrowed === 'undefined' || !position.hasProfit || available <= 0) ? \"\" : \" hidden\")}\r\n\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\thandle=\"\"\r\n\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<span className='spacing'>Y</span>ou can borrow when <br className='br-mobile' />the price is {position.isLong ? 'above' : 'below'} ${separateThousands(((position.averagePrice / 10**30) * (position.isLong ? (1 + BORDER_COEF) : (1 - BORDER_COEF))))}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}} />\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\tonClick={() => borrowPosition(position)}\r\n\t\t\t\t\t\tdisabled={((typeof borrowed === 'undefined') || !position.hasProfit || available <= 0)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tBorrow\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td className=\"td-btn\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName=\"Exchange-list-action\"\r\n\t\t\t\t\t\tonClick={() => repayPosition(position)}\r\n\t\t\t\t\t\tdisabled={typeof borrowed === 'undefined' || !isLocked}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tRepay\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</td>\r\n\t\t\t\t<td className=\"td-btn\">\r\n\t\t\t\t\t{isLocked &&\r\n\t\t\t\t\t\t<CollateralLocked />}\r\n\t\t\t\t</td>\r\n\t\t\t</tr>\r\n\t\t\t:\r\n\t\t\t<div className=\"App-card\">\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-content\">\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Position</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div className=\"Exchange-list-token\">{position.indexToken.symbol}</div>\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tclassName={cx(\"Exchange-list-side\", {\r\n\t\t\t\t\t\t\t\t\tpositive: position.isLong,\r\n\t\t\t\t\t\t\t\t\tnegative: !position.isLong,\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t><span className=\"Exchange-list-leverage\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n\t\t\t\t\t\t\t\t{position.isLong ? t`Long` : t`Short`}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Net Value</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\thandle={`$${formatAmount(position.netValue, USD_DECIMALS, 2, true)}`}\r\n\t\t\t\t\t\t\t\tposition=\"right-bottom\"\r\n\t\t\t\t\t\t\t\thandleClassName=\"plain\"\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\tNet Value:{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{showPnlAfterFees\r\n\t\t\t\t\t\t\t\t\t\t\t\t? \"Initial Collateral - Fees + PnL\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"Initial Collateral - Borrow Fee + PnL\"}\r\n\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Initial Collateral\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow label=\"PnL\" value={position.deltaBeforeFeesStr} showDollar={false} />\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Borrow Fee\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Open + Close fee\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={formatAmount(position.positionFee, USD_DECIMALS, 2, true)}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<StatsTooltipRow\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"PnL After Fees\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={`${position.deltaAfterFeesStr} (${position.deltaAfterFeesPercentageStr})`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tshowDollar={false}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Available</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${available.toFixed(2)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Debt</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(borrowed, 6, 2, true)}</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-content\">\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Mark Price</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\tclassName=\"has-hint-tooltip nowrap\"\r\n\t\t\t\t\t\t\t\thandle=\"Liq. Price\"\r\n\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\tIf the price reaches this price<br /> your loan will be liquidated\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>{liqPrice ? `$${separateThousands(liqPrice.toFixed(2))}` : ''}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"App-card-row\">\r\n\t\t\t\t\t\t<div className=\"label\">\r\n\t\t\t\t\t\t\t<Trans>Borrow APR</Trans>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>{'10.00%'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"App-card-divider\"></div>\r\n\t\t\t\t<div className=\"App-card-options\">\r\n\t\t\t\t\t<div className=\"pos-relative App-button-option\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName={\"btn-tooltip nowrap\" + ((typeof borrowed === 'undefined' || !position.hasProfit || available <= 0) ? \"\" : \" hidden\")}\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\thandle=\"\"\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<span className='spacing'>Y</span>ou can borrow when <br className='br-mobile' />the price is {position.isLong ? 'above' : 'below'} ${separateThousands(((position.averagePrice / 10**30) * (position.isLong ? (1 + BORDER_COEF) : (1 - BORDER_COEF))))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}} />\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"App-button-option App-card-option\"\r\n\t\t\t\t\t\t\tdisabled={((typeof borrowed === 'undefined') || !position.hasProfit || available <= 0)}\r\n\t\t\t\t\t\t\tonClick={() => borrowPosition()}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Trans>Borrow</Trans>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName=\"App-button-option App-card-option\"\r\n\t\t\t\t\t\tdisabled={typeof borrowed === 'undefined' || !isLocked}\r\n\t\t\t\t\t\tonClick={() => repayPosition()}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tRepay\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{isLocked &&\r\n\t\t\t\t\t\t<CollateralLocked />}\r\n\t\t\t\t</div>\r\n\t\t\t</div>}\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default BorrowsItem;","import React, { useState, useEffect } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport PositionSeller from \"./PositionSeller\";\r\nimport PositionEditor from \"./PositionEditor\";\r\nimport OrdersToa from \"./OrdersToa\";\r\n\r\nimport {\r\n  helperToast,\r\n  bigNumberify,\r\n  getLiquidationPrice,\r\n  getUsd,\r\n  getLeverage,\r\n  formatAmount,\r\n  getOrderError,\r\n  USD_DECIMALS,\r\n  FUNDING_RATE_PRECISION,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  INCREASE,\r\n  DECREASE,\r\n} from \"../../lib/legacy\";\r\nimport PositionShare from \"./PositionShare\";\r\nimport BorrowModal from './../../../../components/UI/modal/BorrowModal';\r\nimport RepayModal from './../../../../components/UI/modal/RepayModal';\r\nimport BorrowsItem from \"./BorrowsItem\";\r\nimport Tooltip from './../Tooltip/Tooltip';\r\n\r\nconst getOrdersForPosition = (account, position, orders, nativeTokenAddress) => {\r\n  if (!orders || orders.length === 0) {\r\n    return [];\r\n  }\r\n  /* eslint-disable array-callback-return */\r\n  return orders\r\n    .filter((order) => {\r\n      if (order.type === SWAP) {\r\n        return false;\r\n      }\r\n      const hasMatchingIndexToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      const hasMatchingCollateralToken =\r\n        order.collateralToken === nativeTokenAddress\r\n          ? position.collateralToken.isNative\r\n          : order.collateralToken === position.collateralToken.address;\r\n      if (order.isLong === position.isLong && hasMatchingIndexToken && hasMatchingCollateralToken) {\r\n        return true;\r\n      }\r\n    })\r\n    .map((order) => {\r\n      order.error = getOrderError(account, order, undefined, position);\r\n      if (order.type === DECREASE && order.sizeDelta.gt(position.size)) {\r\n        order.error = \"Order size is bigger than position, will only be executable if position increases\";\r\n      }\r\n      return order;\r\n    });\r\n};\r\n\r\nexport default function BorrowsList(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positions,\r\n    positionsDataIsLoading,\r\n    positionsMap,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    setListSection,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    setIsWaitingForPluginApproval,\r\n    approveOrderBook,\r\n    isPluginApproving,\r\n    isWaitingForPluginApproval,\r\n    orderBookApproved,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    showPnlAfterFees,\r\n    setMarket,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    dgAddress,\r\n  } = props;\r\n\r\n  const [positionToEditKey, setPositionToEditKey] = useState(undefined);\r\n  const [positionToSellKey, setPositionToSellKey] = useState(undefined);\r\n  const [positionToShare, setPositionToShare] = useState(null);\r\n  const [isPositionEditorVisible, setIsPositionEditorVisible] = useState(undefined);\r\n  const [isPositionSellerVisible, setIsPositionSellerVisible] = useState(undefined);\r\n  const [collateralTokenAddress, setCollateralTokenAddress] = useState(undefined);\r\n  const [isPositionShareModalOpen, setIsPositionShareModalOpen] = useState(false);\r\n  const [ordersToaOpen, setOrdersToaOpen] = useState(false);\r\n  const [isHigherSlippageAllowed, setIsHigherSlippageAllowed] = useState(false);\r\n  \r\n  const [isModalLoading, setIsModalLoading] = useState(false);\r\n  const [borrowState, setBorrowState] = useState({\r\n\t\tisVisible: false,\r\n\t\tposition: {},\r\n\t\tstep: 0,\r\n\t})\r\n  const [repayState, setRepayState] = useState({\r\n\t\tisVisible: false,\r\n\t\tposition: {},\r\n\t\tstep: 0,\r\n\t})\r\n  const setBorrowVisible = (bool) => {\r\n\t\tsetBorrowState({\r\n\t\t\t...borrowState,\r\n\t\t\tisVisible: bool\r\n\t\t})\r\n\t}\r\n  const setRepayVisible = (bool) => {\r\n\t\tsetRepayState({\r\n\t\t\t...repayState,\r\n\t\t\tisVisible: bool\r\n\t\t})\r\n\t}\r\n\r\n  const onPositionClick = (position) => {\r\n    helperToast.success(`${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol} market selected`);\r\n    setMarket(position.isLong ? LONG : SHORT, position.indexToken.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"PositionsList BorrowsList\">\r\n      <PositionEditor\r\n        pendingPositions={pendingPositions}\r\n        setPendingPositions={setPendingPositions}\r\n        positionsMap={positionsMap}\r\n        positionKey={positionToEditKey}\r\n        isVisible={isPositionEditorVisible}\r\n        setIsVisible={setIsPositionEditorVisible}\r\n        infoTokens={infoTokens}\r\n        active={active}\r\n        account={account}\r\n        library={library}\r\n        collateralTokenAddress={collateralTokenAddress}\r\n        pendingTxns={pendingTxns}\r\n        setPendingTxns={setPendingTxns}\r\n        getUsd={getUsd}\r\n        getLeverage={getLeverage}\r\n        savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n        positionRouterApproved={positionRouterApproved}\r\n        isPositionRouterApproving={isPositionRouterApproving}\r\n        isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n        approvePositionRouter={approvePositionRouter}\r\n        chainId={chainId}\r\n        minExecutionFee={minExecutionFee}\r\n        minExecutionFeeUSD={minExecutionFeeUSD}\r\n        minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n      />\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionShareModalOpen && (\r\n        <PositionShare\r\n          setIsPositionShareModalOpen={setIsPositionShareModalOpen}\r\n          isPositionShareModalOpen={isPositionShareModalOpen}\r\n          positionToShare={positionToShare}\r\n          chainId={chainId}\r\n          account={account}\r\n        />\r\n      )}\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionSellerVisible && (\r\n        <PositionSeller\r\n          pendingPositions={pendingPositions}\r\n          setPendingPositions={setPendingPositions}\r\n          setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n          isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n          orderBookApproved={orderBookApproved}\r\n          positionsMap={positionsMap}\r\n          positionKey={positionToSellKey}\r\n          isVisible={isPositionSellerVisible}\r\n          setIsVisible={setIsPositionSellerVisible}\r\n          infoTokens={infoTokens}\r\n          active={active}\r\n          account={account}\r\n          orders={orders}\r\n          library={library}\r\n          pendingTxns={pendingTxns}\r\n          setPendingTxns={setPendingTxns}\r\n          flagOrdersEnabled={flagOrdersEnabled}\r\n          savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n          chainId={chainId}\r\n          nativeTokenAddress={nativeTokenAddress}\r\n          setOrdersToaOpen={setOrdersToaOpen}\r\n          positionRouterApproved={positionRouterApproved}\r\n          isPositionRouterApproving={isPositionRouterApproving}\r\n          isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n          approvePositionRouter={approvePositionRouter}\r\n          isHigherSlippageAllowed={isHigherSlippageAllowed}\r\n          setIsHigherSlippageAllowed={setIsHigherSlippageAllowed}\r\n          minExecutionFee={minExecutionFee}\r\n          minExecutionFeeUSD={minExecutionFeeUSD}\r\n          minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n          usdgSupply={usdgSupply}\r\n          totalTokenWeights={totalTokenWeights}\r\n        />\r\n      )}\r\n      {positions && (\r\n        <div className=\"Exchange-list small\">\r\n          <div>\r\n            {positions.length === 0 && positionsDataIsLoading && (\r\n              <div className=\"Exchange-empty-positions-list-note App-card\">\r\n                <Trans>Loading...</Trans>\r\n              </div>\r\n            )}\r\n            {positions.length === 0 && !positionsDataIsLoading && (\r\n              <div className=\"Exchange-empty-positions-list-note App-card Exchange-list-empty-note\">\r\n                <Trans>No open positions</Trans>\r\n              </div>\r\n            )}\r\n            {positions.map((position) => {\r\n              const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n              const liquidationPrice = getLiquidationPrice(position);\r\n              const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n              const positionDelta =\r\n                position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n              let borrowFeeUSD;\r\n              if (position.collateralToken && position.collateralToken.fundingRate) {\r\n                const borrowFeeRate = position.collateralToken.fundingRate\r\n                  .mul(position.size)\r\n                  .mul(24)\r\n                  .div(FUNDING_RATE_PRECISION);\r\n                borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n              }\r\n\r\n              return (\r\n                <BorrowsItem\r\n                  key={position.key}\r\n                  position={position}\r\n                  onPositionClick={onPositionClick}\r\n                  setListSection={setListSection}\r\n                  positionOrders={positionOrders}\r\n                  showPnlAfterFees={showPnlAfterFees}\r\n                  hasPositionProfit={hasPositionProfit}\r\n                  positionDelta={positionDelta}\r\n                  borrowState={borrowState}\r\n                  setBorrowState={setBorrowState}\r\n                  repayState={repayState}\r\n                  setRepayState={setRepayState}\r\n                  liquidationPrice={liquidationPrice}\r\n                  cx={cx}\r\n                  dgAddress={dgAddress}\r\n                  isModalLoading={isModalLoading}\r\n                  isLarge={false}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      <table className=\"Exchange-list large App-box\">\r\n        <tbody>\r\n          {positions.length > 0 && (\r\n            <tr className=\"Exchange-list-header\">\r\n              <th>\r\n                <Trans>Position</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Net Value</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Available</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Debt</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>Mark Price</Trans>\r\n              </th>\r\n              <th>\r\n                <Tooltip\r\n                  className=\"has-hint-tooltip nowrap\"\r\n                  handle=\"Liq. Price\"\r\n                  position=\"left-bottom\"\r\n                  enabled={true}\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div>\r\n                        If the price reaches this price<br /> your loan will be liquidated\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </th>\r\n              <th>\r\n                <Trans>Borrow APR</Trans>\r\n              </th>\r\n              <th></th>\r\n              <th></th>\r\n            </tr>\r\n          )}\r\n          {positions.length === 0 && positionsDataIsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\">\r\n                <div className=\"Exchange-empty-positions-list-note\">Loading...</div>\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {positions.length === 0 && !positionsDataIsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\" className=\"Exchange-list-empty-note\">\r\n                No open positions\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {positions.map((position) => {\r\n            const liquidationPrice = getLiquidationPrice(position) || bigNumberify(0);\r\n            const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n            const hasOrderError = !!positionOrders.find((order) => order.error);\r\n            const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n            const positionDelta =\r\n              position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n            let borrowFeeUSD;\r\n            if (position.collateralToken && position.collateralToken.fundingRate) {\r\n              const borrowFeeRate = position.collateralToken.fundingRate\r\n                .mul(position.size)\r\n                .mul(24)\r\n                .div(FUNDING_RATE_PRECISION);\r\n              borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n            }\r\n            \r\n\r\n            return (\r\n              <BorrowsItem\r\n                key={position.key}\r\n                position={position}\r\n                onPositionClick={onPositionClick}\r\n                setListSection={setListSection}\r\n                positionOrders={positionOrders}\r\n                showPnlAfterFees={showPnlAfterFees}\r\n                hasPositionProfit={hasPositionProfit}\r\n                positionDelta={positionDelta}\r\n                borrowState={borrowState}\r\n                setBorrowState={setBorrowState}\r\n                repayState={repayState}\r\n                setRepayState={setRepayState}\r\n                hasOrderError={hasOrderError}\r\n                liquidationPrice={liquidationPrice}\r\n                cx={cx}\r\n                dgAddress={dgAddress}\r\n                isModalLoading={isModalLoading}\r\n                isLarge={true}\r\n                 />\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n\r\n      {!!positions.length &&\r\n        (<BorrowModal\r\n          state={borrowState}\r\n          setVisible={setBorrowVisible}\r\n          isLoading={isModalLoading}\r\n          setIsLoading={setIsModalLoading}\r\n          />)}\r\n      {!!positions.length &&\r\n        (<RepayModal\r\n          state={repayState}\r\n          setVisible={setRepayVisible}\r\n          isLoading={isModalLoading}\r\n          setIsLoading={setIsModalLoading}\r\n          />)}\r\n    </div>\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nconst AttentionBox = (props) => {\r\n\tconst {\r\n\t\ttitle,\r\n\t\tclassName,\r\n\t\tchildren,\r\n\t} = props;\r\n\t\r\n\treturn (\r\n\t\t<div className={\"App-box Attention-box\" + (className ? ` ${className}` : '')}>\r\n\t\t\t<h2 className=\"Attention-box__title\">{title ?? 'Attention'}</h2>\r\n\t\t\t<div className=\"Attention-box__body\">\r\n\t\t\t\t{children}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AttentionBox;","import React from 'react';\r\nimport Currency from './Currency';\r\nimport Tooltip from './../views/gmx-test/components/Tooltip/Tooltip';\r\nimport cx from 'classnames';\r\n\r\nconst MarginLevel = ({ children, className }) => {\r\n\tconst cls = cx(\"App-box Margin-level\", className);\r\n\t\r\n\treturn (\r\n\t\t<div className={cls}>\r\n\t\t\t<h1>Margin level</h1>\r\n\t\t\t<div className=\"text-table\">\r\n\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t<div className=\"text-table__left\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName=\"has-hint-tooltip margin-tooltip nowrap\"\r\n\t\t\t\t\t\t\thandle=\"Min. Maintenance margin\"\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tThe margin required tomaintain <br className='br-mobile' />your current <br className='br-desktop' />positions. Ifyour current <br className='br-mobile' />margin balance falls <br className='br-desktop' />below<br className='br-mobile' />Min. Maintenance Margin, your <br className='br-mobile' />margin <br className='br-desktop' />account will beliquidated <br className='br-mobile' />torepay the debt\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"text-table__right\">\r\n\t\t\t\t\t\t<Currency>1000</Currency>\r\n\t\t\t\t\t\t<span className=\"red\">(10%)</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t<div className=\"text-table__left\">\r\n\t\t\t\t\t\tCurrent Margin Balance\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"text-table__right\">\r\n\t\t\t\t\t\t<Currency>1000</Currency>\r\n\t\t\t\t\t\t<span className=\"green\">(35%)</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t<div className=\"Margin-level__ruler ruler\">\r\n\t\t\t\t<div className=\"ruler__body-container\">\r\n\t\t\t\t\t<div className=\"ruler__body ruler__body_low\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName=\"nowrap\"\r\n\t\t\t\t\t\t\thandle=\"10%\"\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tYour position will be liquidated if margin <br />maintenance margin is below 10%\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ruler__body ruler__body_med\">\r\n\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\tclassName=\"nowrap\"\r\n\t\t\t\t\t\t\thandle=\"30%\"\r\n\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\tKeep above 30% for lower risk\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ruler__body ruler__body_high\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"ruler__pointer\"></div>\r\n\t\t\t</div>\r\n\t\t\t{children}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MarginLevel;","import React, { useEffect, useState, useMemo, useCallback, forwardRef, useImperativeHandle } from \"react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport cx from \"classnames\";\r\nimport { BigNumber } from \"ethers\";\r\n\r\nimport {\r\n  FUNDING_RATE_PRECISION,\r\n  BASIS_POINTS_DIVISOR,\r\n  MARGIN_FEE_BASIS_POINTS,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  USD_DECIMALS,\r\n  getExplorerUrl,\r\n  helperToast,\r\n  formatAmount,\r\n  bigNumberify,\r\n  getTokenInfo,\r\n  getPositionKey,\r\n  getPositionContractKey,\r\n  getLeverage,\r\n  useLocalStorageSerializeKey,\r\n  useLocalStorageByChainId,\r\n  getDeltaStr,\r\n  useChainId,\r\n  useAccountOrders,\r\n  getPageTitle,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { approvePlugin, useInfoTokens, useMinExecutionFee, cancelMultipleOrders } from \"../../domain/legacy\";\r\n\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport { getTokens, getToken, getWhitelistedTokens, getTokenBySymbol } from \"../../config/Tokens\";\r\n\r\nimport Reader from \"../../abis/ReaderV2.json\";\r\nimport VaultV2 from \"../../abis/VaultV2.json\";\r\nimport Router from \"../../abis/Router.json\";\r\nimport Token from \"../../abis/Token.json\";\r\n\r\nimport Checkbox from \"../../components/Checkbox/Checkbox\";\r\nimport SwapBox from \"../../components/Exchange/SwapBox\";\r\nimport ExchangeTVChart, { getChartToken } from \"../../components/Exchange/ExchangeTVChart\";\r\nimport PositionsList from \"../../components/Exchange/PositionsList\";\r\nimport OrdersList from \"../../components/Exchange/OrdersList\";\r\nimport TradeHistory from \"../../components/Exchange/TradeHistory\";\r\nimport ExchangeWalletTokens from \"../../components/Exchange/ExchangeWalletTokens\";\r\nimport ExchangeBanner from \"../../components/Exchange/ExchangeBanner\";\r\nimport Tab from \"../../components/Tab/Tab\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\n\r\nimport \"./Exchange.scss\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport BorrowsList from './../../components/Exchange/BorrowsList';\r\nimport { DDL_AccountManager, USDC } from \"../../../../components/utils/contracts\";\r\nimport ReturnFundsBox from './../../components/Exchange/ReturnFundsBox';\r\nimport { getDgContract, DDL_GMX } from './../../../../components/utils/contracts';\r\nimport { ARBITRUM } from './../../lib/legacy';\r\nimport Modal from './../../../../components/UI/modal/Modal';\r\nimport Button from './../../../../components/UI/button/Button';\r\nimport MarginLevel from './../../../../components/MarginLevel';\r\n\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nconst PENDING_POSITION_VALID_DURATION = 600 * 1000;\r\nconst UPDATED_POSITION_VALID_DURATION = 60 * 1000;\r\n\r\nconst notifications = {};\r\n\r\nfunction pushSuccessNotification(chainId, message, e) {\r\n  const { transactionHash } = e;\r\n  const id = ethers.utils.id(message + transactionHash);\r\n  if (notifications[id]) {\r\n    return;\r\n  }\r\n\r\n  notifications[id] = true;\r\n\r\n  const txUrl = getExplorerUrl(chainId) + \"tx/\" + transactionHash;\r\n  helperToast.success(\r\n    <div>\r\n      {message}{\" \"}\r\n      <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        View\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction pushErrorNotification(chainId, message, e) {\r\n  const { transactionHash } = e;\r\n  const id = ethers.utils.id(message + transactionHash);\r\n  if (notifications[id]) {\r\n    return;\r\n  }\r\n\r\n  notifications[id] = true;\r\n\r\n  const txUrl = getExplorerUrl(chainId) + \"tx/\" + transactionHash;\r\n  helperToast.error(\r\n    <div>\r\n      {message}{\" \"}\r\n      <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        View\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getFundingFee(data) {\r\n  let { entryFundingRate, cumulativeFundingRate, size } = data;\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    return size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n  }\r\n  return;\r\n}\r\n\r\nconst getTokenAddress = (token, nativeTokenAddress) => {\r\n  if (token.address === AddressZero) {\r\n    return nativeTokenAddress;\r\n  }\r\n  return token.address;\r\n};\r\n\r\nfunction applyPendingChanges(position, pendingPositions) {\r\n  if (!pendingPositions) {\r\n    return;\r\n  }\r\n  const { key } = position;\r\n\r\n  if (\r\n    pendingPositions[key] &&\r\n    pendingPositions[key].updatedAt &&\r\n    pendingPositions[key].pendingChanges &&\r\n    pendingPositions[key].updatedAt + PENDING_POSITION_VALID_DURATION > Date.now()\r\n  ) {\r\n    const { pendingChanges } = pendingPositions[key];\r\n    if (pendingChanges.size && position.size.eq(pendingChanges.size)) {\r\n      return;\r\n    }\r\n\r\n    if (pendingChanges.expectingCollateralChange && !position.collateral.eq(pendingChanges.collateralSnapshot)) {\r\n      return;\r\n    }\r\n\r\n    position.hasPendingChanges = true;\r\n    position.pendingChanges = pendingChanges;\r\n  }\r\n}\r\n\r\nexport function getPositions(\r\n  chainId,\r\n  positionQuery,\r\n  positionData,\r\n  infoTokens,\r\n  includeDelta,\r\n  showPnlAfterFees,\r\n  account,\r\n  pendingPositions,\r\n  updatedPositions,\r\n) {\r\n  const propsLength = getConstant(chainId, \"positionReaderPropsLength\");\r\n  const positions = [];\r\n  const positionsMap = {};\r\n  if (!positionData) {\r\n    return { positions, positionsMap };\r\n  }\r\n  const { collateralTokens, indexTokens, isLong } = positionQuery;\r\n  for (let i = 0; i < collateralTokens.length; i++) {\r\n    const collateralToken = getTokenInfo(infoTokens, collateralTokens[i], true, getContract(chainId, \"NATIVE_TOKEN\"));\r\n    const indexToken = getTokenInfo(infoTokens, indexTokens[i], true, getContract(chainId, \"NATIVE_TOKEN\"));\r\n    const key = getPositionKey(account, collateralTokens[i], indexTokens[i], isLong[i]);\r\n    let contractKey;\r\n    if (account) {\r\n      contractKey = getPositionContractKey(account, collateralTokens[i], indexTokens[i], isLong[i]);\r\n    }\r\n\r\n\r\n    const position = {\r\n      key,\r\n      contractKey,\r\n      collateralToken,\r\n      indexToken,\r\n      isLong: isLong[i],\r\n      size: positionData[i * propsLength],\r\n      collateral: positionData[i * propsLength + 1],\r\n      averagePrice: positionData[i * propsLength + 2],\r\n      entryFundingRate: positionData[i * propsLength + 3],\r\n      cumulativeFundingRate: collateralToken.cumulativeFundingRate,\r\n      hasRealisedProfit: positionData[i * propsLength + 4].eq(1),\r\n      realisedPnl: positionData[i * propsLength + 5],\r\n      lastIncreasedTime: positionData[i * propsLength + 6].toNumber(),\r\n      hasProfit: positionData[i * propsLength + 7].eq(1),\r\n      delta: positionData[i * propsLength + 8],\r\n      markPrice: isLong[i] ? indexToken.minPrice : indexToken.maxPrice,\r\n      ddl: {},\r\n    };\r\n\r\n\r\n    if (\r\n      updatedPositions &&\r\n      updatedPositions[key] &&\r\n      updatedPositions[key].updatedAt &&\r\n      updatedPositions[key].updatedAt + UPDATED_POSITION_VALID_DURATION > Date.now()\r\n    ) {\r\n      const updatedPosition = updatedPositions[key];\r\n      position.size = updatedPosition.size;\r\n      position.collateral = updatedPosition.collateral;\r\n      position.averagePrice = updatedPosition.averagePrice;\r\n      position.entryFundingRate = updatedPosition.entryFundingRate;\r\n    }\r\n\r\n    let fundingFee = getFundingFee(position);\r\n    position.fundingFee = fundingFee ? fundingFee : bigNumberify(0);\r\n    position.collateralAfterFee = position.collateral.sub(position.fundingFee);\r\n\r\n    position.closingFee = position.size.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    position.positionFee = position.size.mul(MARGIN_FEE_BASIS_POINTS).mul(2).div(BASIS_POINTS_DIVISOR);\r\n    position.totalFees = position.positionFee.add(position.fundingFee);\r\n\r\n    position.pendingDelta = position.delta;\r\n\r\n    if (position.collateral.gt(0)) {\r\n      position.hasLowCollateral =\r\n        position.collateralAfterFee.lt(0) || position.size.div(position.collateralAfterFee.abs()).gt(50);\r\n\r\n      if (position.averagePrice && position.markPrice) {\r\n        const priceDelta = position.averagePrice.gt(position.markPrice)\r\n          ? position.averagePrice.sub(position.markPrice)\r\n          : position.markPrice.sub(position.averagePrice);\r\n        position.pendingDelta = position.size.mul(priceDelta).div(position.averagePrice);\r\n\r\n        position.delta = position.pendingDelta;\r\n\r\n        if (position.isLong) {\r\n          position.hasProfit = position.markPrice.gte(position.averagePrice);\r\n        } else {\r\n          position.hasProfit = position.markPrice.lte(position.averagePrice);\r\n        }\r\n      }\r\n\r\n      position.deltaPercentage = position.pendingDelta.mul(BASIS_POINTS_DIVISOR).div(position.collateral);\r\n\r\n      const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n        delta: position.pendingDelta,\r\n        deltaPercentage: position.deltaPercentage,\r\n        hasProfit: position.hasProfit,\r\n      });\r\n\r\n      position.deltaStr = deltaStr;\r\n      position.deltaPercentageStr = deltaPercentageStr;\r\n      position.deltaBeforeFeesStr = deltaStr;\r\n\r\n      let hasProfitAfterFees;\r\n      let pendingDeltaAfterFees;\r\n\r\n      if (position.hasProfit) {\r\n        if (position.pendingDelta.gt(position.totalFees)) {\r\n          hasProfitAfterFees = true;\r\n          pendingDeltaAfterFees = position.pendingDelta.sub(position.totalFees);\r\n        } else {\r\n          hasProfitAfterFees = false;\r\n          pendingDeltaAfterFees = position.totalFees.sub(position.pendingDelta);\r\n        }\r\n      } else {\r\n        hasProfitAfterFees = false;\r\n        pendingDeltaAfterFees = position.pendingDelta.add(position.totalFees);\r\n      }\r\n\r\n      position.hasProfitAfterFees = hasProfitAfterFees;\r\n      position.pendingDeltaAfterFees = pendingDeltaAfterFees;\r\n      position.deltaPercentageAfterFees = position.pendingDeltaAfterFees\r\n        .mul(BASIS_POINTS_DIVISOR)\r\n        .div(position.collateral);\r\n\r\n      const { deltaStr: deltaAfterFeesStr, deltaPercentageStr: deltaAfterFeesPercentageStr } = getDeltaStr({\r\n        delta: position.pendingDeltaAfterFees,\r\n        deltaPercentage: position.deltaPercentageAfterFees,\r\n        hasProfit: hasProfitAfterFees,\r\n      });\r\n\r\n      position.deltaAfterFeesStr = deltaAfterFeesStr;\r\n      position.deltaAfterFeesPercentageStr = deltaAfterFeesPercentageStr;\r\n\r\n      if (showPnlAfterFees) {\r\n        position.deltaStr = position.deltaAfterFeesStr;\r\n        position.deltaPercentageStr = position.deltaAfterFeesPercentageStr;\r\n      }\r\n\r\n      let netValue = position.hasProfit\r\n        ? position.collateral.add(position.pendingDelta)\r\n        : position.collateral.sub(position.pendingDelta);\r\n\r\n      netValue = netValue.sub(position.fundingFee);\r\n\r\n      if (showPnlAfterFees) {\r\n        netValue = netValue.sub(position.closingFee);\r\n      }\r\n\r\n      position.netValue = netValue;\r\n    }\r\n\r\n    position.leverage = getLeverage({\r\n      size: position.size,\r\n      collateral: position.collateral,\r\n      entryFundingRate: position.entryFundingRate,\r\n      cumulativeFundingRate: position.cumulativeFundingRate,\r\n      hasProfit: position.hasProfit,\r\n      delta: position.delta,\r\n      includeDelta,\r\n    });\r\n\r\n    positionsMap[key] = position;\r\n\r\n    applyPendingChanges(position, pendingPositions);\r\n\r\n    if (position.size.gt(0) || position.hasPendingChanges) {\r\n      positions.push(position);\r\n    }\r\n  }\r\n\r\n  return { positions, positionsMap };\r\n}\r\n\r\nexport function getPositionQuery(tokens, nativeTokenAddress) {\r\n  const collateralTokens = [];\r\n  const indexTokens = [];\r\n  const isLong = [];\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = tokens[i];\r\n    if (token.isStable) {\r\n      continue;\r\n    }\r\n    if (token.isWrapped) {\r\n      continue;\r\n    }\r\n    collateralTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n    indexTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n    isLong.push(true);\r\n  }\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const stableToken = tokens[i];\r\n    if (!stableToken.isStable) {\r\n      continue;\r\n    }\r\n\r\n    for (let j = 0; j < tokens.length; j++) {\r\n      const token = tokens[j];\r\n      if (token.isStable) {\r\n        continue;\r\n      }\r\n      if (token.isWrapped) {\r\n        continue;\r\n      }\r\n      collateralTokens.push(stableToken.address);\r\n      indexTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n      isLong.push(false);\r\n    }\r\n  }\r\n\r\n  return { collateralTokens, indexTokens, isLong };\r\n}\r\n\r\nexport const Exchange = forwardRef((props, ref) => {\r\n  const {\r\n    savedIsPnlInLeverage,\r\n    setSavedIsPnlInLeverage,\r\n    savedShowPnlAfterFees,\r\n    savedSlippageAmount,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    savedShouldShowPositionLines,\r\n    setSavedShouldShowPositionLines,\r\n    connectWallet,\r\n    savedShouldDisableValidationForTesting,\r\n  } = props;\r\n  const [showBanner, setShowBanner] = useLocalStorageSerializeKey(\"showBanner\", true);\r\n  const [bannerHidden, setBannerHidden] = useLocalStorageSerializeKey(\"bannerHidden\", null);\r\n\r\n  const [pendingPositions, setPendingPositions] = useState({});\r\n  const [updatedPositions, setUpdatedPositions] = useState({});\r\n\r\n  const hideBanner = () => {\r\n    const hiddenLimit = new Date(new Date().getTime() + 2 * 24 * 60 * 60 * 1000);\r\n    setBannerHidden(hiddenLimit);\r\n    setShowBanner(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (new Date() > new Date(\"2021-11-30\")) {\r\n      setShowBanner(false);\r\n    } else {\r\n      if (bannerHidden && new Date(bannerHidden) > new Date()) {\r\n        setShowBanner(false);\r\n      } else {\r\n        setBannerHidden(null);\r\n        setShowBanner(true);\r\n      }\r\n    }\r\n  }, [showBanner, bannerHidden, setBannerHidden, setShowBanner]);\r\n\r\n  // const { active, account, library } = useWeb3React();\r\n  const { account, library } = useWeb3React();\r\n  const active = Boolean(props.walletAddress);\r\n  const { chainId } = useChainId();\r\n  const currentAccount = account;\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const readerAddress = getContract(chainId, \"Reader\");\r\n  const usdgAddress = getContract(chainId, \"USDG\");\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n\r\n  const positionQuery = getPositionQuery(whitelistedTokens, nativeTokenAddress);\r\n\r\n  const defaultCollateralSymbol = getConstant(chainId, \"defaultCollateralSymbol\");\r\n  const defaultTokenSelection = useMemo(\r\n    () => ({\r\n      [SWAP]: {\r\n        from: AddressZero,\r\n        to: getTokenBySymbol(chainId, defaultCollateralSymbol).address,\r\n      },\r\n      [LONG]: {\r\n        from: AddressZero,\r\n        to: AddressZero,\r\n      },\r\n      [SHORT]: {\r\n        from: getTokenBySymbol(chainId, defaultCollateralSymbol).address,\r\n        to: AddressZero,\r\n      },\r\n    }),\r\n    [chainId, defaultCollateralSymbol]\r\n  );\r\n\r\n  const [tokenSelection, setTokenSelection] = useLocalStorageByChainId(\r\n    chainId,\r\n    \"Exchange-token-selection-v2\",\r\n    defaultTokenSelection\r\n  );\r\n\r\n\r\n  const [swapOption, setSwapOption] = useLocalStorageByChainId(chainId, \"Swap-option-v2\", LONG);\r\n\r\n  const fromTokenAddress = tokenSelection[swapOption].from;\r\n  const toTokenAddress = tokenSelection[swapOption].to;\r\n\r\n  const tokens = getTokens(chainId);\r\n  const stableTokens = tokens.filter((token) => token.isStable);\r\n\r\n  const [shortWarningState, setShortWarningState] = useState({\r\n    visible: false,\r\n    tokenSymbol: '...',\r\n    notShowAgain: false,\r\n  })\r\n  const setShortWarningVisible = (bool) => {\r\n    setShortWarningState({\r\n      ...shortWarningState,\r\n      visible: bool\r\n    })\r\n  }\r\n\r\n  function showShortWarning(tokenAddr) {\r\n    if (localStorage.getItem('Short-warning-show') === 'false') {\r\n      return;\r\n    }\r\n    const isStable = Boolean(stableTokens.find(token => token.address === tokenAddr));\r\n\r\n    if (isStable && tokenAddr !== USDC.address) {\r\n      const token = getToken(ARBITRUM, tokenAddr);\r\n      \r\n      setShortWarningState({\r\n        visible: true,\r\n        tokenSymbol: token.symbol\r\n      })\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (swapOption === SHORT) {\r\n      showShortWarning(fromTokenAddress);\r\n    }\r\n  }, [swapOption])\r\n\r\n  const setFromTokenAddress = useCallback(\r\n    (selectedSwapOption, address) => {\r\n      if (selectedSwapOption === SHORT) {\r\n        showShortWarning(address);\r\n      }\r\n      \r\n      const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n      newTokenSelection[selectedSwapOption].from = address;\r\n      setTokenSelection(newTokenSelection);\r\n    },\r\n    [tokenSelection, setTokenSelection]\r\n  );\r\n\r\n  const setToTokenAddress = useCallback(\r\n    (selectedSwapOption, address) => {\r\n      const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n      \r\n      // ETH/USDC disabling\r\n      // address = AddressZero;\r\n      \r\n      newTokenSelection[selectedSwapOption].to = address;\r\n      if (selectedSwapOption === LONG || selectedSwapOption === SHORT) {\r\n        newTokenSelection[LONG].to = address;\r\n        newTokenSelection[SHORT].to = address;\r\n      }\r\n      setTokenSelection(newTokenSelection);\r\n    },\r\n    [tokenSelection, setTokenSelection]\r\n  );\r\n\r\n  const setMarket = (selectedSwapOption, toTokenAddress) => {\r\n    // ETH/USDC disabling\r\n    // toTokenAddress = AddressZero;\r\n    \r\n    setSwapOption(selectedSwapOption);\r\n    const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n    newTokenSelection[selectedSwapOption].to = toTokenAddress;\r\n    if (selectedSwapOption === LONG || selectedSwapOption === SHORT) {\r\n      newTokenSelection[LONG].to = toTokenAddress;\r\n      newTokenSelection[SHORT].to = toTokenAddress;\r\n    }\r\n    setTokenSelection(newTokenSelection);\r\n  };\r\n\r\n  const [isConfirming, setIsConfirming] = useState(false);\r\n  const [isPendingConfirmation, setIsPendingConfirmation] = useState(false);\r\n\r\n  // const tokens = getTokens(chainId);\r\n\r\n  const tokenAddresses = tokens.map((token) => token.address);\r\n  const { data: tokenBalances } = useSWR(active && [active, chainId, readerAddress, \"getTokenBalances\", account], {\r\n    fetcher: fetcher(library, Reader, [tokenAddresses]),\r\n  });\r\n  \r\n  /* const { data: tokenBalancesDG } = useSWR(active && [active, chainId, readerAddress, \"getTokenBalances\", props.dgAddress], {\r\n    fetcher: fetcher(library, Reader, [tokenAddresses]),\r\n  });\r\n  const { infoTokens: infoTokensDG } = useInfoTokens(library, chainId, active, tokenBalancesDG);\r\n\r\n  const dgFundsAddresses = [];\r\n  Object.keys(infoTokensDG).forEach(address => {\r\n    if (infoTokensDG[address].balance?.gt(0)) {\r\n      dgFundsAddresses.push(address);\r\n    }\r\n  }) */\r\n  \r\n  // const dgHasFunds = Boolean(dgFundsAddresses.length && props.dgAddress);\r\n  const dgHasFunds = false;\r\n\r\n  const { data: positionData, error: positionDataError } = useSWR(\r\n    active && [active, chainId, readerAddress, \"getPositions\", vaultAddress, props.dgAddress || AddressZero],\r\n    {\r\n      fetcher: fetcher(library, Reader, [\r\n        positionQuery.collateralTokens,\r\n        positionQuery.indexTokens,\r\n        positionQuery.isLong,\r\n      ]),\r\n    }\r\n  );\r\n\r\n  const positionsDataIsLoading = active && !positionData && !positionDataError;\r\n\r\n  const { data: fundingRateInfo } = useSWR([active, chainId, readerAddress, \"getFundingRates\"], {\r\n    fetcher: fetcher(library, Reader, [vaultAddress, nativeTokenAddress, whitelistedTokenAddresses]),\r\n  });\r\n\r\n  const { data: totalTokenWeights } = useSWR(\r\n    [`Exchange:totalTokenWeights:${active}`, chainId, vaultAddress, \"totalTokenWeights\"],\r\n    {\r\n      fetcher: fetcher(library, VaultV2),\r\n    }\r\n  );\r\n\r\n  const { data: usdgSupply } = useSWR([`Exchange:usdgSupply:${active}`, chainId, usdgAddress, \"totalSupply\"], {\r\n    fetcher: fetcher(library, Token),\r\n  });\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const { data: orderBookApproved } = useSWR(\r\n    active && [active, chainId, routerAddress, \"approvedPlugins\", account, orderBookAddress],\r\n    {\r\n      fetcher: fetcher(library, Router),\r\n    }\r\n  );\r\n\r\n  const { data: positionRouterApproved } = useSWR(\r\n    active && [active, chainId, routerAddress, \"approvedPlugins\", account, DDL_AccountManager.address],\r\n    {\r\n      fetcher: fetcher(library, Router),\r\n    }\r\n  );\r\n\r\n\r\n  const { infoTokens } = useInfoTokens(library, chainId, active, tokenBalances, fundingRateInfo);\r\n  const { minExecutionFee, minExecutionFeeUSD, minExecutionFeeErrorMessage } = useMinExecutionFee(\r\n    library,\r\n    active,\r\n    chainId,\r\n    infoTokens\r\n  );\r\n  \r\n\r\n  useEffect(() => {\r\n    const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n    const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n    let selectedToken = getChartToken(swapOption, fromToken, toToken, chainId);\r\n    let currentTokenPriceStr = formatAmount(selectedToken.maxPrice, USD_DECIMALS, 2, true);\r\n    let title = getPageTitle(currentTokenPriceStr + ` | ${selectedToken.symbol}${selectedToken.isStable ? \"\" : \"USD\"}`);\r\n    document.title = title;\r\n  }, [tokenSelection, swapOption, infoTokens, chainId, fromTokenAddress, toTokenAddress]);\r\n\r\n  const { positions, positionsMap } = getPositions(\r\n    chainId,\r\n    positionQuery,\r\n    positionData,\r\n    infoTokens,\r\n    savedIsPnlInLeverage,\r\n    savedShowPnlAfterFees,\r\n    account,\r\n    pendingPositions,\r\n    updatedPositions,\r\n    props.dgAddress\r\n  )\r\n\r\n  const [ethLongExists, setEthLongExists] = useState(false);\r\n  const [ethShortExists, setEthShortExists] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const longPos = Boolean(positions.find(pos => {\r\n      return pos.isLong && pos.indexToken.symbol === \"ETH\";\r\n    }));\r\n    const shortPos = Boolean(positions.find(pos => {\r\n      return !pos.isLong && pos.indexToken.symbol === \"ETH\";\r\n    }));\r\n\r\n    if (longPos) {\r\n      setSwapOption(LONG)\r\n    }\r\n    if (shortPos) {\r\n      setSwapOption(SHORT)\r\n    }\r\n\r\n    setEthLongExists(longPos);\r\n    setEthShortExists(shortPos);\r\n  }, [positions.length])\r\n  \r\n\r\n  useImperativeHandle(ref, () => ({\r\n    onUpdatePosition(key, size, collateral, averagePrice, entryFundingRate, reserveAmount, realisedPnl) {\r\n      for (let i = 0; i < positions.length; i++) {\r\n        const position = positions[i];\r\n        if (position.contractKey === key) {\r\n          updatedPositions[position.key] = {\r\n            size,\r\n            collateral,\r\n            averagePrice,\r\n            entryFundingRate,\r\n            reserveAmount,\r\n            realisedPnl,\r\n            updatedAt: Date.now(),\r\n          };\r\n          setUpdatedPositions({ ...updatedPositions });\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    onClosePosition(key, size, collateral, averagePrice, entryFundingRate, reserveAmount, realisedPnl, e) {\r\n      for (let i = 0; i < positions.length; i++) {\r\n        const position = positions[i];\r\n        if (position.contractKey === key) {\r\n          updatedPositions[position.key] = {\r\n            size: bigNumberify(0),\r\n            collateral: bigNumberify(0),\r\n            averagePrice,\r\n            entryFundingRate,\r\n            reserveAmount,\r\n            realisedPnl,\r\n            updatedAt: Date.now(),\r\n          };\r\n          setUpdatedPositions({ ...updatedPositions });\r\n          break;\r\n        }\r\n      }\r\n    },\r\n\r\n    onIncreasePosition(key, account, collateralToken, indexToken, collateralDelta, sizeDelta, isLong, price, fee, e) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      let message;\r\n      if (sizeDelta.eq(0)) {\r\n        message = `Deposited ${formatAmount(collateralDelta, USD_DECIMALS, 2, true)} USD into ${tokenSymbol} ${\r\n          isLong ? \"Long\" : \"Short.\"\r\n        }`;\r\n      } else {\r\n        message = `Increased ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD.`;\r\n      }\r\n\r\n      pushSuccessNotification(chainId, message, e);\r\n    },\r\n\r\n    onDecreasePosition(key, account, collateralToken, indexToken, collateralDelta, sizeDelta, isLong, price, fee, e) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      let message;\r\n      if (sizeDelta.eq(0)) {\r\n        message = `Withdrew ${formatAmount(collateralDelta, USD_DECIMALS, 2, true)} USD from ${tokenSymbol} ${\r\n          isLong ? \"Long\" : \"Short\"\r\n        }.`;\r\n      } else {\r\n        message = `Decreased ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"}, -${formatAmount(\r\n          sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD.`;\r\n      }\r\n\r\n      pushSuccessNotification(chainId, message, e);\r\n    },\r\n\r\n    onCancelIncreasePosition(\r\n      account,\r\n      path,\r\n      indexToken,\r\n      amountIn,\r\n      minOut,\r\n      sizeDelta,\r\n      isLong,\r\n      acceptablePrice,\r\n      executionFee,\r\n      blockGap,\r\n      timeGap,\r\n      e\r\n    ) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      const message = `Could not increase ${tokenSymbol} ${\r\n        isLong ? \"Long\" : \"Short\"\r\n      } within the allowed slippage, you can adjust the allowed slippage in the settings on the top right of the page.`;\r\n\r\n      pushErrorNotification(chainId, message, e);\r\n\r\n      const key = getPositionKey(account, path[path.length - 1], indexToken, isLong);\r\n      pendingPositions[key] = {};\r\n      setPendingPositions({ ...pendingPositions });\r\n    },\r\n\r\n    onCancelDecreasePosition(\r\n      account,\r\n      path,\r\n      indexToken,\r\n      collateralDelta,\r\n      sizeDelta,\r\n      isLong,\r\n      receiver,\r\n      acceptablePrice,\r\n      minOut,\r\n      executionFee,\r\n      blockGap,\r\n      timeGap,\r\n      e\r\n    ) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      const message = `Could not decrease ${tokenSymbol} ${\r\n        isLong ? \"Long\" : \"Short\"\r\n      } within the allowed slippage, you can adjust the allowed slippage in the settings on the top right of the page.`;\r\n\r\n      pushErrorNotification(chainId, message, e);\r\n\r\n      const key = getPositionKey(account, path[path.length - 1], indexToken, isLong);\r\n      pendingPositions[key] = {};\r\n      setPendingPositions({ ...pendingPositions });\r\n    },\r\n  }));\r\n\r\n  const flagOrdersEnabled = true;\r\n  const [orders] = useAccountOrders(flagOrdersEnabled, props.dgAddress);\r\n\r\n  const [isWaitingForPluginApproval, setIsWaitingForPluginApproval] = useState(false);\r\n  const [isWaitingForPositionRouterApproval, setIsWaitingForPositionRouterApproval] = useState(false);\r\n  const [isPluginApproving, setIsPluginApproving] = useState(false);\r\n  const [isPositionRouterApproving, setIsPositionRouterApproving] = useState(false);\r\n  const [isCancelMultipleOrderProcessing, setIsCancelMultipleOrderProcessing] = useState(false);\r\n  const [cancelOrderIdList, setCancelOrderIdList] = useState([]);\r\n\r\n  const onMultipleCancelClick = useCallback(\r\n    async function () {\r\n      setIsCancelMultipleOrderProcessing(true);\r\n      try {\r\n        const tx = await cancelMultipleOrders(chainId, library, cancelOrderIdList, {\r\n          successMsg: t`Orders cancelled.`,\r\n          failMsg: t`Cancel failed.`,\r\n          sentMsg: t`Cancel submitted.`,\r\n          pendingTxns,\r\n          setPendingTxns,\r\n        });\r\n        const receipt = await tx.wait();\r\n        if (receipt.status === 1) {\r\n          setCancelOrderIdList([]);\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      } finally {\r\n        setIsCancelMultipleOrderProcessing(false);\r\n      }\r\n    },\r\n    [\r\n      chainId,\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      setCancelOrderIdList,\r\n      cancelOrderIdList,\r\n      setIsCancelMultipleOrderProcessing,\r\n    ]\r\n  );\r\n\r\n  const approveOrderBook = () => {\r\n    setIsPluginApproving(true);\r\n    return approvePlugin(chainId, orderBookAddress, {\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      sentMsg: t`Enable orders sent.`,\r\n      failMsg: t`Enable orders failed.`,\r\n    })\r\n      .then(() => {\r\n        setIsWaitingForPluginApproval(true);\r\n      })\r\n      .finally(() => {\r\n        setIsPluginApproving(false);\r\n      });\r\n  };\r\n\r\n  const approvePositionRouter = ({ sentMsg, failMsg }) => {\r\n    setIsPositionRouterApproving(true);\r\n    return approvePlugin(chainId, DDL_AccountManager.address, {\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      sentMsg,\r\n      failMsg,\r\n    })\r\n      .then(() => {\r\n        setIsWaitingForPositionRouterApproval(true);\r\n      })\r\n      .finally(() => {\r\n        setIsPositionRouterApproving(false);\r\n      });\r\n  };\r\n\r\n  const LIST_SECTIONS = [\"Positions\", /* flagOrdersEnabled ? \"Orders\" : undefined */, \"Trades\", \"Borrows\"].filter(Boolean);\r\n  let [listSection, setListSection] = useLocalStorageByChainId(chainId, \"List-section-v2\", LIST_SECTIONS[0]);\r\n  const LIST_SECTIONS_LABELS = {\r\n    Orders: orders.length ? `Orders (${orders.length})` : undefined,\r\n    Positions: positions.length ? `Positions (${positions.length})` : undefined,\r\n  };\r\n  if (!LIST_SECTIONS.includes(listSection)) {\r\n    listSection = LIST_SECTIONS[0];\r\n  }\r\n\r\n  if (!getToken(chainId, toTokenAddress)) {\r\n    return null;\r\n  }\r\n\r\n  const renderCancelOrderButton = () => {\r\n    const orderText = cancelOrderIdList.length > 1 ? t`orders` : t`order`;\r\n    if (cancelOrderIdList.length === 0) return;\r\n    return (\r\n      <button\r\n        className=\"muted font-base cancel-order-btn\"\r\n        disabled={isCancelMultipleOrderProcessing}\r\n        type=\"button\"\r\n        onClick={onMultipleCancelClick}\r\n      >\r\n        <Trans>\r\n          Cancel {cancelOrderIdList.length} {orderText}\r\n        </Trans>\r\n      </button>\r\n    );\r\n  };\r\n\r\n  const getListSection = () => {\r\n    return (\r\n      <div>\r\n        <div className=\"Exchange-list-tab-container\">\r\n          <Tab\r\n            options={LIST_SECTIONS}\r\n            optionLabels={LIST_SECTIONS_LABELS}\r\n            option={listSection}\r\n            onChange={(section) => setListSection(section)}\r\n            type=\"inline\"\r\n            className=\"Exchange-list-tabs\"\r\n          />\r\n          {/* <div className=\"align-right Exchange-should-show-position-lines\">\r\n            {renderCancelOrderButton()}\r\n            <Checkbox\r\n              isChecked={savedShouldShowPositionLines}\r\n              setIsChecked={setSavedShouldShowPositionLines}\r\n              className={cx(\"muted chart-positions\", { active: savedShouldShowPositionLines })}\r\n            >\r\n              <span>\r\n                <Trans>Chart positions</Trans>\r\n              </span>\r\n            </Checkbox>\r\n          </div> */}\r\n        </div>\r\n        {listSection === \"Positions\" && (\r\n          <PositionsList\r\n            positionsDataIsLoading={positionsDataIsLoading}\r\n            pendingPositions={pendingPositions}\r\n            setPendingPositions={setPendingPositions}\r\n            setListSection={setListSection}\r\n            setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n            setIsWaitingForPositionRouterApproval={setIsWaitingForPositionRouterApproval}\r\n            approveOrderBook={approveOrderBook}\r\n            approvePositionRouter={approvePositionRouter}\r\n            isPluginApproving={isPluginApproving}\r\n            isPositionRouterApproving={isPositionRouterApproving}\r\n            isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n            isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n            orderBookApproved={orderBookApproved}\r\n            positionRouterApproved={positionRouterApproved}\r\n            positions={positions}\r\n            positionsMap={positionsMap}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            account={account}\r\n            library={library}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            flagOrdersEnabled={flagOrdersEnabled}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            chainId={chainId}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            setMarket={setMarket}\r\n            orders={orders}\r\n            showPnlAfterFees={savedShowPnlAfterFees}\r\n            minExecutionFee={minExecutionFee}\r\n            minExecutionFeeUSD={minExecutionFeeUSD}\r\n            minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n            usdgSupply={usdgSupply}\r\n            totalTokenWeights={totalTokenWeights}\r\n            dgAddress={props.dgAddress}\r\n          />\r\n        )}\r\n        {listSection === \"Orders\" && (\r\n          <OrdersList\r\n            account={account}\r\n            active={active}\r\n            library={library}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            infoTokens={infoTokens}\r\n            positionsMap={positionsMap}\r\n            chainId={chainId}\r\n            orders={orders}\r\n            totalTokenWeights={totalTokenWeights}\r\n            usdgSupply={usdgSupply}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            cancelOrderIdList={cancelOrderIdList}\r\n            setCancelOrderIdList={setCancelOrderIdList}\r\n          />\r\n        )}\r\n        {listSection === \"Trades\" && (\r\n          <TradeHistory\r\n            account={account}\r\n            dgAddress={props.dgAddress}\r\n            forSingleAccount={true}\r\n            infoTokens={infoTokens}\r\n            getTokenInfo={getTokenInfo}\r\n            chainId={chainId}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            shouldShowPaginationButtons={true}\r\n          />\r\n        )}\r\n        {listSection === 'Borrows' && (\r\n          <BorrowsList\r\n            positionsDataIsLoading={positionsDataIsLoading}\r\n            pendingPositions={pendingPositions}\r\n            setPendingPositions={setPendingPositions}\r\n            setListSection={setListSection}\r\n            setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n            setIsWaitingForPositionRouterApproval={setIsWaitingForPositionRouterApproval}\r\n            approveOrderBook={approveOrderBook}\r\n            approvePositionRouter={approvePositionRouter}\r\n            isPluginApproving={isPluginApproving}\r\n            isPositionRouterApproving={isPositionRouterApproving}\r\n            isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n            isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n            orderBookApproved={orderBookApproved}\r\n            positionRouterApproved={positionRouterApproved}\r\n            positions={positions}\r\n            positionsMap={positionsMap}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            account={account}\r\n            library={library}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            flagOrdersEnabled={flagOrdersEnabled}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            chainId={chainId}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            setMarket={setMarket}\r\n            orders={orders}\r\n            showPnlAfterFees={savedShowPnlAfterFees}\r\n            minExecutionFee={minExecutionFee}\r\n            minExecutionFeeUSD={minExecutionFeeUSD}\r\n            minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n            usdgSupply={usdgSupply}\r\n            totalTokenWeights={totalTokenWeights}\r\n            dgAddress={props.dgAddress}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const onSelectWalletToken = (token) => {\r\n    setFromTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  const renderChart = () => {\r\n    return (\r\n      <ExchangeTVChart\r\n        fromTokenAddress={fromTokenAddress}\r\n        toTokenAddress={toTokenAddress}\r\n        infoTokens={infoTokens}\r\n        swapOption={swapOption}\r\n        chainId={chainId}\r\n        positions={positions}\r\n        // savedShouldShowPositionLines={savedShouldShowPositionLines}\r\n        savedShouldShowPositionLines={true}\r\n        orders={orders}\r\n        setToTokenAddress={setToTokenAddress}\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"Exchange page-layout\">\r\n      {showBanner && <ExchangeBanner hideBanner={hideBanner} />}\r\n      <div className=\"Exchange-content\">\r\n        <div className=\"Exchange-left\">\r\n          {renderChart()}\r\n          <div className=\"Exchange-lists large\">{getListSection()}</div>\r\n        </div>\r\n        <div className=\"Exchange-right\">\r\n          <SwapBox\r\n            positions={positions}\r\n            ethShortExists={ethShortExists}\r\n            ethLongExists={ethLongExists}\r\n            pendingPositions={pendingPositions}\r\n            setPendingPositions={setPendingPositions}\r\n            setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n            setIsWaitingForPositionRouterApproval={setIsWaitingForPositionRouterApproval}\r\n            approveOrderBook={approveOrderBook}\r\n            approvePositionRouter={approvePositionRouter}\r\n            isPluginApproving={isPluginApproving}\r\n            isPositionRouterApproving={isPositionRouterApproving}\r\n            isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n            isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n            orderBookApproved={orderBookApproved}\r\n            positionRouterApproved={positionRouterApproved}\r\n            orders={orders}\r\n            flagOrdersEnabled={flagOrdersEnabled}\r\n            chainId={chainId}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            connectWallet={connectWallet}\r\n            library={library}\r\n            account={account}\r\n            positionsMap={positionsMap}\r\n            fromTokenAddress={fromTokenAddress}\r\n            setFromTokenAddress={setFromTokenAddress}\r\n            toTokenAddress={toTokenAddress}\r\n            setToTokenAddress={setToTokenAddress}\r\n            swapOption={swapOption}\r\n            setSwapOption={setSwapOption}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            tokenSelection={tokenSelection}\r\n            setTokenSelection={setTokenSelection}\r\n            isConfirming={isConfirming}\r\n            setIsConfirming={setIsConfirming}\r\n            isPendingConfirmation={isPendingConfirmation}\r\n            setIsPendingConfirmation={setIsPendingConfirmation}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            setSavedIsPnlInLeverage={setSavedIsPnlInLeverage}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            savedSlippageAmount={savedSlippageAmount}\r\n            totalTokenWeights={totalTokenWeights}\r\n            usdgSupply={usdgSupply}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            minExecutionFee={minExecutionFee}\r\n            minExecutionFeeUSD={minExecutionFeeUSD}\r\n            minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n            dgAddress={props.dgAddress}\r\n            setRegisterVisible={props.setRegisterVisible}\r\n          />\r\n          <MarginLevel />\r\n        </div>\r\n        <div className=\"Exchange-lists small\">{getListSection()}</div>\r\n      </div>\r\n      <Modal\r\n        className=\"modal_warning\"\r\n        visible={shortWarningState.visible}\r\n        setVisible={setShortWarningVisible}>\r\n        <h1 className='modal__title'>Attention</h1>\r\n        <div className=\"modal__body\">\r\n          <div className=\"modal__text\">\r\n            <p>Please note that only USDC is allowed as collateral for short positions. DeDeLend will swap {shortWarningState.tokenSymbol} to USDC to open the short position.\r\n            <br />By clicking on the Confirm button you confirm that you have been advised of this.</p>\r\n          </div>\r\n          <div className=\"input-container modal__checkbox\">\r\n\t\t\t\t\t\t<input type=\"checkbox\"\r\n              onChange={(e) => {\r\n                setShortWarningState({\r\n                  ...shortWarningState,\r\n                  notShowAgain: e.target.checked\r\n                })\r\n              }} />\r\n\t\t\t\t\t\t<label>Don't show me this message again</label>\r\n\t\t\t\t\t</div>\r\n          <Button btnActive={true} onClick={() => {\r\n            console.log(shortWarningState);\r\n            \r\n            if (shortWarningState.notShowAgain) {\r\n              localStorage.setItem('Short-warning-show', false);\r\n            }\r\n            setShortWarningVisible(false);\r\n          }}>Confirm</Button>\r\n        </div>\r\n      </Modal>\r\n      \r\n    </div>\r\n  );\r\n});\r\n","// date format: d MMM yyyy, H:mm, time should be specifed based on UTC time\r\n\r\nexport const homeEventsData = [\r\n  {\r\n    id: \"app-gmx-io-launch\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"Updates have been applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nexport const appEventsData = [\r\n  // {\r\n  //   id: \"removal-of-min-profit-rule\",\r\n  //   title: \"Trading improvements\",\r\n  //   isActive: true,\r\n  //   validTill: \"1 Apr 2022, 12:00\",\r\n  //   bodyText: \"The 1.5% minimum profit rule has been removed\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read more\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/roadmap#30-march-2022\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"shorting-of-link-uni-re-enabled\",\r\n  //   title: \"Shorting of LINK and UNI\",\r\n  //   isActive: true,\r\n  //   validTill: \"20 Apr 2022, 12:00\",\r\n  //   bodyText: \"Shorting has been re-enabled for LINK and UNI.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"speed-up-page-loading\",\r\n  //   title: \"Speed Up Page Loading\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"If you experience data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"referral-program-launch\",\r\n  //   title: \"Referral Program Launch\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"The GMX referral program is now live! Get fee discounts and refer traders to earn rewards.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //     {\r\n  //       text: \"Join Now\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey\",\r\n  //   title: \"GMX Arbitrum Odyssey\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"The GMX Arbitrum Odyssey is taking place this week, all participants will receive prizes. Read on to find out more.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-arbitrum-odyssey-fc12cba2d10d\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"fix-arbitrum-transaction-issues\",\r\n  //   title: \"Fix Arbitrum Transactions\",\r\n  //   isActive: true,\r\n  //   validTill: \"30 Jun 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"If you experience transaction errors on Arbitrum or data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey-paused\",\r\n  //   title: \"GMX Arbitrum Odyssey Paused\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText: \"The GMX Arbitrum Odyssey has been paused. Please read the linked post for more information.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://twitter.com/GMX_IO/status/1542163585111150592\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"app-gmx-io\",\r\n  //   title: \"Frontend Updates\",\r\n  //   isActive: true,\r\n  //   validTill: \"6 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"On 6 Jul 2022, updates will be applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"degraded-alchemy-performance\",\r\n  //   title: \"Alchemy RPC\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"There are ongoing syncing issues on Alchemy for Arbitrum at the moment, please check their status page and use the public Arbitrum RPC in the meantime\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Check Status\",\r\n  //       link: \"https://status.alchemy.com/\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Public RPC URL\",\r\n  //       link: \"https://metamask.zendesk.com/hc/en-us/articles/4415758358299-Network-profile-Arbitrum\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  {\r\n    id: \"app-gmx-io-settings\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"You are currently using app.gmx.io. Customized settings have been reset, you may need to adjust your settings by clicking on the menu in the top right after connecting your wallet.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"use-alchemy-rpc-url\",\r\n    title: \"Use Alchemy RPC URL\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"If you experience data loading or transaction issues on Arbitrum, please use a free RPC URL from Alchemy.\",\r\n    buttons: [\r\n      {\r\n        text: \"Learn More\",\r\n        link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n","function Icon({ className }) {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      aria-hidden=\"true\"\r\n      className={className}\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"2\"\r\n        d=\"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z\"\r\n      ></path>\r\n    </svg>\r\n  );\r\n}\r\n\r\nexport default Icon;\r\n","import \"./EventToast.css\";\r\nimport Icon from \"./AnnouncementIcon\";\r\nimport { MdOutlineClose } from \"react-icons/md\";\r\n\r\nexport default function EventToast({ event, id, onClick, t }) {\r\n  return (\r\n    <div className={`single-toast ${t.visible ? \"zoomIn\" : \"zoomOut\"}`} key={id}>\r\n      <header>\r\n        <div className=\"toast-title\">\r\n          <Icon className=\"announcement-icon\" />\r\n          <p>{event.title}</p>\r\n        </div>\r\n        <MdOutlineClose onClick={onClick} className=\"cross-icon\" color=\"white\" />\r\n      </header>\r\n      <p className=\"toast-body\">{event.bodyText}</p>\r\n      <div className=\"toast-links\">\r\n        {event.buttons.map((button) => {\r\n          if (button.newTab) {\r\n            return (\r\n              <a key={event.id + button.text} target=\"_blank\" rel=\"noreferrer noopener\" href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          } else {\r\n            return (\r\n              <a key={event.id + button.text} href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          }\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useLocalStorage } from \"react-use\";\r\nimport toast from \"react-hot-toast\";\r\nimport { homeEventsData, appEventsData } from \"../../config/events\";\r\nimport { useEffect } from \"react\";\r\nimport EventToast from \"./EventToast\";\r\nimport { isFuture, parse } from \"date-fns\";\r\nimport { isHomeSite } from \"../../lib/legacy\";\r\n\r\nfunction useEventToast() {\r\n  const isHome = isHomeSite();\r\n  const [visited, setVisited] = useLocalStorage(\"visited-announcements\", []);\r\n\r\n  useEffect(() => {\r\n    const eventsData = isHome ? homeEventsData : appEventsData;\r\n\r\n    eventsData\r\n      .filter((event) => event.isActive)\r\n      .filter((event) => isFuture(parse(event.validTill + \", +00\", \"d MMM yyyy, H:mm, x\", new Date())))\r\n      .filter((event) => Array.isArray(visited) && !visited.includes(event.id))\r\n      .forEach((event) => {\r\n        toast.custom(\r\n          (t) => (\r\n            <EventToast\r\n              event={event}\r\n              id={event.id}\r\n              t={t}\r\n              onClick={() => {\r\n                toast.dismiss(event.id);\r\n                visited.push(event.id);\r\n                setVisited(visited);\r\n              }}\r\n            />\r\n          ),\r\n          {\r\n            id: event.id,\r\n            style: {},\r\n          }\r\n        );\r\n      });\r\n  }, [visited, setVisited, isHome]);\r\n}\r\n\r\nexport default useEventToast;\r\n","import { Toaster } from \"react-hot-toast\";\r\nimport { useWindowScroll, createBreakpoint } from \"react-use\";\r\n\r\nfunction EventToastContainer() {\r\n  let { y: scrollY } = useWindowScroll();\r\n  const useBreakpoint = createBreakpoint({ XL: 1033, L: 768, S: 350 });\r\n  const breakpoint = useBreakpoint();\r\n  return (\r\n    <Toaster\r\n      position=\"top-right\"\r\n      reverseOrder={true}\r\n      gutter={30}\r\n      containerClassName=\"event-toast-container\"\r\n      containerStyle={{\r\n        zIndex: 2,\r\n        transition: \"all 200ms\",\r\n        top: scrollY > 60 ? \"30px\" : `${93 - scrollY}px`,\r\n        right: breakpoint === \"XL\" ? \"30px\" : \"1rem\",\r\n      }}\r\n      toastOptions={{\r\n        duration: Infinity,\r\n      }}\r\n    />\r\n  );\r\n}\r\nexport default EventToastContainer;\r\n","import { Helmet } from \"react-helmet\";\r\n\r\nimport { t } from \"@lingui/macro\";\r\n\r\nfunction SEO(props) {\r\n  const { children, ...customMeta } = props;\r\n  const meta = {\r\n    title: t`GMX | Decentralized Perpetual Exchange`,\r\n    description: t`Trade spot or perpetual BTC, ETH, AVAX and other top cryptocurrencies with up to 30x leverage directly from your wallet on Arbitrum and Avalanche.`,\r\n    image: \"https://gmx.io/og.png\",\r\n    type: \"exchange\",\r\n    ...customMeta,\r\n  };\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{meta.title}</title>\r\n        <meta name=\"robots\" content=\"follow, index\" />\r\n        <meta content={meta.description} name=\"description\" />\r\n        <meta property=\"og:type\" content={meta.type} />\r\n        <meta property=\"og:site_name\" content=\"GMX\" />\r\n        <meta property=\"og:description\" content={meta.description} />\r\n        <meta property=\"og:title\" content={meta.title} />\r\n        <meta property=\"og:image\" content={meta.image} />\r\n        <meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n        <meta name=\"twitter:site\" content=\"@gmx_io\" />\r\n        <meta name=\"twitter:title\" content={meta.title} />\r\n        <meta name=\"twitter:description\" content={meta.description} />\r\n        <meta name=\"twitter:image\" content={meta.image} />\r\n      </Helmet>\r\n      {children}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SEO;\r\n","import \"./RedirectModal.css\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\n\r\nexport function RedirectPopupModal({\r\n  redirectModalVisible,\r\n  setRedirectModalVisible,\r\n  appRedirectUrl,\r\n  setRedirectPopupTimestamp,\r\n  setShouldHideRedirectModal,\r\n  shouldHideRedirectModal,\r\n  removeRedirectPopupTimestamp,\r\n}) {\r\n  const onClickAgree = () => {\r\n    if (shouldHideRedirectModal) {\r\n      setRedirectPopupTimestamp(Date.now());\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      className=\"RedirectModal\"\r\n      isVisible={redirectModalVisible}\r\n      setIsVisible={setRedirectModalVisible}\r\n      label=\"Launch App\"\r\n    >\r\n      You are leaving GMX.io and will be redirected to a third party, independent website.\r\n      <br />\r\n      <br />\r\n      The website is a community deployed and maintained instance of the open source{\" \"}\r\n      <a href=\"https://github.com/gmx-io/gmx-interface\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        GMX front end\r\n      </a>\r\n      , hosted and served on the distributed, peer-to-peer{\" \"}\r\n      <a href=\"https://ipfs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        IPFS network\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      Alternative links can be found in the{\" \"}\r\n      <a href=\"https://gmxio.gitbook.io/gmx/app-links\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        docs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      By clicking Agree you accept the{\" \"}\r\n      <a href=\"https://gmx.io/#/terms-and-conditions\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        T&Cs\r\n      </a>{\" \"}\r\n      and{\" \"}\r\n      <a href=\"https://gmx.io/#/referral-terms\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        Referral T&Cs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      <div className=\"mb-sm\">\r\n        <Checkbox isChecked={shouldHideRedirectModal} setIsChecked={setShouldHideRedirectModal}>\r\n          Don't show this message again for 30 days.\r\n        </Checkbox>\r\n      </div>\r\n      <a href={appRedirectUrl} className=\"App-cta Exchange-swap-button\" onClick={() => onClickAgree()}>\r\n        Agree\r\n      </a>\r\n    </Modal>\r\n  );\r\n}\r\n","import { i18n } from \"@lingui/core\";\r\nimport { en, es, zh, ko, ru, ja, fr } from \"make-plural/plurals\";\r\nimport { LANGUAGE_LOCALSTORAGE_KEY } from \"./legacy\";\r\n\r\nexport const locales = {\r\n  en: \"English\",\r\n  es: \"Spanish\",\r\n  // zh: \"Chinese\",\r\n  ko: \"Korean\",\r\n  // ru: \"Russian\",\r\n  ja: \"Japanese\",\r\n  // fr: \"French\",\r\n};\r\n\r\nexport const defaultLocale = \"en\";\r\n\r\ni18n.loadLocaleData({\r\n  en: { plurals: en },\r\n  es: { plurals: es },\r\n  zh: { plurals: zh },\r\n  ko: { plurals: ko },\r\n  ru: { plurals: ru },\r\n  ja: { plurals: ja },\r\n  fr: { plurals: fr },\r\n});\r\n\r\nexport async function dynamicActivate(locale) {\r\n  const { messages } = await import(`@lingui/loader!../config/locales/${locale}/messages.po`);\r\n  localStorage.setItem(LANGUAGE_LOCALSTORAGE_KEY, locale);\r\n  i18n.load(locale, messages);\r\n  i18n.activate(locale);\r\n}\r\n","import React, { useState, useEffect, useCallback, useRef } from \"react\";\r\nimport { SWRConfig } from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport { Web3ReactProvider, useWeb3React } from \"@web3-react/core\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\nimport useScrollToTop from \"../lib/useScrollToTop\";\r\n\r\nimport { Routes, Route, HashRouter as Router, Navigate, useLocation, useNavigate } from \"react-router-dom\";\r\n\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  SLIPPAGE_BPS_KEY,\r\n  IS_PNL_IN_LEVERAGE_KEY,\r\n  SHOW_PNL_AFTER_FEES_KEY,\r\n  BASIS_POINTS_DIVISOR,\r\n  SHOULD_SHOW_POSITION_LINES_KEY,\r\n  getAppBaseUrl,\r\n  isHomeSite,\r\n  clearWalletConnectData,\r\n  helperToast,\r\n  getAlchemyWsUrl,\r\n  useChainId,\r\n  getInjectedHandler,\r\n  useEagerConnect,\r\n  useLocalStorageSerializeKey,\r\n  useInactiveListener,\r\n  getExplorerUrl,\r\n  getWalletConnectHandler,\r\n  activateInjectedProvider,\r\n  hasMetaMaskWalletExtension,\r\n  hasCoinBaseWalletExtension,\r\n  isMobileDevice,\r\n  clearWalletLinkData,\r\n  SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY,\r\n  CURRENT_PROVIDER_LOCALSTORAGE_KEY,\r\n  REFERRAL_CODE_KEY,\r\n  REFERRAL_CODE_QUERY_PARAM,\r\n  isDevelopment,\r\n  DISABLE_ORDER_VALIDATION_KEY,\r\n  LANGUAGE_LOCALSTORAGE_KEY,\r\n} from \"../lib/legacy\";\r\n\r\n// import Home from \"../pages/Home/Home\";\r\n// import Dashboard from \"../pages/Dashboard/Dashboard\";\r\n// import Ecosystem from \"../pages/Ecosystem/Ecosystem\";\r\n// import Stake from \"../pages/Stake/Stake\";\r\nimport { Exchange } from \"../pages/Exchange/Exchange\";\r\n// import Actions from \"../pages/Actions/Actions\";\r\n// import OrdersOverview from \"../pages/OrdersOverview/OrdersOverview\";\r\n// import PositionsOverview from \"../pages/PositionsOverview/PositionsOverview\";\r\n// import Referrals from \"../pages/Referrals/Referrals\";\r\n// import BuyGlp from \"../pages/BuyGlp/BuyGlp\";\r\n// import BuyGMX from \"../pages/BuyGMX/BuyGMX\";\r\n// import Buy from \"../pages/Buy/Buy\";\r\n// import NftWallet from \"../pages/NftWallet/NftWallet\";\r\n// import ClaimEsGmx from \"../pages/ClaimEsGmx/ClaimEsGmx\";\r\n// import BeginAccountTransfer from \"../pages/BeginAccountTransfer/BeginAccountTransfer\";\r\n// import CompleteAccountTransfer from \"../pages/CompleteAccountTransfer/CompleteAccountTransfer\";\r\n\r\nimport { cssTransition, ToastContainer } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Modal from \"../components/Modal/Modal\";\r\nimport Checkbox from \"../components/Checkbox/Checkbox\";\r\n\r\nimport \"../styles/Shared.scss\";\r\nimport \"../styles/Font.css\";\r\nimport \"./App.scss\";\r\nimport \"../styles/Input.scss\";\r\n\r\nimport metamaskImg from \"../img/metamask.png\";\r\nimport coinbaseImg from \"../img/coinbaseWallet.png\";\r\nimport walletConnectImg from \"../img/walletconnect-circle-blue.svg\";\r\nimport useEventToast from \"../components/EventToast/useEventToast\";\r\nimport EventToastContainer from \"../components/EventToast/EventToastContainer\";\r\nimport SEO from \"../components/Common/SEO\";\r\nimport useRouteQuery from \"../lib/useRouteQuery\";\r\nimport { encodeReferralCode, decodeReferralCode } from \"../domain/referrals\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport VaultV2 from \"../abis/VaultV2.json\";\r\nimport VaultV2b from \"../abis/VaultV2b.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\n// import PageNotFound from \"../pages/PageNotFound/PageNotFound\";\r\n// import ReferralTerms from \"../pages/ReferralTerms/ReferralTerms\";\r\n// import TermsAndConditions from \"../pages/TermsAndConditions/TermsAndConditions\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { RedirectPopupModal } from \"../components/ModalViews/RedirectModal\";\r\nimport { REDIRECT_POPUP_TIMESTAMP_KEY } from \"../config/ui\";\r\n// import Jobs from \"../pages/Jobs/Jobs\";\r\n\r\nimport { i18n } from \"@lingui/core\";\r\nimport { I18nProvider } from \"@lingui/react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { defaultLocale, dynamicActivate } from \"../lib/i18n\";\r\n// import { Header } from \"../components/Header/Header\";\r\n\r\nimport { signer } from './../../../components/utils/providers';\r\nimport _AccountManager from \"../../../deployments/arbitrum_ddl/accountManager.json\";\r\nimport Banner from './../../../components/Banner';\r\n\r\nif (\"ethereum\" in window) {\r\n  window.ethereum.autoRefreshOnNetworkChange = false;\r\n}\r\n\r\nfunction getLibrary(provider) {\r\n  const library = new Web3Provider(provider);\r\n  return library;\r\n}\r\n\r\nconst Jelly = cssTransition({\r\n  enter: \"jellyIn\",\r\n  exit: \"jellyOut\",\r\n});\r\n\r\nconst arbWsProvider = new ethers.providers.WebSocketProvider(getAlchemyWsUrl());\r\n\r\nconst avaxWsProvider = new ethers.providers.JsonRpcProvider(\"https://api.avax.network/ext/bc/C/rpc\");\r\n\r\nfunction getWsProvider(active, chainId) {\r\n  if (!active) {\r\n    return;\r\n  }\r\n  if (chainId === ARBITRUM) {\r\n    return arbWsProvider;\r\n  }\r\n\r\n  if (chainId === AVALANCHE) {\r\n    return avaxWsProvider;\r\n  }\r\n}\r\n\r\nfunction FullApp(props) {\r\n  const { setRegisterVisible } = props; \r\n  const isHome = isHomeSite();\r\n  const exchangeRef = useRef();\r\n  const { connector, library, deactivate, activate, active } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  const location = useLocation();\r\n  const history = useNavigate();\r\n  useEventToast();\r\n  const [activatingConnector, setActivatingConnector] = useState();\r\n  useEffect(() => {\r\n    if (activatingConnector && activatingConnector === connector) {\r\n      setActivatingConnector(undefined);\r\n    }\r\n  }, [activatingConnector, connector, chainId]);\r\n  const triedEager = useEagerConnect(setActivatingConnector);\r\n  useInactiveListener(!triedEager || !!activatingConnector);\r\n\r\n  const query = useRouteQuery();\r\n\r\n  useEffect(() => {\r\n    let referralCode = query.get(REFERRAL_CODE_QUERY_PARAM);\r\n    if (!referralCode || referralCode.length === 0) {\r\n      const params = new URLSearchParams(window.location.search);\r\n      referralCode = params.get(REFERRAL_CODE_QUERY_PARAM);\r\n    }\r\n\r\n    if (referralCode && referralCode.length <= 20) {\r\n      const encodedReferralCode = encodeReferralCode(referralCode);\r\n      if (encodeReferralCode !== ethers.constants.HashZero) {\r\n        localStorage.setItem(REFERRAL_CODE_KEY, encodedReferralCode);\r\n        const queryParams = new URLSearchParams(location.search);\r\n        if (queryParams.has(REFERRAL_CODE_QUERY_PARAM)) {\r\n          queryParams.delete(REFERRAL_CODE_QUERY_PARAM);\r\n          history.replace({\r\n            search: queryParams.toString(),\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }, [query, history, location]);\r\n\r\n  const disconnectAccount = useCallback(() => {\r\n    // only works with WalletConnect\r\n    clearWalletConnectData();\r\n    // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n    clearWalletLinkData();\r\n    deactivate();\r\n  }, [deactivate]);\r\n\r\n  const disconnectAccountAndCloseSettings = () => {\r\n    disconnectAccount();\r\n    localStorage.removeItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY);\r\n    localStorage.removeItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY);\r\n    setIsSettingsVisible(false);\r\n  };\r\n\r\n  const connectInjectedWallet = getInjectedHandler(activate);\r\n  const activateWalletConnect = () => {\r\n    getWalletConnectHandler(activate, deactivate, setActivatingConnector)();\r\n  };\r\n\r\n  const userOnMobileDevice = \"navigator\" in window && isMobileDevice(window.navigator);\r\n\r\n  useEffect(() => {\r\n    attemptActivateWallet(\"MetaMask\");\r\n  }, [props.walletAddress])\r\n  \r\n  const activateMetaMask = () => {\r\n    if (!hasMetaMaskWalletExtension()) {\r\n      helperToast.error(\r\n        <div>\r\n          <Trans>MetaMask not detected.</Trans>\r\n          <br />\r\n          <br />\r\n          <a href=\"https://metamask.io\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            <Trans>Install MetaMask</Trans>\r\n          </a>\r\n          {userOnMobileDevice ? (\r\n            <Trans>, and use GMX with its built-in browser</Trans>\r\n          ) : (\r\n            <Trans> to start using GMX</Trans>\r\n          )}\r\n          .\r\n        </div>\r\n      );\r\n      return false;\r\n    }\r\n    attemptActivateWallet(\"MetaMask\");\r\n  };\r\n  const activateCoinBase = () => {\r\n    if (!hasCoinBaseWalletExtension()) {\r\n      helperToast.error(\r\n        <div>\r\n          <Trans>Coinbase Wallet not detected.</Trans>\r\n          <br />\r\n          <br />\r\n          <a href=\"https://www.coinbase.com/wallet\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            <Trans>Install Coinbase Wallet</Trans>\r\n          </a>\r\n          {userOnMobileDevice ? (\r\n            <Trans>, and use GMX with its built-in browser</Trans>\r\n          ) : (\r\n            <Trans> to start using GMX</Trans>\r\n          )}\r\n          .\r\n        </div>\r\n      );\r\n      return false;\r\n    }\r\n    attemptActivateWallet(\"CoinBase\");\r\n  };\r\n\r\n  const attemptActivateWallet = (providerName) => {\r\n    localStorage.setItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY, true);\r\n    localStorage.setItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY, providerName);\r\n    activateInjectedProvider(providerName);\r\n    connectInjectedWallet();\r\n  };\r\n\r\n  const [walletModalVisible, setWalletModalVisible] = useState(false);\r\n  const [redirectModalVisible, setRedirectModalVisible] = useState(false);\r\n  const [shouldHideRedirectModal, setShouldHideRedirectModal] = useState(false);\r\n  const [redirectPopupTimestamp, setRedirectPopupTimestamp, removeRedirectPopupTimestamp] =\r\n    useLocalStorage(REDIRECT_POPUP_TIMESTAMP_KEY);\r\n  const [selectedToPage, setSelectedToPage] = useState(\"\");\r\n  // const connectWallet = () => setWalletModalVisible(true);\r\n  const connectWallet = () => {\r\n    props.connectWallet();\r\n    attemptActivateWallet(\"MetaMask\");\r\n  };\r\n\r\n  const [isSettingsVisible, setIsSettingsVisible] = useState(false);\r\n  const [savedSlippageAmount, setSavedSlippageAmount] = useLocalStorageSerializeKey(\r\n    [chainId, SLIPPAGE_BPS_KEY],\r\n    DEFAULT_SLIPPAGE_AMOUNT\r\n  );\r\n  \r\n  const [slippageAmount, setSlippageAmount] = useState(0);\r\n  const [isPnlInLeverage, setIsPnlInLeverage] = useState(false);\r\n  const [shouldDisableValidationForTesting, setShouldDisableValidationForTesting] = useState(false);\r\n  const [showPnlAfterFees, setShowPnlAfterFees] = useState(false);\r\n\r\n  const [savedIsPnlInLeverage, setSavedIsPnlInLeverage] = useLocalStorageSerializeKey(\r\n    [chainId, IS_PNL_IN_LEVERAGE_KEY],\r\n    false\r\n  );\r\n\r\n  const [savedShowPnlAfterFees, setSavedShowPnlAfterFees] = useLocalStorageSerializeKey(\r\n    [chainId, SHOW_PNL_AFTER_FEES_KEY],\r\n    false\r\n  );\r\n  const [savedShouldDisableValidationForTesting, setSavedShouldDisableValidationForTesting] =\r\n    useLocalStorageSerializeKey([chainId, DISABLE_ORDER_VALIDATION_KEY], false);\r\n\r\n  const [savedShouldShowPositionLines, setSavedShouldShowPositionLines] = useLocalStorageSerializeKey(\r\n    [chainId, SHOULD_SHOW_POSITION_LINES_KEY],\r\n    false\r\n  );\r\n\r\n  const openSettings = () => {\r\n    const slippage = parseInt(savedSlippageAmount);\r\n    setSlippageAmount((slippage / BASIS_POINTS_DIVISOR) * 100);\r\n    setIsPnlInLeverage(savedIsPnlInLeverage);\r\n    setShowPnlAfterFees(savedShowPnlAfterFees);\r\n    setShouldDisableValidationForTesting(savedShouldDisableValidationForTesting);\r\n    setIsSettingsVisible(true);\r\n  };\r\n\r\n  const saveAndCloseSettings = () => {\r\n    const slippage = parseFloat(slippageAmount);\r\n    if (isNaN(slippage)) {\r\n      helperToast.error(t`Invalid slippage value`);\r\n      return;\r\n    }\r\n    if (slippage > 5) {\r\n      helperToast.error(t`Slippage should be less than 5%`);\r\n      return;\r\n    }\r\n\r\n    const basisPoints = (slippage * BASIS_POINTS_DIVISOR) / 100;\r\n    if (parseInt(basisPoints) !== parseFloat(basisPoints)) {\r\n      helperToast.error(t`Max slippage precision is 0.01%`);\r\n      return;\r\n    }\r\n\r\n    setSavedIsPnlInLeverage(isPnlInLeverage);\r\n    setSavedShowPnlAfterFees(showPnlAfterFees);\r\n    setSavedShouldDisableValidationForTesting(shouldDisableValidationForTesting);\r\n    setSavedSlippageAmount(basisPoints);\r\n    setIsSettingsVisible(false);\r\n  };\r\n\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const baseUrl = getAppBaseUrl();\r\n  let appRedirectUrl = baseUrl + selectedToPage;\r\n  if (localStorageCode && localStorageCode.length > 0 && localStorageCode !== ethers.constants.HashZero) {\r\n    const decodedRefCode = decodeReferralCode(localStorageCode);\r\n    if (decodedRefCode) {\r\n      appRedirectUrl = `${appRedirectUrl}?ref=${decodedRefCode}`;\r\n    }\r\n  }\r\n\r\n  const [pendingTxns, setPendingTxns] = useState([]);\r\n\r\n  const showRedirectModal = (to) => {\r\n    setRedirectModalVisible(true);\r\n    setSelectedToPage(to);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const checkPendingTxns = async () => {\r\n      const updatedPendingTxns = [];\r\n      for (let i = 0; i < pendingTxns.length; i++) {\r\n        const pendingTxn = pendingTxns[i];\r\n        const receipt = await library.getTransactionReceipt(pendingTxn.hash);\r\n        if (receipt) {\r\n          if (receipt.status === 0) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.error(\r\n              <div>\r\n                <Trans>Txn failed.</Trans>{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          if (receipt.status === 1 && pendingTxn.message) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.success(\r\n              <div>\r\n                {pendingTxn.message}{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          continue;\r\n        }\r\n        updatedPendingTxns.push(pendingTxn);\r\n      }\r\n\r\n      if (updatedPendingTxns.length !== pendingTxns.length) {\r\n        setPendingTxns(updatedPendingTxns);\r\n      }\r\n    };\r\n\r\n    const interval = setInterval(() => {\r\n      checkPendingTxns();\r\n    }, 2 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [library, pendingTxns, chainId]);\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  useEffect(() => {\r\n    const wsVaultAbi = chainId === ARBITRUM ? VaultV2.abi : VaultV2b.abi;\r\n    const wsProvider = getWsProvider(active, chainId);\r\n    if (!wsProvider) {\r\n      return;\r\n    }\r\n\r\n    const wsVault = new ethers.Contract(vaultAddress, wsVaultAbi, wsProvider);\r\n    const wsPositionRouter = new ethers.Contract(positionRouterAddress, PositionRouter.abi, wsProvider);\r\n\r\n    const callExchangeRef = (method, ...args) => {\r\n      if (!exchangeRef || !exchangeRef.current) {\r\n        return;\r\n      }\r\n\r\n      exchangeRef.current[method](...args);\r\n    };\r\n\r\n    // handle the subscriptions here instead of within the Exchange component to avoid unsubscribing and re-subscribing\r\n    // each time the Exchange components re-renders, which happens on every data update\r\n    const onUpdatePosition = (...args) => callExchangeRef(\"onUpdatePosition\", ...args);\r\n    const onClosePosition = (...args) => callExchangeRef(\"onClosePosition\", ...args);\r\n    const onIncreasePosition = (...args) => callExchangeRef(\"onIncreasePosition\", ...args);\r\n    const onDecreasePosition = (...args) => callExchangeRef(\"onDecreasePosition\", ...args);\r\n    const onCancelIncreasePosition = (...args) => callExchangeRef(\"onCancelIncreasePosition\", ...args);\r\n    const onCancelDecreasePosition = (...args) => callExchangeRef(\"onCancelDecreasePosition\", ...args);\r\n\r\n    wsVault.on(\"UpdatePosition\", onUpdatePosition);\r\n    wsVault.on(\"ClosePosition\", onClosePosition);\r\n    wsVault.on(\"IncreasePosition\", onIncreasePosition);\r\n    wsVault.on(\"DecreasePosition\", onDecreasePosition);\r\n    wsPositionRouter.on(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n    wsPositionRouter.on(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n\r\n    return function cleanup() {\r\n      wsVault.off(\"UpdatePosition\", onUpdatePosition);\r\n      wsVault.off(\"ClosePosition\", onClosePosition);\r\n      wsVault.off(\"IncreasePosition\", onIncreasePosition);\r\n      wsVault.off(\"DecreasePosition\", onDecreasePosition);\r\n      wsPositionRouter.off(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n      wsPositionRouter.off(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n    };\r\n  }, [active, chainId, vaultAddress, positionRouterAddress]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"App GMX-Interface\">\r\n        <div className=\"App-content\">\r\n          <Exchange\r\n            ref={exchangeRef}\r\n            savedShowPnlAfterFees={savedShowPnlAfterFees}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            setSavedIsPnlInLeverage={setSavedIsPnlInLeverage}\r\n            savedSlippageAmount={savedSlippageAmount}\r\n            setPendingTxns={setPendingTxns}\r\n            pendingTxns={pendingTxns}\r\n            savedShouldShowPositionLines={savedShouldShowPositionLines}\r\n            setSavedShouldShowPositionLines={setSavedShouldShowPositionLines}\r\n            connectWallet={connectWallet}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            dgAddress={props.dgAddress}\r\n            walletAddress={props.walletAddress}\r\n            setRegisterVisible={setRegisterVisible}\r\n          />\r\n        </div>\r\n      </div>\r\n      <ToastContainer\r\n        limit={1}\r\n        transition={Jelly}\r\n        position=\"bottom-right\"\r\n        // autoClose={}\r\n        hideProgressBar={true}\r\n        newestOnTop={false}\r\n        closeOnClick={false}\r\n        draggable={false}\r\n        pauseOnHover\r\n      />\r\n      <EventToastContainer />\r\n      <RedirectPopupModal\r\n        redirectModalVisible={redirectModalVisible}\r\n        setRedirectModalVisible={setRedirectModalVisible}\r\n        appRedirectUrl={appRedirectUrl}\r\n        setRedirectPopupTimestamp={setRedirectPopupTimestamp}\r\n        setShouldHideRedirectModal={setShouldHideRedirectModal}\r\n        shouldHideRedirectModal={shouldHideRedirectModal}\r\n        removeRedirectPopupTimestamp={removeRedirectPopupTimestamp}\r\n      />\r\n      <Modal\r\n        className=\"App-settings\"\r\n        isVisible={isSettingsVisible}\r\n        setIsVisible={setIsSettingsVisible}\r\n        label=\"Settings\"\r\n      >\r\n        <div className=\"App-settings-row\">\r\n          <div>\r\n            <Trans>Allowed Slippage</Trans>\r\n          </div>\r\n          <div className=\"App-slippage-tolerance-input-container\">\r\n            <input\r\n              type=\"number\"\r\n              className=\"App-slippage-tolerance-input\"\r\n              min=\"0\"\r\n              value={slippageAmount}\r\n              onChange={(e) => setSlippageAmount(e.target.value)}\r\n            />\r\n            <div className=\"App-slippage-tolerance-input-percent\">%</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={showPnlAfterFees} setIsChecked={setShowPnlAfterFees}>\r\n            <Trans>Display PnL after fees</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={isPnlInLeverage} setIsChecked={setIsPnlInLeverage}>\r\n            <Trans>Include PnL in leverage display</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        {isDevelopment() && (\r\n          <div className=\"Exchange-settings-row\">\r\n            <Checkbox isChecked={shouldDisableValidationForTesting} setIsChecked={setShouldDisableValidationForTesting}>\r\n              <Trans>Disable order validations</Trans>\r\n            </Checkbox>\r\n          </div>\r\n        )}\r\n\r\n        <button className=\"App-cta Exchange-swap-button\" onClick={saveAndCloseSettings}>\r\n          <Trans>Save</Trans>\r\n        </button>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction GMXInterface(props) {\r\n  /* useEffect(() => {\r\n    const defaultLanguage = localStorage.getItem(LANGUAGE_LOCALSTORAGE_KEY) || defaultLocale;\r\n    dynamicActivate(defaultLanguage);\r\n  }, []); */\r\n\r\n  return (\r\n    <SWRConfig value={{ refreshInterval: 5000 }}>\r\n      <Web3ReactProvider getLibrary={getLibrary}>\r\n        <SEO>\r\n          {/* <I18nProvider i18n={i18n}> */}\r\n            <FullApp {...props} />\r\n          {/* </I18nProvider> */}\r\n        </SEO>\r\n      </Web3ReactProvider>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default GMXInterface;\r\n","import React from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nexport default function useRouteQuery() {\r\n  const { search } = useLocation();\r\n  return React.useMemo(() => new URLSearchParams(search), [search]);\r\n}\r\n","export default __webpack_public_path__ + \"static/media/icon-ETH.6aac1b5f.svg\";","export default __webpack_public_path__ + \"static/media/icon-WBTC.8955e194.svg\";","export default __webpack_public_path__ + \"static/media/icon-dollar.37b11694.svg\";","import React from 'react';\r\nimport Currency from './../components/Currency';\r\nimport Button from './../components/UI/button/Button';\r\nimport icon_ETH from '../img/icon-ETH.svg';\r\nimport icon_WBTC from '../img/icon-WBTC.svg';\r\nimport icon_link from '../img/icon-link.svg';\r\nimport icon_repay from '../img/icon-repay.svg';\r\nimport icon_wallet from '../img/icon-wallet.svg';\r\nimport icon_dollar from '../img/icon-dollar.svg';\r\nimport { cutAddress } from './../components/utils/wallet';\r\nimport MarginLevel from './../components/MarginLevel';\r\nimport Tooltip from './gmx-test/components/Tooltip/Tooltip';\r\n\r\nconst MarginAccount = (props) => {\r\n\tconst {\r\n\t\taccount\r\n\t} = props;\r\n\r\n\treturn (\r\n\t\t(account &&\r\n\t\t\t<div className=\"MarginAccount block\">\r\n\t\t\t\t<div className=\"MarginAccount__header\">\r\n\t\t\t\t\t<h1 className=\"MarginAccount__title block__title\">Margin Account info</h1>\r\n\t\t\t\t\t<a className=\"MarginAccount__account-link\" href={`https://arbiscan.io/address/${account}`} rel='noreferrer' target='_blank'>\r\n\t\t\t\t\t\t<img src={icon_link} alt=\"Link icon\" />\r\n\t\t\t\t\t\t{cutAddress(account, false)}\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"MarginAccount__sections\">\r\n\t\t\t\t\t{/* USDC */}\r\n\t\t\t\t\t<div className=\"MarginAccount__section App-box\">\r\n\t\t\t\t\t\t<div className=\"MarginAccount__section-title\">Available</div>\r\n\t\t\t\t\t\t<div className=\"MarginAccount__section-value\">\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-value_major\">\r\n\t\t\t\t\t\t\t\t<Currency>2000.15</Currency>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-value_minor\">\r\n\t\t\t\t\t\t\t\t$2000,15\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-value_minor MarginAccount__section-price\">\r\n\t\t\t\t\t\t\t\t<span className='muted_light nowrap'>Current price:</span>\r\n\t\t\t\t\t\t\t\t$1\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"MarginAccount__section-btns btns\">\r\n\t\t\t\t\t\t\t<Button className={'btn_hlight'}>Deposit</Button>\r\n\t\t\t\t\t\t\t<Button className={'btn_stroke'}>Withdraw</Button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{/* USDC end */}\r\n\r\n\t\t\t\t\t<div className=\"MarginAccount__section App-box coming-soon\">\r\n\t\t\t\t\t\t<div className=\"coming-soon__text\">\r\n\t\t\t\t\t\t\t<img src={icon_WBTC} alt=\"Wrapped Bitcoin icon\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"MarginAccount__section App-box coming-soon\">\r\n\t\t\t\t\t\t<div className=\"coming-soon__text\">\r\n\t\t\t\t\t\t\t<img src={icon_ETH} alt=\"Ethereum icon\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<MarginLevel className=\"MarginAccount__section\">\r\n\t\t\t\t\t\t<div className=\"divider\" />\r\n\t\t\t\t\t\t<div className=\"text-table\">\r\n\t\t\t\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t\t\t\t<div className=\"text-table__left\">Borrow APY</div>\r\n\t\t\t\t\t\t\t\t<div className=\"text-table__right muted_light\">5%</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</MarginLevel>\r\n\r\n\t\t\t\t\t<div className=\"MarginAccount__section MarginAccount__section_complex App-box\">\r\n\t\t\t\t\t\t<div className=\"MarginAccount__section-child App-box\">\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-icon\">\r\n\t\t\t\t\t\t\t\t<img src={icon_wallet} alt=\"Wallet icon\" />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-title\">\r\n\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\tclassName=\"has-hint-tooltip nowrap\"\r\n\t\t\t\t\t\t\t\t\tid=\"margin-balance-tooltip\"\r\n\t\t\t\t\t\t\t\t\thandle=\"Margin Balance\"\r\n\t\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\tMargin Balance = Account Balance + <br />UnrealizedPnL. Your margin account <br />will beliquidated once Margin Balance <br />less orequal min. Maintain margin\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-value\">$100,000</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-table text-table text-table_small\">\r\n\t\t\t\t\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__left\">\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"has-hint-tooltip nowrap\"\r\n\t\t\t\t\t\t\t\t\t\t\tid=\"account-balance-tooltip\"\r\n\t\t\t\t\t\t\t\t\t\t\thandle=\"Account Balance\"\r\n\t\t\t\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tThe value of your assets in USDC\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__right\">$99,500</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__left\">Unrealized PnL</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__right\">$500</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"MarginAccount__section-child App-box\">\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-icon\">\r\n\t\t\t\t\t\t\t\t<img src={icon_dollar} alt=\"Dollar Icon\" />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-title\">\r\n\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\tclassName=\"has-hint-tooltip nowrap\"\r\n\t\t\t\t\t\t\t\t\tid=\"debt-tooltip\"\r\n\t\t\t\t\t\t\t\t\thandle=\"Debt\"\r\n\t\t\t\t\t\t\t\t\tposition=\"left-bottom\"\r\n\t\t\t\t\t\t\t\t\tenabled={true}\r\n\t\t\t\t\t\t\t\t\trenderContent={() => {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\tThe total amount ofUSDC <br />loaned toyou margin account <br />+ Interest fee + Service fee\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-value\">\r\n\t\t\t\t\t\t\t\t<div className=\"MarginAccount__section-value_major\">\r\n\t\t\t\t\t\t\t\t\t<Currency>20000</Currency>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"MarginAccount__section-btn\">\r\n\t\t\t\t\t\t\t\t\t<button className=\"btn_inline\">\r\n\t\t\t\t\t\t\t\t\t\t<img className=\"btn__icon\" src={icon_repay} alt=\"Repay icon\" />\r\n\t\t\t\t\t\t\t\t\t\tRepay\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"MarginAccount__section-table text-table text-table_small\">\r\n\t\t\t\t\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__left\">Debt</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__right\">\r\n\t\t\t\t\t\t\t\t\t\t<Currency>19950</Currency>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"text-table__row\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__left\">Interest & Service Fee</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-table__right\">\r\n\t\t\t\t\t\t\t\t\t\t<Currency>50</Currency>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>)\r\n\t);\r\n};\r\n\r\nexport default MarginAccount;","import React, { useState, useEffect, useContext } from 'react';\r\nimport { Routes, Route,\tuseLocation, Navigate } from \"react-router-dom\";\r\nimport BorrowMarket from '../views/markets/BorrowMarket';\r\nimport SupplyMarket from '../views/markets/SupplyMarket';\r\nimport Tabs from './Tabs';\r\nimport { DDL_POOL, USDC } from './utils/contracts';\r\nimport { UserStatsContext } from '../context/context';\r\nimport { ethers } from 'ethers';\r\nimport GMXInterface from '../views/gmx-test/App/App';\r\nimport { connectWallet } from './utils/wallet';\r\nimport MarginAccount from '../views/MarginAccount';\r\nimport { HOMEPAGE_HREF } from './utils/constants';\r\n\r\n\r\nconst AppRouter = ({ walletAddress, setWalletAddress, dgAddress, setRegisterVisible, account }) => {\r\n\t// Supply Market state\r\n\tconst {userStats} = useContext(UserStatsContext)\r\n\tconst [supplyStep, setSupplyStep] = useState(0)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (walletAddress) {\r\n\t\t\tUSDC.allowance(walletAddress, DDL_POOL.address)\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (Number(ethers.utils.formatUnits(res, 6)) >= userStats.balance) {\r\n\t\t\t\t\t\tsetSupplyStep(1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetSupplyStep(0)\r\n\t\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}, [userStats.balance, walletAddress]);\r\n\r\n\t\r\n\treturn (\r\n\t\t<Routes>\r\n\t\t\t{/* <Route\r\n\t\t\t\tpath=\"/options\"\r\n\t\t\t\telement={<BorrowMarket walletAddress={walletAddress} setWalletAddress={setWalletAddress} />} \r\n\t\t\t/> */}\r\n\t\t\t<Route path=\"/perpetuals\" element={\r\n\t\t\t\t<GMXInterface\r\n\t\t\t\t\tconnectWallet={() => {\r\n\t\t\t\t\t\tconnectWallet(setWalletAddress)\r\n\t\t\t\t\t}}\r\n\t\t\t\t\twalletAddress={walletAddress} \r\n\t\t\t\t\tdgAddress={dgAddress}\r\n\t\t\t\t\tsetRegisterVisible={setRegisterVisible} />\r\n\t\t\t} />\r\n\t\t\t<Route\r\n\t\t\t\tpath=\"/earn\"\r\n\t\t\t\telement={<SupplyMarket walletAddress={walletAddress} setWalletAddress={setWalletAddress} supplyStep={supplyStep} setSupplyStep={setSupplyStep} />} \r\n\t\t\t/>\r\n\t\t\t<Route\r\n\t\t\t\tpath=\"/account\"\r\n\t\t\t\telement={\r\n\t\t\t\t\t<MarginAccount\r\n\t\t\t\t\t\taccount={account}\r\n\t\t\t\t\t/>\r\n\t\t\t\t}\r\n\t\t\t/>\r\n\t\t\t<Route\r\n\t\t\t\tpath=\"*\"\r\n\t\t\t\telement={<Navigate to={HOMEPAGE_HREF} replace />}\r\n\t\t\t/>\r\n\t\t</Routes>\r\n\t);\r\n};\r\n\r\nexport default AppRouter;","import React from 'react';\r\n\r\nconst Warning = (props) => {\r\n\treturn (\r\n\t\t<div className=\"warning\">\r\n\t\t\t{props.children}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Warning;","// Style\r\nimport './style/App.scss'\r\n\r\n// Main\r\nimport React, { useState, useEffect } from 'react';\r\n\r\nimport Header from './Header';\r\nimport Footer from './Footer';\r\nimport AppRouter from './components/AppRouter';\r\nimport { HashRouter } from 'react-router-dom';\r\nimport { UserStatsContext } from './context/context';\r\nimport { GlobalStatsContext } from './context/context';\r\nimport Warning from './components/UI/warning/Warning';\r\nimport { ToastContainer } from 'react-toastify';\r\nimport { cssTransition } from 'react-toastify';\r\nimport EventToastContainer from './views/gmx-test/components/EventToast/EventToastContainer';\r\nimport { i18n } from '@lingui/core';\r\nimport { I18nProvider } from '@lingui/react';\r\nimport { defaultLocale, dynamicActivate } from './views/gmx-test/lib/i18n';\r\nimport { LANGUAGE_LOCALSTORAGE_KEY } from './views/gmx-test/lib/legacy';\r\n\r\n\r\n\r\nfunction App() {\r\n\tconst [walletAddress, setWalletAddress] = useState('');\r\n\tconst [dgAddress, setDgAddress] = useState('');\r\n\tconst [account, setAccount] = useState('');\r\n\tconst [accounts, setAccounts] = useState([\r\n\t\t'0x0641bc55ddab3b9636e82cbf87ede3c3c533039d',\r\n\t\t'0x0641bc55ddab3b9636e82cbf87ede3c3c5330000'\r\n\t])\r\n\tconst [registerVisible, setRegisterVisible] = useState(false);\r\n\t\r\n\tconst [userStats, setUserStats] = useState({\r\n\t\tbalance: undefined,\r\n\t\tcurBalance: undefined,\r\n\t\tavail: undefined\r\n\t})\r\n\tconst [globalStats, setGlobalStats] = useState(\r\n\t\t{\r\n\t\t\ttotalSupplied: \"\",\r\n\t\t\ttotalBorrowed: \"\",\r\n\t\t\tutilRate: \"\",\r\n\t\t\tavailToBorrow: \"\",\r\n\t\t\tborrowAPY: \"\",\r\n\t\t}\r\n\t)\r\n\r\n\tconst Jelly = cssTransition({\r\n\t\tenter: \"jellyIn\",\r\n\t\texit: \"jellyOut\",\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n    const defaultLanguage = localStorage.getItem(LANGUAGE_LOCALSTORAGE_KEY) || defaultLocale;\r\n    dynamicActivate(defaultLanguage);\r\n  }, []);\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{/* <Favicon url=\"https://i.imgur.com/dLCWse0.png\" /> */}\r\n\t\t\t<GlobalStatsContext.Provider value={{\r\n\t\t\t\tglobalStats,\r\n\t\t\t\tsetGlobalStats\r\n\t\t\t}}>\r\n\t\t\t\t<UserStatsContext.Provider value={{\r\n\t\t\t\t\tuserStats,\r\n\t\t\t\t\tsetUserStats\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<HashRouter>\r\n\t\t\t\t\t\t<I18nProvider i18n={i18n}>\r\n\t\t\t\t\t\t\t<ToastContainer\r\n\t\t\t\t\t\t\t\tlimit={1}\r\n\t\t\t\t\t\t\t\ttransition={Jelly}\r\n\t\t\t\t\t\t\t\tposition=\"bottom-right\"\r\n\t\t\t\t\t\t\t\t// autoClose={}\r\n\t\t\t\t\t\t\t\thideProgressBar={true}\r\n\t\t\t\t\t\t\t\tnewestOnTop={false}\r\n\t\t\t\t\t\t\t\tcloseOnClick={false}\r\n\t\t\t\t\t\t\t\tdraggable={false}\r\n\t\t\t\t\t\t\t\tpauseOnHover={false}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<EventToastContainer />\r\n\t\t\t\t\t\t\t<div className=\"App\">\r\n\t\t\t\t\t\t\t\t<Header walletAddress={walletAddress}\r\n\t\t\t\t\t\t\t\t\tsetWalletAddress={setWalletAddress}\r\n\t\t\t\t\t\t\t\t\taccounts={accounts}\r\n\t\t\t\t\t\t\t\t\taccount={account}\r\n\t\t\t\t\t\t\t\t\tsetAccount={setAccount}\r\n\t\t\t\t\t\t\t\t\tregisterVisible={registerVisible}\r\n\t\t\t\t\t\t\t\t\tsetRegisterVisible={setRegisterVisible}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t<main className='_container'>\r\n\t\t\t\t\t\t\t\t\t<AppRouter\r\n\t\t\t\t\t\t\t\t\t\twalletAddress={walletAddress}\r\n\t\t\t\t\t\t\t\t\t\tsetWalletAddress={setWalletAddress} \r\n\t\t\t\t\t\t\t\t\t\taccount={account}\r\n\t\t\t\t\t\t\t\t\t\tsetAccount={setAccount}\r\n\t\t\t\t\t\t\t\t\t\tdgAddress={dgAddress}\r\n\t\t\t\t\t\t\t\t\t\tsetDgAddress={setDgAddress}\r\n\t\t\t\t\t\t\t\t\t\tsetRegisterVisible={setRegisterVisible}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</main>\r\n\r\n\t\t\t\t\t\t\t\t<Footer />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</I18nProvider>\r\n\t\t\t\t\t</HashRouter>\r\n\t\t\t\t\t\r\n\t\t\t\t</UserStatsContext.Provider>\r\n\t\t\t</GlobalStatsContext.Provider>\r\n\t\t\t<Warning>\r\n\t\t\t\tDeDeLend is in beta. Use at your own risk\r\n\t\t\t</Warning>\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App';\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById('root'));\r\nroot.render(\r\n\t<React.StrictMode>\r\n\t\t<App />\r\n\t</React.StrictMode>\r\n);\r\n"],"sourceRoot":""}