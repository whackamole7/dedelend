{"version":3,"sources":["views/gmx-test/img/ic_arbitrum_16.svg","views/gmx-test/img/ic_avalanche_16.svg","views/gmx-test/img/ic_arbitrum_24.svg","views/gmx-test/img/ic_avalanche_24.svg","views/gmx-test/img/ic_arbitrum_96.svg","views/gmx-test/img/ic_avalanche_96.svg","views/gmx-test/img/ic_language24.svg","views/gmx-test/img/logo_GMX.svg","views/gmx-test/img/ic_checked.svg","views/gmx-test/img/ic_glp_24.svg","views/gmx-test/img/ic_glp_40.svg","views/gmx-test/img/ic_wallet_24.svg","views/gmx-test/img/ic_banxa.svg","views/gmx-test/img/ic_binance_logo.svg","views/gmx-test/img/ic_multiswap.svg","views/gmx-test/img/ic_settings_16.svg","views/gmx-test/img/ic_synapse.svg","views/gmx-test/img/logo_GMX_small.svg","views/gmx-test/img/ddl/ic_eth_40.svg","views/gmx-test/img/DROP_DOWN.svg","views/gmx-test/img/buy_gmx.svg","views/gmx-test/img/coinbaseWallet.png","views/gmx-test/img/ddl/icon_dollar.svg","views/gmx-test/img/ddl/icon_dollar_active.svg","views/gmx-test/img/ddl/icon_market.svg","views/gmx-test/img/ddl/icon_market_active.svg","views/gmx-test/img/ddl/icon_trigger.svg","views/gmx-test/img/ddl/icon_trigger_active.svg","views/gmx-test/img/ddl/icon_withdraw.svg","views/gmx-test/img/ddl/icon_withdraw_active.svg","views/gmx-test/img/ddl/long.svg","views/gmx-test/img/ddl/long_active.svg","views/gmx-test/img/ddl/short.svg","views/gmx-test/img/ddl/short_active.svg","views/gmx-test/img/gmx-logo-with-name.svg","views/gmx-test/img/ic_avax_30.svg","views/gmx-test/img/ic_buy_glp.svg","views/gmx-test/img/ic_coingecko_16.svg","views/gmx-test/img/ic_convert_down.svg","views/gmx-test/img/ic_copy_16.svg","views/gmx-test/img/ic_cost.svg","views/gmx-test/img/ic_discord.svg","views/gmx-test/img/ic_github.svg","views/gmx-test/img/ic_glp_custom.svg","views/gmx-test/img/ic_gmx_40.svg","views/gmx-test/img/ic_gmx_arbitrum.svg","views/gmx-test/img/ic_gmx_avax.svg","views/gmx-test/img/ic_gmx_custom.svg","views/gmx-test/img/ic_gmx_footer.svg","views/gmx-test/img/ic_hop.svg","views/gmx-test/img/ic_liquidity.svg","views/gmx-test/img/ic_medium.svg","views/gmx-test/img/ic_metamask_16.svg","views/gmx-test/img/ic_new_link_16.svg","views/gmx-test/img/ic_olympus_arbitrum.svg","views/gmx-test/img/ic_sign_out_16.svg","views/gmx-test/img/ic_simpleswaps.svg","views/gmx-test/img/ic_stats.svg","views/gmx-test/img/ic_telegram.svg","views/gmx-test/img/ic_totaluser.svg","views/gmx-test/img/ic_trading.svg","views/gmx-test/img/ic_twitter.svg","views/gmx-test/img/metamask.png","views/gmx-test/img/position-share-bg.png","views/gmx-test/img/swap.svg","views/gmx-test/img/walletconnect-circle-blue.svg","views/gmx-test/img/ddl/ic_btc_40.svg","views/gmx-test/img/ddl/ic_dai_40.svg","views/gmx-test/img/ddl/ic_frax_40.svg","views/gmx-test/img/ddl/ic_link_40.svg","views/gmx-test/img/ddl/ic_uni_40.svg","views/gmx-test/img/ddl/ic_usdc_40.svg","views/gmx-test/img/ddl/ic_usdt_40.svg","views/gmx-test/img/ddl/ic_weth_40.svg","views/gmx-test/img/ic_avax_24.svg","views/gmx-test/img/ic_btc.b_24.svg","views/gmx-test/img/ic_btc_24.svg","views/gmx-test/img/ic_busd_24.svg","views/gmx-test/img/ic_dai_24.svg","views/gmx-test/img/ic_eth_24.svg","views/gmx-test/img/ic_frax_24.svg","views/gmx-test/img/ic_gmx_24.svg","views/gmx-test/img/ic_link_24.svg","views/gmx-test/img/ic_mim_24.svg","views/gmx-test/img/ic_settings_24.svg","views/gmx-test/img/ic_tether_24.svg","views/gmx-test/img/ic_uni_24.svg","views/gmx-test/img/ic_usdc.e_24.svg","views/gmx-test/img/ic_usdc_24.svg","views/gmx-test/img/ic_usdt_24.svg","views/gmx-test/img/ic_wavax_24.svg","views/gmx-test/img/ic_weth_24.svg","views/gmx-test/img sync /^/.*$","views/gmx-test/img/Anyswap.png","views/gmx-test/img/Anyswap.svg","views/gmx-test/img/Artwork.svg","views/gmx-test/img/Artwork_gmx.svg","views/gmx-test/img/Banxa.png","views/gmx-test/img/Hop.png","views/gmx-test/img/Hop.svg","views/gmx-test/img/Hop_dark.png","views/gmx-test/img/Hop_dark.svg","views/gmx-test/img/Synapse.png","views/gmx-test/img/Synapse.svg","views/gmx-test/img/binance.png","views/gmx-test/img/bscscan.png","views/gmx-test/img/btn_big_arbitrum.png","views/gmx-test/img/btn_big_avalanche.png","views/gmx-test/img/btn_big_bsc.png","views/gmx-test/img/btn_big_purchasegmx.png","views/gmx-test/img/btn_big_purchasegmx.svg","views/gmx-test/img/buy_gmx_bond.svg","views/gmx-test/img/buy_transfer_eth.svg","views/gmx-test/img/coingecko.png","views/gmx-test/img/cross.svg","views/gmx-test/img/ddl/chevron-down.svg","views/gmx-test/img/ddl/chevron-down_sm.svg","views/gmx-test/img/ddl/ic_btc_40.png","views/gmx-test/img/ddl/ic_dai_40.png","views/gmx-test/img/ddl/ic_eth_40.png","views/gmx-test/img/ddl/ic_frax_40.png","views/gmx-test/img/ddl/ic_link_40.png","views/gmx-test/img/ddl/ic_uni_40.png","views/gmx-test/img/ddl/ic_usdc_40.png","views/gmx-test/img/ddl/ic_usdt_40.png","views/gmx-test/img/ddl/ic_weth_40.png","views/gmx-test/img/ddl/icon_arrow.svg","views/gmx-test/img/ddl/icon_check.svg","views/gmx-test/img/ddl/icon_close.svg","views/gmx-test/img/ddl/icon_close_sm.svg","views/gmx-test/img/ddl/icon_close_toast.svg","views/gmx-test/img/ddl/lock.svg","views/gmx-test/img/flag_en.svg","views/gmx-test/img/flag_es.svg","views/gmx-test/img/flag_fr.svg","views/gmx-test/img/flag_ja.svg","views/gmx-test/img/flag_ko.svg","views/gmx-test/img/flag_ru.svg","views/gmx-test/img/flag_zh.svg","views/gmx-test/img/glp_icon.svg","views/gmx-test/img/gmx-logo-final-white-small.png","views/gmx-test/img/gmx-logo-final-white.png","views/gmx-test/img/gmx-logo-final.png","views/gmx-test/img/gmx-logo-glow.png","views/gmx-test/img/gmx_logo.svg","views/gmx-test/img/graphite-01.png","views/gmx-test/img/ic-communityproject.svg","views/gmx-test/img/ic_arbitrum_hover_16.svg","views/gmx-test/img/ic_arrowleft16.svg","views/gmx-test/img/ic_arrowright16.svg","views/gmx-test/img/ic_avax_40.svg","views/gmx-test/img/ic_bsc.svg","views/gmx-test/img/ic_bsc_96.svg","views/gmx-test/img/ic_btc.b_40.svg","views/gmx-test/img/ic_btc_40.svg","views/gmx-test/img/ic_cash.png","views/gmx-test/img/ic_cash.svg","views/gmx-test/img/ic_coingecko_hover_16.svg","views/gmx-test/img/ic_dai_40.svg","views/gmx-test/img/ic_eth_40.svg","views/gmx-test/img/ic_frax_40.svg","views/gmx-test/img/ic_gmx.svg","views/gmx-test/img/ic_gmx_30.svg","views/gmx-test/img/ic_gmx_64.svg","views/gmx-test/img/ic_gmx_big.svg","views/gmx-test/img/ic_info.svg","views/gmx-test/img/ic_link_40.svg","views/gmx-test/img/ic_menu_dots.svg","views/gmx-test/img/ic_metamask_hover_16.svg","views/gmx-test/img/ic_mim_40.svg","views/gmx-test/img/ic_olympus.svg","views/gmx-test/img/ic_selector_dropdowns.svg","views/gmx-test/img/ic_sign in_16.svg","views/gmx-test/img/ic_stats_big.svg","views/gmx-test/img/ic_tokens.svg","views/gmx-test/img/ic_transfer_avax.svg","views/gmx-test/img/ic_uni_40.svg","views/gmx-test/img/ic_usdc.e_40.svg","views/gmx-test/img/ic_usdc_40.svg","views/gmx-test/img/ic_usdt_40.svg","views/gmx-test/img/ic_wavax_40.svg","views/gmx-test/img/ic_weth_40.svg","views/gmx-test/img/lg_arbitrum.svg","views/gmx-test/img/long.svg","views/gmx-test/img/metamask-text.svg","views/gmx-test/img/page-not-found.svg","views/gmx-test/img/short.svg","views/gmx-test/img/trading.jpg","views/gmx-test/img/wallet-connect-text.svg","views/gmx-test/img/wave-01.png","views/gmx-test/img/wave-02.png","views/gmx-test/img sync /^/ic_.*_24/.svg$","views/gmx-test/img/ddl sync /^/ic_.*_40/.svg$","../ /^/.*/messages/.po$/ groupOptions: {} namespace object","components/UI/logo/Logo.jsx","components/UI/button/Button.jsx","components/Wallet.jsx","context/context.js","components/utils/wallet.js","components/utils/providers.js","components/utils/contracts.js","components/utils/sepThousands.js","components/utils/math.js","components/utils/stats.js","components/Tabs.jsx","Header.jsx","Footer.jsx","components/UI/modal/Modal.jsx","components/UI/input/Input.jsx","components/UI/input/NumberInput.jsx","components/Form.jsx","components/UI/loader/Loader.jsx","components/utils/error.js","components/UI/modal/BorrowModal.jsx","components/UI/pagination/Pagination.jsx","hooks/usePages.js","components/utils/pages.js","components/UI/modal/RepayModal.jsx","components/OptionItem.jsx","components/OptionsList.jsx","views/markets/BorrowMarket.jsx","hooks/useFilter.js","components/SupplyCard.jsx","components/WithdrawCard.jsx","views/markets/SupplyMarket.jsx","components/MarketInfoBoard.jsx","views/gmx-test/config/Addresses.js","views/gmx-test/config/Tokens.js","views/gmx-test/lib/legacy.js","views/gmx-test/components/Footer/Footer.js","views/gmx-test/config/chains.js","views/gmx-test/domain/common.js","views/gmx-test/lib/contracts/fetcher.ts","views/gmx-test/lib/helperToast.ts","views/gmx-test/components/ToastifyDebug/ToastifyDebug.tsx","views/gmx-test/lib/contracts/transactionErrors.ts","views/gmx-test/lib/contracts/constants.js","views/gmx-test/lib/contracts/utils.ts","views/gmx-test/lib/contracts/callContract.tsx","views/gmx-test/domain/prices.js","views/gmx-test/domain/legacy.js","views/gmx-test/config/ui.js","views/gmx-test/components/Tooltip/Tooltip.js","views/gmx-test/config/Fees/FEES_42161.js","views/gmx-test/config/Fees/index.js","views/gmx-test/config/Fees/FEES_43113.js","views/gmx-test/pages/Dashboard/AssetDropdown.js","views/gmx-test/components/Common/SEO.js","views/gmx-test/components/StatsTooltip/StatsTooltipRow.tsx","views/gmx-test/pages/Dashboard/DashboardV2.js","views/gmx-test/pages/Ecosystem/Ecosystem.js","views/gmx-test/lib/useLockBodyScroll.ts","views/gmx-test/components/Modal/Modal.js","views/gmx-test/pages/Stake/StakeV1.js","views/gmx-test/components/Checkbox/Checkbox.js","views/gmx-test/pages/Stake/StakeV2.js","views/gmx-test/components/Tab/Tab.js","views/gmx-test/components/Common/Portal.js","views/gmx-test/components/Tooltip/TooltipWithPortal.js","views/gmx-test/components/Exchange/TokenSelector.js","views/gmx-test/components/Exchange/ExchangeInfoRow.js","views/gmx-test/components/Exchange/ConfirmationBox.js","views/gmx-test/components/Exchange/OrdersToa.js","views/gmx-test/components/Referrals/referralsHelper.js","views/gmx-test/domain/referrals.js","views/gmx-test/components/Exchange/NoLiquidityErrorModal.tsx","views/gmx-test/components/Exchange/SwapBox.js","views/gmx-test/components/Exchange/ChartTokenSelector.js","views/gmx-test/components/Exchange/ExchangeTVChart.js","views/gmx-test/components/Exchange/PositionSeller.js","views/gmx-test/components/Exchange/PositionEditor.js","views/gmx-test/components/Common/SpinningLoader.js","views/gmx-test/components/Exchange/PositionShare.js","views/gmx-test/lib/useLoadImage.js","views/gmx-test/components/Exchange/PositionDropdown.js","views/gmx-test/components/Exchange/PositionsList.js","views/gmx-test/components/Exchange/OrderEditor.js","views/gmx-test/components/Exchange/OrdersList.js","views/gmx-test/components/Exchange/TradeHistory.js","views/gmx-test/components/Exchange/ExchangeWalletTokens.js","views/gmx-test/components/Exchange/ExchangeBanner.js","views/gmx-test/pages/Exchange/Exchange.js","views/gmx-test/pages/Referrals/Referrals.js","views/gmx-test/components/Glp/SwapErrorModal.tsx","views/gmx-test/components/Glp/GlpSwap.js","views/gmx-test/config/events.js","views/gmx-test/components/EventToast/AnnouncementIcon.js","views/gmx-test/components/EventToast/EventToast.js","views/gmx-test/components/EventToast/useEventToast.js","views/gmx-test/components/EventToast/EventToastContainer.js","views/gmx-test/components/ModalViews/RedirectModal.js","views/gmx-test/pages/Jobs/Jobs.js","views/gmx-test/lib/i18n.js","views/gmx-test/App/App.js","views/gmx-test/lib/useRouteQuery.js","components/AppRouter.jsx","components/UI/warning/Warning.jsx","App.js","index.js"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","webpackAsyncContext","Promise","then","ids","t","Logo","className","href","Button","children","disabled","clickHandler","isMain","props","classes","btnActive","childProps","join","toString","Wallet","address","window","outerWidth","substr","onClick","GlobalStatsContext","createContext","UserStatsContext","ARBITRUM","requestAccount","setWalletAddress","ethereum","networkVersion","Number","alert","request","method","params","chainId","ethers","utils","hexlify","location","reload","console","log","chainName","nativeCurrency","symbol","decimals","rpcUrls","blockExplorerUrls","accounts","connectWallet","netProvider","getDefaultProvider","mmProvider","providers","Web3Provider","undefined","signer","getSigner","DDL_ETH","Contract","_DDL_ETH","abi","DDL_ETH_signed","connect","DDL_BTC","_DDL_BTC","DDL_BTC_signed","DDL_POOL","_DDL_POOL","DDL_POOL_signed","OptManager","_OptManager","USDC","_USDC","USDC_signed","PriceProviderETH","_PriceProviderETH","PriceProviderBTC","_PriceProviderBTC","separateThousands","num","symb","str","split","intPart","fractionPart","hasFraction","replace","length","convertInputNum","result","match","removeNonNumeric","sepToNumber","floor","fraction","Math","formatForContract","val","getGlobalStats","globalStats","getTotalBalance","totalBalance","toNumber","totalLocked","totalSupplied","round","formatUnits","availToBorrow","totalBorrowed","utilRate","borrowAPY","getUserStats","walletAddress","balanceOf","balance","shareOf","curBalance","avail","min","userStats","getOptionStats","isETH","contract","contract_signed","profitByOption","intrinsicValue","maxBorrowLimit","borrowLimit","borrowedByOption","borrowLimitUsed","currentLiqPrice","liqPrice","realVals","contracts","Tabs","links","cls","link","linkCls","isActive","to","name","Header","setGlobalStats","useContext","setUserStats","userAddress","hot","hegicOperationalTreasury","HegicOperationalTreasury","iface","Interface","OptionsManager","strategyMap","Map","HegicStrategyATM_CALL_ETH","HegicStrategyOTM_CALL_110_ETH","HegicStrategyOTM_CALL_120_ETH","HegicStrategyOTM_CALL_130_ETH","HegicStrategyATM_CALL_BTC","HegicStrategyOTM_CALL_110_BTC","HegicStrategyOTM_CALL_120_BTC","HegicStrategyOTM_CALL_130_BTC","HegicStrategyATM_PUT_ETH","HegicStrategyOTM_PUT_70_ETH","HegicStrategyOTM_PUT_80_ETH","HegicStrategyOTM_PUT_90_ETH","HegicStrategyATM_PUT_BTC","HegicStrategyOTM_PUT_70_BTC","HegicStrategyOTM_PUT_80_BTC","HegicStrategyOTM_PUT_90_BTC","transferTopics","encodeFilterTopics","getLogs","transferLogs","arrObj","event","decodeData","decodeEventLog","data","topics","lockedLiquidity","tokenId","lockL","state","includes","expiration","Date","now","strategyInf","get","strategy","push","HegicStrategy","inf","strategyData","amount","strike","res","isCALL","PriceProvider","latestRoundData","curPrice","diff","priorLiqPrice","useEffect","stats","getOptionByUser","options","loc","useLocation","headerLinks","find","pathname","Footer","target","xmlns","width","height","viewBox","fill","clipPath","rx","d","fillRule","clipRule","Modal","visible","setVisible","resetModal","closeModal","onMouseDown","stopPropagation","Input","msg","setValue","setBtnActive","type","NumberInput","value","onChange","onBlur","Form","maxVal","inputProps","btnText","btnIsActive","onSubmit","modalVisible","useState","class","setState","setVal","action","preventDefault","maxWarningMsg","validateForm","isModal","maxOnClick","btnIsDisabled","Loader","style","stroke","strokeWidth","strokeLinecap","cx","cy","r","errAlert","err","reason","message","BorrowModal","updateOptionStats","isLoading","setIsLoading","option","initStep","step","setStep","inputVal","setInputVal","setLiqPrice","available","classic","prior","max","steps","title","approve","wait","placeholder","lockOption","borrow","isVisible","el","i","Pagination","totalPages","page","changePage","useMemo","pagesArray","pagesArr","getPagesArray","p","usePages","RepayModal","repay","unlock","isStep","OptionItem","initBorrowStep","setInitBorrowStep","initRepayStep","setInitRepayStep","repayDisabled","setRepayDisabled","isApprovedOrOwner","ownerOf","owner","key","stat","convertedNum","unit","setBorrowModalState","borrowModalState","setRepayModalState","repayModalState","OptionsList","optionStats","ms","h","dResult","hResult","Fragment","isModalLoading","filter","BorrowMarket","setIsModalLoading","updateModalState","optI","slice","opt","setTotalPages","limit","setPage","fetchOptions","filteredOptions","isAuth","setIsAuth","Boolean","fetchedOptions","lowerBound","upperBound","setOptions","totalCount","ceil","getPageCount","setFilter","items","filterItems","item","useFilter","checked","bool","SupplyCard","toFixed","tsc","provideFrom","WithdrawCard","withdraw","SupplyMarket","supplyStep","setSupplyStep","MarketInfoBoard","CONTRACTS","Treasury","BUSD","GMT","Vault","Router","Reader","AmmFactory","AmmFactoryV2","OrderBook","OrderBookReader","GmxMigrator","USDG","NATIVE_TOKEN","XGMT","GMT_USDG_PAIR","XGMT_USDG_PAIR","GMT_USDG_FARM","XGMT_USDG_FARM","USDG_YIELD_TRACKER","XGMT_YIELD_TRACKER","GMT_USDG_FARM_TRACKER_XGMT","GMT_USDG_FARM_TRACKER_NATIVE","XGMT_USDG_FARM_TRACKER_XGMT","XGMT_USDG_FARM_TRACKER_NATIVE","AUTO","AUTO_USDG_PAIR","AUTO_USDG_FARM","AUTO_USDG_FARM_TRACKER_XGMT","AUTO_USDG_FARM_TRACKER_NATIVE","GMT_GMX_IOU","XGMT_GMX_IOU","GMT_USDG_GMX_IOU","XGMT_USDG_GMX_IOU","VaultReader","GlpManager","RewardRouter","RewardReader","GLP","GMX","ES_GMX","BN_GMX","ES_GMX_IOU","StakedGmxTracker","BonusGmxTracker","FeeGmxTracker","StakedGlpTracker","FeeGlpTracker","StakedGmxDistributor","StakedGlpDistributor","GmxVester","GlpVester","PositionRouter","PositionManager","ReferralStorage","ReferralReader","OrderExecutor","UniswapGmxEthPool","TraderJoeGmxAvaxPool","getContract","TOKENS","coingeckoUrl","imageUrl","constants","AddressZero","isNative","isWrapped","baseSymbol","isUsdg","isStable","isShortable","isTempHidden","ADDITIONAL_TOKENS","CHAIN_IDS","TOKENS_MAP","TOKENS_BY_SYMBOL_MAP","j","tokens","concat","token","WRAPPED_TOKENS_MAP","NATIVE_TOKENS_MAP","getWrappedToken","getNativeToken","getTokens","isValidToken","getToken","getTokenBySymbol","getWhitelistedTokens","MAINNET","createRandom","AVALANCHE","ARBITRUM_TESTNET","DEFAULT_CHAIN_ID","CHAIN_ID","SELECTED_NETWORK_LOCAL_STORAGE_KEY","IS_NETWORK_DISABLED","CHAIN_NAMES_MAP","alchemyWhitelistedDomains","ARBITRUM_RPC_PROVIDERS","AVALANCHE_RPC_PROVIDERS","WALLET_CONNECT_LOCALSTORAGE_KEY","SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY","CURRENT_PROVIDER_LOCALSTORAGE_KEY","LANGUAGE_LOCALSTORAGE_KEY","getChainName","USDG_ADDRESS","MAX_LEVERAGE","USDG_DECIMALS","USD_DECIMALS","BASIS_POINTS_DIVISOR","DUST_BNB","DUST_USD","expandDecimals","PRECISION","DEFAULT_MAX_USDG_AMOUNT","TAX_BASIS_POINTS","MARGIN_FEE_BASIS_POINTS","LIQUIDATION_FEE","THRESHOLD_REDEMPTION_VALUE","FUNDING_RATE_PRECISION","SWAP","INCREASE","DECREASE","LONG","SHORT","MARKET","LIMIT","STOP","LEVERAGE_ORDER_OPTIONS","SWAP_ORDER_OPTIONS","SWAP_OPTIONS","SLIPPAGE_BPS_KEY","REFERRAL_CODE_KEY","REFERRAL_CODE_QUERY_PARAM","TRIGGER_PREFIX_ABOVE","TRIGGER_PREFIX_BELOW","HIGH_EXECUTION_FEES_MAP","coingecko","arbitrum","ETH","BTC","LINK","UNI","USDT","DAI","MIM","FRAX","avalanche","AVAX","supportedChainIds","isDevelopment","injectedConnector","InjectedConnector","getWalletConnectConnector","localStorage","getItem","WalletConnectConnector","rpc","qrcode","deserialize","entries","_type","bigNumberify","isHomeSite","process","REACT_APP_IS_HOME_SITE","helperToast","content","opts","toast","dismiss","success","error","useLocalStorageByChainId","defaultValue","useLocalStorage","internalValue","setInternalValue","useCallback","useLocalStorageSerializeKey","JSON","stringify","getLiquidationPriceFromDelta","liquidationAmount","size","collateral","averagePrice","isLong","eq","gt","priceDelta","sub","mul","div","add","replaceNativeTokenAddress","path","nativeTokenAddress","updatedPath","getMarginFee","sizeDelta","afterFeeUsd","getServerBaseUrl","document","hostname","fromLocalStorage","getServerUrl","isTriggerRatioInverted","fromTokenInfo","toTokenInfo","maxPrice","lt","getExchangeRate","tokenAInfo","tokenBInfo","inverted","minPrice","getMostAbundantStableToken","infoTokens","availableAmount","whitelistedTokens","stableToken","info","getTokenInfo","adjustedAvailableAmount","adjustForDecimals","shouldInvertTriggerRatio","tokenA","tokenB","getExchangeRateDisplay","rate","rateValue","formatAmount","omitSymbols","adjustForDecimalsFactory","n","number","divDecimals","mulDecimals","getFeeBasisPoints","usdgDelta","feeBasisPoints","taxBasisPoints","increment","usdgSupply","totalTokenWeights","usdgAmount","initialAmount","nextAmount","targetAmount","weight","getTargetUsdgAmount","initialDiff","nextDiff","rebateBps","averageDiff","taxBps","getNextFromAmount","toAmount","fromTokenAddress","toTokenAddress","toTokenPriceUsd","ratio","forSwap","fromTokenMinPrice","toTokenMaxPrice","fromToken","toToken","contractMinPrice","contractMaxPrice","fromAmountBasedOnRatio","adjustDecimals","isZero","fromAmount","swapFeeBasisPoints","feeBasisPoints0","feeBasisPoints1","getNextToAmount","toAmountBasedOnRatio","getSwapFeeBasisPoints","redemptionAmount","expectedAmount","getProfitPrice","closePrice","position","profitPrice","calculatePositionDelta","price","lastIncreasedTime","delta","pendingDelta","minProfitExpired","hasProfit","lte","deltaPercentage","pendingDeltaPercentage","getDeltaStr","deltaStr","deltaPercentageStr","getLeverage","increaseSize","collateralDelta","increaseCollateral","entryFundingRate","cumulativeFundingRate","includeDelta","nextSize","gte","remainingCollateral","fundingFee","getLiquidationPrice","adjustedDelta","positionFee","liquidationPriceForFees","liquidationPriceForMaxLeverage","getUsd","tokenAddress","orderOption","triggerPriceUsd","getTriggerPrice","getPositionKey","account","collateralTokenAddress","indexTokenAddress","getPositionContractKey","collateralToken","indexToken","solidityKeccak256","BSC_RPC_PROVIDERS","RPC_PROVIDERS","FALLBACK_PROVIDERS","host","formatDateTime","time","formatDateFn","activateInjectedProvider","providerName","isCoinbaseWallet","isMetaMask","provider","setSelectedProvider","getInjectedConnector","useChainId","useWeb3React","chainIdFromLocalStorage","parseInt","removeItem","clearWalletConnectData","clearWalletLinkData","x","startsWith","getProvider","library","_","sample","StaticJsonRpcProvider","getFallbackProvider","BigNumber","from","pow","limitDecimals","maxDecimals","amountStr","dotIndex","indexOf","_parseOrdersData","ordersData","indexes","extractor","uintPropsLength","addressPropsLength","uintProps","addressProps","count","orders","sliced","order","index","parseDecreaseOrdersData","decreaseOrdersData","triggerPrice","triggerAboveThreshold","parseIncreaseOrdersData","increaseOrdersData","purchaseToken","purchaseTokenAmount","parseSwapOrdersData","swapOrdersData","shouldUnwrap","amountIn","minOut","triggerRatio","every","getOrderKey","useAccountOrders","flagOrdersEnabled","overrideAccount","connectedAccount","shouldRequest","orderBookAddress","orderBookReaderAddress","useSWR","dedupingInterval","fetcher","active","orderBookContract","orderBookReaderContract","fetchIndexesFromServer","ordersIndexesUrl","fetch","json","ret","toLowerCase","sort","a","b","catch","swap","increase","decrease","fetchLastIndex","_hex","fetchLastIndexes","all","getRange","_indexes","getIndexes","knownIndexes","lastIndex","getOrders","parseFunc","serverIndexes","lastIndexes","swapOrders","increaseOrders","decreaseOrders","mutate","tokenDecimals","displayDecimals","useCommas","minDecimals","padEnd","padDecimals","numberWithCommas","formatAmountFree","parseFloat","trimZeroDecimals","parseValue","pValue","isNaN","parseUnits","parts","getExplorerUrl","usePrevious","ref","useRef","current","approveTokens","setIsApproving","spender","onApproveSubmitted","pendingTxns","setPendingTxns","includeMessage","Token","MaxUint256","txUrl","hash","rel","pendingTxn","failMsg","finally","shouldRaiseGasError","replaceNative","NETWORK_METADATA","addNetwork","metadata","switchNetwork","setItem","chainIdHex","getInjectedHandler","activate","fn","UnsupportedChainIdError","errString","setTokenUsingIndexPrices","indexPrices","indexPrice","indexPriceBn","spreadBps","MAX_PRICE_DEVIATION_BASIS_POINTS","minPrimaryPrice","halfSpreadBps","getInfoTokens","tokenBalances","vaultTokenInfo","fundingRateInfo","vaultPropsLength","parse","poolAmount","reservedAmount","bufferAmount","maxUsdgAmount","globalShortSize","maxGlobalShortSize","maxGlobalLongSize","guaranteedUsd","maxPrimaryPrice","maxAvailableShort","hasMaxAvailableShort","availableUsd","maxAvailableLong","hasMaxAvailableLong","remainingLongSize","maxLongCapacity","managedUsd","managedAmount","fundingRate","CHART_PERIODS","sleep","getPageTitle","isHashZero","HashZero","isAddressZero","isLocal","getHomeUrl","getAppBaseUrl","getPositionForOrder","positionsMap","getOrderError","positionForOrder","twitterIcon","mediumIcon","githubIcon","telegramIcon","discordIcon","parseEther","nativeTokenSymbol","defaultCollateralSymbol","defaultFlagOrdersEnabled","positionReaderPropsLength","v2","SWAP_ORDER_EXECUTION_GAS_FEE","INCREASE_ORDER_EXECUTION_GAS_FEE","DECREASE_ORDER_EXECUTION_GAS_FEE","wrappedTokenSymbol","getConstant","chainlinkClient","createClient","arbitrumGraphClient","avalancheGraphClient","nissohGraphClient","arbitrumReferralsGraphClient","avalancheReferralsGraphClient","uri","ApolloClient","cache","InMemoryCache","get1InchSwapUrl","rootUrl","contractInfo","additionalArgs","args","arg0","arg1","isAddress","contractCall","getContractCall","shouldCallFallback","handleFallback","reject","fallbackProvider","contractName","setTimeout","ToastifyDebug","open","setOpen","old","NOT_ENOUGH_FUNDS","USER_DENIED","SLIPPAGE","RPC_ERROR","TX_ERROR_PATTERNS","extractError","ex","patterns","pattern","matchCode","matchMessage","GAS_PRICE_ADJUSTMENT_MAP","MAX_GAS_PRICE_MAP","setGasPrice","txnOpts","maxGasPrice","premium","getGasPrice","gasPrice","getFeeData","feeData","maxPriorityFeePerGas","maxFeePerGas","getGasLimit","estimateGas","gasLimit","callContract","Array","isArray","sentMsg","hideSuccessMsg","successMsg","autoCloseToast","errorData","originalError","autoClose","FEED_ID_MAP","BTC_USD","ETH_USD","BNB_USD","LINK_USD","UNI_USD","SUSHI_USD","AVAX_USD","AAVE_USD","YFI_USD","SPELL_USD","timezoneOffset","getTimezoneOffset","getChartPricesFromStats","period","timeDiff","url","done","lastEx","ok","status","statusText","prices","OBSOLETE_THRESHOLD","updatedAt","toISOString","close","c","high","low","l","getChainlinkChartPricesFromGraph","tokenSymbol","marketName","feedId","requests","query","gql","chunks","uniqTs","Set","forEach","chunk","rounds","has","unixTimestamp","periodTime","candles","first","prevTsGroup","prevPrice","ts","tsGroup","getCandlesFromPrices","useChartPrices","currentAveragePrice","swrKey","warn","focusThrottleInterval","updatePrices","currentAveragePriceString","retPrices","periodSeconds","priceData","getStablePriceData","_prices","currentCandleTime","last","averagePriceValue","newCandle","appendCurrentAveragePrice","newPrices","prevTime","fillGaps","getGmxGraphClient","useAllOrdersStats","setRes","graphClient","orderStat","useInfoTokens","vaultReaderAddress","vaultAddress","positionRouterAddress","whitelistedTokenAddresses","indexPricesUrl","refreshInterval","refreshWhenHidden","useUserStat","userStat","useLiquidationsData","setData","_data","liquidatedPositions","markPrice","useAllPositions","aggregatedTradeOpens","dataItem","initialPosition","getPosition","positionData","getFundingFee","marginFee","fee","collateralDiffPercent","danger","useAllOrders","charAt","toUpperCase","substring","orderFromChain","path0","path1","path2","createdTimestamp","usePositionsForOrders","reduce","memo","invariant","condition","errorMsg","useTrades","forSingleAccount","afterId","urlItem","URL","searchParams","append","trades","updateTrades","item0","item1","data0","data1","time0","timestamp","time1","block0","blockNumber","block1","useMinExecutionFee","multiplier","minExecutionFee","finalExecutionFee","estimatedExecutionFee","finalExecutionFeeUSD","isFeeHigh","getHighExecutionFee","minExecutionFeeUSD","minExecutionFeeErrorMessage","useStakedGmxSupply","gmxAddressArb","stakedGmxTrackerAddressArb","arbData","arbMutate","gmxAddressAvax","stakedGmxTrackerAddressAvax","avaxData","avaxMutate","useHasOutdatedUi","text","hasOutdatedUi","useGmxPrice","libraries","poolAddress","UniPool","uniPoolSlot0","updateUniPoolSlot0","ethAddress","ethPrice","updateEthPrice","gmxPrice","UniToken","gmxAddress","poolTokenPrice","Pool","sqrtPriceX96","tick","priceOf","toSignificant","useGmxPriceFromArbitrum","gmxPriceFromArbitrum","mutateFromArbitrum","UniswapV2","updateReserves","gmxReserve","_reserve0","avaxReserve","_reserve1","avaxAddress","avaxPrice","updateAvaxPrice","useGmxPriceFromAvalanche","gmxPriceFromAvalanche","mutateFromAvalanche","useTotalGmxSupply","gmxSupplyUrlArbitrum","gmxSupply","updateGmxSupply","total","useTotalGmxStaked","stakedGmxTrackerAddressArbitrum","totalStakedGmx","stakedGmxSupplyArbitrum","updateStakedGmxSupplyArbitrum","stakedGmxSupplyAvax","updateStakedGmxSupplyAvax","avax","useTotalGmxInLiquidity","poolAddressArbitrum","poolAddressAvax","totalGMX","gmxInLiquidityOnArbitrum","mutateGMXInLiquidityOnArbitrum","gmxInLiquidityOnAvax","mutateGMXInLiquidityOnAvax","approvePlugin","pluginAddress","routerAddress","createSwapOrder","executionFee","shouldWrap","createIncreaseOrder","fromETH","createDecreaseOrder","cancelSwapOrder","cancelDecreaseOrder","cancelIncreaseOrder","handleCancelOrder","func","cancelMultipleOrders","ordersWithTypes","allIndexes","groupBy","v","updateDecreaseOrder","updateIncreaseOrder","updateSwapOrder","_executeOrder","feeReceiver","positionManagerAddress","executeSwapOrder","executeIncreaseOrder","executeDecreaseOrder","IS_TOUCH","Tooltip","enabled","intervalCloseRef","intervalOpenRef","trigger","onMouseEnter","clearInterval","onMouseClick","onMouseLeave","disableHandleStyle","handleClassName","handle","renderContent","FEES_42161","feeUsd","createFeeList","list","AssetDropdown","SEO","customMeta","meta","description","image","Helmet","property","StatsTooltipRow","label","showDollar","arbitrumIcon","avalancheIcon","TOUCH_MOVE_CONTAINER_CLASS_NAME","allowTouchMoveFn","body","parentElement","setIsVisible","zIndex","onAfterOpen","allowContentTouchMove","disableBodyScrollLock","modalRef","disableLock","disableBodyScroll","allowTouchMove","enableBodyScroll","clearAllBodyScrollLocks","useLockBodyScroll","keyCode","addEventListener","removeEventListener","motion","initial","animate","exit","variants","hidden","opacity","transition","duration","overflow","fontSize","Checkbox","isChecked","setIsChecked","selected","Tab","setOption","optionLabels","icons","src","alt","Portal","root","createElement","appendChild","removeChild","createPortal","TooltipWithPortal","coords","setCoords","tooltipWidth","setTooltipWidth","handlerRef","updateTooltipCoords","rect","getBoundingClientRect","left","top","y","scrollY","fitHandleWidth","closeOnDoubleClick","TokenSelector","isModalVisible","setIsModalVisible","searchKeyword","setSearchKeyword","tokenInfo","mintingCap","showMintingCap","selectedTokenLabel","showBalances","showTokenImgInDropdown","showSymbolImage","showNewCaret","getTokenState","visibleTokens","onSelectToken","tokenImage","require","filteredTokens","tokenIndex","tokenPopupImage","mintAmount","tokenState","portalClassName","default","strokeLinejoin","dropDownIcon","ExchangeInfoRow","isTop","isWarning","HIGH_SPREAD_THRESHOLD","ConfirmationBox","fromTokenUsd","toTokenUsd","isSwap","isMarketOrder","isShort","isHigherSlippageAllowed","setIsHigherSlippageAllowed","onConfirmationClick","setIsConfirming","shortCollateralAddress","hasExistingPosition","leverage","existingPosition","existingLiquidationPrice","displayLiquidationPrice","shortCollateralToken","isPendingConfirmation","fees","feesUsd","isSubmitting","fromUsdMin","toUsdMax","nextAveragePrice","feeBps","savedSlippageAmount","isProfitWarningAccepted","setIsProfitWarningAccepted","isTriggerWarningAccepted","setIsTriggerWarningAccepted","isLimitOrdersVisible","setIsLimitOrdersVisible","onCancelOrderClick","collateralAfterFees","existingOrder","wrappedToken","sameToken","existingOrders","existingTriggerOrders","decreaseOrdersThatWillBeExecuted","getError","hasPendingProfit","spread","fromSpread","toSpread","isHigh","getSpread","showSpread","allowedSlippage","renderSpreadWarning","renderFeeWarning","MIN_PROFIT_TIME","renderMinProfitWarning","renderExistingOrderWarning","sizeInToken","triggerPricePrefix","renderExistingTriggerErrors","existingTriggerOrderLength","orderText","renderExistingTriggerWarning","renderMain","renderExecutionFee","renderAvailableLiquidity","availableLiquidity","isLiquidityRisk","riskThresholdBps","poolWithoutBuffer","adjustedMaxGlobalShortSize","sizeTokens","renderMarginSection","renderSwapSection","getPrimaryText","OrdersToa","isPluginApproving","approveOrderBook","REGEX_VERIFY_BYTES32","getGraphClient","decodeReferralCode","hexCode","parseBytes32String","String","fromCharCode","trim","encodeReferralCode","final","formatBytes32String","useUserReferralCode","localStorageCode","referralStorageAddress","onChainCode","localStorageCodeOwner","test","attachedOnChain","userReferralCode","userReferralCodeString","NoLiquidityErrorModal","outputCurrency","modalError","setModalError","nativeToken","inputCurrency","swapTokenSymbol","oneInchSwapUrl","SWAP_ICONS","longImg","shortImg","swapImg","longActiveImg","shortActiveImg","leverageSliderHandle","dragging","restProps","prefixCls","overlay","placement","Handle","SwapBox","pendingPositions","setPendingPositions","setFromTokenAddress","setToTokenAddress","swapOption","setSwapOption","tokenSelection","setTokenSelection","isConfirming","setIsPendingConfirmation","savedIsPnlInLeverage","orderBookApproved","positionRouterApproved","isWaitingForPluginApproval","approvePositionRouter","setIsWaitingForPluginApproval","isWaitingForPositionRouterApproval","setIsWaitingForPositionRouterApproval","isPositionRouterApproving","savedShouldDisableValidationForTesting","fromValue","setFromValue","toValue","setToValue","anchorOnFromAmount","setAnchorOnFromAmount","isApproving","isWaitingForApproval","setIsWaitingForApproval","setIsSubmitting","setShortCollateralAddress","leverageOption","setLeverageOption","isLeverageSliderEnabled","hasLeverageOption","ordersToaOpen","setOrdersToaOpen","setOrderOption","positionKey","orderOptions","orderOptionLabels","triggerPriceValue","setTriggerPriceValue","fromTokens","stableTokens","indexTokens","shortableTokens","toTokens","needOrderBookApproval","prevNeedOrderBookApproval","needPositionRouterApproval","prevNeedPositionRouterApproval","tokenAllowanceAddress","tokenAllowance","Api","fromBalance","toBalance","isPotentialWrap","isWrapOrUnwrap","needApproval","prevFromTokenAddress","prevNeedApproval","prevToTokenAddress","triggerRatioValue","setTriggerRatioValue","triggerRatioInverted","maxToTokenOut","maxToTokenOutUSD","maxFromTokenInUSD","maxFromTokenIn","maxSwapAmountUsd","entryMarkPrice","nextToAmount","nextToValue","nextFromAmount","nextFromValue","updateSwapAmounts","leverageMultiplier","fromUsdMinAfterFee","toNumerator","toDenominator","baseFromAmountUsd","swapFees","updateLeverageAmounts","nextDelta","nextHasProfit","nextPrice","divisor","getNextAveragePrice","liquidationPrice","getToLabel","currentRate","usdgFromAmount","getSwapError","requiredAmount","swapAmount","sizeUsd","stableTokenAmount","getLeverageError","wrap","WETH","unwrap","multiPath","referralCode","increasePosition","tokenAddress0","refPrice","priceBasisPoints","priceLimit","boundedFromAmount","contractAddress","pendingChanges","isStopOrder","showFromAndToSection","showTriggerPriceSection","showTriggerRatioSection","feeTokenPrice","setFromValueToMaximumAvailable","maxAvailableAmount","shouldShowMaxButton","getTokenLabel","evt","positive","negative","marks","modal","errorCode","isPrimaryEnabled","isSupportedChain","indexTokenInfo","nextToAmountUsd","ChartTokenSelector","selectedToken","onSelect","as","Items","Item","marginLeft","getChartToken","ExchangeTVChart","positions","savedShouldShowPositionLines","currentChart","setCurrentChart","currentSeries","setCurrentSeries","setPeriod","hoveredCandlestick","setHoveredCandlestick","chartToken","setChartToken","tmp","previousMarketName","currentOrders","chartRef","updatePriceData","chartInited","setChartInited","scaleChart","timeScale","setVisibleRange","onCrosshairMove","seriesPrices","values","point","chart","createChart","offsetWidth","offsetHeight","layout","backgroundColor","textColor","fontFamily","localization","timeFormatter","businessDayOrTimestamp","grid","vertLines","color","horzLines","rightOffset","borderVisible","barSpacing","timeVisible","fixLeftEdge","priceScale","crosshair","horzLine","vertLine","mode","subscribeCrosshairMove","series","addCandlestickSeries","lineColor","topColor","bottomColor","lineWidth","priceLineColor","downColor","wickDownColor","upColor","wickUpColor","interval","setInterval","resizeChart","resize","lines","createPriceLine","line","removePriceLine","deltaPrice","candleStatsHtml","candlestick","timeThreshold","average","CLOSE_ICONS","Market","marketImg","Market_active","marketActiveImg","Stop","triggerImg","Stop_active","triggerActiveImg","ORDER_SIZE_DUST_USD","getTokenAmount","usdAmount","shouldSwap","receiveToken","isCollateralWrapped","isSameToken","isUnwrap","PositionSeller","keepLeverage","setKeepLeverage","prevIsVisible","savedRecieveTokenAddress","setSavedRecieveTokenAddress","swapToToken","setSwapToToken","maxAmount","maxAmountFormatted","maxAmountFormattedFree","convertedAmount","convertedAmountFormatted","nextLeverage","nextLiquidationPrice","isClosing","nextCollateral","isNotEnoughReceiveTokenLiquidity","isCollateralPoolCapacityExceeded","swapFeeToken","swapFee","isSwapAllowed","receiveAmount","convertedReceiveAmount","totalFees","executionFeeUsd","residualSize","abs","deductions","collateralInfo","receiveTokenInfo","onClickPrimary","minProfitExpiration","minProfitTimeExpired","withdrawETH","prefix","warning","tokenOptionInfo","convertedTokenAmount","maxInUsd","maxIn","maxOut","maxOutUsd","fromInfo","toInfo","getSwapLimits","DEPOSIT","WITHDRAW","EDIT_OPTIONS","EDIT_ICONS","depositImg","withdrawImg","depositActiveImg","withdrawActiveImg","PositionEditor","nextLeverageExcludingPnl","isSwapping","setIsSwapping","isDeposit","isWithdrawal","resetForm","depositCollateral","collateralSnapshot","expectingCollateralChange","withdrawCollateral","SpinningLoader","ROOT_SHARE_URL","UPLOAD_URL","UPLOAD_SHARE","config","quality","canvasWidth","canvasHeight","getShareURL","imageInfo","PositionShareCard","positionRef","userAffiliateCode","uploadedImageInfo","uploadedImageError","sharePositionBgImg","deltaAfterFeesPercentageStr","homeURL","backgroundImage","gmxLogo","PositionShare","setIsPositionShareModalOpen","isPositionShareModalOpen","positionToShare","affiliateCodes","setAffiliateCodes","variables","parsedAffiliateCodes","referrerTotalStats","useAffiliateCodes","setUploadedImageInfo","setUploadedImageError","useCopyToClipboard","copyToClipboard","sourceLoaded","setSourceLoaded","img","Image","onload","useLoadImage","shareBgImg","tweetLink","hashtag","finalURL","encodeURIComponent","getTwitterIntentURL","element","toJpeg","dataUrl","download","click","PositionDropdown","getOrdersForPosition","hasMatchingIndexToken","hasMatchingCollateralToken","PositionsList","positionsDataIsLoading","setListSection","showPnlAfterFees","setMarket","positionToEditKey","setPositionToEditKey","positionToSellKey","setPositionToSellKey","isPositionEditorVisible","setIsPositionEditorVisible","isPositionSellerVisible","setIsPositionSellerVisible","setCollateralTokenAddress","editPosition","sellPosition","borrowFeeUSD","borrowFeeRate","netValue","deltaBeforeFeesStr","deltaAfterFeesStr","collateralAfterFee","hasLowCollateral","colSpan","positionOrders","hasOrderError","hasPositionProfit","positionDelta","onPositionClick","hasPendingChanges","muted","OrderEditor","setEditingOrder","initialRatio","indexTokenMarkPrice","OrdersList","hideActions","cancelOrderIdList","setCancelOrderIdList","editingOrder","onCancelClick","onEditClick","renderHead","isAllOrdersSelected","allOrderIds","renderEmptyRow","renderActions","renderLargeList","markExchangeRate","orderId","prevState","indexTokenSymbol","collateralTokenInfo","collateralUSD","renderSmallList","getOrderActionTitle","actionDisplay","renderLiquidationTooltip","liquidationData","minCollateral","borrowFee","loss","getLiquidationData","liquidationsDataMap","TradeHistory","shouldShowPaginationButtons","pageIds","setPageIds","pageIndex","setPageIndex","liquidationsData","getMsg","trade","tradeData","defaultMsg","tokenAmount","tokenIn","tokenOut","amountOut","acceptablePrice","flags","isOrderExecution","isLiquidation","longShortDisplay","executionPriceDisplay","executionPrice","sizeDeltaDisplay","priceDisplay","getPositionDisplay","fromAmountDisplay","toAmountDisplay","amountInDisplay","minOutDisplay","tradesWithMessages","txhash","lastTrade","ExchangeWalletTokens","balanceUsd","ExchangeBanner","hideBanner","transform","notifications","pushSuccessNotification","transactionHash","pushErrorNotification","getTokenAddress","applyPendingChanges","getPositions","positionQuery","updatedPositions","propsLength","collateralTokens","contractKey","hasRealisedProfit","realisedPnl","updatedPosition","closingFee","hasProfitAfterFees","pendingDeltaAfterFees","deltaPercentageAfterFees","getPositionQuery","Exchange","forwardRef","setSavedIsPnlInLeverage","savedShowPnlAfterFees","setSavedShouldShowPositionLines","showBanner","setShowBanner","bannerHidden","setBannerHidden","setUpdatedPositions","currentAccount","readerAddress","usdgAddress","defaultTokenSelection","selectedSwapOption","newTokenSelection","tokenAddresses","positionDataError","VaultV2","useImperativeHandle","onUpdatePosition","reserveAmount","onClosePosition","onIncreasePosition","indexTokenItem","onDecreasePosition","onCancelIncreasePosition","blockGap","timeGap","onCancelDecreasePosition","receiver","setIsPluginApproving","setIsPositionRouterApproving","setIsCancelMultipleOrderProcessing","tx","LIST_SECTIONS","listSection","LIST_SECTIONS_LABELS","Orders","Positions","getListSection","section","hiddenLimit","getTime","homeEventsData","validTill","bodyText","buttons","newTab","appEventsData","Icon","EventToast","button","useEventToast","isHome","visited","setVisited","isFuture","custom","EventToastContainer","useWindowScroll","breakpoint","createBreakpoint","XL","L","S","useBreakpoint","reverseOrder","gutter","containerClassName","containerStyle","right","toastOptions","Infinity","RedirectPopupModal","redirectModalVisible","setRedirectModalVisible","appRedirectUrl","setRedirectPopupTimestamp","setShouldHideRedirectModal","shouldHideRedirectModal","removeRedirectPopupTimestamp","Jobs","defaultLocale","dynamicActivate","locale","messages","i18n","load","loadLocaleData","en","plurals","es","zh","ko","ru","ja","fr","getLibrary","autoRefreshOnNetworkChange","Zoom","cssTransition","enter","appendPosition","collapse","collapseDuration","arbWsProvider","WebSocketProvider","avaxWsProvider","JsonRpcProvider","FullApp","exchangeRef","connector","deactivate","history","useNavigate","activatingConnector","setActivatingConnector","triedEager","tried","setTried","shouldTryWalletConnect","rawData","connected","SyntaxError","currentProviderName","isAuthorized","useEagerConnect","suppress","injected","on","handleConnect","handleChainChanged","handleAccountsChanged","handleNetworkChanged","networkId","removeListener","useInactiveListener","search","React","URLSearchParams","useRouteQuery","encodedReferralCode","queryParams","delete","navigator","connectInjectedWallet","userOnMobileDevice","userAgent","attemptActivateWallet","walletModalVisible","setWalletModalVisible","selectedToPage","isSettingsVisible","setIsSettingsVisible","setSavedSlippageAmount","slippageAmount","setSlippageAmount","isPnlInLeverage","setIsPnlInLeverage","shouldDisableValidationForTesting","setShouldDisableValidationForTesting","setShowPnlAfterFees","setSavedShowPnlAfterFees","setSavedShouldDisableValidationForTesting","decodedRefCode","checkPendingTxns","updatedPendingTxns","getTransactionReceipt","receipt","wsVaultAbi","VaultV2b","wsProvider","getWsProvider","wsVault","wsPositionRouter","callExchangeRef","off","hideProgressBar","newestOnTop","closeOnClick","draggable","pauseOnHover","metamaskImg","hasCoinBaseWalletExtension","coinbaseImg","walletConnect","UserRejectedRequestErrorWalletConnect","getWalletConnectHandler","walletConnectImg","slippage","basisPoints","GMXInterface","defaultLanguage","AppRouter","navigate","allowance","Warning","App","Provider","ReactDOM","createRoot","getElementById","render","StrictMode"],"mappings":"u//bAAA,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,q0zaCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,g8wCCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,oC,kwqDCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,qC,u7NCAzC,OAAe,cAA0B,wC,yCCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,0C,wDCAzC,OAAe,cAA0B,qC,6CCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,8C,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,8C,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,gC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,iC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,8C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0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,cAA0B,uC,+BCAzC,OAAe,8/C,+BCAf,OAAe,s1D,+BCAf,OAAe,cAA0B,+B,+BCAzC,OAAe,spE,+BCAf,OAAe,cAA0B,oC,+BCAzC,OAAe,07D,+BCAf,OAAe,cAA0B,mC,+BCAzC,OAAe,kwC,+BCAf,OAAe,kvG,+BCAf,OAAe,cAA0B,4C,+BCAzC,OAAe,8lK,+BCAf,OAAe,cAA0B,uC,+BCAzC,OAAe,8lY,+BCAf,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,s/S,+BCAf,OAAe,cAA0B,iC,+BCAzC,OAAe,cAA0B,wC,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,szB,+BCAf,OAAe,suB,+BCAf,OAAe,8zB,+BCAf,OAAe,khB,+BCAf,OAAe,kmB,+BCAf,OAAe,skB,+BCAf,OAAe,k7B,+BCAf,OAAe,syB,+BCAf,OAAe,02B,+BCAf,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,4C,+BCAzC,OAAe,cAA0B,gC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,03C,+BCAf,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,yC,+BCAzC,OAAe,cAA0B,oC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,+C,+BCAzC,OAAe,cAA0B,gD,+BCAzC,OAAe,cAA0B,0C,+BCAzC,OAAe,cAA0B,2C,+BCAzC,OAAe,cAA0B,sC,+BCAzC,OAAe,cAA0B,kC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,cAA0B,uC,+BCAzC,OAAe,cAA0B,qC,+BCAzC,OAAe,00D,+BCAf,OAAe,cAA0B,mC,+BCAzC,OAAe,cAA0B,iD,+BCAzC,OAAe,cAA0B,qC,+BCAzC,O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","file":"static/js/main.7538fe71.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/ic_arbitrum_16.f4c1a9fe.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_16.90aca01d.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_24.21ec7bfe.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_24.be4891c9.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_96.b12913b6.svg\";","export default __webpack_public_path__ + \"static/media/ic_avalanche_96.b6255c50.svg\";","export default __webpack_public_path__ + \"static/media/ic_language24.ceaebef6.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX.b956aa96.svg\";","export default __webpack_public_path__ + \"static/media/ic_checked.b4f2217c.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_24.eff381d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_40.087335c1.svg\";","export default __webpack_public_path__ + \"static/media/ic_wallet_24.4be97369.svg\";","export default __webpack_public_path__ + \"static/media/ic_banxa.06412144.svg\";","export default __webpack_public_path__ + \"static/media/ic_binance_logo.46794a16.svg\";","export default __webpack_public_path__ + \"static/media/ic_multiswap.e577f4fa.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_16.9d97766b.svg\";","export default __webpack_public_path__ + \"static/media/ic_synapse.b100121a.svg\";","export default __webpack_public_path__ + \"static/media/logo_GMX_small.f593fa5c.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_40.03a12ea6.svg\";","export default __webpack_public_path__ + \"static/media/DROP_DOWN.ef525fad.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx.01459500.svg\";","export default __webpack_public_path__ + \"static/media/coinbaseWallet.ae86a337.png\";","export default __webpack_public_path__ + \"static/media/icon_dollar.8908c0f2.svg\";","export default __webpack_public_path__ + \"static/media/icon_dollar_active.059213a3.svg\";","export default __webpack_public_path__ + \"static/media/icon_market.1494995a.svg\";","export default __webpack_public_path__ + \"static/media/icon_market_active.257003dd.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger.abfde3ea.svg\";","export default __webpack_public_path__ + \"static/media/icon_trigger_active.8868a9b4.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw.09cda1b1.svg\";","export default __webpack_public_path__ + \"static/media/icon_withdraw_active.1e16a67d.svg\";","export default __webpack_public_path__ + \"static/media/long.0f8a81b9.svg\";","export default __webpack_public_path__ + \"static/media/long_active.d0e619ea.svg\";","export default __webpack_public_path__ + \"static/media/short.670d98eb.svg\";","export default __webpack_public_path__ + \"static/media/short_active.d3098d1c.svg\";","export default __webpack_public_path__ + \"static/media/gmx-logo-with-name.03a4464f.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_30.403cd87e.svg\";","export default __webpack_public_path__ + \"static/media/ic_buy_glp.8eb00e6a.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_convert_down.74b7eb02.svg\";","export default __webpack_public_path__ + \"static/media/ic_copy_16.fafdf331.svg\";","export default __webpack_public_path__ + \"static/media/ic_cost.56371371.svg\";","export default __webpack_public_path__ + \"static/media/ic_discord.be4d716c.svg\";","export default __webpack_public_path__ + \"static/media/ic_github.dbd4de8a.svg\";","export default __webpack_public_path__ + \"static/media/ic_glp_custom.11dd75db.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_40.8cd483b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_arbitrum.59f04e87.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_avax.fb50658c.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_custom.fd35b66a.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_footer.e7821eb2.svg\";","export default __webpack_public_path__ + \"static/media/ic_hop.0f4a98a0.svg\";","export default __webpack_public_path__ + \"static/media/ic_liquidity.f00d35e4.svg\";","export default __webpack_public_path__ + \"static/media/ic_medium.f6051b2e.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_new_link_16.5b7cb7bf.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus_arbitrum.b358dc93.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign_out_16.1b0564f3.svg\";","export default __webpack_public_path__ + \"static/media/ic_simpleswaps.4cd51f2a.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats.f0a18011.svg\";","export default __webpack_public_path__ + \"static/media/ic_telegram.af1a4a66.svg\";","export default __webpack_public_path__ + \"static/media/ic_totaluser.e274ef10.svg\";","export default __webpack_public_path__ + \"static/media/ic_trading.2c53815a.svg\";","export default __webpack_public_path__ + \"static/media/ic_twitter.9f35b403.svg\";","export default __webpack_public_path__ + \"static/media/metamask.4b5d438a.png\";","export default __webpack_public_path__ + \"static/media/position-share-bg.900fbfaa.png\";","export default __webpack_public_path__ + \"static/media/swap.40fb8e49.svg\";","export default __webpack_public_path__ + \"static/media/walletconnect-circle-blue.31c29967.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.ec9214a7.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.eb3c180f.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.7e94b658.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.9db627fc.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.02be34a3.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.38f03c0f.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.6edf6fb0.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.2dd52bee.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_24.bab8cadc.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_24.f992927a.svg\";","export default __webpack_public_path__ + \"static/media/ic_busd_24.2432ce58.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_24.bafa9da6.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_24.6b1d8a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_24.7349c478.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_24.2b59d7e0.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_24.0d641e52.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_24.b6a1708c.svg\";","export default __webpack_public_path__ + \"static/media/ic_settings_24.25d2f4a7.svg\";","export default __webpack_public_path__ + \"static/media/ic_tether_24.a7c88dcd.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_24.47e903f7.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_24.0952740b.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_24.5ab8778d.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_24.43583fc4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_24.bc395894.svg\";","var map = {\n\t\"./Anyswap.png\": 536,\n\t\"./Anyswap.svg\": 537,\n\t\"./Artwork.svg\": 538,\n\t\"./Artwork_gmx.svg\": 539,\n\t\"./Banxa.png\": 540,\n\t\"./DROP_DOWN.svg\": 287,\n\t\"./Hop.png\": 541,\n\t\"./Hop.svg\": 542,\n\t\"./Hop_dark.png\": 543,\n\t\"./Hop_dark.svg\": 544,\n\t\"./Synapse.png\": 545,\n\t\"./Synapse.svg\": 546,\n\t\"./binance.png\": 547,\n\t\"./bscscan.png\": 548,\n\t\"./btn_big_arbitrum.png\": 549,\n\t\"./btn_big_avalanche.png\": 550,\n\t\"./btn_big_bsc.png\": 551,\n\t\"./btn_big_purchasegmx.png\": 552,\n\t\"./btn_big_purchasegmx.svg\": 553,\n\t\"./buy_gmx.svg\": 288,\n\t\"./buy_gmx_bond.svg\": 554,\n\t\"./buy_transfer_eth.svg\": 555,\n\t\"./coinbaseWallet.png\": 289,\n\t\"./coingecko.png\": 556,\n\t\"./cross.svg\": 557,\n\t\"./ddl/chevron-down.svg\": 558,\n\t\"./ddl/chevron-down_sm.svg\": 559,\n\t\"./ddl/ic_btc_40.png\": 560,\n\t\"./ddl/ic_btc_40.svg\": 388,\n\t\"./ddl/ic_dai_40.png\": 561,\n\t\"./ddl/ic_dai_40.svg\": 389,\n\t\"./ddl/ic_eth_40.png\": 562,\n\t\"./ddl/ic_eth_40.svg\": 272,\n\t\"./ddl/ic_frax_40.png\": 563,\n\t\"./ddl/ic_frax_40.svg\": 390,\n\t\"./ddl/ic_link_40.png\": 564,\n\t\"./ddl/ic_link_40.svg\": 391,\n\t\"./ddl/ic_uni_40.png\": 565,\n\t\"./ddl/ic_uni_40.svg\": 392,\n\t\"./ddl/ic_usdc_40.png\": 566,\n\t\"./ddl/ic_usdc_40.svg\": 393,\n\t\"./ddl/ic_usdt_40.png\": 567,\n\t\"./ddl/ic_usdt_40.svg\": 394,\n\t\"./ddl/ic_weth_40.png\": 568,\n\t\"./ddl/ic_weth_40.svg\": 395,\n\t\"./ddl/icon_arrow.svg\": 569,\n\t\"./ddl/icon_check.svg\": 570,\n\t\"./ddl/icon_close.svg\": 571,\n\t\"./ddl/icon_close_sm.svg\": 572,\n\t\"./ddl/icon_close_toast.svg\": 573,\n\t\"./ddl/icon_dollar.svg\": 290,\n\t\"./ddl/icon_dollar_active.svg\": 291,\n\t\"./ddl/icon_market.svg\": 292,\n\t\"./ddl/icon_market_active.svg\": 293,\n\t\"./ddl/icon_trigger.svg\": 294,\n\t\"./ddl/icon_trigger_active.svg\": 295,\n\t\"./ddl/icon_withdraw.svg\": 296,\n\t\"./ddl/icon_withdraw_active.svg\": 297,\n\t\"./ddl/lock.svg\": 574,\n\t\"./ddl/long.svg\": 298,\n\t\"./ddl/long_active.svg\": 299,\n\t\"./ddl/short.svg\": 300,\n\t\"./ddl/short_active.svg\": 301,\n\t\"./flag_en.svg\": 575,\n\t\"./flag_es.svg\": 576,\n\t\"./flag_fr.svg\": 577,\n\t\"./flag_ja.svg\": 578,\n\t\"./flag_ko.svg\": 579,\n\t\"./flag_ru.svg\": 580,\n\t\"./flag_zh.svg\": 581,\n\t\"./glp_icon.svg\": 582,\n\t\"./gmx-logo-final-white-small.png\": 583,\n\t\"./gmx-logo-final-white.png\": 584,\n\t\"./gmx-logo-final.png\": 585,\n\t\"./gmx-logo-glow.png\": 586,\n\t\"./gmx-logo-with-name.svg\": 302,\n\t\"./gmx_logo.svg\": 587,\n\t\"./graphite-01.png\": 588,\n\t\"./ic-communityproject.svg\": 589,\n\t\"./ic_arbitrum_16.svg\": 112,\n\t\"./ic_arbitrum_24.svg\": 153,\n\t\"./ic_arbitrum_96.svg\": 170,\n\t\"./ic_arbitrum_hover_16.svg\": 590,\n\t\"./ic_arrowleft16.svg\": 591,\n\t\"./ic_arrowright16.svg\": 592,\n\t\"./ic_avalanche_16.svg\": 113,\n\t\"./ic_avalanche_24.svg\": 154,\n\t\"./ic_avalanche_96.svg\": 171,\n\t\"./ic_avax_24.svg\": 396,\n\t\"./ic_avax_30.svg\": 303,\n\t\"./ic_avax_40.svg\": 593,\n\t\"./ic_banxa.svg\": 241,\n\t\"./ic_binance_logo.svg\": 242,\n\t\"./ic_bsc.svg\": 594,\n\t\"./ic_bsc_96.svg\": 595,\n\t\"./ic_btc.b_24.svg\": 397,\n\t\"./ic_btc.b_40.svg\": 596,\n\t\"./ic_btc_24.svg\": 398,\n\t\"./ic_btc_40.svg\": 597,\n\t\"./ic_busd_24.svg\": 399,\n\t\"./ic_buy_glp.svg\": 304,\n\t\"./ic_cash.png\": 598,\n\t\"./ic_cash.svg\": 599,\n\t\"./ic_checked.svg\": 194,\n\t\"./ic_coingecko_16.svg\": 305,\n\t\"./ic_coingecko_hover_16.svg\": 600,\n\t\"./ic_convert_down.svg\": 306,\n\t\"./ic_copy_16.svg\": 307,\n\t\"./ic_cost.svg\": 308,\n\t\"./ic_dai_24.svg\": 400,\n\t\"./ic_dai_40.svg\": 601,\n\t\"./ic_discord.svg\": 309,\n\t\"./ic_eth_24.svg\": 401,\n\t\"./ic_eth_40.svg\": 602,\n\t\"./ic_frax_24.svg\": 402,\n\t\"./ic_frax_40.svg\": 603,\n\t\"./ic_github.svg\": 310,\n\t\"./ic_glp_24.svg\": 195,\n\t\"./ic_glp_40.svg\": 196,\n\t\"./ic_glp_custom.svg\": 311,\n\t\"./ic_gmx.svg\": 604,\n\t\"./ic_gmx_24.svg\": 403,\n\t\"./ic_gmx_30.svg\": 605,\n\t\"./ic_gmx_40.svg\": 312,\n\t\"./ic_gmx_64.svg\": 606,\n\t\"./ic_gmx_arbitrum.svg\": 313,\n\t\"./ic_gmx_avax.svg\": 314,\n\t\"./ic_gmx_big.svg\": 607,\n\t\"./ic_gmx_custom.svg\": 315,\n\t\"./ic_gmx_footer.svg\": 316,\n\t\"./ic_hop.svg\": 317,\n\t\"./ic_info.svg\": 608,\n\t\"./ic_language24.svg\": 172,\n\t\"./ic_link_24.svg\": 404,\n\t\"./ic_link_40.svg\": 609,\n\t\"./ic_liquidity.svg\": 318,\n\t\"./ic_medium.svg\": 319,\n\t\"./ic_menu_dots.svg\": 610,\n\t\"./ic_metamask_16.svg\": 320,\n\t\"./ic_metamask_hover_16.svg\": 611,\n\t\"./ic_mim_24.svg\": 405,\n\t\"./ic_mim_40.svg\": 612,\n\t\"./ic_multiswap.svg\": 243,\n\t\"./ic_new_link_16.svg\": 321,\n\t\"./ic_olympus.svg\": 613,\n\t\"./ic_olympus_arbitrum.svg\": 322,\n\t\"./ic_selector_dropdowns.svg\": 614,\n\t\"./ic_settings_16.svg\": 244,\n\t\"./ic_settings_24.svg\": 406,\n\t\"./ic_sign in_16.svg\": 615,\n\t\"./ic_sign_out_16.svg\": 323,\n\t\"./ic_simpleswaps.svg\": 324,\n\t\"./ic_stats.svg\": 325,\n\t\"./ic_stats_big.svg\": 616,\n\t\"./ic_synapse.svg\": 245,\n\t\"./ic_telegram.svg\": 326,\n\t\"./ic_tether_24.svg\": 407,\n\t\"./ic_tokens.svg\": 617,\n\t\"./ic_totaluser.svg\": 327,\n\t\"./ic_trading.svg\": 328,\n\t\"./ic_transfer_avax.svg\": 618,\n\t\"./ic_twitter.svg\": 329,\n\t\"./ic_uni_24.svg\": 408,\n\t\"./ic_uni_40.svg\": 619,\n\t\"./ic_usdc.e_24.svg\": 409,\n\t\"./ic_usdc.e_40.svg\": 620,\n\t\"./ic_usdc_24.svg\": 410,\n\t\"./ic_usdc_40.svg\": 621,\n\t\"./ic_usdt_24.svg\": 411,\n\t\"./ic_usdt_40.svg\": 622,\n\t\"./ic_wallet_24.svg\": 230,\n\t\"./ic_wavax_24.svg\": 412,\n\t\"./ic_wavax_40.svg\": 623,\n\t\"./ic_weth_24.svg\": 413,\n\t\"./ic_weth_40.svg\": 624,\n\t\"./lg_arbitrum.svg\": 625,\n\t\"./logo_GMX.svg\": 173,\n\t\"./logo_GMX_small.svg\": 246,\n\t\"./long.svg\": 626,\n\t\"./metamask-text.svg\": 627,\n\t\"./metamask.png\": 330,\n\t\"./page-not-found.svg\": 628,\n\t\"./position-share-bg.png\": 331,\n\t\"./short.svg\": 629,\n\t\"./swap.svg\": 332,\n\t\"./trading.jpg\": 630,\n\t\"./wallet-connect-text.svg\": 631,\n\t\"./walletconnect-circle-blue.svg\": 333,\n\t\"./wave-01.png\": 632,\n\t\"./wave-02.png\": 633\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 535;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAZlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+Vn2moAAAAInRSTlMABhQdEgsKKUeEstIZdbP/wlfRwTjgpJRm8fDhhaNlk3ZW+c569wAAAsRJREFUeAHs0AEBwEAMAjFaCv4lbz7+IiHSrJ+3I40vfVzOo72it3JaxHLxI4IIIogggggiiCDia9cMdx5FwSj8aw84Ug4qCoL96t7/Te68YL7GjrPpn0nsxCepLXrA8IQ3NoY/IULp5keLJ0YbHKM1/gfd3PQni7Ak6b6bXU9y8DigIz1+hx9JsvefKwITyfBsVCIOgrPkjlGp7WDiPJqPFWF6kvHpISgox6R+DXKyI35DpK6LJn6oCPEwW/rNw6bEZC4Hc+0iu/Irmttw7wDdKKB8bSKwaDRPF6bpANUM96/aTT2GR3dOEeLBY9p7ABY6vDJkGJakG1N24krVdp+h5qRRaceyNPptgfg0O8dBuiVKt/spRbTiAa8esP4qQjFIxABwnMq85GO2K3Hm+PBVogcCqWp8zAaIMrKTHAL1CUVE8sgDJk7YU+fXlYgrOiJVneBaxjBrS44d4LkC41SOFtClergALkPI7oQiJoYjD5HUeGFMzU/qGi9T0ZKZ+1IZFRMzY5mpZ2ctvLTMfWQaiogAwY4nFOG4HHuY8ILnhtqJCFSlMryvKnIv57DOWGlWKph+Dstii4h6r8BTiggvHnQ88iCBTv8kct2JUAylMtyIgsvirOstFKNrJdV9l4atkTOWRmRSOw9YORx5QHIo5HEnAjaVylhrf5WsZKy0WivSYkmtRQQ9RFM4oQiTmW76q3/WReChh/h8sPqdiI51Yi1/3L4eafZ1DFOOClBz/69+sIiQe93SbE4oAj5TmOOzWHj0pLc0KChOOxHI9EXpMpN0ul5pZWi2pZFl+LkHnJOMUyf9Z7m0bIP6blNY8D59xoZROETV88Wf/5T3Eb6dVm3wPp4r3sS5v/bFjL83KRtcIlRL6/EuYfkbRFzvLC8Rl4hLxCXiEnGJuET8A+HaTFa3F17bC68Np9uG02sL8rYF+T+idSlyqmiqtwAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Anyswap.491d1f32.svg\";","export default __webpack_public_path__ + \"static/media/Artwork.a2d41b8c.svg\";","export default __webpack_public_path__ + \"static/media/Artwork_gmx.cc61d732.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAAoCAMAAABO8gGqAAABcVBMVEUAAAAoKDwnKTsnKTsnKTuGh5HJyc6urrWFhpA1Nkehoqrx8vO7vMF4eoVCRFRrbHhQUWARbooBqMcRcojKys////+vr7ZdX2zW19ry8vMUZIIBo8cBqMYBrMUUbYCTlJ0iN00BnsgAoscArMUDqbwiO0zl5ee8vcLX2NsNd50Bp8YBrcYAscQPgpHk5OYeRF8AmcgAo8cUaYEBssUAtsMdTl0Gh7gBmckPdpMPe5IBtsQIn6mgoalcXmtqa3gWVnoBlcoAmckDmMAlMUQiOUwDqr0Bu8MYYm4lL0QDicIBlMoAu8MDtrolM0MSYI0Bj8oFi7clMkQFpbMAv8EUd34iNU0Bi8sBkMsbTGgZXm8AwMIAxMEiPUwKb6gBi8wLeqcKl6EAv8IBxcEMl5YbRWkBhs0gPVYgRFUBwMIAycAdUlwGeLwBhswRY4wPh48Fuq8UVoQBgs0Azr8YaWwKbKkBzsAKqZ4ZS3IDfcQCxLcbXmRL8BeXAAAABHRSTlMAM7D2JaXEwgAAAp1JREFUeAHszjEBADAQArF7wL/myigDURA4OaWsg3OK+VCqCaeaSbkFF/xswQUfa2XRJa8OxNFNYF6gvUkz7u7u7u7u7m6f/1UqZArW/9wNhZ26kd+JZWvy/uMsjOPGQg8c247rOmHblrwm4a8UQ+K2HUswIp3JGhL0BOEmGRGHBzm6FYA29IXwUBCe5eMgUlAVQKUpLCouKTUvKFyaBO4KwCdBSSoqyMrgWV7wcUGK/VFeUZmpqq4xJej4SLIWSlpSIbGjgm6KBJE6eGgxVo/TSzRUFDU2NbeYEvRpUT39OCE7h9sKpJVHBblU8x0hh0a0tVd0dFZ1dfcYFrRCgp6sy6QRCeb0liNBligQwoXndSxEb19FPxtoHhwyJDg8goy6lAofNxyH7mUk6Ftqy5Eg1pJ6zoix8YnJKTY90z07ZzokQvepVa5xyg0mRs6hQ4KIpdJDzC8s9hXCtXRwaXnFtGDeX9MCHryNkaD6Oh4VrBcYFGJ1bXxdXjc2Z7e2jQjWlyk8lAC4q1v6+IgEVSjCgjmBJJlmZ3dvcR+rg6XDo2MzIaG6LGhaS/3zSTAIBaaJFrhePkuxgJPTtbOgPL+4vDIqWKYap1CGUhoPCbIUPBBaEM+SWu4Livv1ze7eLVPc3R89PBoQ1MvDW9UMetifpF1OgtKJBFPBCWIJPdHs6fn0hWleLx/eDAi6tgK6iYQ2COOQIBBHQT0iNb85HbD3j2fYg30VcBY3D8IefPj8MprieNAsikeC2sbTAXboRJG5+v54Pl0bn5BncVf37MXlw8/vPwrWkUdBXQrXrVZEKZDa8DDFyLAO92r0RCmA6/8rr0iFhKCWNjAEgWmwsmq0RY0XjDpw1IGjDhx14KAfwBz0Q8CDfhB90E9DAACtALoxSNWoNwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAYAAACZvCZrAAAFLElEQVR4Ae3aBWwcRxTG8QjKQqsUEtOJpTJzw+U2zMmGmZlJVIYwYznMya0ZjslU58Jo2Nu43L7Os2ej7eiMMt+30s8ws+a7f2Zn044PIrpbeFDonPAA4EHhbnsceDBJeEC4P2EBwAOyBZ0rIiFrkWSdAAAgm/BgO1kKdeUAAFhJdJaBUCYBABAIAKhzIAAAEAgAQCAAAIEAAAQCABAIAEAg8tcEHIExrqhPc/ui26Pt78wBAAIRmRXs4h3pIe9wH3lGBLa30V80AAJx6aszT0dXHFt+bslxZ+H841Q49xTlzzpDeTOcFJmWHM2dlr4/PD1zBq8a7qwgluU7vMP95B4cINfAMLlGFfbm8QbmELoIVa1Q2qvzANCAgbjyyekuRYuPUNHCY1Q4/wQVzLHioFNkajKFJ6dRaEI6BcdlkX9MDvlHe5zBCcGR/LHuoSE9R8Qhu18eZfYuKIuuvdnQT9QVVHl0qWK+izoP0IAQiPOrTmpFC49TwTyOw2nKm3mW8qaLOExJqYhDcEKGiEO2CEMO+TQ3eYd7yTMsQK7BQZ9reO7MrL4ch0JKf7+I0j88vx+BgDYGlxiFi07PLFygr8ifp888tyKzS8ESV5eCha4ukRkuLTzR9YV/tMvvG+khD8dhqIjDoBDl9I9QVp98yvyI43CO0t45Tym9LlJG72saAgEJBpuUvOfg00IrcgaGjOz+uZRZEYdfKO09jsMFSu51iZJ7XKWzXa6VucbecrSAQIwU9gtOYXu8c+TYcuV8thz7GoBA1ENgftSR1a/gQMaHHIcopb4t4tDzEundOQ7X6czrt4SSA80YiPaCT46fF3T5mo/98T6/7Xxd4iMqPI0HGyR8IMx9W3sbO74pMw/+UOt/+dP7np+Z+vZFEYfLIg7X6OyblXE49UoJnXzJoAYOhE9wxuGLEwinHFPvqsyU4yvifH6/YP/ZOQyG/Fx4wAECEdvxDZk719bpCZH24TVN78ZxuEGnXyumUy+X0skXY3TipdsNvYLwC3ocfiUQDiUCqgNCWQ0rFHUOqwjAJYa5Y+15EQiK7V6/oi4fl/xOsXb6NV41lJKza7l2ppvZO7yC2jfTJUbvGs6fqczLz48N0LgAgeDLitjezSPN3eu/4FUEu/3Tzjo9KU6/VrrjxAsmnXih/EAz3+acWcP5vesRCA0POEjcQFgrB46DZefasl/376n10ppXDMeeLT9/9KnfKX3gH45mDEQXZf9B9YWcdyifv31NMQFIvEDk6O1tYVCVmfs2abVeRfT4q8vhx/887xxIzRkIdl6Iqk96+X6ZoKufv4o9C6dg4HYnJPQKIrZjrd+KgrqS4PfN3es+55DU5XM2cyB6225TjpRzM2QcDOFp9fPbboF+JDnl2Ew82CChA8GXEhyD6vAt0NiejTN4v6IVBMIa99P/D12Jg/r5z9vONay9BwDc5ty7cYUSBUNZSdjfdpp7NnzOG5vGd9u6sPLvxNt7NizncQ5JC/pFta8yLvE3KR3S/QAIhE1sp7zUkMx9WzTewJTv14m1wdmiKYEAQCBquNSwrxSMnet28DhvVJoyHvb5qt43dnxt8KVIGwoEAALBYns3zLQ/4dX/L1Exv3PdAXVlwe/zOM+3ojgwzbqrAYBA1IK5a50uVwa2SwUAQCDkSqFyRbDWj180AAIBAAgEACAQANDwEAgAQCAAAIEAAATiAdsgAMADViAeFJKsCQAA2YQHORB3cynkAFYSAFg5JMkm3N2ODxmJB3kQABLeg1Yc/gOptOvB5Z4VkgAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/Hop.4b77c9e3.svg\";","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/Hop_dark.423942af.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAABmFBMVEUAAAD///////////////////////+PcOZ/UON5R+KNT+iFQeWSYOi4hfWIP+aRP+iIP+WUP+ibPeqSPOiiauz///////////////95VON4U+O3N/C1LO9+WOL///////9yS+F4SeO/JvK+IvF4SOP///////////////9+WOWHVeXRQPbKHvTRO/b///////////+pOOyxKu6+KfG7JvCxKu+wRPH///////////////////////////////////+qL+21J+/CIvLTS/PCIPK2J++sMuz///////////+eT+2iOOu3QfG8MPDNQPbUH/beGff1Zv/gGPjVIfXNNvS+MvOiNuv///////96SOKHQeaZQ+noMvrvDfv3A/3vC/vmRPmHP+V6R+J7SOKIQuaXQefvDfz3Bf2ZQeehNuuzPu27MPDUHfbeG/fTIfWiNuurMuy2J/DBIPGtQO2wKu68KPGwKe7NKvXKHvR3SOJ4SOJ3UuK/SfG0Ku+7QfF7V+OUPuidPeqIQOaRPueQP+eQT+iFQOV6R+MNOs0rAAAAhnRSTlMABhQdEgsKKXb/V/84Gf+z/7OF4SkpZYRWdnVmwVeT////wv//lIU4s1dXOMI44MLSdv+U0v9H4dFHV6PBGbJ10v/gKf//o/DxZkekR3Y4lIUZk4VHZrN2pPHwdjiz/8Ip8fDS4Xaz4XazV3WUhYWkpP//V/+z/2bB//+FOMJHZrKF/8KzVzMrutwAAANDSURBVHgB7NDFAQRBCERRfHxa8091PYK9Ur8Fzo+IRdMnTMRqHslzUyaxQGFC6oHClfQ90f8QgAAEIACxAOLTuq2AeLcfOyDO67dcZ2qI8y6/rdQzM8TV+m/rYz65LYvt9nkgju7mDWSXp2Q5JdsfxkqscmunzMzMzPjqf4+isrv3iQq6yZzfQlf4W5gZZhkrYRHlFRoqqyo1VVckZGuQmlm6ImrrNNQ31GtqrP0ZtZDbYGeQl6yIpmYNLa1tmpqbfkYdV3WeU9JnxF9//6Pp3//+T45mfdUJDsJkRDkTmMlEPjClqhj59g4iYcqOIK8QmBnkDSiW24MalnoRnV3dPQp6evv6k6MW5mWRBFrUOdmY8ui6GMYF6ccUhQyAox+5HvoSwMYsEaiy50ZYSLeIgcGh4ZHRMYDxicmp6aGZgaSodBHbDUmYdYAGOQsCURBxGn4OgEUZIk+SrTmAjEcrhypBJADkHLIUi5hfWFT90vLK6pqixfWNpLCYi1AtiwINzUL2tjZcF8C2iTIOiWCEcxgXHEk5pqyRzGguxSI2t7aLInZ2d5YU7W1tQnKz52jJS5p4x6NpL7yJANNH9H0E4BFQy6GI/8J8hw1quwTUQjfdW2P/4HDq6Bhg/Phk6vDgNGlrSCFVP0urYQ6ZmmOB4k2EhXOcW1kSoU9VqjHuIgaStourWiblh+XZ+YU+LC/Oz5LXAs7q8c2qDxayLyL0JiERqI0x0EtjDgooFNss5SIur641Xd9cJkcjX1LH1ZA8h3bGFxE8BhYqEVxfKhBliHwXZBQULfIUi6hu1nB7d6upufpnNIehWWa2ozruCoizX0W4oSGMMFIisEYYvjpQYxI1WKBAYIiO0JNpfmLf/3hiP9QmZIWLiBGXxDJC9lWEpKrFkdFFmkXM5qjCI4ooj/F3OCfT/I54fNTw9Pyi6fXxl0vjnRwvwRT9K54R7H3EjL2T/WdDoRve0AhlNTbwEmGOJZ42opr8UB6YaWqGslqaCA7MqFuLuxuw4QmIkTJUJ2ruoYEns3vqD/XB29a2VjA9OpzfPjqcPzrBgxWMBsRoQIwGxGhAjAYEK4geXUwGXV44urwQuuB0dMEpdAny6BJkAMRHfxzYlb9eAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/Synapse.3cfd1d07.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQgAAAAsCAMAAACuYtZZAAAAn1BMVEUAAAD////////////////////////1vjzzuzPzui/yvDTyujD////////////////2xE3/////////////////1nrzuzH////////////////zvTb1wELzvDL0wEbyvDb////////////////////////0uzDzuzHzuy/////////////////////////////0vDLyujD////////1wD3k7xDPAAAANXRSTlMABhQdEgsKZqT/o/EpRzgZOIX/wcIZ0nbx4JSEScJFiVeEk6NlsvbR8vDS4dFmpLPB8FZ1ZcrSjpcAAAKDSURBVHgB7NABAcBQFAFAD/SPvPX4LsIBRz2PB5ycPi7Wge7UhNJpBHV+i1jEIr527aipUR8IAPjTP4KSpGxigaoK0P49AFDv7vt/ttvNmpnrVfrgE7TZmcBOlIf8Jlkk5hsQNwHCRRTfBgjnEKNEgCAHkrhyCHJgieuGYAeWuGYIdri7uTsjkUgKRamW6kIh2GEjNmckUnBh0ECCvUyI+y07CJbY3n8NkUkps7wQQtndRUKQBDuQxIwDQki67UBdao14eESJpw1ebpFg84SX55dZiJJulWtJbWopKGRtqoTqSJXIxlSaOxtTl8LF/mDqZOkQD/H/jzwtXuNXngzPP+KXOYhDroWAFNuh7WwONNQGOttTJqEBa6HVrrPHzgYzPbifj0uGIIeYJdAhZgl0iE8lUhiMMUWOHAxBF91bGv6EfbaljLQUpK6kYOdIwzf0jJ5ArgRiy3VyHqKz1vZQe4iee+nFqt2YE4RwVdSiTmEFxbRjF4z8bS1LY8sO55fG6BCoTR5ClAeAwoBEiPETQvPoKTIYDEVbrKFYvlOxjKhYvp8vlqKzBMGNIUqwaZp2DkIyhJ8GfipxLByC68PH5+vzg+vEPIQ9gbAdZdkRhOBFIpRCp9KnS4egOkkS5MAVcx5CwXQCMVA2HENMrXuftpPQueEH01X8iU0S7BBHMzOiqaqqafPkGIJaJX8aOIZI8vaX3Bf02yOYvdy3vV48hJf47R3mvzXyt0T8CyF2AGAzGP+GEMpSr1sOZY/ppFf2GR6Jb4T6cpRS+NBqdRszUdiq8w5h89Y7hO18cggQ4R88sxEgAkSACBABIkD855JwmCwcL+Tjhf7AaThwGo4g8xHkP7gaLtKObnJaAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/btn_big_arbitrum.ff6ad480.png\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAf8AAAB/CAMAAADW6DvgAAABF1BMVEUbIDIeITUbHDAXGCwhGi2HLjhhJjNhJzNOIzJPIzI8HzBYJjNrKDRqKDRYJTM7Hy+QMDhGITGsNTwqHC51KjWaMTqPMDkzHi8eIDYbHDBFITB0KjYeITaiMzt+LDceITajMzt9LDdCIDCZMTo4HzA+IDBLKDmBMT15LzuuOD+TND05JjhRIzJyKjVwKjU2Hi+RMDgyHi8oIzdSIzJUKTp7LDYjGy5PJDKeMjuELThAIDBjJjSbMjqKLzg5HzBUJDJ5LDYlGy5hJzSSMDkfGSxqKDUpHC5EITEnGy5VJDMcGS02HS9DIDFAIDFFITFDIDAsHC4eITYcHzMaGy8TFiMeITUAAAASFiIcHzJlLDowJDduLjpCJjgHX8VeAAAAWXRSTlM4+O////////////////////////////+18P//+f/////////////////////////////////////////////////////////////////////6vvJR+SRTwHfs7R4AAA1sSURBVHgB7d2Hmuo6lgVgute2jKRNkLYoTcPgQ01NzjnnnKdzvO//HAOc2+jjkGRjwFT5vzmHtSwkWTaDwTe+iZOowJYqkY2GWhP2KIMvkLGsRuMJnf9Hm6lDiwq/UeBGRDOPBfUwGgh+bfZCuEY08ZvfGPzCt3Ca1vhMOCLL3DrCl5zBUWLUyRZYBVpMI54i/yRa5iHdOn+wnzmYqcGVvjX4xcx/OWszwldacIQxOCM6xVwOJ0gAWr6Uy4rQKpvyv6WoeDRHJoUrKEW4zuATTiOFrawhIFobT/4hJOdbELFFL36N0C6aeu9XEXdgFJcTXCYa1xB2N8zfCoCsISAq5doouXFKcTmfvPgNg5aRVZZwJ+SUGkecZwyuY4LcLH/GPlERR8hY6TYHOXKV31J4dqKVGgpOU4RrqZJuk390+JJTdBB+sNT6JCfl//zEspoTjmNcT8IQtChepeX8FQ4RGyQ0rlhuMMkhv7ESvBfR8miCI1SLE1tvkO+XLuZPFse4INiiYQjmJpPcuJxN1/E7vCtGqcMpYWhzZfvSav5acJRUJUDD10ITcIv8zcwCxuD9Icf7U8KocA2aTCbjclS8+c+Q7Zd/JeVfOzR+e5kpQdJq/noa8Y6R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\"","export default __webpack_public_path__ + \"static/media/btn_big_bsc.5e5ec82b.png\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYwAAAB4CAYAAADhTcXxAAAj8klEQVR4Ae2d51brStPnWWtuYLK7CTY44ICTZDIccs4bNnviEy5y5vOEz3Mtk3PSS51+eN0+pX+7ZIT2yzr14bd0gvBfLUzFlmpucWV9s7yy+S/e+F9vJGJG35Ly7h/e+KM77v0xWdqj4x/GR2KfU47uhToe3Uum544Opgv0y6u/ZNNdu+C6XA+vd++fJeXqTkgDU91OljpnYdY4co3iUBT6PpdrW8VqDm6TJWJ4+6a98/l67bMJe0iUe1efuL47sk3YPg3vP6rxv8g/kJ+Ym5v7W3PllY3/ubA4/A8l000ysbSemNGPN17Hx/VJSj4bDrP+PSktDPHnVrbg/7P9e9IiPG2uCbXbp+mfvbyTlBqHUNf07kgvuN4S0mwc4LUKMKsnYT18bxUFU9kuXnM+SkqNo0I1TXmT/n4K1TVrN6TpGDx+8j3tJzZ6SbdPo5c3ezD4sAb5B/ITvzoN4CxEmOYpv0h3xMbbGWaIGdyTM4JfcqbDdH94ut6Rbt58P12z//Crsf2H8+nG1lS2QnrQWZnBA1qnHNtPzPB5ut4Gv7e5sBAnpereb9hNSrW9L2EYFcW2zovVXNpITOwMeGll9/MdVP2AtLjTqGcMVpe3w05jefNfzn3Uuxnn3WQReNiAugXS+WvX+Jz2pacFdRkg0qf/Pja+7fPAl+4C6oJMhzKX8HrbZ7IvRO0Xpsv0cnBO4XvuO99n6Hxzhpw48aUMlKKY5lliOjfFOcXuAzmpv3ZUtpfNHpjaPgXrwXOoPDWXr3cLR/5Bb2t7iYlfxsYWnbsYAcPN9MZGtf+AHR5peplJqbIJI20bcz3orNauwveuvOGMb3oJjmF7d3id+H7lw0JEa+eRSwGY8gY5TDVCytdifkCZxsxVhewlxh3nLBw4WEW2N3p29qh+EHIYCXYYi3FSap4Ijdn9dCO+dj3FI59MRuqDh3BdPxY4DQe8eaZ1xo197wbrNo6RLtMvLY3C6+3eOL3+ndBwbgFtnJHlianT2nHkoihKPpBdooAyeyXgytmIzvUMfdJXR4xL92GH0blwEfdSLGqgOc8GjSjuSxBLo/SMpB5oRA++yZxG5wrXGVEmVN0L6D5N153maFd2fScFImhQFuP3Gd/bnDH9J4pkPuvzFUUpO7tkujhwDQX5NsLBKvoZbr9OscMATd5xzbpzJa9zxz+YQeMXwCCPCIwv3vVjqvueHnZWdEOm7WRgusMnfK0re2HN6HlqSkk7J3wn5X6mx89FZTEffG9heWnW/oNxZS9F+d1g6sWUQ7ldmq3MbBonmbMSpweDUIHD6N35ETcs6TBPFf9g2AimOI7l3XBPINSI7t6GncbqSSDCD2cmpdXj4C8V6E7PFhpHqXowKwFlMcIOszefTecyMS3nZBTly2B7P2XrMQ4Ac8fZpfhHAVtyQWXI1+5cixwGGTxmRG3/QerduCGtHUzpfzxO7QmUyptgu+smaaQzxFG76T8GsxLCvkERPdzbzTWpMS1sHqchTyVt/1tiw/cW3y+XOc5cxlKUnxFwmNXTIjZb8N5sjEvMeWN6jywIpQCzgJ1VTJegYD7oMMiT2uFLiiFl3XNAL7GDZ2c8iV5wmxYZPFFZidfzWF2fgSJ9Uz9CN4nTvgjonrt1+p9RDu94su3LsJ60/LeyR7/s7F/I7i1ulCtK8cifRVreo+99cQ6qepDY4ffERg4czOWDqR1R/4GYDELjV/fAY+56B2M9OqbYQ9t/5A6DdcuREeXdc9hbeL+Q4NOk8wP6RZCOxIDjRvR8xG9y9w6cO0xs9BrS5FS2RJ9FjmtKdC/QFG+Hw/cW/16YHqXABe78UMOnKMCGzQ9end30AbYll6fDBy9Qb4L6IXAYiyPmaZhha8r+6O3aXWJal+Fzmue+XliXGOBGNGUNNvY8ZXkLZiNQD+gGy0y1w7/c7H8EyldjyImF7y+Rx7ZVnPkxvX7OWthZkR7fKqgoCtmrNzbTqTjyfFDWrp4ldvjDETF8O+WC+oUBdximfQ09jUO8hdMtcDEOPYyFPFvYaTSOg/U/G0FvTDef3xioKW9km+4jvy6cdTnCmr5XzwXTOAVrzl8LfUGpBo13dCmKUlQ2Y6sHqZgaZtJhVHbCnsZn7ebjBqRzG9YD2Bg3omnL53xE/z8CWQ/TlGc4Q7xTwizvTo/u+8843YQ7ywboM7PvzR6G1j2OIACKoihjh2HXHplRwRGxvPaNDDvSAXqEqFdg6sdAcx9oSZ0V2KIrje6HM6y3eZZX884hiCAURQmiDsOSIWldJfYNE6I9yexb1Z7GBjTspLARL29l1PyG9eQZB/V5ZovuHVgf6MrfRaMoilJQhlEUpnbMDCghzTjwLiiMqZ/I9bAmgR0l1pbRSOOY0C+qovxOUYdR2f2Vknd07IyPy7tveEeAKW/IXqXRvn3jhh87b7gjw4yPDNG2VzmKoijqMBRFURR1GIqiKIo6DEVRFEVRh6EoiqLYXnaKdxgknDPTNOuHkzRyorB7piiKkvO4ZW+y6Tsln43f0DwGDqOIC/XnbHgXCy4aU9+HWuFJfmO4vkC3uptpzTOz6NAv+ZdFUeRjB5qniWlNUnqnfZqvZuNo0i4G7KCJniZLUmRUZ2DWC+Uzt9eRp8POwwxuwcsA98CscKeHNEW6RDfjrNzmKfulYI/OMR03PEpRlIKhbfuVzTGf/PocGqXgB7W+bTDLm/nrDR7DwbTDt6nOYZB383+Iexpu1Ezn4iMXCmdpG0HGAW8grSN6Sn+XfvTM9WbJdMrr6VlE4DXCJn6ZaZ1mA4+nVZSfSsFjSwmzdl1oAOXsxouzD2uXxVRgYm6X8EweOeGpo9gOm95NetPbtM+xp/HZcB9Ii8vhQoGHQ/oEjLppce781ZMEThGcXRdNGXMjZCtbgae9D7guEc44cuuVmOoeOWnHcEzpneiNlQyzNRRlcVS8w6Cpm/NRsZo197db1HpN4yhl6mdUwPxwYBcrm2CX1PyQ+gvc07CMA826ZkaS1frBoHN55O9Iv4HVPf/81No/zbUIOw3c4zAjMDu7sun+f/9u2qhHphfsqeQ8y9d0b3AGCaMnRVHM6kmxev0nbzzr8WeX3cAgN57Z8KZ3/ZBODkfDwydBajVIzOjFRbH4QpmWJPIvrabPt6XrmjiPl8xoct50PQc34o2DUFbjCKXplW28Xq5HWVju0Rlb77veUlzItD2z/j0p1UIbFRRFMSu7zoD3w7YW0rnMptc846NZR6+URECH4Xm3x4DxxmNSuXF4JajJHToPGG8Q+SNn1ThOrcHxMpGbuOfriXT7D7DU4+m5Eba2H2hqXcp0uzfiN+FmM9oXXLdZUPQ0P2AvjFQUBc8Lmml++fI22SLh++7wqGxKHmQP7r17txFDZsjKG5NR+oiVkNiFAj1m3FJLXPRyQZQp9O/Tz4//EdABusvbKKthWVjQAC/GnhfHeqIxppXNUCSBZ5DHr/5QKPwsS/4IJjUSiqIYPNZAUPp+TWz/IWuvZmyb+o/ZnvQ2nZv0MaXlTSwa6k10LmQXGor8u7c4asYRe2qZyDSOx3ruiH8eGGX6DJQhuC3HsB4aXm/rTN6TWH+FzgxSPxzrg7GzeaAoSq/I56jc5hrfHmXcNGNp1HSEh+NBh0GRIJsD0ToX737iuG479oqPeJY2AaJuU2Y9CU70khpFm8ET1+Okl30W4rBm5yr4SL4ZPKeuVzyWtbrndNZZFiXC9B61PKQUgTbLQcCZO/N9sh+TdihG9gRQ2aFkQfAuKdAImZz5PBQ+XwEi9t5toO62g2dpE8BZkdGbmpmM0stEVB/ker4uHslq2xdTM5NQDdFUf+HaBKgbpjo7X68Ox6vCGeR8YqGiFMM/LP7ZItr6XqzmYjwOOivbBTinU243ccUCs7QhcRjAYw1ffnUapdqhIB06YhfMqO4HfqHX3IA6Z8WfsERGdwRJLRPZtVs8vxvU901lS6LJa4jA2b1je+B8UArjkUS/iD8EsIlBjqK1edM4Kfz5Ddv/lpTqR8Vpti69v+37T+8NuvHSzI551ZkC3lZr3hyF6T7InlCMXqcb8OG3wKJH6SNRU5wVGXLLyzpYl+hcp36R4GfUfsGGnukBXRz5U4nOm1mOMxLWsEfrbJ4W8iTqlIxGUZTydmJa14lpe9Q+72+GpoaSwyBM2mjptZv8HEZ12zkMyDJugPhbVd1FAka8zANqfuMyGNF7DJ8n1SRAmci2zp0emBfOnhaX61J2BGuITvsysRGYEw7uc0Av511IoBRHWtFzcRkNfP2KoihUXrZDchYM307k9lxXuXcLHIb8LYvMs0FjzhrJ/N0tdvDy/nnpzmoxluoxXdt/TN9qGr1OeubyFrw28TpjQQ2RMrOh6LUDdE1s3Uyvc/25aX3kaTZPi/yjAGUMRVGHkUaJk8vrYCpbf8zsMFgfAHs2YEzbl8GGsIu6r0Ft8IrpERKnAcpEVPYaf07rAmY1bJ1QV15DNPVj4X2+E6wXONkcsJ07dw3dMfpchaL8frBvtrccv87uMMzKPjOiUmMa2jlgu/fpxqiyI9LDuriJTltN5yPwoq/F0cd05TVE7ESHwvssbJ4rilIoOqLV9p+5IeNwYxreOQC3fNq1B6yDjSh6poSldiDapwaWQBdrymuIoEzXf3H32YG18WP9iqIoP89hmPqJb8SI7EZcvnOAykaeDtATR/6gTGR76VkNXqdc1/VPFEVRfmcOg4YCVQ8dNTkljlhvfuCibEY0FVAmuhVpz689JvPDf4SJMJaIxxi3D1xRFOV35DAKxq6eJbZ5+Rcu+LF1+YZ3FGJgmUhRFEUpwGEoiqIo6jAURVEUdRiKoiiKgiaG0nvkyr3rL+AwyhsfowIR6CuKoihm7Top7/4hu8MwNISnkYWD9yNn9UA4GCQ8c9sdPTYEsK214P1RRF1OyTsysJaiKAoG2cbOBWdtErK1ebwVt7z7xxkcRnWfz76e1Xgvb8k0+/ekh3Wz6rfP5BPqfL2RRA8gmsEtR1EUxfYemD30bZEZPOSmVR7czfjgXveWz9Ben6TkwMYUjW5tHqfV0EiL+LCuWQeTqOb7wFk9cl25nmOVr0k81L15MkEJ0RrjfYaiKEsxBWyFlm9MRCMYnpNSjgYb2Qg2zM23RSs7+TmM2vaMDqOyiWZay8tFi1H6pKr19Hm0pn3J9SYzjumRP/psKiO1TsOjZ5keHQV60dPHvnydK6AHnBMeh6soPx83ZqBQTOe62FfyL62PZ/wX8LyXaV+l28O1q4J3SS1EgYu8wONR1zklHzQXo3PpjOHIZQFo7KFDnnG4I0jPbN9FAnROeR1EDDdIb7qTrO198Ms34usF99V0zj9n3GRtPyn51Ikv0pNRlPlh0ZpubGrnuriRsDGaNCr/DKpUzO4wKpvhWbjzUWJjHPHDyD/6hlMr/7zWWeprxrGzEGQ6PLpxZZ73c9euYcSAdXFPxfTCb6pFBh6vO6T3PfmHuf1hgOCAdIhRgUOUFiIdoPT1UOb7RY4AcDYi/jEGGn9A58IFnkvxTA6DjJ0zDsubWKR+BKL+gPGu7QO9exax851MPRr1ijVDup0rEL375+EU0jRPkSbMOMjphhyyc2LborfWmuFLcJ2lxuGnGm0be7r1g2LnQIORuYqi8NHVdvhCNiNDi2ErMSNgJ0UOo7o3zgz6t2Gx/iNLh2Ak3rsNbp1lEXT3Jn2XFtZDR56euf4A70kMHvBLF6MXsR7Ozhx0L1yZ7B6cA0bEpunn3VgDw55I3+rMDUUpHunsnPhH5gDL9O58Owj7TNBhmOHTZLTMsgKPlT022Q5S2USGGPYI6PP5kKVbpod5TU/Plne4noOidezY4ul69o1Q3dRU9/xMRByx2959qn4RjTXC9J/A8KvcUBSlcYjth2A6Z4bzyblw+9V/kDsM0zjmETP1HWwPi3Zu2IxpZrTbF/JSj68/eEzfpQX02OdEz5Segf3LKFP4Dn9htvsw1ga604YYmcHTpF5MTf6eJHX8+ES/yhYv9Qkxn+qYFEUxC0OyP6BCIfv5TAPahi/p9rp+IHAYC3FikfEOPUuwtBGcpW3j1/TG5dK6KGIvNY644W5fQD2ftPTMuAfyQuBfWGU7oAuGJTGHzO8vOU7RF6I1uW7cWMMPQfJSn6IooDxfrMNonYOKTAGNcqfrBbH9oMNwcyJwjT748ItpniGnQc1xWWbCeMUOhxqxUZqed+zx9Iy269roJU2Xr7eyCfc921nGsS7EAT1m/PFnuMl+wMlgTO2A7w9XlC+AKW/SLsCiNakaUKyeb5c+M7BbHAXHWbsg9gw7DFPemh6tdy4nRZkh/s6EYcRNc7TxxXJ4SYum2NH5mMqWzLGNAN2b4L5nRoefzxwy1hTv2zYNGpHLI4Agtuf3ivxSXxFIdoNhFMX2i3dSK/tuk81KMVmG7dyyGf3mkzIc0752Wthp+EEsdxi2eycx3u4PH0ewbKY1utmm9xg09rhpzhuxKT9PxjmtdIZvDtKt7qF0jnlokCGg/oO4gQ3mnGd9kIjpUamvsAeL4E4uRVHITtrmxZjWmNz1Kjvp46zpyHukzGHQdix2MjBsU7dV2u6jE4cRtzN2Futhg9q9TWvEss+hGdpUukkrgWFdoDl4Cu57dp/H0zd+X+5l99dlZPmyNGJ6uLeUP6Z1SZr+ZoBi0B1disKwa4+JHZKTAIAyu3MY1CkfvDAPE0hTwttAl8feiyL6tMf0bfQq0ANGvLrPDRKlcrH3eY3jdA/Ob0p4ne5In4f3PUc/UHmInSe/v4d5p58ggmClvvwpbyd27Z4cJoF2nymKUgC2epCY1lVi3zAh2hOMHQbVw6GXAdiIGUhmoEDETemWxLNhBt/SngYep1X9J1QCk6dhKGMB+55D5SHfITOg3vc3vUFOUfZuSjTh6wl3YyiKoiNayXig9CQYETdPgx14aoKn7QJgOkzPOwLIyXFHdE6fkdozMbUjmS6O/GEtERtbv0GNtaFu6zyfiKJxmhifVeJkfHQIPktRFHUYZMzeiSDcqOEmb3gXQFhHGvnzLb7zA/r81Jckzg/Y+hDCXVfyrWvg/soyjvADdoqiFIw6DGoECzF0XHs7rrkj2gYKdgEw40nHmSP/9mX6K3p5CYx0ODM4K9vN+tj98Zj6bIQ1FEUpEHUYxY0S/MaNtjTyBga8NCXiN+UtarhiuhnoOfTNqYqiqMP4bGzvc5DqK4qiFIo6DEVRFEUdhqIoiqKow1AURVGWRjNRvMNY2Z2N6vjIEA85VxRFUUxlk493Xh8fSxvj4zumc+E96U1zJTozsvZG40C4xXR/crLd+iSlNDYCrF1KdN2woPaFo/NBqvpKcEVRvjamfc6choPZXzeydSHyHIY/y9X7If7DHDyPGs+xJj18sSKP51iK5brNU08PrTfspEzvZraX/vXvZAw4JX1wT/ndoK9vp+mg5rc2t3WSvxa9z88F7swuMnvoBuf5DuM1HPljx4FfdU4eyfZAOvTDh2mKMo5m+CaCueHAWQnXWt6YdaqVpyvXM+0zuQ6e1+uop1Pyqe1l11CUIuepuCCxKNzs/d5NIW90ZvO1yUbEbLx0fvCpo9xGDZ9405sZUd/j4IwjWBKiMhcy6qZ9yfUy6Lqb2APvbTrE11Q/wHojpJeD8abBRcNnphvUW3/J5+WDpB09s/vKHNRQZ1UoChipXKie7d2NDXj9l89dW/9xrMXtIo2n5Q7Dti+YpxFlHEsxHhSEz3GjVWOgJ8g40E2kCMSMXvhLDz1s/x7oEkBvJDfeosiBCJbj2AD2HLS9+8ucVC7jWnFJbvDwKyWHOieAoviTT23vvpCNSCYOThvlDsObMw0jf1bzxyUhV49/Pw+NdG0cBZwUdh702Vj33l1f6yw0UIfp4QznBzPeYC1g1jmMHAh4f+0nTKYzpA30TPf68wfNO13SK3TjgFl7W5vLOhXlq+DejF3ZmnFYWcY5/52b9LlD5U3gMFza5U4KG3FHBEtCFM0yI4/6HGbwhDRxllPZwuUmXxP3G6gkJtB0Rz79jmdLZsQcI4ocpuq5+7Uj+UXLew5hbfDG4RyxfRowxaOWYqK1r2cwFAUHoGHobxnaP/wzBo9WwA/u0WAiEwucRu2XTLV620+PmA1Ih2Dk377ADe34xY+cw4ZpMRbrTjPepnPhjDxzjDhycJP8gG7niv8ccpDRt8xRC9NtnhbVzNPXtStKARk1tn8YGnZnveFtZmEocBjVPZaWMHp34dIDMr71A7DAW9KbqmvfABPvyOgxPaK0she61um6netpD8B4Tkq2xZjWYLGu6EFE6qeY0XfnqCSDj4A2nJqI+VA2Yps8alEUJb9+hGdLsvUl510VgOxDyU0PxQ4DGnBu1HCKvxiHI/Y43ThRxMn1OKXGMTRg0EkNQuWkXmIHz0BXZrxN75b3PuoHkl0X6bqyrcKULvq7uzKlrzRfwzpdfK0YF7ksCfQURctKoIT+eTuePHsC7B+GxkybLuyfAodR3iRRzgiPKCVoSLg7DwKbMaZ5HnYagyes27kOalJDGu+x3me6bPws/lmmxR0jxvSffD3y7rL91uUN3oPo4N8L0rb4i4Gp7rqsxpXNFOWr8FOCHNu+ABWZ/DH1Q24/sf3DLO8KHAaqdXvYGJaEqM4PjD2L/FNLGmZhkNjoOzbe1T24OKzr9Gz8Gnzoxq7d0tqY8Q7P2ehRvwevEzgbNn3QnyRYw9E+ywDZOvEgKaRdqoT7LXiTgtPz+zWF4LZK54hil7aK13VBafGataMiZ+dQJWY87hn0fHN9ajt6ZXYM27/ZKTePkjl0Ab546OEVila5oQfOY+0Gp0P85+H5hOk9YD2f9kW4D+H/vMB4m8ZJSBc4RuCsIhr7ei809LtQz/bvP/vhpUm93kOBtdk9XK5TFDmFOgyPz3X8zQs+Yjr2wPYvM5X4hTsMwtSPnMci8f5TsO4FZm4D44abMbb3yGZpw2jE0xU5q8pmYPfQ5bvudOO9GENd3DDHkZaNcHaAy1hA1zm6/KEHLSOu5/dACngatfCyAv7OKErxQBsCxlx7diqX77JZ2U8q239M5nAE/0jCroSBO+vexQkNeP8RlZic3rvxBnuBzcKQSlhAF2h2b4MGcd7d5KmlGtO6FOgCxwh2Domb1dEUpxwJ+yAY6FB9h4F3WeUPBS7mXbtzVXwZQ42S8jcYs7Txxvr4+EYJ8VE70H9OKlshh7G8l9hOoCS0esZTIakxrR+C5vn1Xz7rlUpjyMhyTxo2pu5Y3Q8bplbw4TtyJtnW23/ILcKfHwp1V0/yjrLDus2zHHQQPTLaY+pvaNSvKIVj6ieUxQCHIWlQLW0w48nTIYyNgUNYWneGqXYIr2dm3cG3aYY57GG791l1yTHmFuELdXMdKmU7d8n84Mebwxpjh69v2mNw9KIoypeHHoyuHv5KZe0q5DAwtn1DBovXznDkz41b6wJkLqcBA3ZDmlDXTMs4GrNF4KZ6gHUJoGsj/NRkxhqlbN2E65/kj6IoOtM7axffLO9iIyaPhHFTG28HzUW3tBhlfxdS98nR4xjvaPopgF6MBFeXdJTk5NnLUBRFmX2mt+0+csNNRBAc+a/dyo1n83KSVkba4+Nn31hFURR1GPTwy3yUL1/3BiqKoqjDUBRFURR1GIqiKIr8PVUNR7l3qQ5DURRFCb1o1b1Drrz7B3UYiqIoXwz3Hrzl6ZR8ZtXqulEO5V344B7G1Pb/mhI/ZiebvqIoirI04uOd18fH0sZvKK9/xDl5GUbzOOM707f9yXZ8hncaG0QOi2gcpXD4fuSsMr7aU5azI9dRFOULYponvtNAdhjMIsr2tgvTvnAZxiyvkjCdS7pIPnFunXs65DRMW7gIOBbVHcV6o2fBO/HxjTTDp3SiMaXx0bF2+cEXfj2gCCLsjGu7Mg3E6nF23JdNUdSQ925prLSzUTG9kqj3OVq2Ty8d9e0wtxcj4UtCyba2zwPBa5SUd7L3MNBIVpZtwIzDGW/ZIoCn4zfHETSm9Q8OMmkc83WGs6mPv5J7ecdp4nUyXdO7yaM+Cu4vWGdL51V8Nczi+s8qpRStCeb55AYObIlPLrvTgCbPDnN7IRtDQHbDnR/odZS718lc0Hs1sJhZnUyH0jKOEsg4wOfCLxSbzxBzvVDGYfr5jEo0gye5s2oe56PZuRLcX4983uhKjln0+3SZW84lsMp2YgYPSekNQ0eHm1O8qq8dV/7mY9uX1CwuRqt3l+40pIPVqnvjv+/+reA5DFgfw+kMlXfM8BlkGjjjmLYI073h42B5L4Pr4p5KfsPYV3ZTdZle9I3uT24RGdNDujyl5NiefPRj/Mq1CV+TZ245OaxLnl4PH4sbnrS8PfsoWkVZiIp6HT/Zt/SZ3rJRzK607v9t1/axw4BGCjRMxOkQMG7BP8LqrjuvfSGexBbKcPBnzQ6NjQ3ritNQYOBBNjft/o6+J/8QzBDxMa0T+XD4uueY+TrzytwEZc9XNpSqgEl/unngZ6DMNDLAtC5+M5r1Ulqu4/bEBbzQYeAyyDoR3s1kuzwdgkamcznF0z06TUlW4GZcB3UtGZmFWNIroF1VwleOb4R1eyylg00m50C3JM0tkM0RaCgVDgTMCA+Hh46Z8QrGywJWdiTncUcZ83nwBcBnMStKQZi16+zB0cLE+GgKuGQ/g+z16jFyGNx4skiSFoBnNviT7YKRcHARjSP/fEn0SkaEpWEe1KgWGsUH0qQyjNCbnwNdcnSb0iaTy+AG9/LmFpoh3n+Q90NIk+hcCA39XoouiGAQixH1ImaaumcHz+4PoLzx9Y2BoojK3q8z/b3QvB8byef+2NaF3F4jh2F7bisnKgcAYWZUGKsn4UZ22kXXptTHXbSfrj14Er4r5YDOz1S+MgsDGo7ENVvCn6/u0frwTgaczfG14t8N2HH1Ol6v1Ll1bphuprkinUvSw1lc+NUEeBSsonxVcPCKqwYCbJ9t44UZ9FSb3bkMOwxTO8AeZ/AYNvjMcHvHIX4Gwm9wMt2I/RyDjAnpMKp7gsbuILHxd9LLniHUDn09Wj/dh9l2W0UvbJ3ol8zus3DCnmU9H1Q+AyN5Z51cWNny7u93nMWFf090VJSiAcFcXgCbMnLYWf5eKtvZg0/sOKjnDBzGvBc1j9LgESJrnjhRTm1fsGcZ0MTGiV23Q1zvNq0zWQ8CYHuPnhE9ljaZsq8TZ3OwQQYCAQb/3WDHbPFsdIjt3ftOCjf684dtAsgJpb5XvKbrRRbL8i4FlG/anx+wmIUhs2OuanGev1b1FzbMDjkOqjhxh+EMAvY0Qo9n+k/sIsiTyTwd7oHwZzO4QbRZR7+WN7BedU/+hYp+0LrFX3pwf8E6QaMq+ke0Xjz/HDtUvt6hLIWlHUN2+EIlouB5koy1VC5ou2HrTNiY5yiKpYifqB9+vlbzfDyhlOym3J5lHzk9ePEmoXI9Zo/rB5MOwyzxXgA04u3z0Nxt7rkqm+H6NNLz6VzJRsfSTWiez1iX9xjKo2jTvqZ1Z8wOgG7nWpyl2KHskX+6H0AT95dwypxlOiNdY7pmt4AdT+UNwcNLPx9FMUubaWOu5aOsszfGOaQDsJGzNWOH0bkReRpH2AlYMsTuAshAhg3K4JnpAV1q2k5r6rpIekHwLMLKLtCVG1G8Zxr3H3xnite5K43eBZob4t+raBueHMp+nC7QAz2m3DCd27Geu1dFATZrKAqgsoNZdgjtTJjFkXMO3DlNzziap85hkPHkXg3jIsTb4DZb91mgCQw8HdZktbQPR8Cm9zhFN38jarv34/UG1/mYn2bnVhZFyLfJip9OD+uCXWw54X+nScsO8aYCRfm9YFtX5CzGRJg0p1Fu/JLM2d4T9jQhqnvBepypH4ee4hV4OGbUcqklmvqRPCVrX+TVZALrBbq1g1yNpvT+SndYSMp0ovvbOP6kFH/9V0o+i6PftbFQNIux7ZvEduQYOtKzbmvuuBQ9/Z+5xfV/9t/EnsYH75aZWhYy754O6eJa2se2WM5Hyfwg6F25bmXr402m/kum9dro4zszKBDIeo9tL4d6f2WXdMVpb/G7XxRFycr8wuA/L1bifz1X2frD/8ZOA0emM0eIlW15WsQN24ce4rLNi1/TMhOizfiY4W6cJPPD1wmsd7SRz/f344e205nasX+Pw8Y73+yGHOwbm/yIya6jKEqhzqK8svG//u4/WHmd+3u17T8vxa//rrz1h/9T2fpjUtkOU975DfU9aoaIqQyfk0qEKUffxsSAxkFIQ2keY1oC3OcoiqL878Vy/G//zt9f/sdzc3PtvwLVOJ7+QqpQzQAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/btn_big_purchasegmx.86c08dee.svg\";","export default __webpack_public_path__ + \"static/media/buy_gmx_bond.ed3174dc.svg\";","export default __webpack_public_path__ + \"static/media/buy_transfer_eth.373e200e.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHkAAAB5CAYAAAAd+o5JAAAcJElEQVR4AexdBXgTWbRee+7u7u7+Hg6LO3XcbZVFi7u7Wym+uLsupa4JVKFK3T2NnHf+x32X6XSSppmk2y6Zj/9LIzNz5/5z/Nzhg868bXre9WPGLzP+keHLCGaEMB4zUhn5jCYGOUCT+F2q2C9EHMdXHPeXxXk+6KzobAPGZP8moydjHuM0I5ZRyGhk2BjkBtjE8QrF8U+L8/XE+d1PupfkH2P8JWMC46SQuHoGfQ/AeVPFOCaIcf2Yl2TX8BHj9xhjGRcYBQyrs2Rs/D90oQ1AWOvA7zYCbSPcKsZ1QYzz9zBuL8nOSe1/MLYx0hmWVgkVROJ18/NutCOiB+2L6kNHYwbQ6bihdD5hBF1P8qM7xkC6awySwHt8ju/xO/we+2F/HEdxXGcIt4jxbsP4taXbS/JPMQYzLjLKnSEVf++K6EnHYgbS1SRfCkuZSC9efUbZ2XOpOG8xVeUvp7qCVdRYuIZMRWupqWgdAWa8CuBzfI/f4ffYD/vjOM/4eDgujo/z4HxOkl4urmMwrstL8jtybzDqHBELbAvvzhLXn24a/Ck+fQbl5cyn6vwVZCpcy+StJ0vxerwKgEhHWCuwRsLM7wGLuBlMfANUM/m52fMpLn06zovzYxwYT2uE1+G6JNnvIcmfMLowztsjdyMDtnJreDcKYVX64MVoSs/8kirfLIMEglDHZDpC8SYyl+4lc9lRMlecIkvlBQlzxbdkLg/l7w6SuWQnmfFb3sfC5wTpOH8aj+M+jwfj4vEJm+6Q7PPiej95X0j+Q2G7yhxJ7Z7I3nQl0QeqExMLckCsIFUHIK1lh8laF0W2plwiaw0RWUlu+Ntm4pdasllK+c9MstbHkqX6FpN/jInfBkmH5GNcGB/GifG2Jt1l4rr/8IdM8k8yxjGM9sjF68GovvTo5Vh6w6q4gSXHIqXVzSje+FZSy0PIUnXtLemmLLJZqwXp6s3G/xr4xsjn30awxJ9mKd8KCedxrobpoIcvxmD8yuvRglHMw0/+0Ej+Y8ZxRoO9cOdQdF84T1SSt1g4SOvdTqxju7xWqPH9UNtMZCQTmgdiSWvjL/lfDkv4Hb5ZdpFZHK84L5ieJU/A9TgKyxrEfPzxD4Hkj4XjYbAnvVBzkIDi3GAy6ydXL1Skb3kr6TUPWcpfE+ttTQm3mYuZ7LvUxKocjhuuoyh3EfsRY3B9jqTaIObn485K8s8xFjPKtcjdyh7qVbZlOdlz4UjpJdfzpEPKy5jw2idCwptUZFv5o2xW42eoSZgYXBdCMthsXK8dssvFPP1cZyP5dxmnGBYtghGGJGXMpPqCVR2YXAfqvXgrk3mWBTuenbNKSLNCsBvYZwtjqd5OTeLmRRyemD4T122PaIuYr9/tLCT/I+OptvR2oxtJfrBbktzOizV4ZRu+D6qa1Xk2vPJ3Ktz0iiX/CIiWPgZM0vUkX8yDPbKfYv46OsldGUlaBO+L7EMxaVP1SG8HV+db4HGzdCeKsIxYysvZibuI3wFSqqN5Hvbat9WYv64dleQBjGwtgk/EDqLMrDk6QqHOJN3rRRwe8TYcszWy4/YINl1KNfA662s6zvNih+hszGdHIxkDymGQGpcTR1KJUj2/FxAquuwQS3YcMeOw32yndzRX3zwvl3h+7HjeOe4i2iMEb2Rs4UrOPWMQcr/vGcFqstfDSYNHLuz0QUi8JBqFkbvGQFH58gzR7rDB2WqCkcB/zFmrOrX9fW+xBgkTSDMyZsiXKyUa88RZvjGi8KGhunXaaL1edJKa4O080PCUSSjhNbPBXiD02kiwzzZzKVKpkHJZ/kQK93nKRHtEJ+nxuvXEwU+0JFgQ7CXVASzVNxFfM+GPQbyU6kbHRD9xNY52NZN1SjUA2GCoaOcI9ko1S/J14ZBFI7kiiYZEo0ADG63hjJ1yJTPmSu/VYo1MFpwsYYO9JDov0fcI6VFrg1F63pg/zCNalOxkxhaDB0+SPIRRro6DrySOcsmL9mIDC3M4Ie9tbUwnc+luEC29boRXGnF0OXjwFMl/wkjSSnSU5i32EuyyM7aVCU4lbKh0mUv34HMZR9tJmCSBD3eT/JOMUDXB6G7MyvrGS7DuTpWD6ELRJBqZMaRANRyxUPDiTpLHqQv+KJ3FpU3z2mC3OWJXZfnSakpnG71TOmNRaVNQ1NBqPBjnLpL/iGFQSzGqSfWFq7/PyREdmg7goNkPn+F7K8OmgI4+Mt3tSNaGRBIb/51EKHrgOxR1riX5aqltA/jRS/LHjG0a9WD95UIdpOLvmoKVVJQbzOpsDhm5mQ4tszGsWQD8jc9eZc6hgtyFVJm/HH1YkljsX/FmNX+/lKJSFtA9w1y6a/iGHhnnkSE9mI+7gvAbW7sSvhatR1Jtwxmz1D57mxZlFHKnyZHoflpEbwNPekjuyihVq2kU/HHi9iQWvdWleUvQHYnwgh2SwQRbhcTBZlWnJ/7GZ/hud2Qvnpz+dC5hOKEdJyp1Ou17Po5GXBpBf3p0IP38vr70Y7v7EPBTe/rQrx3oR/94fChNuTGariV8zR2ZqyHt7UY0ukKJLETYUMGqvCTtc0L6DMy/muTS1tKerTlb59RSjJYdqI/2IBev5W+WkjFjNqsrPzrIzXFbwruJlQxAG9ZFhTHEPqu+60ILHnalybe6Ud/z3enPQnrSz+ztSR/u7EUf7AB6EvCTTPrQC36Qdr7R2kttbyaEU2KDZIuixlrMO1qJtKT5nCMnrLWYuE45WZCc3Ox5HpVitOBCtaI3CpJ3mFUUsmnqJSp6AUnfEv4W6551pW8edKNRV7rT3x7vST+3r9c7wrf3pD9hib+TOAcapX2KGeUnmzUNIlmCejTmHfOyp6W3Xecodna0fOW6SoqRbsMd5THJxZ2a+vpLTgKMop0RPZXq1+PYLAhfH9aV5jHhwy93pz8/1pN+Ys9bov/s6CCKT13YTqp7PfrASW42M7xvzD2ZGLj5NeblOnhrC8mDm0txF0iUR4r/OB7y3RmZX9PFhJFcxeohpNZ5gqQ9DvsfCbzXS/halvBZd7tRl7M9WLp7UMCVAKrNZ0lrNyesXMFzITJiODecMDoQ9an6GuvAm7Mk/xjjrPrC0fhu9oD0wkO+bQigHSy5G9pGjLC1/82qlx2sqEF0OC6QQhLG05G4INoTPYSJ6oHvdREOsvE672E38rncm6JT5kCaMXaPE40qlXJDF6j4Hnxojfcs+HOG5P+Q65Tk6gZIsftSl2ZRVkvKmAUN4coCcEgr7YoaSNdSeT1S8W0qrs2gGlMp1TdVUq2pjErrMiml5CHdTl9He6OH4fe0SZ90i2U8/elJ8nisdITvIGNxz0jzbpbgEhIbesbQAYoGfvABR1R9A5eBP2dIVsfFKCG6VXprClZg1QRCHBekrAskly4lL6C8qkSysL1ytFltFiqqTaObaas5/Oil28Zjf2BXRC+YF0rkG7WMIwC5IM/D0oyeMdFswLyMsxM3Oyb59xhpSo8anhwWn4EcdxBcwRNyJckHx3fJ7m6L6E3fZR+kRnMNqTeLxUImUxNeSb2ZrY0Uk3+Odkb210u0HDt8B9R9oY3uGUfDr8B6aTcu94E071PaZtSgsXQH0sy8LNDytNPAoyOSxymfzQEbiWZwqFZ3EIyY90LCSJcnGTY2LOcIWaxN78gzmyk1LY2+PXeeNm/ZSitXraENGzfTyVOnyWA0Mummd+rOZqX4gst8o/TRobodL5JH1egpq/NMLtzUCMJ1qnS096qkOUZ2knD+QD55QcCqzmmrHa4LzbNb3Sj51ecYpG4bDBWtDuTbaoNhf02WOnmxpaWldOjwEZo4aQr5+PrTKB+/Zq/jxk+kHTt3UV7eG4X6NtPDzJ1qkt1OOJ49AsIR7iS//oJV+hJk7VwgfC0kFxKsSJBUsYQfwDppPvbnWlmwC+BTi+S/YuQrB3ssZgDnfZfptjONfHGwH3ombl/MCNhWeaFFRUWQWpBJvn4B5Ocf2AL4fBR/P2/+QnqdmSn3rWosoJD4cbhxPBl7y0wbsnRwklBkMGTMljbcabLRXNCYTMoNKy2hstFccCx2oFp48sGnFskTGDbFAHEXukVNv2RtgDsbtsNVKb7/ehtWGBG2xsZG2r5jFwgGma0Ckr1i5WqqqqqSkxSZd0Itze1BOGw4ohU8jgLZK6hcJ8hegxw2qFUsj86RVaqHL8eqSbaBTzXJHzNOKAcF+5Ke+RXUi247HKrsbnABsKGZFe8yQOERkRQ0eiwIbBNu3rxFYuOQKx2xtK5x6ffQe+IxU7Df0HYOyF6LHjCymYtIbrZGVuMnIM1w+JivHurzgM+PlST/FiOlWTnRTaoaQbu+CfkfOhQXQNWmYulBb9u+A9LZJoIh9UuXraD6+nrCBtt+yjADyZJ2J1n98BukcPFcMcfl27VIhjRX2bVPpcoOiWmhslPAq5LknspHGUKt3DIEIE+qS4pRGkR4oUdaQMIZ42fUZG0gbBUVlfTV1984parV9nnqtOmUm5snPe3raSvan2QHlbIjMf1RSrUz7yhcHFM+3gIPrZEL6W4bA9Vedj14VZI8T31iPCdLr6rGEk29EwASLiTPg1dM2PLzC2ja9JnS2WoLxo6bQMkpKXKS7r3a0iFIFpBeORYoIJumUYZED5giA1YjveyE9Jmyrq4AeJWPEz6tvKtgK/J0JkDQO3wmfijUkW6Sz7+cI2PjwsIimjFzdptJxu8RUqWlvavV3s5Y35FIlvMPb/y75Alwylo6YDX3lREzHDKZGNkV2Uvt3J4GvyD5lxmxyrspNHagyNy4LsU52fNga3RfNDzr44mTqcFcTdhqa2tpwcJgl9T1rNmfU1GxsO1801x4Oa9DkaxecpSIDhyNZ5ApYmb+8zk+p+qCFVoObiz4/f+Fa4UKe4x4DoG7rsJ/ZOoUnNAtKgxecHFdhrywkJDQNpMMR23L1m3IkBG2GlMxV62CZKzcwSALQ0W5KmeMbbBSZVsb0xBHw45rZb8KwS9I9mM0Kg8Oj1iHqsYNgoePqk6oD/EFF+WFpaWn05Sp0yGdTksx7HF0TKw8RnrZUxQsOiDB6uLQOA2VLYsWCKvwEBpIPPM2SS1YjeAXJAerF67Bw3PV6cLJ4NIjBJMn1K+y2cOeLVW2zWajS5evUEDg6FaJxvfA0ZBj1CSk2GI10bXUpVDVHZ7kEISyWILUzMs+AdeaRJFZOl/oUNVYKBcMkkMUH8C7w7O1XJZk7JefsxClOAcZLpeKEyzNyPqQzHqdPnOWxowdbze1ic8Dg8bQ/gOHqLq6ppkUb4/sKzNeHRnbmY+srLkwgYrEyHZ0isgnA6InDM4X/KAdLf2gEJD8SGnwsfRFT4MANAD6tOAhuveu/h86EOtDb6oNzSpQ4eERtGz5SnjO5AtiBeEgf+GixXT/wUNqaGiU+5TVZ9OxhAkdzBY7bjg0ttSsikZ8G54wJBsJ9rdsC3oEklPV6qFKqAdXSUaDuycuGMSEJk6iwpoUUm51dXWUnJxC9+8/oGvXrtOdu/fIYDCy9FaTciuvz6VvjV+0O8G4QdHosDVCNC20TYOgMUFF8hosZCex4fme+AwRkVbmKxUk5yvrx2fihurpq4YGYGdhPJwujxENrzi19JGyrtxqd0hWRTSdSJzS/gRDcBLGkaHoJmVVxtDjrD2sgp02FdCIKFWqSEYodVRmvyw1D0Ayli3R2fhh6rnPB8lNyvDpQsII3U0CtwwyxeYponmiPqUbaStAnugSsZF6Q346r9rAma3N6AdrfxWNDFZkP3pdEdGsnn331SZnxiISU72Q6FCZT9jlbdIu43mfIBm8oSlDNfdNHzTPLmEhm7+unDVOdDFhlAdJFhCdmiD7RNJUupOxgSJyQyk2/zzKiHSfU5anDbO43WeAjhZd/Tcjiis1phJSboaiG05rATQeoOFCsze7wShIDpM92dcN/i3mvgXJd4xBOIiudOapOJnO9DxEvzUIF2TK98D36kGjwhQ1gHKrEpQPTqZHmTudlOQu9ITjZLN2jRlqWpD8TC56uGsc3SrJWEyGg+qIkVfQ0WgZI7/3wDycTJpOGeVh6GyhqLxTMB0O5kfdRClVtZpkPAROrH58hPeYf7r3wgmS7+kieT2V5S3l7v6+XpJV3vXWiN4wHfL/nHLi5oDAQQU7WmWBZAgkWkWyRyUZ62iD1W2iEl50cVb60ROG5TAO8xVo/8HjHC1VN1Qke84mi1V385A18xKqA2tu96HnRq5AFbe+MA5JEUvleUGykzb5hsF17xqxHPqNRIuoF21chrP+cXdacrY/nX84gRfWrXZy0fodtOxKx+umIUCTZLfFySAZLaebvaQ5j3BGWDdacelTmndoEB194IPmR+fTyiU70TEiw9cLidpxsv6Mlyql6bXHzi+gW3WtN83bO4TmHx5Eh54NpvzcBW1uvhd/O8x4qXPXLneFYHBPXyL57/Ws7ZIb8VZyV17pQ3O2DaWvNg2nZZf68GrJfpSV7fIz0cCXg9y1qgqFKoaOKhQcN41sl1clQ3I3wOae7kefrxlBs1aMpOATA2j9E15dEdOXXmXNwZzrcXqZtyXaVSjtevI87OTScpjLiT4dnuSNz7ph4j2ujiG1G7/rBpVMc3cPpmnzfWj6olG0MITJfcQrSsK7IKdArzJ1Eazoq5uv1VcXqtkZ8lLUL3WmNDsmwrrSsnP9aenZfrThaXcQAcLdRKqQ2CfdaeXVPjRv3yCavnAUTZjtTzOXQnL7w4PG7yBtuglW+UNYjqRVx1+m2eP1PGVSm09sZqBNBc/M6ujZLkz0XHZ2ZrPKXHhkIMelvSDdgiigC/4GcAMA4r34Dr8BhGcMqVx1vTcFh/anLzcMo8lf+9LYqQE06Us/+mrrUFrB9hfHxz7KJr3X7nsuKY7DvE222+P1L4zi5rGyH2Jll57/sTeSL6gT2MiNTM7iU/2hQmn8TH+atmAUfbVlKJM+AFLOIU0fVrN9aPV1fmVAMpdf7IPvQCaklL7cOIxmBI9kSfWj0RMCGIE08XNf+mLDUI53+4J8eYMohAiC4PYHz4Kv6y27NYvBL0j+dUaiqryFBdRtVhfoRcLTezpXAqIHLQodQDOWjKQxUwIoICiQ/AMDKWB0IAWNY4x/i8Cx+CyAvwvi/rEg8g8Iwmd8g/jRjKUjWTMMouUc60piI7TTlVhmmqteuKAfKEdqPTY5EfxqrqDAowrzZfXDeZJfsE1AAr4zhjVQp6tZbQef7E9f7xhMs1YOp6ks3VPm+tCUb3xoKr9OWzSSZq8ezt8PoUXH+kMN07oHPaAVhPp2nI8OjRnEVaX/be8cwmVJgiicY3uWsxtrO7bn2bZt27Zt27ZtVz/bZl/FuV/kIL9sfd2Vr6uzF2fwUMj/JisiTpOYA+bgSXADP7VS3zPaXKjupD0cVxRJQP1GnhM8vdX5DyyA77r2Zyn8P379/3OyFqwe8DkXAEPgBF6aDtYwWFYjUikjrr63KLlHNg6YBV4hsxrfIR1RSklEFLWJI7UpO/Oo2yebxe2YzZUhmgU+gUpKHAHX/0J+Ws7LUlhAHT1eF0NBmKWbWmFbkAwWUHKZThkoOIsvf5oF72RwlZClKoQVX6SHrETvJwGj9uUx9aDDDelrhkBVwqr+gxTWMIZs9HYkQfPFk4D7U2TMoWO13AbMQzWnrIZZ/ec50hy1OMyRY7XDGrKX7S9h/aKrK09z+IF3Caw6VCMlCZzUZ5mj1vFSh+zU//5ULkCkCHKVQ5xZT1TPrC0Uzo1xJMynhW4LXBDJo7Z7KnMUUjrnmGNqtfrzQQ5G2ARD9S6yUvjMil2G35A3x3lqdyQoKu1+DByDQX6C1E+dY9ZSrUh/yJCfn6yeh6dR2NRNg1aG4LHmYBndggv8nggGGfqedF2tWh/Mqm+RmvtkkbjmGUYzow47qNWJklAK5OvMT4SC/AJptvoy8PX16z4vnlWrCtgjmZB25FgdY4BZKB2he6bZ4Bcass5JBp/HNL0ZQ7VDL8irO9uEKQrn9cYN0BCeNUytWs+OMtG4yUCYm3VbJ0t7MSyFCzwWz2iuOByVm4y+N3OpCVnFno8ybUxu43VKFqPzMPdiFNEDh5j4QsnePFd9OUQfSIONfb4aiAmzBa5iZVjN+DyMdp+nN+acC14RQ2b9qjqf96YX3O+rrkZm2tSLcQBBDd7B+Fy811dNt/4Bn1+jMeR8hjRA9/lsDx3d9bfrAISzDf9G5qbxYRplkkcqWyaI+TwTDWToI9JhNXIE8b02rqa3whjc/DCN0tQ6wIfBJ1ZO6GVI923/uoQ8sdvn2hpdTeNeO53KumEaPMrE0u7+RWlfYKtQ/v8QSi0ZHqbhU6HxZYTA48VYQoY+IR3SZSQkOmAsLmfszm/U3l9W/h+/I4cO8CHmIWINGSpMumVbL8Y3YjZdMQYYdv5z9NulW8xBuAX5GVJ7UqotgPGtdsYuc73YT8K9lu8vrkvmT+X2f8ZNyNCbpBkWHXwgkcxYL0a1AHwM6qkvQDuD21+4DRl6j7Q5wQFzylAOTso3AxgmI1hJa84fNnO7C1OQoS9JTgJDVjM8XZM/NGCH21uYhgxlJZ1KSMCcE8YV8dxcZGEOxhAdCPApbmdhGrIK+lwibpuQEQIALq+iscjCHKwDfE4P2DxkqHiCgcZQjYAAt3ox+1i2gHNPoJJYF0klScIlyMmhG3tj5Fu7sar2k5BxMnFHTu29uR2zk56IN8hQlkRYjMlqAIhf88e49+Jjwy6nivaokuVwOwooHiHLVff2wIVZvDEf4wAkept/tYJwC6SY8gJLC3i7XEXHO2ToA45WSPUiaEBesb8UwMSq98JrC7llge6ZivbidhNegQy9TepGuu3B7RPKR0btOot/oywHUo16B+69t9FO3F7Ca5ChZ0nFSI6Xhu/umbXMpINL5HAxjyNsFs6pgxF0p4cLOWgfbifhVchSn/O560OvnFf7ZAJ+5HDhdYmsEx4VtPd4iPbgdhFQIkCGXiFVJfm8ECBw4mTo7ZOf00eRXXj+dJP0ddRzGW6w3nucVI3bQyQaZKmPScNIt7wKGb2Wq9IifxtzLmKhQ8G9xe/9qdz/JjJk6DneCy4gPYj34RpQ5X8D7DGqaItSG+O2Z5fboWBRqw/4PbP8NzHcBshSr/DCYy3pYXwtvGpmDsV36GwZmRLYAi3bXxxV71BJGGBDZY485PcqpgzN1kGWeoNUlLQwTrZcsMPDwQVirJBgj0yRcMBCt/k9ivJ7Cch2yGpqzm+k4aTTpDSSOy5t60MebeJQhMGGtABK4+cdjufXp6wkIat6mgyzPhy6vVCTodsKbei7OctNmGSrwI1KAYvnwXMN2ZZ/Pf27NtnyfSjrZkFJyBFoz9m5r84/1Oa7SXuqtRq+vcjK/ltyXOy18fcUzJvc6JB7QCGep3Hf/luyX8Rz4HnwXHvOznmVJOJZ+IdndPTy+peWOd0/nbq3dpExO8v2GrqtIKAf77Pprzs9N/6aBiNqBVDEMCFcB9fDdXF93Af3w31xf9+ltS+RhFeEf3hS5ET5hHNx9cvLnZ7vzznQLMvkPTXqjt5ZeiD1siWDt+U7OHBLrisDtuRMo94XFDB+H38Of37wtvwH8fdxHVwP18X1cR/cjyS8qAxeuCFCnJXVgAAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/cross.2c9772ea.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down.4485a8ac.svg\";","export default __webpack_public_path__ + \"static/media/chevron-down_sm.5c6065f6.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHjSURBVHgBfVO/a1NRFP7Ova8NQYkZigSDJbqJQh4Ogk4NiqIuCiJuDZgOQhGKk1P9C1Tq4KJQR12yiRWkg4ODg3EQp7ahpTSUQtMftE2bvNN7zstLXtMfH7x3f5zznXO+c+8l9GB7IlsEYZgBn8BpBtUJqFjCZP/o4qe4L3VI7zM5apkyM3wcjyq8oJB8VqvKwkRENM10L9EMXEbfvY8w2ev6Oaif+kdk2VBDG/bSYySefEffrTe69q69iMfMUZPK6tfWWIxbeeUfTOYqzGAB2FoGDVyBHRwCNhbAqzOiNjN+P1U10pyjxFF/Sse9r0+x+/k2kDgD7+bbjr3FQdELu3oEOXsD3FiHzZd0pEQKvL7QrQ7kGzmOXqI0SpyDuW9K9PyRsIofY93gQNrIOcaJ9uIdWL8Ulvb/C1p/P2C3/Ci05UuxzKh7hKDi4gx1IrqsxpUskC5LqZQ6HxpdFd3MXLEv754mQ/Qg2gwWf2m3ldBYA5066wLMOwlTaP1+7cpptNn8Snu18+7cH2lcR7O7EKLZ5kew93Ncgx0AczX5fOmCp/Nm8BCWpkGUi7Kr5tkpHIIjunMqaBL5Jcdq4YYYToDoFD/1R+xhRNicyBQt0TAz+URIu/teJ3Ik4snkaO3Aq9oHE/y09owWmgYAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGoSURBVHgBpVM7SwNBEJ7ZXHwSH6CFlQG1sPMB5hAUrQQro8ZgpWCpkNhZCLn8ApPCTrC0CDGpUvpsYoQQLSysoq2CSKIhJHfj7pm73AmagB8szDc3s/PNzB7CD5QSsps0ChDBEqdu3UmQA0Y5xli43ZvOW+PRSopxTxAJDuAPaERhly+jGJwZxkdMVhol6wmIoUJsSrEpKMblTSQ6FrZjcBFY34S96ksW1OeUzaeq5O3yZ5LsWwaFzAoiuVIA9SllHkf/OLQtxAE7BswLJAl1tViIyXMM6dz44JzcB+01qydaIQ37wTEwA+XrnboyUufxM+EJkAoR4WidPeQKxqERSqfTRv9Bia+sx1hG+Wr7VwVGgcrDkckJqef/CtQq3vEZNFQgDa8B8gFX0numD5mWYy5f+oLbeWswOl36xMVh/RPgHN0CacgP1fuINSzfvnx7KQlLBdp1ACaELaqLVUrdI2ak9v4I1bMNoEqx3j+QUmuj1ldcDvFnqkAzQFI6VzJh2wXNXiIG17F6E7VwO95OZHeLU+MvE8c4Hau583zOyXIVo73r9r/xCzLjs4Txvi/RAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHoSURBVHgBfVPPaxNBFP7eTBI31Wr8RdpDYRURxUMCIogemoJnrUdva/QoWC9etN0kXgXJP6C5eRK8efHSkygICYq0IDR4MIm1ECGaNMnOczNpNrtT6INd9s1775vv+2aHYITjNmwB+RCMZT+195arIFQVvGKlOF8P91M4ybvNFbB4gYOCveLLZ/OFSSqC4dVWwRw+lZK4cTUZBSDp5lcbUYC8+8sBkWtu9uDOUVw8m0D6pNwH4jxtLU8ZMPYNX89aWJiL6e8rlyyzDCFIsxX33e0cpmYF1G8tHQ7yE8cEMucTJobtPGnkBAvOmJWbSzOQPuuNrQE+fumh+dvTUo7MRDz3e2Qmxh6lRhomkYgT4v5T2+zrvLfL2Nzpw0oQTh+X6PwbBr0MSsVIcpu9KWp/wPj2vQ9PAecW4nptOGT8/KPAKsqUwG3hKaqZEqxDhAt2HOufu9hpe0jNSixeTqLTjSIopqoWdXettUUgO1y8d3sW1/yT+FDb1azevO/gb5dD9Ln+qpQ+o4+RCY9MFq/fdfTuSYvw6WsvMrwnoKCNHL2q6883MouPR/91blIe+F79aI4NG7GIUAcXKqV0eexDKJy1bVf4RRwQCmqlUporBzzMBn0blXR9WVm/mB3rRZ0Yb5XwyuZt/A/V0KylFRZwagAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEHSURBVHgBjVMLEYQgEGUuAQ3EJNrACNLACEYwgjYwAhGwAZqAa8DxdsAB8Rx3Zt3Zx779gYyVIr0qr9arCxZ+zx5EeNWB8E9NiCuIhnP+RHThvEhARK21W9fVCSHcMAxumiay8JdlccaYmECnM1JmBNyJtZbsPM9pJ7QDFQFUQCAqNE1DGCx8yGUs8M6tOiklBXVdl83ati3hGCHB7cd/eOy/qiqy27Zl29z3nayvnMIc5G/0juMgW9d1RvaVsyRBvsXMcUF935OPljEzMPjXmWUElFLZdq+Cq0yWdr44DRAVcLc4xNLGcaQOcAYc56G6SfsXAC5tvX5hZwL2/Lb1HTEVyV7+VT9KbxPpO/XgrgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFDSURBVHgBrZIxUoNQEIbfvkcVmxyBJmoSC3MDPIGWJmNBTgCeALhBPEGoJCVHwBNoJRgbvEGqjEXYdWHChHlA4Uz+hvfe/PuxO/uD6JH58D4cDC58Pt4jwjLbjJIuH3QXDlwA6RDRsGEMCyyCbDPOewE3T98WIq1LjugTUoACwxpUAa4fU1MpY81/tDSzz+YfCdITAE1oTnR4TqNJbJQ3KZXVLCYSCVGxbLQbThZfHgjpkqjGYpjh8DeWrQ4R/DS6vNNn/Xy9Cgo8zHR/C6AU5KJHOrQT8F+dHwBEZp+5zIj+ZugPKMifLrZmMzRauNoAxCJRSvHqhFXe2WLzau3pfLviHX8QoV9y6mIOz44Q4+P5JA6U3RGa03hVIa32v/uXPJ7tWoBa43nmggCnCeoIl+gFHLsxeQyPK2+RE5hFo7cu3x+G+J1ieOsLEAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAEuSURBVHgBlVO9UgJBDP6wszut7LxWG6mtHF9AHR8A3gB9Anpt7C3Aws5CZ9TKmbOhgzlooIKDBjoWKuhCQrif5ff4ZjJ7m82X5MvuAUsgojybx2ZIYRb7HDaBD102n7YjkLh1xIDSwU6wBzGEn9SYcPfTJsgJ2bNcZsKeDjf2rIlKVd63ubehnsXwDrh4dmV69QHgOsBoCvTGwN078PDD/n4yKitkxyKOJmo3ZyIKKF4DhUtN9Pirq8KRto3VdvGPWzR2m7LmP1jKE1HhOxIoletR1c8m8NXSyu6R+v47al0DnLIvk4nECfktIjuHGiQayzXgpcJJjoHbc6B0DzR4FhcnYXQ5vC7fuiqZ9tWrrnGb+h3MVQa7X5gkCvXHkDjXGjKle6L+CnEpSeq/agZ2kCMI5PSNywAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAI/SURBVHgBfVNNaFNBEJ7dF6sRUhJUqglK/KG8kEKF1tSCQiH1WEguHltvXgJG0iLtJcnFIFFsIR48xpteInpsAgpCTPRQpcHnXw1CA4KY0iCK5L11ZrfvNemhA8vb2flm9vtm9jHYY/qtatA0XTc4FzEQEKQzAbCGnzXOzaxxZ7LZi2e9Tmj+ddJi/D7sYwxE1shPZGyfOzcv1DJ2cuJKAGYvDTlJc5eHID5+FBQbliZsXwF9oX6NAgHfQSglR8BzSIPS25/4dclVXm9D5IwHY2EZI+xwqhZzCggGaXWzHyrrvyD3/Dt0/prSp7XZ/geLT75BpbEFD+bOKSkaSLZcT72ZomZFznrkLYVySwJyV0/DoFuTKzHtl2eF1U3MZBKHtwb1VHXKJbgYpSAdFl/9cHST5mjuPTLpwgVK2LEKyomGfVDf6IDg2igXgnkpQPoJbFthtSXpFq/rEDpx2DnfRgyxktIxlzMmtsghzdQwMgJ8aP2G2HIDEsXPOIXjToFBxGz/MVUfMJczy3xHTrnRhumwV92CgKWZU3Kc8fFj6O8yi474sJltuTfpcRn3Jl/gvln/2pENio+pec8+NFDWAIT8bslEvgd8GwHvgNSPAppf8pGXkrOwxE3GWWnx8QY8Qs2USNOgriu9TLEZOyILqxzISBk2teH5WpoxlqFkApPR7MmWZk6Cx+2C28/U+xBCZD7dncj2FegtAvualfyYv7hie2xvWE9Wg9YBLY2B86AWWdMS7KnW7a4Yy/1/43+jYdjzTW6D2QAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHYSURBVHgBlVM9SCNBFH4zu0rk7nSvuuO8g72zuas81MafQrEVRYuUatDeYONfkU0VtVDSC0HFysJYWigR/Cn9AdFGXDCYiEViUBR15jkz68ZNiIIfPN7bN+9973vDLIEimLGg8UQrghxIFyXElDmOaBOCiTLGo3ZgyvbWE+9H9cJEUCRCCGjAGyAMw8lAxHK/NTf4OT9mCbqICH3wHihprepsIbnVrUReQfXCeL9wMUX02YBfn76W7D2/zUDyJqtizp66U4HpuP5yFnKL/H/qYLi2vSTBzME6zBxuOEI0fVa4ODFj4/8fNdhzixq//VYmMfivWfm5423ldy/PlEH+PlibznRqAvJ88iiTUlZVXgH+mnqoLPfB3MkOVJb5IHmbLVDEdK1W58gN7/Tcw70ikF7i+uFOxdLkuSRcOz92FAAYupdRypNF/po61XiUuXBW+dukLlCSuM0SCJDVGWMJTdMKSNw9ww0doghhILEEpYCI+zQtX5Z4ZfBBiGY73RvZpM4uPAwfhNjfkl5pz61s2196mkWStHqL5GUun+7B1f1N0XRuXfRNRl+IXvFjcTREkFrvDM5yZFaqbyrqUVKI77ERk2h0iKJQQ8B0RoKNwOOc43y66G98Bj1CxfZyFDl9AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAILSURBVHgBdVJNaBNBFP5msjFRobsVsRVtGEE9RVgFT0VIQS9ejBfFk6voRRA82aBoLkLoLacetZ4EDzYo2INCAtKDl2bxKBTWRDH4uyuIxmRnnDdN0iS07zLvvZnvvfd98xjG7NtMwYNilxljrlLK0WeoTz/BsTTZKD0efsv6zk8xL2SXLyvAxTbGGAKekHOTwUIwABtgzKtKQVAcyTaacajPv8gmp2Hz1JYFLEoMA5/8fodfqg3oxMfd/3D362uc3XkUtydOGTC9kx2+rN3jrMfxEV28/PMeGcvBK7eD04UryOVyBlCr1fD25iKuhYcHE2gNPIvE6SeacYTWyT14sDKiiykiXgg8PXcPF37MmFws4XFNwgi02v5gOp8p3dhSLCEE0ldnERGlDXN1Z+WQN8HSJhMEAcrlMlzXRaVSQT6fHynS7Eawk/vIdSzdOaQCGcs2VWnEMAzhOI7x+3EURajX6+YHehZSZ59o2TyNS7uOwfd9eJ5nbse7rr9Zw2wq04uUz6VSA3Wyepz712+Z0ceNik49W99MKLZkluT7wTt1BeWeaC2ioTmROMVi0fAmqz5fQerhGi7GR3pABHs/lQ4Z8OfpeZFM8KreN7Habox0tFkK2R1TQx0RdGI5t7+1EAx2e7gAtjG9XX43lucJSDEbf/DlQMHjDHpxuJ6ZvlH/BqRPHPWoI9vzH5xq3+2NFxVlAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/icon_arrow.5a2e0b83.svg\";","export default __webpack_public_path__ + \"static/media/icon_check.11b53f10.svg\";","export default __webpack_public_path__ + \"static/media/icon_close.0c82fb42.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_sm.d5bc42f1.svg\";","export default __webpack_public_path__ + \"static/media/icon_close_toast.0a4cfb5c.svg\";","export default __webpack_public_path__ + \"static/media/lock.d4328791.svg\";","export default __webpack_public_path__ + \"static/media/flag_en.c92a8361.svg\";","export default __webpack_public_path__ + \"static/media/flag_es.4ba7dfef.svg\";","export default __webpack_public_path__ + \"static/media/flag_fr.589da1a2.svg\";","export default __webpack_public_path__ + \"static/media/flag_ja.81aa61af.svg\";","export default __webpack_public_path__ + \"static/media/flag_ko.97c8fe63.svg\";","export default __webpack_public_path__ + \"static/media/flag_ru.0c71e16b.svg\";","export default __webpack_public_path__ + \"static/media/flag_zh.fd0e8daf.svg\";","export default __webpack_public_path__ + \"static/media/glp_icon.ef02d046.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABPCAQAAAC3gKgqAAADyUlEQVR4Ae3BfWhVdQDH4e/Z3Uvb2lZukS5sOEI3UHS95xbBqg2iQmcvpCRZZClYkBoWaAvpD0ncHxVCFjE0iyE6eyFqK6K3RRTaiy1ptaXljDnL29h2t7v7iZGeTuuen9vd7r3nynke+Xw+n8/n800EWToXUMKrVCnVkcELwPsUKbWxlH5GbcZS6mI23/OPk9QqVZHNTv7VxiVKTawkhFMDAaUeKujkv4LUKdWQTzP/9zWlSi2sI0w0O8hU6qCSbqIbYLlSBYW04O4w5UoFWNQTwWQ3OfI+aujFbIhV8jqKaePsuqiQlxGggfHZT768iyX8xfiMsF5eRSnfMn7dVMmLyOJlJqaFafIe7mOQiYnwFJa8hXl0MHG91MhLyKWJ2LRRLO/gEYaJ1TYC8gau5iixC7JIXsAFvI1ZK3sxOcAsJR9PEMGki/mUcBCTF8lUcnEDv2MyxCpJoo4g7vpZqmTiIj7EbDc5kkSABkzaKVOykMYzmP1AuU6jmM8x2UW2koNb+AOTAe6VA7WcxN0QDysZmMkXmO0gUw5YbMakkwVKNNJ5DrODzNIYFPEBJs3kKbG4iz5MgixWFFzPcdyFeUyJxGV8h9lWAoqKxxnB3TEWKlE4j0bMPmOGbAQIyEYBb2DSQqESg/sZxKSXm+XAA6yWA1fQhbsIm5QIzOMnzOqxZKOCI3RzrRxYzRDuTnCj4o3z2YNZC4Wykc9+Rr3LNNnI4TVMPmGG4otHCWNyjIVyYB1hRkXYKAfKOYzJs6QpfriGXzEJs1YOVNLNGT1Uy4HlDODuFLcrXriQdzDbR55sFNKK00dcLBtZvITJV5QoPthIBJOfmS8bFk8z1hbSZKOUbzDZTqamHtX0YBLiQTlQQy9j/cmtcuAO+nDXzzJNNabzMWaNZMtGMW1E8yUzZSOdBkzaKdNUIo0tmB1itmwE2Iab58mQjWLaMNlJtqYOt3EKkyB3yoHFBHHTx91yoJZe3IV4SONi6awo0V5dLpNf1KiQLI1C6bpHZXJ3SIusDp2GpXo9qXS56VKddUCTRwbbmWqvkCUbRbRiso88TR7L6GeqDbJCDlRxHHdh1mqymEM78dDBXDmwgRHc/cZ1mgyy2UW8NJErGwW8icl7FCp2rCREvAyzRg5cyRHcRdikWLGATuLpKFfJgTUM4+4ENykW5NNMvL1FgWzk0oTJp0zXxLGeMPE2wgY5MJcfMdlKQBNDJT0kQi/VcmAFIdz1s0Qu0hVdjpoV0fhZik1Al2JZ6IzXVag5iii6dOXKq7Dk8/l8Pp/Pd676GwYUP6Kwt1/bAAAAAElFTkSuQmCC\"","export default __webpack_public_path__ + \"static/media/gmx-logo-final-white.b7833ed6.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-final.0b59e423.png\";","export default __webpack_public_path__ + \"static/media/gmx-logo-glow.83c5aea5.png\";","export default __webpack_public_path__ + \"static/media/gmx_logo.2b33868e.svg\";","export default __webpack_public_path__ + \"static/media/graphite-01.6f3526cd.png\";","export default __webpack_public_path__ + \"static/media/ic-communityproject.9b5f97dd.svg\";","export default __webpack_public_path__ + \"static/media/ic_arbitrum_hover_16.d779b479.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowleft16.21502a04.svg\";","export default __webpack_public_path__ + \"static/media/ic_arrowright16.b425521a.svg\";","export default __webpack_public_path__ + \"static/media/ic_avax_40.ba220dde.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc.8de996f1.svg\";","export default __webpack_public_path__ + \"static/media/ic_bsc_96.369f1d28.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc.b_40.1560513c.svg\";","export default __webpack_public_path__ + \"static/media/ic_btc_40.1560513c.svg\";","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAAsCAYAAAAq/ZsdAAAFI0lEQVR4Ac1ZA5AsSRCd2FkMvm2cbdu2bdu2bdt3obN9X6tGrW3vxv6x509e5dwtukZdXYt5EW9ZNf1eZFZmVbVJL8yyfJpZlT2UYIw4VzrVlC3IJXINChNhriLXZJOh56gon4Ahbw5RHs8SO+JRwrmmbEMuIfuYiRzgNYNzcK4pG5Gryk9j+vCkGs7JGgOiqYdjj7MEzj/OErrfCHHuBBiS9slR5XpMpXTEMZtf037hcdYgiPAEe3gHU7bghBkw43hrsNWoGZw77iLNqnqWWVW+yVElNR1xDG2mZ51gCRxg1BDOHT8nkrQFFfgLpVvP+rmorRUe6ekJPtrTU3P6Lt7PDRh6Ydy85CjSlVRkxKxIusr2TrXVMBq3NnVtOGq2b5An1TBdxyfFiPwRFbmep/cc1FCvMfRgTzfY/yqLzP6iehJTTVEW5SqyRA3FU0zUEP7dUkRiW13W0X3EIu/Tx9kCDyTjsZbABWNvRi1ckUuUOr0phpxdTuDGzg742+MG4vdrDLWEQvG/v9DfB4c01ofiG9WysiWmCUF5+cxcVaniMYNrxhGNgl6scnpg578anbsfMHgKjcj+oznmfcesyKuoyCC/GT784vDBwnfqk66hY63Bv+g6WiFuRpVf5dyrwT8eD/DCR/3fWBeDZauaYaMHW1IVBwfl9SLV7HTeUylGJxnQ5Cq3B9a4fEA8G6CSeu4Pac2cQP7jrNXVsOPpPelK+Ff8JbyoaBoVOMBbzW6iRYAFVjhrURmsLGxFwRre0xiDy6q1fzuAeKGgSIVDNvKkK+Uq19rKJdKLQzsAHmI5ZmEpIbBVcReK1c0tV3fB8kebMvUnB5rS1W+ouBgl8PKk5iZg8fWAH0Vy07a6DPbbySFsCrc193JFh+k9qVDkBHixnUmxNNx6VTesvL8ZRYuZov2mnREqnHYsmv0A3/ZriwHLw0kILOuI3o2rioUi6WFtqLKJ8Pv1LtCLCk9qYzP/qYZdj+7Xu4H9KjHdiHIP00S5iUVgb+KCL3rjJVkXvNHkppaXtsCOp/bqPmIcawudwDRS5S9RMxutaxsWdHZFDN7tikGxEzKiLwQJhrYhPbDpg208Z6YWxpD0i4ihXMojSChB2JC5x1ti8OfgUFNNxEvt2jl7Egcs+LSexxBoduc0Ql4RQxsVtukuy9hUGWAkNWMOI0GYsqacwxATJbMitxk1YysqgwOJl6fX4BZIA/ydHTPr92o4YoEPhXKvJUy5P40amlZUmZBij7XEv6dMQW80s6Gt3u3kv1CxhT4wIUQu4Dcr7dCIbfYPVTAszYnEIsAAK6PGzFEkPNSLeOkYMvS3ETP2deWwB3GwZriPEGw0dyODsPDdeqNXXiv+v2OTndxbnj9rYC/iRBHxMs2PxAqHnLu6DnY5vk/sDo8K/I23uVpKCRxJwsNCvhvgiUxyM5uXdMKitxoMmUHiBYspDlWdkavIMs8WaObq6gRBuAnFNYELvYVJQexD+HeMJptmx5Eobc6tMPeLWjhyrk/IEHNiVd5BU3qiNefvGq6ewy7+Y6kJPNhtWdIFtnVlsNFDicdwYUOIPEJ2zFXjrx8bKMO5RC5KGqFfqwzdyyE3+bQN8ktVmPldNWxyeyvsv71T2AxS6D4PK0q6D79+d22N/vyRqIBYjionAvohf6d7wIuXReJGkGcuGF8zqMWYCzZKlqBTTIg4UcNQdISBR2GBF1rCxGejhjF/S4cVhj9aYlHBZ/Lf1/Gn4QFxc+PIdK9a/gVaRiAcqhHzNAAAAABJRU5ErkJggg==\"","export default __webpack_public_path__ + \"static/media/ic_cash.21569a1d.svg\";","export default __webpack_public_path__ + \"static/media/ic_coingecko_hover_16.ef20d202.svg\";","export default __webpack_public_path__ + \"static/media/ic_dai_40.6f901476.svg\";","export default __webpack_public_path__ + \"static/media/ic_eth_40.5e255508.svg\";","export default __webpack_public_path__ + \"static/media/ic_frax_40.1e127166.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx.bf8fb0b1.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_30.375de394.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_64.f4caeaad.svg\";","export default __webpack_public_path__ + \"static/media/ic_gmx_big.a0a74216.svg\";","export default __webpack_public_path__ + \"static/media/ic_info.f334ee0a.svg\";","export default __webpack_public_path__ + \"static/media/ic_link_40.4bb3a048.svg\";","export default __webpack_public_path__ + \"static/media/ic_menu_dots.87c2cfaa.svg\";","export default __webpack_public_path__ + \"static/media/ic_metamask_hover_16.aa3dce32.svg\";","export default __webpack_public_path__ + \"static/media/ic_mim_40.42c8b575.svg\";","export default __webpack_public_path__ + \"static/media/ic_olympus.70b17676.svg\";","export default __webpack_public_path__ + \"static/media/ic_selector_dropdowns.aaf0b8f0.svg\";","export default __webpack_public_path__ + \"static/media/ic_sign in_16.b6f5b1d9.svg\";","export default __webpack_public_path__ + \"static/media/ic_stats_big.4a4ebfb7.svg\";","export default __webpack_public_path__ + \"static/media/ic_tokens.6a27251b.svg\";","export default __webpack_public_path__ + \"static/media/ic_transfer_avax.53893264.svg\";","export default __webpack_public_path__ + \"static/media/ic_uni_40.efe1f12f.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc.e_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdc_40.27f415ba.svg\";","export default __webpack_public_path__ + \"static/media/ic_usdt_40.e357d24a.svg\";","export default __webpack_public_path__ + \"static/media/ic_wavax_40.ba36eda4.svg\";","export default __webpack_public_path__ + \"static/media/ic_weth_40.334ca16a.svg\";","export default __webpack_public_path__ + \"static/media/lg_arbitrum.bdf133fe.svg\";","export default __webpack_public_path__ + \"static/media/long.0bc4a064.svg\";","export default __webpack_public_path__ + \"static/media/metamask-text.2f9c2df2.svg\";","export default __webpack_public_path__ + \"static/media/page-not-found.bb90d073.svg\";","export default __webpack_public_path__ + \"static/media/short.1f94a0c2.svg\";","export default __webpack_public_path__ + \"static/media/trading.7ea1604c.jpg\";","export default __webpack_public_path__ + \"static/media/wallet-connect-text.78166b41.svg\";","export default __webpack_public_path__ + \"static/media/wave-01.3c9bce1e.png\";","export default __webpack_public_path__ + \"static/media/wave-02.4a56e8c7.png\";","var map = {\n\t\"./ic_arbitrum_24.svg\": 153,\n\t\"./ic_avalanche_24.svg\": 154,\n\t\"./ic_avax_24.svg\": 396,\n\t\"./ic_btc.b_24.svg\": 397,\n\t\"./ic_btc_24.svg\": 398,\n\t\"./ic_busd_24.svg\": 399,\n\t\"./ic_dai_24.svg\": 400,\n\t\"./ic_eth_24.svg\": 401,\n\t\"./ic_frax_24.svg\": 402,\n\t\"./ic_glp_24.svg\": 195,\n\t\"./ic_gmx_24.svg\": 403,\n\t\"./ic_link_24.svg\": 404,\n\t\"./ic_mim_24.svg\": 405,\n\t\"./ic_settings_24.svg\": 406,\n\t\"./ic_tether_24.svg\": 407,\n\t\"./ic_uni_24.svg\": 408,\n\t\"./ic_usdc.e_24.svg\": 409,\n\t\"./ic_usdc_24.svg\": 410,\n\t\"./ic_usdt_24.svg\": 411,\n\t\"./ic_wallet_24.svg\": 230,\n\t\"./ic_wavax_24.svg\": 412,\n\t\"./ic_weth_24.svg\": 413\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 788;","var map = {\n\t\"./ic_btc_40.svg\": 388,\n\t\"./ic_dai_40.svg\": 389,\n\t\"./ic_eth_40.svg\": 272,\n\t\"./ic_frax_40.svg\": 390,\n\t\"./ic_link_40.svg\": 391,\n\t\"./ic_uni_40.svg\": 392,\n\t\"./ic_usdc_40.svg\": 393,\n\t\"./ic_usdt_40.svg\": 394,\n\t\"./ic_weth_40.svg\": 395\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 789;","var map = {\n\t\"./en/messages.po\": [\n\t\t848,\n\t\t4\n\t],\n\t\"./es/messages.po\": [\n\t\t849,\n\t\t5\n\t],\n\t\"./fr/messages.po\": [\n\t\t850,\n\t\t6\n\t],\n\t\"./ja/messages.po\": [\n\t\t851,\n\t\t7\n\t],\n\t\"./ko/messages.po\": [\n\t\t852,\n\t\t8\n\t],\n\t\"./ru/messages.po\": [\n\t\t853,\n\t\t9\n\t],\n\t\"./zh/messages.po\": [\n\t\t854,\n\t\t10\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\treturn __webpack_require__.t(id, 7);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 829;\nmodule.exports = webpackAsyncContext;","import React from 'react';\r\n\r\nconst Logo = () => {\r\n\treturn (\r\n\t\t<div className=\"logo-wrapper\">\r\n\t\t\t<a className='logo' href=\"/index.html\">DeDeLend</a>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Logo;","import React from 'react';\r\n\r\nconst Button = ({children, className, clickHandler, disabled, isMain, ...props}) => {\r\n\tconst classes = ['btn', (isMain ? 'btn_main' : ''), (disabled ? 'disabled' : ''), (props.btnActive ? 'highlighted' : ''), className]\r\n\t\r\n\tconst childProps = { ...props };\r\n\tdelete childProps.btnActive;\r\n\t\r\n\treturn (\r\n\t\t<button {...childProps} disabled={disabled} className={classes.join(' ')} data-text={children}>\r\n\t\t\t{\r\n\t\t\t\tisMain ? \r\n\t\t\t\t\t<span>{children.toString()}</span> :\r\n\t\t\t\t\tchildren\r\n\t\t\t}\r\n\t\t</button>\r\n\t);\r\n};\r\n\r\nexport default Button;","import React from 'react';\r\n\r\nconst Wallet = ({ address }) => {\r\n\t\r\n\t\r\n\treturn (\r\n\t\t<div className=\"wallet-container\">\r\n\t\t\t<div className=\"wallet\">\r\n\t\t\t\t<div className=\"wallet__avatar-wrapper\">\r\n\t\t\t\t\t<div className=\"wallet__avatar\">\r\n\t\t\t\t\t\t{/* <img src=\"./img/1.jpg\" alt=\"Wallet Avatar\" /> */}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"wallet__address\">\r\n\t\t\t\t\t{window.outerWidth < 768 ?\r\n\t\t\t\t\t\taddress.substr(0,5) + '...' + address.substr(-4)\r\n\t\t\t\t\t\t: address}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<button className=\"logout-btn\" onClick={() => {\r\n\t\t\t\t\r\n\t\t\t}}></button>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Wallet;","import { createContext } from \"react\";\r\n\r\nexport const GlobalStatsContext = createContext(null)\r\nexport const UserStatsContext = createContext(null)","import { ethers } from 'ethers';\r\n\r\nconst ARBITRUM = 42161;\r\n\r\nexport const requestAccount = async (setWalletAddress) => {\r\n\tif (window.ethereum) {\r\n\t\ttry {\r\n\t\t\tif (window.ethereum.networkVersion && Number(window.ethereum.networkVersion) !== ARBITRUM) {\r\n\t\t\t\talert('Change your network (Arbitrum) and reload the page')\r\n\t\t\t\t\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait window.ethereum.request({\r\n\t\t\t\t\t\tmethod: \"wallet_switchEthereumChain\",\r\n\t\t\t\t\t\tparams: [{\r\n\t\t\t\t\t\t\tchainId: ethers.utils.hexlify(ARBITRUM)\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\twindow.location.reload()\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\tconsole.log(err);\r\n\r\n\t\t\t\t\tif (err.code === 4902) {\r\n\t\t\t\t\t\tawait window.ethereum.request({\r\n\t\t\t\t\t\t\tmethod: \"wallet_addEthereumChain\",\r\n\t\t\t\t\t\t\tparams: [{\r\n\t\t\t\t\t\t\t\tchainId: ethers.utils.hexlify(ARBITRUM),\r\n\t\t\t\t\t\t\t\tchainName: 'Arbitrum One',\r\n\t\t\t\t\t\t\t\tnativeCurrency: {\r\n\t\t\t\t\t\t\t\t\tsymbol: 'ETH',\r\n\t\t\t\t\t\t\t\t\tdecimals: 18\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\trpcUrls: ['https://arb1.arbitrum.io/rpc'],\r\n\t\t\t\t\t\t\t\tblockExplorerUrls: ['https://arbiscan.io/']\r\n\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\twindow.location.reload()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst accounts = await window.ethereum.request({\r\n\t\t\t\tmethod: 'eth_requestAccounts',\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tsetWalletAddress(accounts[0])\r\n\t\t} catch(e) {\r\n\t\t\tconsole.log(e);\r\n\t\t}\r\n\t\t\r\n\t} else {\r\n\t\talert('Please, install MetaMask extension to use this application.');\r\n\t}\r\n}\r\n\r\nexport const connectWallet = async (setWalletAddress) => {\r\n\tawait requestAccount(setWalletAddress);\r\n}","import { ethers } from 'ethers';\r\n\r\nexport const netProvider = new ethers.getDefaultProvider('https://arb-mainnet.g.alchemy.com/v2/r6kd0heyoOCe8RFndkyv0XW0F-BG38Fy');\r\n\r\n\r\nexport const mmProvider = window.ethereum ? new ethers.providers.Web3Provider(window.ethereum) : undefined;\r\n\r\nexport const signer = mmProvider?.getSigner()","import { ethers } from 'ethers';\r\nimport _DDL_ETH from '../../deployments/arbitrum_ddl/DDL_ETH.json'\r\nimport _DDL_BTC from '../../deployments/arbitrum_ddl/DDL_BTC.json'\r\nimport _DDL_POOL from '../../deployments/arbitrum_ddl/DDL_POOL.json'\r\nimport _OptManager from \"../../deployments/arbitrum_ddl/OptionsManager.json\";\r\nimport _USDC from \"../../deployments/arbitrum_ddl/USDC.json\";\r\nimport _PriceProviderETH from \"../../deployments/arbitrum_ddl/PriceProviderETH.json\";\r\nimport _PriceProviderBTC from \"../../deployments/arbitrum_ddl/PriceProviderBTC.json\";\r\nimport {netProvider, mmProvider, signer} from './providers.js'\r\n\r\nexport const DDL_ETH = new ethers.Contract(_DDL_ETH.address, _DDL_ETH.abi, mmProvider ?? netProvider);\r\nexport const DDL_ETH_signed = DDL_ETH.connect(signer);\r\n\r\nexport const DDL_BTC = new ethers.Contract(_DDL_BTC.address, _DDL_BTC.abi, mmProvider ?? netProvider);\r\nexport const DDL_BTC_signed = DDL_BTC.connect(signer)\r\n\r\nexport const DDL_POOL = new ethers.Contract(_DDL_POOL.address, _DDL_POOL.abi, mmProvider ?? netProvider);\r\nexport const DDL_POOL_signed = DDL_POOL.connect(signer)\r\n\r\n\r\nexport const OptManager = new ethers.Contract(_OptManager.address, _OptManager.abi, signer)\r\n\r\nexport const USDC = new ethers.Contract(_USDC.address, _USDC.abi, mmProvider ?? netProvider)\r\nexport const USDC_signed = USDC.connect(signer)\r\n\r\n\r\nexport const PriceProviderETH = new ethers.Contract(_PriceProviderETH.address, _PriceProviderETH.abi, mmProvider ?? netProvider)\r\n\r\nexport const PriceProviderBTC = new ethers.Contract(_PriceProviderBTC.address, _PriceProviderBTC.abi, mmProvider ?? netProvider)","export const separateThousands = (num, symb = \",\") => {\r\n\tif (typeof num === 'undefined') {\r\n\t\treturn '';\r\n\t}\r\n\t\r\n\tconst str = num.toString();\r\n\tlet [intPart, fractionPart] = str.split('.')\r\n\tconst hasFraction = fractionPart !== undefined;\r\n\r\n\tintPart = intPart.replace(/\\B(?=(\\d{3})+(?!\\d))/g, hasFraction ? ',' : symb)\r\n\t\r\n\tif (hasFraction) {\r\n\t\tif (fractionPart.length === 1 && symb !== ' ') {\r\n\t\t\tfractionPart += '0'\r\n\t\t}\r\n\t\t\r\n\t\treturn intPart + '.' + fractionPart\r\n\t} else {\r\n\t\treturn intPart;\r\n\t}\r\n}\r\n\r\n\r\nconst removeNonNumeric = (num) => {\r\n\tlet result = num.toString().replace(/^\\./g, '').replace(/[^0-9.]/g, '').replace(/^0\\d/, '')\r\n\r\n\tif (result.match(/\\./g)?.length > 1) {\r\n\t\tresult = result.replace(/\\.$/, '')\r\n\t}\r\n\r\n\tlet [, fractionPart] = result.split('.')\r\n\r\n\tif (fractionPart?.length > 6) {\r\n\t\tresult = result.substr(0, result.length - 1)\r\n\t}\r\n\t\r\n\treturn result;\r\n}\r\n\r\nexport const convertInputNum = (num) => {\r\n\treturn separateThousands(removeNonNumeric(num), ' ')\r\n}\r\n\r\n\r\nexport const sepToNumber = (str, symb = ' ') => {\r\n\tif (typeof str !== 'string') {\r\n\t\treturn str;\r\n\t}\r\n\t\r\n\treturn Number(str.split(symb).join(''))\r\n}","import { sepToNumber } from \"./sepThousands\";\r\n\r\nexport const floor = (num, fraction = 2) => {\r\n\treturn Math.floor(num * 10**fraction) / 10**fraction;\r\n}\r\n\r\n\r\nexport const formatForContract = (val, fraction = 6) => {\r\n\treturn Math.floor(sepToNumber(val) * 10**fraction);\r\n}","import { ethers } from \"ethers\"\r\nimport { DDL_ETH, DDL_ETH_signed, USDC, DDL_POOL, DDL_BTC, DDL_BTC_signed } from './contracts';\r\nimport { floor } from './math';\r\n\r\n\r\nexport const getGlobalStats = async () => {\r\n\tconst globalStats = {}\r\n\t\r\n\tconst totalBalance = (await DDL_POOL.getTotalBalance()).toNumber()\r\n\t\r\n\tconst totalLocked = (await DDL_POOL.totalLocked()).toNumber()\r\n\tconst totalSupplied = totalBalance + totalLocked;\r\n\tglobalStats.totalSupplied = Math.round(ethers.utils.formatUnits(totalSupplied, 6));\r\n\tglobalStats.availToBorrow = Math.round(ethers.utils.formatUnits(totalBalance, 6));\r\n\tglobalStats.totalBorrowed = Math.round(ethers.utils.formatUnits(totalLocked, 6));\r\n\r\n\tconsole.log(totalBalance);\r\n\t\r\n\tglobalStats.utilRate = floor(totalSupplied === 0 ? \r\n\t\t0 : (totalLocked / totalSupplied * 100))\r\n\tglobalStats.borrowAPY = 10;\r\n\t\r\n\t\r\n\treturn globalStats;\r\n}\r\n\r\nexport const getUserStats = async (walletAddress) => {\r\n\ttry {\r\n\t\tconst balance = Number(ethers.utils.formatUnits(await USDC.balanceOf(walletAddress), 6))\r\n\t\tconst curBalance = Number(ethers.utils.formatUnits(await DDL_POOL.shareOf(walletAddress), 6))\r\n\t\r\n\t\tconst totalBalance = (await DDL_POOL.getTotalBalance()).toNumber()\r\n\t\tconst avail = Math.min(curBalance, totalBalance)\r\n\t\r\n\t\tconst userStats = {\r\n\t\t\tbalance: floor(balance),\r\n\t\t\tcurBalance: floor(curBalance),\r\n\t\t\tavail: floor(avail),\r\n\t\t}\r\n\t\r\n\t\treturn userStats;\r\n\t} catch(err) {\r\n\t\tconsole.log(err);\r\n\t}\r\n\t\r\n}\r\n\r\n\r\nexport const getOptionStats = async (id, isETH) => {\r\n\tconsole.log('getting option stats', id);\r\n\r\n\tconst contract = isETH ? DDL_ETH : DDL_BTC;\r\n\tconst contract_signed = isETH ? DDL_ETH_signed : DDL_BTC_signed;\r\n\t\r\n\tconst intrinsicValue = Number(ethers.utils.formatUnits(await contract.profitByOption(id), 6))\r\n\tconst borrowLimit = Number(ethers.utils.formatUnits(await contract.maxBorrowLimit(id), 6))\r\n\tconst borrowLimitUsed = Number(ethers.utils.formatUnits((await contract.borrowedByOption(id))[0], 6))\r\n\tconst liqPrice = Number(borrowLimitUsed) === 0 ? '' : Number(ethers.utils.formatUnits(await contract.currentLiqPrice(id), 8))\r\n\r\n\treturn {\r\n\t\tintrinsicValue: floor(intrinsicValue),\r\n\t\tborrowLimit: floor(borrowLimit),\r\n\t\tborrowLimitUsed: floor(borrowLimitUsed),\r\n\t\tliqPrice: (typeof liqPrice === 'string') ? liqPrice : floor(liqPrice),\r\n\t\trealVals: {\r\n\t\t\tintrinsicValue,\r\n\t\t\tborrowLimit,\r\n\t\t\tborrowLimitUsed,\r\n\t\t\tliqPrice,\r\n\t\t},\r\n\t\tcontracts: [contract, contract_signed]\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { Link } from \"react-router-dom\";\r\n\r\nconst Tabs = ({className, links}) => {\r\n\tconst cls = [className, 'tabs']\r\n\t\r\n\treturn (\r\n\t\t<div className={cls.join(' ')}>\r\n\t\t\t{links.map((link) => {\r\n\t\t\t\tconst linkCls = ['btn', 'btn_tab', link.isActive ? 'active' : '']\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Link to={link.to} className={linkCls.join(' ')} key={link.to}>{link.name}</Link>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t\t\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Tabs;","import React, { useContext, useEffect } from 'react';\r\nimport Logo from './components/UI/logo/Logo'\r\nimport Button from './components/UI/button/Button';\r\nimport Wallet from './components/Wallet';\r\nimport { GlobalStatsContext, UserStatsContext } from './context/context';\r\nimport { ethers } from 'ethers';\r\nimport { connectWallet } from './components/utils/wallet';\r\nimport HegicStrategyATM_CALL_ETH from \"./deployments/arbitrum_ddl/HegicStrategyATM_CALL_ETH.json\";\r\nimport HegicStrategyOTM_CALL_110_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_110_ETH.json\";\r\nimport HegicStrategyOTM_CALL_120_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_120_ETH.json\";\r\nimport HegicStrategyOTM_CALL_130_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_130_ETH.json\";\r\nimport HegicStrategyATM_CALL_BTC from \"./deployments/arbitrum_ddl/HegicStrategyATM_CALL_BTC.json\";\r\nimport HegicStrategyOTM_CALL_110_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_110_BTC.json\";\r\nimport HegicStrategyOTM_CALL_120_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_120_BTC.json\";\r\nimport HegicStrategyOTM_CALL_130_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_CALL_130_BTC.json\";\r\nimport HegicStrategyATM_PUT_ETH from \"./deployments/arbitrum_ddl/HegicStrategyATM_PUT_ETH.json\";\r\nimport HegicStrategyOTM_PUT_70_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_70_ETH.json\";\r\nimport HegicStrategyOTM_PUT_80_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_80_ETH.json\";\r\nimport HegicStrategyOTM_PUT_90_ETH from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_90_ETH.json\";\r\nimport HegicStrategyATM_PUT_BTC from \"./deployments/arbitrum_ddl/HegicStrategyATM_PUT_BTC.json\";\r\nimport HegicStrategyOTM_PUT_70_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_70_BTC.json\";\r\nimport HegicStrategyOTM_PUT_80_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_80_BTC.json\";\r\nimport HegicStrategyOTM_PUT_90_BTC from \"./deployments/arbitrum_ddl/HegicStrategyOTM_PUT_90_BTC.json\";\r\nimport OptionsManager from \"./deployments/arbitrum_ddl/OptionsManager.json\";\r\nimport HegicOperationalTreasury from \"./deployments/arbitrum_ddl/HegicOperationalTreasury.json\";\r\nimport {mmProvider} from './components/utils/providers.js'\r\nimport { OptManager, PriceProviderETH, PriceProviderBTC } from './components/utils/contracts';\r\nimport { getGlobalStats, getUserStats, getOptionStats } from './components/utils/stats';\r\nimport { useLocation } from 'react-router-dom';\r\nimport Tabs from './components/Tabs';\r\n\r\n\r\nconst Header = ({ walletAddress, setWalletAddress }) => {\r\n\t\r\n\tconst { setGlobalStats } = useContext(GlobalStatsContext)\r\n\tconst { setUserStats } = useContext(UserStatsContext)\r\n\t\r\n\tasync function getOptionByUser(userAddress) {\r\n\t\tlet hot = OptManager;\r\n\r\n\t\tlet hegicOperationalTreasury = new ethers.Contract(HegicOperationalTreasury.address, HegicOperationalTreasury.abi, mmProvider)\r\n\t\tconst iface = new ethers.utils.Interface(OptionsManager.abi)\r\n\t\r\n\t\tconst strategyMap = new Map([\r\n\t\t\t[HegicStrategyATM_CALL_ETH.address, { \"name\": \"ETH-ATM-CALL\", \"inf\": HegicStrategyATM_CALL_ETH }],\r\n\t\t\t[HegicStrategyOTM_CALL_110_ETH.address, { \"name\": \"ETH-OTM-CALL-10%\", \"inf\": HegicStrategyOTM_CALL_110_ETH }],\r\n\t\t\t[HegicStrategyOTM_CALL_120_ETH.address, { \"name\": \"ETH-OTM-CALL-20%\", \"inf\": HegicStrategyOTM_CALL_120_ETH }],\r\n\t\t\t[HegicStrategyOTM_CALL_130_ETH.address, { \"name\": \"ETH-OTM-CALL-30%\", \"inf\": HegicStrategyOTM_CALL_130_ETH }],\r\n\t\t\t[HegicStrategyATM_CALL_BTC.address, { \"name\": \"BTC-ATM-CALL\", \"inf\": HegicStrategyATM_CALL_BTC }],\r\n\t\t\t[HegicStrategyOTM_CALL_110_BTC.address, { \"name\": \"BTC-OTM-CALL-10%\", \"inf\": HegicStrategyOTM_CALL_110_BTC }],\r\n\t\t\t[HegicStrategyOTM_CALL_120_BTC.address, { \"name\": \"BTC-OTM-CALL-20%\", \"inf\": HegicStrategyOTM_CALL_120_BTC }],\r\n\t\t\t[HegicStrategyOTM_CALL_130_BTC.address, { \"name\": \"BTC-OTM-CALL-30%\", \"inf\": HegicStrategyOTM_CALL_130_BTC }],\r\n\t\t\t[HegicStrategyATM_PUT_ETH.address, { \"name\": \"ETH-ATM-PUT\", \"inf\": HegicStrategyATM_PUT_ETH }],\r\n\t\t\t[HegicStrategyOTM_PUT_70_ETH.address, { \"name\": \"ETH-OTM-PUT-30%\", \"inf\": HegicStrategyOTM_PUT_70_ETH }],\r\n\t\t\t[HegicStrategyOTM_PUT_80_ETH.address, { \"name\": \"ETH-OTM-PUT-20%\", \"inf\": HegicStrategyOTM_PUT_80_ETH }],\r\n\t\t\t[HegicStrategyOTM_PUT_90_ETH.address, { \"name\": \"ETH-OTM-PUT-10%\", \"inf\": HegicStrategyOTM_PUT_90_ETH }],\r\n\t\t\t[HegicStrategyATM_PUT_BTC.address, { \"name\": \"BTC-ATM-PUT\", \"inf\": HegicStrategyATM_PUT_BTC }],\r\n\t\t\t[HegicStrategyOTM_PUT_70_BTC.address, { \"name\": \"BTC-OTM-PUT-30%\", \"inf\": HegicStrategyOTM_PUT_70_BTC }],\r\n\t\t\t[HegicStrategyOTM_PUT_80_BTC.address, { \"name\": \"BTC-OTM-PUT-20%\", \"inf\": HegicStrategyOTM_PUT_80_BTC }],\r\n\t\t\t[HegicStrategyOTM_PUT_90_BTC.address, { \"name\": \"BTC-OTM-PUT-10%\", \"inf\": HegicStrategyOTM_PUT_90_BTC }],\r\n\t\t])\r\n\t\r\n\t\tlet transferTopics = iface.encodeFilterTopics(\"Transfer\", [\r\n\t\t\tnull,\r\n\t\t\tuserAddress\r\n\t\t\t])\r\n\t\tlet transferLogs = await mmProvider.getLogs({\r\n\t\t\t\"address\":hot.address,\r\n\t\t\t\"fromBlock\": 6661745 , \r\n\t\t\t\"topics\": transferTopics\r\n\t\t})\r\n\t\r\n\t\tlet arrObj = []\r\n\t\tlet ids = []\r\n\t\t\r\n\t\tfor (let event of transferLogs) {\r\n\t\t\t\r\n\t\t\tlet decodeData = iface.decodeEventLog(\"Transfer\", event.data, event.topics)\r\n\r\n\t\t\t\r\n\t\t\tlet lockL = await hegicOperationalTreasury.lockedLiquidity(decodeData.tokenId)\r\n\t\t\t\r\n\t\t\tif (Number(lockL.state) !== 0) {\r\n\t\t\t\tconst id = decodeData.tokenId.toNumber()\r\n\t\t\t\tif (ids.includes(id)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet expiration = lockL.expiration * 1000 - Date.now();\r\n\t\t\t\tif (expiration <= 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlet strategyInf = strategyMap.get(lockL.strategy);\r\n\t\t\t\tif (!strategyInf) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tids.push(id)\r\n\t\t\t\t\r\n\t\t\t\tconst HegicStrategy = new ethers.Contract(lockL.strategy, strategyInf.inf.abi, mmProvider)\r\n\t\t\t\t\r\n\t\t\t\tlet strategyData = await HegicStrategy.strategyData(id)\r\n\t\t\t\tlet isETH = strategyInf.name?.includes(\"ETH\")\r\n\t\t\t\tlet amount = Number(ethers.utils.formatUnits(strategyData.amount.toString(),isETH ? 18 :8))\r\n\t\t\t\tlet strike = Number(ethers.utils.formatUnits(strategyData.strike.toString(),8))\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tconst res = await getOptionStats(id, isETH)\r\n\t\t\t\t\r\n\t\t\t\tconst isCALL = strategyInf.name?.includes(\"CALL\");\r\n\t\t\t\tconst PriceProvider = isETH ? PriceProviderETH : PriceProviderBTC\r\n\t\t\t\tconst curPrice = Number(ethers.utils.formatUnits(\r\n\t\t\t\t\t(await PriceProvider.latestRoundData())[1], 8\r\n\t\t\t\t))\r\n\t\t\t\t\r\n\t\t\t\tconst diff = isETH ? 0.04 : 0.03;\r\n\t\t\t\tlet priorLiqPrice;\r\n\t\t\t\tif (isCALL) {\r\n\t\t\t\t\tpriorLiqPrice = strike * (1 + diff);\r\n\r\n\t\t\t\t\tif (curPrice <= priorLiqPrice) {\r\n\t\t\t\t\t\tres.borrowLimit = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpriorLiqPrice = strike * (1 - diff)\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (curPrice >= priorLiqPrice) {\r\n\t\t\t\t\t\tres.borrowLimit = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tarrObj.push({\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tname: strategyInf.name,\r\n\t\t\t\t\tamount: Math.floor(amount * 100)/100,\r\n\t\t\t\t\tstrike: Math.floor(strike * 100)/100,\r\n\t\t\t\t\texpiration,\r\n\t\t\t\t\t// strategy: lockL.strategy,\r\n\t\t\t\t\tintrinsicValue: res.intrinsicValue,\r\n\t\t\t\t\tborrowLimit: res.borrowLimit,\r\n\t\t\t\t\tborrowLimitUsed: res.borrowLimitUsed,\r\n\t\t\t\t\tliqPrice: res.liqPrice ?? '',\r\n\t\t\t\t\trealVals: res.realVals ?? {},\r\n\t\t\t\t\tcontracts: res.contracts,\r\n\t\t\t\t\tisETH,\r\n\t\t\t\t\tpriorLiqPrice\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\r\n\t\tif (!arrObj.length) {\r\n\t\t\tarrObj.push('You don’t have active Hegic Options')\r\n\t\t}\r\n\t\treturn arrObj;\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tconnectWallet(setWalletAddress)\r\n\r\n\t\tgetGlobalStats()\r\n\t\t\t.then(stats => {\r\n\t\t\t\tsetGlobalStats(stats)\r\n\t\t\t})\r\n\t}, [window.ethereum?.networkVersion])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (walletAddress) {\r\n\t\t\tgetUserStats(walletAddress)\r\n\t\t\t\t.then(stats => {\r\n\t\t\t\t\tsetUserStats(stats)\r\n\r\n\t\t\t\t\tgetOptionByUser(walletAddress)\r\n\t\t\t\t\t\t.then(options => {\r\n\t\t\t\t\t\t\tsetUserStats({\r\n\t\t\t\t\t\t\t\t...stats,\r\n\t\t\t\t\t\t\t\toptions\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t}\r\n\t}, [walletAddress])\r\n\t\r\n\r\n\r\n\tconst loc = useLocation();\r\n\tconst headerLinks = [\r\n\t\t{\r\n\t\t\tname: 'Options',\r\n\t\t\tto: '/options/borrow-market',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Perpetuals',\r\n\t\t\tto: '/perpetuals',\r\n\t\t},\r\n\t]\r\n\theaderLinks.find(link => {\r\n\t\tlink.isActive = loc.pathname.split('/')[1] === link.to.split('/')[1];\r\n\t\treturn link.isActive;\r\n\t})\r\n\t\r\n\treturn (\r\n\t\t<header className='header'>\r\n\t\t\t<div className=\"header__content _container\">\r\n\t\t\t\t<div className=\"header__nav\">\r\n\t\t\t\t\t<Logo></Logo>\r\n\t\t\t\t\t<Tabs className='header__links' links={headerLinks}></Tabs>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{walletAddress ?\r\n\t\t\t\t\t<Wallet address={walletAddress} /> :\r\n\t\t\t\t\t<Button isMain={true} onClick={(e) => {\r\n\t\t\t\t\t\tconnectWallet(setWalletAddress)\r\n\t\t\t\t\t}}>Connect wallet</Button>}\r\n\t\t\t</div>\r\n\t\t</header>\r\n\t);\r\n};\r\n\r\nexport default Header;","import React from 'react';\r\nimport Logo from './components/UI/logo/Logo';\r\n\r\nconst Footer = () => {\r\n\treturn (\r\n\t\t<footer className=\"footer\">\r\n\t\t\t<div className=\"footer__content _container\">\r\n\t\t\t\t<Logo></Logo>\r\n\t\t\t\t<div className=\"footer__smedia-items\">\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" href=\"https://mirror.xyz/dedelend.eth/gJriRVVlVGqU3l4qKIP6v08z5KUrdHDpGki6j4jLhss\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<g clipPath=\"url(#clip0_58_113)\">\r\n\t\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t\t<path d=\"M9 14C9 10.6863 11.6863 8 15 8C18.3137 8 21 10.6863 21 14V21.3929C21 22.2805 20.2805 23 19.3929 23H10.6071C9.71954 23 9 22.2805 9 21.3929V14Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t\t</g>\r\n\t\t\t\t\t\t\t<defs>\r\n\t\t\t\t\t\t\t\t<clipPath id=\"clip0_58_113\">\r\n\t\t\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"3\" fill=\"white\"/>\r\n\t\t\t\t\t\t\t\t</clipPath>\r\n\t\t\t\t\t\t\t</defs>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" href=\"https://github.com/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path fillRule=\"evenodd\" clipRule=\"evenodd\" d=\"M15.5 8C11.3562 8 8 11.4411 8 15.6897C8 19.0924 10.1469 21.9664 13.1281 22.9853C13.5031 23.0526 13.6437 22.8219 13.6437 22.62C13.6437 22.4374 13.6344 21.8319 13.6344 21.1878C11.75 21.5435 11.2625 20.7168 11.1125 20.2843C11.0281 20.0632 10.6625 19.3808 10.3438 19.1981C10.0812 19.0539 9.70625 18.6983 10.3344 18.6887C10.925 18.6791 11.3469 19.2462 11.4875 19.4769C12.1625 20.64 13.2406 20.3131 13.6719 20.1113C13.7375 19.6115 13.9344 19.275 14.15 19.0828C12.4812 18.8905 10.7375 18.2273 10.7375 15.286C10.7375 14.4497 11.0281 13.7577 11.5063 13.2194C11.4313 13.0271 11.1688 12.2389 11.5812 11.1816C11.5812 11.1816 12.2094 10.9798 13.6437 11.9698C14.2437 11.7968 14.8812 11.7103 15.5187 11.7103C16.1562 11.7103 16.7937 11.7968 17.3938 11.9698C18.8281 10.9701 19.4563 11.1816 19.4563 11.1816C19.8687 12.2389 19.6063 13.0271 19.5312 13.2194C20.0094 13.7577 20.3 14.4401 20.3 15.286C20.3 18.2369 18.5469 18.8905 16.8781 19.0828C17.15 19.3231 17.3844 19.7845 17.3844 20.5054C17.3844 21.5339 17.375 22.3605 17.375 22.62C17.375 22.8219 17.5156 23.0622 17.8906 22.9853C19.3795 22.4699 20.6732 21.4888 21.5898 20.1801C22.5063 18.8714 22.9996 17.3009 23 15.6897C23 11.4411 19.6438 8 15.5 8Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" href=\"https://twitter.com/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M23 10.4234C22.4484 10.664 21.8558 10.8265 21.2328 10.8999C21.8756 10.5215 22.3565 9.92574 22.5858 9.22397C21.9819 9.57697 21.3209 9.82545 20.6317 9.95859C20.1682 9.47158 19.5543 9.14877 18.8852 9.0403C18.2162 8.93183 17.5295 9.04376 16.9317 9.35871C16.334 9.67366 15.8586 10.174 15.5794 10.7821C15.3002 11.3902 15.2328 12.0719 15.3877 12.7215C14.164 12.6611 12.9669 12.3481 11.8741 11.8029C10.7813 11.2577 9.81726 10.4924 9.04444 9.55683C8.78019 10.0054 8.62825 10.5255 8.62825 11.0794C8.62795 11.578 8.75273 12.069 8.99151 12.5088C9.23029 12.9486 9.57568 13.3236 9.99705 13.6005C9.50837 13.5852 9.03048 13.4552 8.60314 13.2215V13.2605C8.6031 13.9598 8.84892 14.6377 9.2989 15.1789C9.74888 15.7202 10.3753 16.0916 11.0719 16.2302C10.6185 16.3509 10.1433 16.3687 9.68193 16.2822C9.87847 16.8839 10.2613 17.4101 10.7768 17.7871C11.2923 18.1641 11.9148 18.373 12.5569 18.3846C11.4668 19.2268 10.1205 19.6836 8.73461 19.6816C8.48911 19.6816 8.24382 19.6675 8 19.6393C9.40677 20.5294 11.0444 21.0018 12.7168 21C18.3783 21 21.4733 16.3855 21.4733 12.3835C21.4733 12.2535 21.47 12.1221 21.4641 11.9921C22.0661 11.5637 22.5857 11.0332 22.9987 10.4254L23 10.4234Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" href=\"https://discord.gg/5DGZ7rzSfS\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M20.6981 10.9123C19.7418 10.4907 18.7169 10.179 17.645 10.0018C17.6355 10 17.6256 10.0012 17.6167 10.0051C17.6079 10.009 17.6005 10.0156 17.5956 10.0238C17.4644 10.2493 17.3182 10.5432 17.2157 10.7754C16.0789 10.6094 14.9232 10.6094 13.7864 10.7754C13.6722 10.5181 13.5435 10.2671 13.4008 10.0238C13.3959 10.0155 13.3886 10.0088 13.3798 10.0047C13.371 10.0005 13.3611 9.99908 13.3514 10.0006C12.2802 10.1778 11.2552 10.4894 10.2984 10.9117C10.2901 10.9151 10.2831 10.9208 10.2784 10.9282C8.33342 13.7238 7.80031 16.4504 8.06217 19.1428C8.0629 19.1494 8.065 19.1558 8.06833 19.1616C8.07166 19.1673 8.07616 19.1724 8.08155 19.1764C9.21676 19.9845 10.4829 20.6001 11.8271 20.9974C11.8364 21.0002 11.8465 21.0002 11.8558 20.9974C11.8652 20.9946 11.8735 20.989 11.8796 20.9815C12.1688 20.6033 12.4251 20.2021 12.6458 19.782C12.6489 19.7762 12.6506 19.7699 12.651 19.7635C12.6513 19.757 12.6502 19.7505 12.6478 19.7445C12.6454 19.7385 12.6417 19.733 12.6369 19.7285C12.6321 19.724 12.6264 19.7206 12.6202 19.7184C12.2164 19.5698 11.8252 19.3904 11.4502 19.1819C11.4435 19.1782 11.4378 19.1728 11.4337 19.1664C11.4296 19.16 11.4272 19.1526 11.4267 19.145C11.4262 19.1375 11.4276 19.1299 11.4308 19.123C11.4341 19.1161 11.439 19.1101 11.4452 19.1055C11.5239 19.0487 11.6027 18.9894 11.6777 18.9302C11.6844 18.9248 11.6926 18.9214 11.7012 18.9204C11.7098 18.9193 11.7185 18.9206 11.7264 18.9241C14.1807 20.002 16.8388 20.002 19.2643 18.9241C19.2723 18.9204 19.2811 18.9189 19.2898 18.9199C19.2986 18.9208 19.3068 18.9242 19.3137 18.9295C19.3887 18.9894 19.4668 19.0487 19.5462 19.1055C19.5525 19.11 19.5575 19.1159 19.5608 19.1228C19.5642 19.1296 19.5657 19.1371 19.5653 19.1447C19.565 19.1523 19.5627 19.1596 19.5587 19.1661C19.5547 19.1726 19.5491 19.1781 19.5425 19.1819C19.1687 19.3921 18.78 19.57 18.3719 19.7178C18.3656 19.7201 18.3599 19.7236 18.3551 19.7281C18.3504 19.7327 18.3466 19.7382 18.3442 19.7442C18.3418 19.7503 18.3407 19.7568 18.3411 19.7633C18.3414 19.7698 18.3432 19.7762 18.3463 19.782C18.5712 20.2018 18.8287 20.6014 19.1119 20.9809C19.1177 20.9887 19.1259 20.9945 19.1353 20.9976C19.1447 21.0006 19.1549 21.0008 19.1644 20.998C20.5108 20.6018 21.779 19.986 22.9155 19.1764C22.921 19.1726 22.9257 19.1677 22.9291 19.162C22.9326 19.1563 22.9348 19.15 22.9355 19.1434C23.248 16.0306 22.4118 13.326 20.7174 10.9294C20.7133 10.9216 20.7064 10.9155 20.6981 10.9123ZM13.0127 17.5033C12.2739 17.5033 11.6646 16.8501 11.6646 16.049C11.6646 15.2472 12.2621 14.5946 13.0127 14.5946C13.7689 14.5946 14.3726 15.2527 14.3607 16.049C14.3607 16.8507 13.7633 17.5033 13.0127 17.5033ZM17.9969 17.5033C17.2575 17.5033 16.6488 16.8501 16.6488 16.049C16.6488 15.2472 17.2457 14.5946 17.9969 14.5946C18.7531 14.5946 19.3568 15.2527 19.345 16.049C19.345 16.8507 18.7537 17.5033 17.9969 17.5033Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t\t<a className=\"footer__smedia-item\" target=\"_blank\" href=\"https://t.me/DeDeLend\">\r\n\t\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" viewBox=\"0 0 30 30\" fill=\"none\">\r\n\t\t\t\t\t\t\t<rect width=\"30\" height=\"30\" rx=\"5\" fill=\"#181A3C\"/>\r\n\t\t\t\t\t\t\t<path d=\"M21.9875 9.0789L8.70041 13.9664C7.79362 14.3138 7.79886 14.7964 8.53404 15.0115L11.9454 16.0267L19.8382 11.2764C20.2114 11.0598 20.5524 11.1763 20.2721 11.4136L13.8774 16.9188H13.8759L13.8774 16.9195L13.642 20.2737C13.9868 20.2737 14.1389 20.1228 14.3323 19.9448L15.9892 18.4079L19.4358 20.8363C20.0713 21.1701 20.5277 20.9985 20.6858 20.2751L22.9483 10.104C23.1798 9.2183 22.5938 8.81726 21.9875 9.0789Z\" fill=\"#6988FF\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t\t</a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</footer>\r\n\t);\r\n};\r\n\r\nexport default Footer;","import React from 'react';\r\n\r\nconst Modal = ({children, className, visible, setVisible, resetModal}) => {\r\n\tconst classes = ['modal', className]\r\n\r\n\t\r\n\tif (visible) {\r\n\t\tclasses.push('active')\r\n\t}\r\n\r\n\tconst closeModal = () => {\r\n\t\tsetVisible(false)\r\n\t\tresetModal()\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className={classes.join(' ')} onMouseDown={closeModal}>\r\n\t\t\t<div className=\"modal__content-wrapper\">\r\n\t\t\t\t<div className=\"modal__content\" onMouseDown={e => e.stopPropagation()}>\r\n\t\t\t\t\t<button className=\"close-btn\" onClick={closeModal}></button>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Modal;","import React from 'react';\r\n\r\nconst Input = ({msg, ...props}) => {\r\n\tconst childProps = { ...props };\r\n\tdelete childProps.setValue;\r\n\tdelete childProps.setBtnActive;\r\n\t\r\n\treturn (\r\n\t\t<div className='input-container'>\r\n\t\t\t<input type=\"text\" {...childProps} />\r\n\t\t\t<span className=\"msg\">{msg}</span>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Input;","import React, { useState, } from 'react';\r\nimport Input from './Input';\r\nimport { convertInputNum } from '../../utils/sepThousands';\r\n\r\n\r\nconst NumberInput = (props) => {\r\n\t\r\n\treturn (\r\n\t\t<Input\r\n\t\t\t{...props}\r\n\t\t\tvalue={props.value}\r\n\r\n\t\t\tonChange={e => {\r\n\t\t\t\tprops.setBtnActive(true)\r\n\t\t\t\tprops.setValue(convertInputNum(e.target.value))\r\n\t\t\t}}\r\n\t\t\t\r\n\t\t\tonBlur={() => {\r\n\t\t\t\tif(!props.value) {\r\n\t\t\t\t\tprops.setBtnActive(false)\r\n\t\t\t\t}\r\n\t\t\t}} />\r\n\t);\r\n};\r\n\r\nexport default NumberInput;","import React, { useState, useEffect } from 'react';\r\nimport NumberInput from './UI/input/NumberInput'\r\nimport Button from './UI/button/Button'\r\n\r\nconst Form = ({children, maxVal, inputProps, btnText, btnIsActive, onSubmit, modalVisible, ...props}) => {\r\n\r\n\tconst [state, setState] = useState({class: '', msg: ''});\r\n\t\r\n\tlet [val, setVal] = useState('')\r\n\tif (inputProps.state) {\r\n\t\tval = inputProps.state.val\r\n\t\tsetVal = inputProps.state.setVal\r\n\t}\r\n\r\n\tconst [btnActive, setBtnActive] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!modalVisible) {\r\n\t\t\tsetState({\r\n\t\t\t\tclass: '',\r\n\t\t\t\tmsg: ''\r\n\t\t\t});\r\n\t\t\tsetVal('')\r\n\t\t}\r\n\t}, [modalVisible])\r\n\t\r\n\treturn (\r\n\t\t<form className={props.className} action=\"post\" onSubmit={((e) => {\r\n\t\t\te.preventDefault()\r\n\t\t\t\r\n\t\t\tconst validateForm = () => {\r\n\t\t\t\tif (!val) {\r\n\t\t\t\t\te.preventDefault()\r\n\t\r\n\t\t\t\t\tsetState({\r\n\t\t\t\t\t\tclass: 'error',\r\n\t\t\t\t\t\tmsg: 'Empty field'\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif(Number(val.toString().split('.').join('')) === 0) {\r\n\t\t\t\t\t\te.preventDefault()\r\n\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tclass: 'error',\r\n\t\t\t\t\t\t\tmsg: ''\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else if(val.toString().split(' ').join('') > maxVal) {\r\n\t\t\t\t\t\te.preventDefault()\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tclass: 'error',\r\n\t\t\t\t\t\t\tmsg: props.maxWarningMsg ?? 'Insufficient balance'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetState({\r\n\t\t\t\t\t\t\tclass: '',\r\n\t\t\t\t\t\t\tmsg: ''\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\tonSubmit(e)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (inputProps.disabled) {\r\n\t\t\t\tonSubmit(e)\r\n\t\t\t} else {\r\n\t\t\t\tvalidateForm()\r\n\t\t\t}\r\n\t\t})}>\r\n\t\t\t<div className='form-field'>\r\n\t\t\t\t<div className=\"input-container\">\r\n\t\t\t\t\t<NumberInput value={val} setValue={setVal} {...inputProps} className={state.class} msg={state.msg} setBtnActive={setBtnActive}></NumberInput>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tprops.isModal ?\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\tclassName=\"btn_plain\"\r\n\t\t\t\t\t\t\tdisabled={inputProps.disabled}\r\n\t\t\t\t\t\t\tonClick={props.maxOnClick}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tMax\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t: ''\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<Button btnActive={btnActive || btnIsActive} disabled={props.btnIsDisabled}>{btnText}</Button>\r\n\t\t\t</div>\r\n\t\t\t{children}\r\n\t\t</form>\r\n\t);\r\n};\r\n\r\nexport default Form;","import React from 'react';\r\n\r\nconst Loader = () => {\r\n\treturn (\r\n\t\t<div className='loader-container'>\r\n\t\t\t<svg viewBox=\"0 0 100 100\">\r\n\t\t\t\t<defs>\r\n\t\t\t\t</defs>\r\n\t\t\t\t<circle className=\"loader\" style={{fill:'transparent',stroke:'#fff',strokeWidth: '7px',strokeLinecap: 'round'}} cx=\"50\" cy=\"50\" r=\"45\"/>\r\n\t\t\t</svg>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Loader;","export const errAlert = (err) => {\r\n\tconst msg = err.reason ?? err.message;\r\n\t\r\n\tconsole.log(err);\r\n\talert(`Error code: ${err.code}\\nError message: ${msg}\\n\\nCheck the console for details.`)\r\n}","import React, {useContext, useState, useEffect} from 'react';\r\nimport Modal from './Modal';\r\nimport { GlobalStatsContext } from './../../../context/context';\r\nimport Form from './../../Form';\r\nimport { OptManager } from './../../utils/contracts';\r\nimport Loader from './../loader/Loader';\r\nimport { floor, formatForContract } from './../../utils/math';\r\nimport { sepToNumber, separateThousands } from './../../utils/sepThousands';\r\nimport { errAlert } from './../../utils/error';\r\n\r\nconst BorrowModal = ({state, setVisible, updateOptionStats, isLoading, setIsLoading}) => {\r\n\tconst option = state.option;\r\n\tconst contract = option.contracts?.[0]\r\n\tconst contract_signed = option.contracts?.[1]\r\n\t\r\n\tconst {globalStats} = useContext(GlobalStatsContext)\r\n\tconst [step, setStep] = useState(state.initStep ?? 0);\r\n\tconst [inputVal, setInputVal] = useState('')\r\n\tconst [liqPrice, setLiqPrice] = useState('—')\r\n\r\n\tconst available = floor(option.realVals?.borrowLimit - option.realVals?.borrowLimitUsed, 6);\r\n\r\n\tconst setMaxVal = () => {\r\n\t\tsetInputVal(available)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof option !== 'object' || !Object.keys(option).length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (sepToNumber(inputVal) > available) {\r\n\t\t\tsetInputVal(available)\r\n\t\t}\r\n\t\t\r\n\t\tlet classic, result;\r\n\t\tconst prior = option.priorLiqPrice;\r\n\t\tconst val = sepToNumber(inputVal)\r\n\r\n\t\tconst isCALL = option.name.includes('CALL')\r\n\r\n\t\tif (isCALL) {\r\n\t\t\tclassic = option.strike + (((option.borrowLimitUsed + val) / option.amount) * 1.2)\r\n\t\t\t\r\n\t\t\tresult = Math.max(prior, classic);\r\n\t\t} else {\r\n\t\t\tclassic = option.strike - (((option.borrowLimitUsed + val) / option.amount) * 1.2)\r\n\r\n\t\t\tresult = Math.min(prior, classic);\r\n\t\t}\r\n\t\t\r\n\t\tsetLiqPrice(floor(result))\r\n\r\n\t}, [inputVal])\r\n\r\n\tuseEffect(() => {\r\n\t\tsetStep(state.initStep ?? 0)\r\n\t}, [state.initStep])\r\n\t\r\n\r\n\tconst steps = [\r\n\t\t{\r\n\t\t\ttitle: \"Approve\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsetIsLoading(true);\r\n\t\t\t\t\r\n\t\t\t\tOptManager.approve(contract.address, option.id)\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconsole.log('Approve transaction:', res);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tsetStep(step + 1);\r\n\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true,\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Lock Collateral\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsetIsLoading(true);\r\n\t\t\t\t\r\n\t\t\t\tcontract_signed.lockOption(option.id)\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconsole.log('Lock Collateral transaction:', res);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tsetStep(step + 1);\r\n\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true,\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Borrow\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\tsetIsLoading(true);\r\n\r\n\t\t\t\tcontract_signed.borrow(option.id, formatForContract(inputVal))\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconsole.log('Borrow transaction:', res);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: false,\r\n\t\t\t\tstate: {\r\n\t\t\t\t\tval: inputVal,\r\n\t\t\t\t\tsetVal: setInputVal\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\r\n\tconst resetModal = () => {\r\n\t\tsetStep(state.initStep ?? 0)\r\n\t}\r\n\r\n\r\n\treturn (\r\n\t\t<Modal className={'modal_borrow'} visible={state.isVisible} setVisible={setVisible} resetModal={resetModal}>\r\n\t\t\t<h1 className='modal__title'>Borrow USDC</h1>\r\n\t\t\t<div className=\"modal__body\">\r\n\t\t\t\t<div className=\"modal__steps steps\">\r\n\t\t\t\t\t{steps.map((el, i) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div className={i === step ? 'modal__step step current' : 'modal__step step'} key={i}>\r\n\t\t\t\t\t\t\t\t{el.title}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__info\">\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow APY:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{globalStats.borrowAPY + '%'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow Limit:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{separateThousands(option.borrowLimit) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title nowrap\">Loan-To-Value:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">\r\n\t\t\t\t\t\t\t{floor((option.borrowLimitUsed / option.intrinsicValue) * 100) + '%'}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Available:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val highlighted\">{separateThousands(floor(available)) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstep === 2 ?\r\n\t\t\t\t\t\t\t<div className=\"modal__info-field modal__info-field_hl\">\r\n\t\t\t\t\t\t\t\t<div className=\"modal__info-field-title\">Liquidation Price:</div>\r\n\t\t\t\t\t\t\t\t<div className=\"modal__info-field-val\">{separateThousands(liqPrice)}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__form-wrapper\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading ?\r\n\t\t\t\t\t\t\t<Loader />\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<Form maxVal={available} inputProps={steps[step].inputProps} btnText={steps[step].title} onSubmit={steps[step].onSubmit}\r\n\t\t\t\t\t\t\tmodalVisible={state.isVisible}\r\n\t\t\t\t\t\t\tbtnIsActive={steps[step].btnIsActive}\r\n\t\t\t\t\t\t\tmaxWarningMsg={'Limit is exceed'}\r\n\t\t\t\t\t\t\tisModal={true}\r\n\t\t\t\t\t\t\tmaxOnClick={setMaxVal}></Form>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"modal__tip\">\r\n\t\t\t\tYou have 30 minutes before the option expires to get your option back. 30 minutes before the expiration date DeDeLend will exercise this option and take 100% of the payoff from the option.\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default BorrowModal;","import { usePages } from './../../../hooks/usePages';\r\n\r\nconst Pagination = ({totalPages, page, changePage}) => {\r\n\treturn usePages(totalPages, page, changePage)\r\n};\r\n\r\nexport default Pagination;","import { useMemo } from 'react';\r\nimport { getPagesArray } from '../components/utils/pages'\r\n\r\nexport const usePages = (totalPages, page, changePage) => {\r\n\tconst pages = useMemo( () => {\r\n\t\tconst pagesArray = getPagesArray(totalPages)\r\n\t\t\r\n\t\treturn(\r\n\t\t\t<div className=\"pages-container\">\r\n\t\t\t\t<button className=\"pages-btn-back pages-btn\" disabled={page <= 1}\r\n\t\t\t\t\tonClick={() => changePage(page - 1)}>\r\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"7\" height=\"12\" viewBox=\"0 0 7 12\" fill=\"none\">\r\n\t\t\t\t\t\t<path d=\"M6 11L1 6L6 1\" stroke=\"#384263\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t\t<div className=\"pages\">\r\n\t\t\t\t\t{pagesArray.map((p, i) => {\r\n\t\t\t\t\t\treturn <button className={page === p ? 'page current' : 'page'}\r\n\t\t\t\t\t\t\tkey={p}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tchangePage(p)\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t\t\t{p}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<button className=\"pages-btn-forward pages-btn\" disabled={page >= totalPages}\r\n\t\t\t\t\tonClick={() => changePage(page + 1)}>\r\n\t\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"7\" height=\"12\" viewBox=\"0 0 7 12\" fill=\"none\">\r\n\t\t\t\t\t\t<path d=\"M1 1L6 6L1 11\" stroke=\"#6988FF\"/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t)\r\n\t}, [totalPages, page])\r\n\r\n\treturn pages;\r\n}","export const getPageCount = (totalCount, limit) => {\r\n\treturn Math.ceil(totalCount / limit);\r\n}\r\n\r\nexport const getPagesArray = (totalPages) => {\r\n\tconst pagesArr = []\r\n\t\r\n\tfor (let i = 0; i < totalPages; i++) {\r\n\t\tpagesArr.push(i + 1);\r\n\t}\r\n\r\n\treturn pagesArr;\r\n}","import React, {useContext, useState, useEffect} from 'react';\r\nimport Modal from './Modal';\r\nimport { GlobalStatsContext } from './../../../context/context';\r\nimport Form from './../../Form';\r\nimport { USDC_signed } from '../../utils/contracts';\r\nimport Loader from './../loader/Loader';\r\nimport { sepToNumber, separateThousands } from './../../utils/sepThousands';\r\nimport { floor, formatForContract } from './../../utils/math';\r\nimport { errAlert } from './../../utils/error';\r\n\r\n\r\nconst RepayModal = ({state, setVisible, updateOptionStats, isLoading, setIsLoading}) => {\r\n\tconst option = state.option;\r\n\tconst contract_signed = option.contracts?.[1]\r\n\r\n\tconst {globalStats} = useContext(GlobalStatsContext)\r\n\tconst [inputVal, setInputVal] = useState('')\r\n\tconst [step, setStep] = useState(0);\r\n\tconst [liqPrice, setLiqPrice] = useState('—')\r\n\r\n\tconst repay = option.realVals?.borrowLimitUsed;\r\n\r\n\tconst setMaxVal = () => {\r\n\t\tsetInputVal(repay)\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (typeof option !== 'object' || !Object.keys(option).length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (sepToNumber(inputVal) > repay) {\r\n\t\t\tsetInputVal(repay)\r\n\t\t}\r\n\t\t\r\n\t\tlet classic, result;\r\n\t\tconst prior = option.priorLiqPrice;\r\n\t\tconst val = sepToNumber(inputVal)\r\n\r\n\t\tconst isCALL = option.name.includes('CALL')\r\n\r\n\t\tif (isCALL) {\r\n\t\t\tclassic = option.strike + (((option.borrowLimitUsed - val) / option.amount) * 1.2)\r\n\t\t\t\r\n\t\t\tresult = Math.max(prior, classic);\r\n\t\t} else {\r\n\t\t\tclassic = option.strike - (((option.borrowLimitUsed - val) / option.amount) * 1.2)\r\n\r\n\t\t\tresult = Math.min(prior, classic);\r\n\t\t}\r\n\r\n\t\tif (result === prior && sepToNumber(inputVal) >= repay) {\r\n\t\t\tsetLiqPrice('—')\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetLiqPrice(floor(result))\r\n\r\n\t}, [inputVal])\r\n\t\r\n\tuseEffect(() => {\r\n\t\tsetStep(state.initStep ?? 0)\r\n\t}, [state.initStep])\r\n\t\r\n\r\n\tconst steps = [\r\n\t\t{\r\n\t\t\ttitle: \"Repay\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\t\r\n\t\t\t\tsetIsLoading(true);\r\n\t\t\t\tcontract_signed.repay(option.id, formatForContract(inputVal))\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconsole.log('Repay transaction:', res);\r\n\r\n\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\r\n\t\t\t\t\t\tif (err.message.includes('transfer amount exceeds allowance')) {\r\n\t\t\t\t\t\t\tUSDC_signed.approve(contract_signed.address, 10**9 * 1e6)\r\n\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\tcontract_signed.repay(option.id, formatForContract(inputVal))\r\n\t\t\t\t\t\t\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\terr => {\r\n\t\t\t\t\t\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}, err => {\r\n\t\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: false,\r\n\t\t\t\tstate: {\r\n\t\t\t\t\tval: inputVal,\r\n\t\t\t\t\tsetVal: setInputVal\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbtnIsActive: false\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Unlock Collateral\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\tsetIsLoading(true);\r\n\r\n\t\t\t\tcontract_signed.unlock(option.id)\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconsole.log('Unlock transaction:', res);\r\n\r\n\t\t\t\t\t\tres.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tupdateOptionStats(option.id, option.isETH, false)\r\n\t\t\t\t\t\t\t\tsetVisible(false)\r\n\t\t\t\t\t\t\t\tsetStep(0)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true\r\n\t\t}\r\n\t]\r\n\r\n\tconst resetModal = () => {\r\n\t\tsetStep(state.initStep ?? 0)\r\n\t}\r\n\r\n\r\n\treturn (\r\n\t\t<Modal className={'modal_borrow'} visible={state.isVisible} setVisible={setVisible} resetModal={resetModal}>\r\n\t\t\t<h1 className='modal__title'>Repay USDC</h1>\r\n\t\t\t<div className=\"modal__body\">\r\n\t\t\t\t<div className=\"modal__steps steps\">\r\n\t\t\t\t\t{steps.map((el, i) => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div className={i === step ? 'modal__step step current' : 'modal__step step'} key={i}>\r\n\t\t\t\t\t\t\t\t{el.title}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__info\">\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow APY:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{globalStats.borrowAPY + '%'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Borrow Limit:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val\">{separateThousands(option.borrowLimit) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title nowrap\">Loan-To-Value:</div>\r\n\t\t\t\t\t\t\t<div className=\"modal__info-field-val\">\r\n\t\t\t\t\t\t\t\t{floor((option.borrowLimitUsed / option.intrinsicValue) * 100) + '%'}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"modal__info-field\">\r\n\t\t\t\t\t\t<div className=\"modal__info-field-title\">Repay:</div>\r\n\t\t\t\t\t\t<div className=\"modal__info-field-val highlighted\">{separateThousands(option.borrowLimitUsed) + ' USDC'}</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tstep === 0 ?\r\n\t\t\t\t\t\t\t<div className=\"modal__info-field modal__info-field_hl\">\r\n\t\t\t\t\t\t\t\t<div className=\"modal__info-field-title\">Liquidation Price:</div>\r\n\t\t\t\t\t\t\t\t<div className=\"modal__info-field-val\">{separateThousands(liqPrice)}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"modal__form-wrapper\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading ?\r\n\t\t\t\t\t\t\t<Loader />\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<Form maxVal={repay} inputProps={steps[step].inputProps} btnText={steps[step].title} onSubmit={steps[step].onSubmit}\r\n\t\t\t\t\t\t\tisStep={step < steps.length - 1}\r\n\t\t\t\t\t\t\tmodalVisible={state.isVisible}\r\n\t\t\t\t\t\t\tbtnIsActive={steps[step].btnIsActive}\r\n\t\t\t\t\t\t\tmaxWarningMsg={'Amount is too big'}\r\n\t\t\t\t\t\t\tisModal={true}\r\n\t\t\t\t\t\t\tmaxOnClick={setMaxVal}></Form>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Modal>\r\n\t);\r\n};\r\n\r\nexport default RepayModal;","import React, { useState } from 'react';\r\nimport Button from './UI/button/Button';\r\nimport { OptManager } from './utils/contracts';\r\nimport { separateThousands } from './utils/sepThousands';\r\n\r\nconst OptionItem = ({ option, stats, ...props }) => {\r\n\tconst [initBorrowStep, setInitBorrowStep] = useState(0)\r\n\tconst [initRepayStep, setInitRepayStep] = useState(0)\r\n\tconst [repayDisabled, setRepayDisabled] = useState(true);\r\n\r\n\tconst contract = option.contracts?.[0]\r\n\t\r\n\r\n\tif (typeof option === 'string') {\r\n\t\treturn(\r\n\t\t\t<div className='borrow-market__warning'>\r\n\t\t\t\t{option}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\t\r\n\tOptManager.isApprovedOrOwner(contract.address, option.id)\r\n\t\t.then(res => {\r\n\t\t\tif (res === true) {\r\n\t\t\t\tOptManager.ownerOf(option.id)\r\n\t\t\t\t\t.then(owner => {\r\n\t\t\t\t\t\tif (owner == contract.address) {\r\n\t\t\t\t\t\t\tsetInitBorrowStep(2)\r\n\t\t\t\t\t\t\tsetRepayDisabled(false)\r\n\r\n\t\t\t\t\t\t\tif (option.realVals?.borrowLimitUsed <= 0) {\r\n\t\t\t\t\t\t\t\tsetInitRepayStep(1)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tsetInitRepayStep(0)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsetInitBorrowStep(1)\r\n\t\t\t\t\t\t\tsetRepayDisabled(true)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\tsetInitBorrowStep(0)\r\n\t\t\t\tsetInitRepayStep(0)\r\n\t\t\t\tsetRepayDisabled(true)\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\r\n\r\n\treturn (\r\n\t\t<div className=\"borrow-market__item _mobile-fluid\" key={option.id}>\r\n\t\t\t<div className=\"borrow-market__item-options\">\r\n\t\t\t\t{\r\n\t\t\t\t\tObject.keys(option).map((key, i) => {\r\n\t\t\t\t\t\tconst stat = stats[i] ?? '';\r\n\t\t\t\t\t\tif (!stat) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet val = '';\r\n\t\t\t\t\t\tif (typeof stat.unit !== 'function') {\r\n\t\t\t\t\t\t\tif (option[key] !== '') {\r\n\t\t\t\t\t\t\t\tlet convertedNum;\r\n\t\t\t\t\t\t\t\tif (stat.name === 'ID' || stat.name === 'Option') {\r\n\t\t\t\t\t\t\t\t\tconvertedNum = option[key]\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tconvertedNum = separateThousands(option[key]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tval = stat.unit === '$' ? stat.unit + convertedNum\r\n\t\t\t\t\t\t\t\t: convertedNum + ' ' + stat.unit;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tval = '—'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tval = stat.unit(option[key])\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn(\r\n\t\t\t\t\t\t\t<div className=\"borrow-market__item-option\" key={key}>\r\n\t\t\t\t\t\t\t\t<div className=\"borrow-market__item-option-name\">\r\n\t\t\t\t\t\t\t\t\t{stat.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"borrow-market__item-option-val\">\r\n\t\t\t\t\t\t\t\t\t{val}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"borrow-market__item-btns btns\">\r\n\t\t\t\t<Button className={'btn_small'} disabled={\r\n\t\t\t\t\t(option.borrowLimit <= 0\r\n\t\t\t\t\t\t|| option.borrowLimitUsed >= option.borrowLimit\r\n\t\t\t\t\t\t|| option.expiration <= 60 * 60 * 1000)\r\n\t\t\t\t} onClick={() => {\r\n\t\t\t\t\tprops.setBorrowModalState({\r\n\t\t\t\t\t\t...props.borrowModalState,\r\n\t\t\t\t\t\tisVisible: true,\r\n\t\t\t\t\t\toption,\r\n\t\t\t\t\t\tinitStep: initBorrowStep\r\n\t\t\t\t\t})\r\n\t\t\t\t}}>Borrow</Button>\r\n\t\t\t\t<Button className={\"btn_small\"} disabled={\r\n\t\t\t\t\trepayDisabled\r\n\t\t\t\t} onClick={() => {\r\n\t\t\t\t\tprops.setRepayModalState({\r\n\t\t\t\t\t\t...props.repayModalState,\r\n\t\t\t\t\t\tisVisible: true,\r\n\t\t\t\t\t\toption,\r\n\t\t\t\t\t\tinitStep: initRepayStep\r\n\t\t\t\t\t})\r\n\t\t\t\t}}>Repay</Button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default OptionItem;","import React from 'react';\r\nimport OptionItem from './OptionItem';\r\nimport Loader from './UI/loader/Loader';\r\n\r\nconst OptionsList = ({ options, setBorrowModalState, borrowModalState, setRepayModalState, repayModalState, ...props }) => {\r\n\t\r\n\tfunction convertMsToDays(ms) {\r\n\t\tconst s = ms / 1000;\r\n\t\tconst h = s / 3600;\r\n\t\tconst dResult = Math.floor(h / 24);\r\n\t\tconst hResult = Math.floor(h % 24);\r\n\r\n\t\treturn `${dResult}d ${hResult}h`\r\n\t}\r\n\t\r\n\t\r\n\tconst optionStats = [\r\n\t\t{\r\n\t\t\tname: 'ID',\r\n\t\t\tunit: ''\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Option',\r\n\t\t\tunit: ''\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Amount',\r\n\t\t\tunit: ''\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Strike',\r\n\t\t\tunit: '$'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Expires In',\r\n\t\t\tunit: convertMsToDays,\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Intrinsic Value',\r\n\t\t\tunit: 'USDC'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Borrow Limit',\r\n\t\t\tunit: 'USDC'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Borrow Limit Used',\r\n\t\t\tunit: 'USDC'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Liq. Price',\r\n\t\t\tunit: '$'\r\n\t\t},\r\n\t]\r\n\t\r\n\t\r\n\treturn (\r\n\t\t<React.Fragment>\r\n\t\t\t{\r\n\t\t\t\toptions.length ?\r\n\t\t\t\t\t<div className={typeof options[0] === 'string' ? \"\" : \"borrow-market__items app-box\"}>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toptions.map(option => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<OptionItem\r\n\t\t\t\t\t\t\t\t\t\toption={option}\r\n\t\t\t\t\t\t\t\t\t\tstats={optionStats}\r\n\t\t\t\t\t\t\t\t\t\tsetBorrowModalState={setBorrowModalState}\r\n\t\t\t\t\t\t\t\t\t\tborrowModalState={borrowModalState}\r\n\t\t\t\t\t\t\t\t\t\tsetRepayModalState={setRepayModalState}\r\n\t\t\t\t\t\t\t\t\t\trepayModalState={repayModalState}\r\n\t\t\t\t\t\t\t\t\t\tkey={option.id ?? option}\r\n\t\t\t\t\t\t\t\t\t\tisModalLoading={props.isModalLoading}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t:\r\n\t\t\t\t\tprops.filter ? \r\n\t\t\t\t\t\t'' : <Loader />\r\n\t\t\t}\r\n\t\t</React.Fragment>\r\n\t\t\r\n\t\t\r\n\t);\r\n};\r\n\r\nexport default OptionsList;","import React, { useState, useEffect, useContext } from 'react';\r\nimport BorrowModal from '../../components/UI/modal/BorrowModal';\r\nimport { useFilter } from './../../hooks/useFilter';\r\nimport { getPageCount } from './../../components/utils/pages';\r\nimport Pagination from './../../components/UI/pagination/Pagination';\r\nimport RepayModal from './../../components/UI/modal/RepayModal';\r\nimport { UserStatsContext } from './../../context/context';\r\nimport { connectWallet } from '../../components/utils/wallet';\r\nimport OptionsList from './../../components/OptionsList';\r\nimport { getOptionStats } from './../../components/utils/stats';\r\n\r\nconst BorrowMarket = ({ walletAddress, setWalletAddress }) => {\r\n\r\n\tconst {userStats, setUserStats} = useContext(UserStatsContext)\r\n\tconst [isModalLoading, setIsModalLoading] = useState(false)\r\n\r\n\tconst updateOptionStats = (id, isETH, updateModalState = true) => {\r\n\t\tgetOptionStats(id, isETH)\r\n\t\t\t.then(res => {\r\n\t\t\t\tconst options = userStats.options.slice()\r\n\r\n\t\t\t\tlet optI;\r\n\t\t\t\toptions.find((opt, i) => {\r\n\t\t\t\t\tif (opt.id === id) {\r\n\t\t\t\t\t\toptI = i;\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\r\n\t\t\t\toptions[optI] = {\r\n\t\t\t\t\t...options[optI],\r\n\t\t\t\t\t...res\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetUserStats({\r\n\t\t\t\t\t...userStats,\r\n\t\t\t\t\toptions\r\n\t\t\t\t})\r\n\r\n\t\t\t\tif (updateModalState) {\r\n\t\t\t\t\tsetRepayModalState({\r\n\t\t\t\t\t\t...repayModalState,\r\n\t\t\t\t\t\tinitStep: res.borrowLimitUsed > 0 ? 0 : 1,\r\n\t\t\t\t\t\toption: options[optI]\r\n\t\t\t\t\t})\r\n\t\t\t\t\tsetBorrowModalState({\r\n\t\t\t\t\t\t...borrowModalState,\r\n\t\t\t\t\t\toption: options[optI]\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetIsModalLoading(false)\r\n\t\t\t})\r\n\t}\r\n\t\r\n\t// Modal window\r\n\tconst [borrowModalState, setBorrowModalState] = useState({\r\n\t\tisVisible: false,\r\n\t\toption: {},\r\n\t\tinitStep: 0\r\n\t})\r\n\tconst [repayModalState, setRepayModalState] = useState({\r\n\t\tisVisible: false,\r\n\t\toption: {},\r\n\t\tinitStep: 0\r\n\t})\r\n\tconst setBorrowModalVisible = (bool) => {\r\n\t\tsetBorrowModalState({\r\n\t\t\t...borrowModalState,\r\n\t\t\tisVisible: bool\r\n\t\t})\r\n\t}\r\n\tconst setRepayModalVisible = (bool) => {\r\n\t\tsetRepayModalState({\r\n\t\t\t...repayModalState,\r\n\t\t\tisVisible: bool\r\n\t\t})\r\n\t}\r\n\t\r\n\r\n\t// Pagination\r\n\tconst [totalPages, setTotalPages] = useState(0);\r\n\tconst [limit] = useState(10);\r\n\tconst [page, setPage] = useState(1);\r\n\tconst changePage = (page) => {\r\n\t\tsetPage(page);\r\n\t\tfetchOptions(limit, page, filteredOptions);\r\n\t}\r\n\r\n\r\n\t\r\n\tconst [isAuth, setIsAuth] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tsetIsAuth(Boolean(walletAddress))\r\n\t}, [walletAddress])\r\n\r\n\tconst fetchOptions = (limit, page, options) => {\r\n\t\tif (!options) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\t\r\n\t\tconst fetchedOptions = []\r\n\t\tconst lowerBound = limit * (page - 1);\r\n\t\tconst upperBound = limit * page >= options.length ?\r\n\t\t\t options.length : limit * page;\r\n\t\t\r\n\t\tfor(let i = lowerBound; i < upperBound; i++) {\r\n\t\t\tconst option = options[i];\r\n\t\t\t\r\n\t\t\tif (option) {\r\n\t\t\t\tfetchedOptions.push(option);\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!fetchedOptions.length) {\r\n\t\t\tif (page !== 1) {\r\n\t\t\t\tchangePage(page - 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tsetOptions(fetchedOptions);\r\n\t\tconst totalCount = options.length;\r\n\t\tsetTotalPages(getPageCount(totalCount, limit))\r\n\t}\r\n\t\r\n\tconst [options, setOptions] = useState([]);\r\n\tconst [filter, setFilter] = useState('');\r\n\t\r\n\tuseEffect(() => {\r\n\t\tfetchOptions(limit, page, filteredOptions)\r\n\t}, [limit, page, filter, userStats.options])\r\n\r\n\tconst filteredOptions = useFilter(userStats.options, filter);\r\n\r\n\treturn (\r\n\t\t<div className='block borrow-market'>\r\n\t\t\t<h1 className='block__title'>Borrow Market</h1>\r\n\r\n\t\t\t<div className=\"borrow-market__items-container\">\r\n\t\t\t\t<div className=\"borrow-market__filter filter\">\r\n\t\t\t\t\t<div className=\"input-container\">\r\n\t\t\t\t\t\t<input type=\"checkbox\"\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tif (e.target.checked) {\r\n\t\t\t\t\t\t\t\tsetFilter('activeBorrows')\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tsetFilter('')\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdisabled={!isAuth || (!options.length && !filter)}\t/>\r\n\t\t\t\t\t\t<label>Show only active borrows</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t{\r\n\t\t\t\t\tisAuth ?\r\n\t\t\t\t\t<OptionsList filter={filter} options={options} setBorrowModalState={setBorrowModalState} borrowModalState={borrowModalState} setRepayModalState={setRepayModalState} repayModalState={repayModalState} isModalLoading={isModalLoading}></OptionsList>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<div className='auth-prompt app-box _mobile-fluid'>\r\n\t\t\t\t\t\t<button onClick={() => connectWallet(setWalletAddress)}>Connect wallet</button> to see a list of options\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t{isAuth && userStats.options ?\r\n\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t<BorrowModal state={borrowModalState} setVisible={setBorrowModalVisible} walletAddress={walletAddress}\r\n\t\t\t\t\tupdateOptionStats={updateOptionStats}\r\n\t\t\t\t\tisLoading={isModalLoading}\r\n\t\t\t\t\tsetIsLoading={setIsModalLoading}></BorrowModal>\r\n\t\t\t\t\t<RepayModal state={repayModalState} setVisible={setRepayModalVisible} walletAddress={walletAddress}\r\n\t\t\t\t\tupdateOptionStats={updateOptionStats}\r\n\t\t\t\t\tisLoading={isModalLoading}\r\n\t\t\t\t\tsetIsLoading={setIsModalLoading}></RepayModal>\r\n\r\n\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\ttotalPages={totalPages}\r\n\t\t\t\t\t\tpage={page}\r\n\t\t\t\t\t\tchangePage={changePage}\r\n\t\t\t\t\t></Pagination>\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t\t:\r\n\t\t\t\t\"\"\r\n\t\t\t}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default BorrowMarket;","import { useMemo } from 'react';\r\n\r\nexport const useFilter = (items = [], filter) => {\r\n\tconst filterItems = (filter) => {\r\n\t\tif (!filter) {\r\n\t\t\treturn items;\r\n\t\t}\r\n\r\n\t\tswitch(filter) {\r\n\t\t\tcase 'activeBorrows':\r\n\t\t\t\treturn items.filter(item => {\r\n\t\t\t\t\treturn Number(item.borrowLimitUsed) !== 0;\r\n\t\t\t\t})\r\n\t\t\tdefault: \r\n\t\t\t\treturn items;\r\n\t\t}\r\n\t}\r\n\t\r\n\tconst filteredItems = useMemo(() => {\r\n\t\treturn filterItems(filter)\r\n\t}, [items, filter])\r\n\r\n\t\r\n\r\n\treturn filteredItems;\r\n}","import React, { useContext, useState, useEffect } from 'react';\r\nimport { UserStatsContext } from './../context/context';\r\nimport Form from './Form';\r\nimport { DDL_POOL, DDL_POOL_signed, USDC_signed } from './utils/contracts';\r\nimport { separateThousands, sepToNumber } from './utils/sepThousands';\r\nimport Loader from './UI/loader/Loader';\r\nimport { getUserStats } from './utils/stats';\r\nimport { formatForContract } from './utils/math';\r\nimport { errAlert } from './utils/error';\r\n\r\nconst SupplyCard = ({ step, setStep, ...props }) => {\r\n\tconst {userStats, setUserStats} = useContext(UserStatsContext)\r\n\tconst [inputVal, setInputVal] = useState('')\r\n\tconst [isLoading, setIsLoading] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (sepToNumber(inputVal) > userStats.balance) {\r\n\t\t\tsetInputVal(userStats.balance)\r\n\t\t}\r\n\t}, [inputVal])\r\n\t\r\n\r\n\tconst steps = [\r\n\t\t{\r\n\t\t\ttitle: \"Approve\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tsetIsLoading(true)\r\n\t\t\t\ttry {\r\n\t\t\t\t\tUSDC_signed.approve(DDL_POOL.address, (10**9 * 1e6).toFixed(0))\r\n\t\t\t\t\t.then(tsc => {\r\n\t\t\t\t\t\tconsole.log('Supply Approve transaction: ', tsc);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\ttsc.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tsetStep(step + 1)\r\n\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: true,\r\n\t\t\t},\r\n\t\t\tbtnIsActive: true\r\n\t\t},\r\n\t\t{\r\n\t\t\ttitle: \"Supply\",\r\n\t\t\tonSubmit: (e) => {\r\n\t\t\t\te.preventDefault()\r\n\t\t\t\tsetIsLoading(true)\r\n\t\t\t\ttry {\r\n\t\t\t\t\tDDL_POOL_signed.provideFrom(props.walletAddress, formatForContract(inputVal), 0)\r\n\t\t\t\t\t.then(tsc => {\r\n\t\t\t\t\t\tconsole.log('Supply transaction:', tsc);\r\n\r\n\t\t\t\t\t\ttsc.wait()\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tgetUserStats(props.walletAddress)\r\n\t\t\t\t\t\t\t\t\t.then(stats => {\r\n\t\t\t\t\t\t\t\t\t\tsetUserStats({\r\n\t\t\t\t\t\t\t\t\t\t\t...userStats,\r\n\t\t\t\t\t\t\t\t\t\t\t...stats\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\terr => {\r\n\t\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t})\r\n\t\t\t\t} catch(err) {\r\n\t\t\t\t\terrAlert(err)\r\n\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tinputProps: {\r\n\t\t\t\tplaceholder: 'Amount',\r\n\t\t\t\tdisabled: false,\r\n\t\t\t\tstate: {\r\n\t\t\t\t\tval: inputVal,\r\n\t\t\t\t\tsetVal: setInputVal\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t]\r\n\t\r\n\treturn (\r\n\t\t<div className={\"supply-card market-card app-box \" + props.className}>\r\n\t\t\t<h2>Supply USDC</h2>\r\n\t\t\t<div className=\"steps\">\r\n\t\t\t\t{steps.map((el, i) => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div className={i === step ? 'step current' : 'step'} key={i}>\r\n\t\t\t\t\t\t\t{el.title}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t\t{\r\n\t\t\t\tisLoading ?\r\n\t\t\t\t\t<Loader />\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Form className=\"market-card__form\" maxVal={userStats.balance} inputProps={steps[step].inputProps} btnText={steps[step].title} onSubmit={steps[step].onSubmit}\r\n\t\t\t\t\tisStep={step < steps.length - 1}\r\n\t\t\t\t\tbtnIsActive={steps[step].btnIsActive}\r\n\t\t\t\t\tbtnIsDisabled={userStats.balance <= 0 || userStats.balance === undefined || props.walletAddress === ''}></Form>\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t<div className=\"market-card__info\">\r\n\t\t\t\t<div className=\"info-field\">\r\n\t\t\t\t\t<div className=\"info-field__name\">Balance: </div>\r\n\t\t\t\t\t<div className={\"info-field__val\" + (userStats.balance !== undefined ? '' : ' no-data')}>{userStats.balance !== undefined ? (separateThousands(userStats.balance) + ' USDC') : ''}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SupplyCard;","import React, {useContext, useEffect, useState} from 'react';\r\nimport { separateThousands, sepToNumber } from './utils/sepThousands';\r\nimport { UserStatsContext } from './../context/context';\r\nimport Form from './Form';\r\nimport { DDL_POOL_signed } from './utils/contracts';\r\nimport Loader from './UI/loader/Loader';\r\nimport { getUserStats } from './utils/stats';\r\nimport { formatForContract } from './utils/math';\r\nimport { errAlert } from './utils/error';\r\n\r\nconst WithdrawCard = (props) => {\r\n\tconst {userStats, setUserStats} = useContext(UserStatsContext)\r\n\tconst [inputVal, setInputVal] = useState('')\r\n\tconst [isLoading, setIsLoading] = useState(false)\r\n\t\r\n\tconst inputProps = {\r\n\t\tplaceholder: 'Amount',\r\n\t\tdisabled: props.walletAddress === '',\r\n\t\tstate: {\r\n\t\t\tval: inputVal,\r\n\t\t\tsetVal: setInputVal\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (sepToNumber(inputVal) > userStats.avail) {\r\n\t\t\tsetInputVal(userStats.avail)\r\n\t\t}\r\n\t}, [inputVal])\r\n\r\n\tconst onSubmit = (e) => {\r\n\t\te.preventDefault()\r\n\t\tsetIsLoading(true)\r\n\t\t\r\n\t\ttry {\r\n\t\t\tDDL_POOL_signed.withdraw(formatForContract(inputVal))\r\n\t\t\t.then(tsc => {\r\n\t\t\t\tconsole.log('Withdraw transaction:', tsc);\r\n\r\n\t\t\t\ttsc.wait()\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tgetUserStats(props.walletAddress)\r\n\t\t\t\t\t\t\t.then(stats => {\r\n\t\t\t\t\t\t\t\tsetUserStats({\r\n\t\t\t\t\t\t\t\t\t...userStats,\r\n\t\t\t\t\t\t\t\t\t...stats\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tsetInputVal('')\r\n\t\t\t\t\t\t\t\tsetIsLoading(false)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\terr => {\r\n\t\t\t\terrAlert(err)\r\n\t\t\t\tsetIsLoading(false)\r\n\t\t\t})\r\n\t\t} catch(err) {\r\n\t\t\terrAlert(err)\r\n\t\t\tsetIsLoading(false)\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\treturn (\r\n\t\t<div className={\"withdraw-card market-card app-box \" + props.className}>\r\n\t\t\t<h2>Withdraw USDC</h2>\r\n\t\t\t\r\n\t\t\t{\r\n\t\t\t\tisLoading ?\r\n\t\t\t\t\t<Loader />\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<Form className=\"market-card__form\" maxVal={userStats.avail} btnText={\"Withdraw\"} onSubmit={onSubmit} inputProps={inputProps} btnIsDisabled={userStats.avail <= 0 || userStats.avail === undefined || props.walletAddress === '' }></Form>\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t<div className=\"market-card__info\">\r\n\t\t\t\t<div className=\"info-field\">\r\n\t\t\t\t\t<div className=\"info-field__name\">Current Balance: </div>\r\n\t\t\t\t\t<div className={\"info-field__val\" + (userStats.curBalance !== undefined ? '' : ' no-data')}>{userStats.curBalance !== undefined ? (separateThousands(userStats.curBalance) + ' USDC') : ''}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-field\">\r\n\t\t\t\t\t<div className=\"info-field__name\">Available: </div>\r\n\t\t\t\t\t<div className={\"info-field__val\" + (userStats.balance !== undefined ? '' : ' no-data')}>{userStats.avail !== undefined ? (separateThousands(userStats.avail) + ' USDC') : ''}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default WithdrawCard;","import SupplyCard from './../../components/SupplyCard';\r\nimport WithdrawCard from './../../components/WithdrawCard';\r\n\r\nconst SupplyMarket = ({ walletAddress, supplyStep, setSupplyStep }) => {\r\n\t\r\n\t\r\n\treturn (\r\n\t\t<div className='block supply-market'>\r\n\t\t\t<h1 className='block__title'>Supply Market</h1>\r\n\t\t\t<div className=\"supply-market__functions\">\r\n\t\t\t\t<SupplyCard walletAddress={walletAddress} className=\"supply-market__function\" step={supplyStep} setStep={setSupplyStep}></SupplyCard>\r\n\t\t\t\t<WithdrawCard walletAddress={walletAddress} className=\"supply-market__function\" setSupplyStep={setSupplyStep}></WithdrawCard>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SupplyMarket;","import React, { useContext } from 'react';\r\nimport { GlobalStatsContext, UserStatsContext } from './../context/context';\r\nimport { separateThousands } from './utils/sepThousands';\r\n\r\n\r\nconst MarketInfoBoard = () => {\r\n\tconst {globalStats} = useContext(GlobalStatsContext)\r\n\r\n\r\n\treturn (\r\n\t\t<div className=\"info-board app-box block _mobile-fluid\">\r\n\t\t\t<div className=\"info-board__items\">\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Total Supplied</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">{separateThousands(globalStats.totalSupplied, ',') + ' USDC'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Total Borrowed</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">{separateThousands(globalStats.totalBorrowed, ',') + ' USDC'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Utilization Rate</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">{separateThousands(globalStats.utilRate, ',') + '%'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Available to Borrow</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">{separateThousands(globalStats.availToBorrow, ',') + ' USDC'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info-board__item\">\r\n\t\t\t\t\t<div className=\"info-board__item-title\">Supply APY</div>\r\n\t\t\t\t\t<div className=\"info-board__item-val\">{separateThousands(globalStats.borrowAPY, ',') + '%'}</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MarketInfoBoard;","const CONTRACTS = {\r\n  56: {\r\n    // bsc mainnet\r\n    Treasury: \"0xa44E7252a0C137748F523F112644042E5987FfC7\",\r\n    BUSD: \"0xe9e7cea3dedca5984780bafc599bd69add087d56\",\r\n    GMT: \"0x99e92123eB77Bc8f999316f622e5222498438784\",\r\n    Vault: \"0xc73A8DcAc88498FD4b4B1b2AaA37b0a2614Ff67B\",\r\n    Router: \"0xD46B23D042E976F8666F554E928e0Dc7478a8E1f\",\r\n    Reader: \"0x087A618fD25c92B61254DBe37b09E5E8065FeaE7\",\r\n    AmmFactory: \"0xBCfCcbde45cE874adCB698cC183deBcF17952812\",\r\n    AmmFactoryV2: \"0xcA143Ce32Fe78f1f7019d7d551a6402fC5350c73\",\r\n    OrderBook: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBookReader: \"0x1111111111111111111111111111111111111111\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x85E76cbf4893c1fbcB34dCF1239A91CE2A4CF5a7\",\r\n    NATIVE_TOKEN: \"0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c\",\r\n    XGMT: \"0xe304ff0983922787Fd84BC9170CD21bF78B16B10\",\r\n    GMT_USDG_PAIR: \"0xa41e57459f09a126F358E118b693789d088eA8A0\",\r\n    XGMT_USDG_PAIR: \"0x0b622208fc0691C2486A3AE6B7C875b4A174b317\",\r\n    GMT_USDG_FARM: \"0x3E8B08876c791dC880ADC8f965A02e53Bb9C0422\",\r\n    XGMT_USDG_FARM: \"0x68D7ee2A16AB7c0Ee1D670BECd144166d2Ae0759\",\r\n    USDG_YIELD_TRACKER: \"0x0EF0Cf825B8e9F89A43FfD392664131cFB4cfA89\",\r\n    XGMT_YIELD_TRACKER: \"0x82A012A9b3003b18B6bCd6052cbbef7Fa4892e80\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x08FAb024BEfcb6068847726b2eccEAd18b6c23Cd\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd8E26637B34B2487Cad1f91808878a391134C5c2\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0x026A02F7F26C1AFccb9Cba7C4df3Dc810F4e92e8\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x22458CEbD14a9679b2880147d08CA1ce5aa40E84\",\r\n    AUTO: \"0xa184088a740c695E156F91f5cC086a06bb78b827\",\r\n    AUTO_USDG_PAIR: \"0x0523FD5C53ea5419B4DAF656BC1b157dDFE3ce50\",\r\n    AUTO_USDG_FARM: \"0xE6958298328D02051769282628a3b4178D0F3A47\",\r\n    AUTO_USDG_FARM_TRACKER_XGMT: \"0x093b8be41c1A30704De84a9521632f9a139c08bd\",\r\n    AUTO_USDG_FARM_TRACKER_NATIVE: \"0x23ed48E5dce3acC7704d0ce275B7b9a0e346b63A\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  97: {\r\n    // bsc testnet\r\n    Vault: \"0x1B183979a5cd95FAF392c8002dbF0D5A1C687D9a\",\r\n    Router: \"0x10800f683aa564534497a5b67F45bE3556a955AB\",\r\n    Reader: \"0x98D4742F1B6a821bae672Cd8721283b91996E454\",\r\n    AmmFactory: \"0x6725f303b657a9451d8ba641348b6761a6cc7a17\",\r\n    AmmFactoryV2: \"0x1111111111111111111111111111111111111111\",\r\n    OrderBook: \"0x9afD7B4f0b58d65F6b2978D3581383a06b2ac4e9\",\r\n    OrderBookReader: \"0x0713562970D1A802Fa3FeB1D15F9809943982Ea9\",\r\n    GmxMigrator: \"0xDEF2af818514c1Ca1A9bBe2a4D45E28f260063f9\",\r\n    USDG: \"0x2D549bdBf810523fe9cd660cC35fE05f0FcAa028\",\r\n    GMT: \"0xedba0360a44f885ed390fad01aa34d00d2532817\",\r\n    NATIVE_TOKEN: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n    XGMT: \"0x28cba798eca1a3128ffd1b734afb93870f22e613\",\r\n    GMT_USDG_PAIR: \"0xe0b0a315746f51932de033ab27223d85114c6b85\",\r\n    XGMT_USDG_PAIR: \"0x0108de1eea192ce8448080c3d90a1560cf643fa0\",\r\n    GMT_USDG_FARM: \"0xbe3cB06CE03cA692b77902040479572Ba8D01b0B\",\r\n    XGMT_USDG_FARM: \"0x138E92195D4B99CE3618092D3F9FA830d9A69B4b\",\r\n    USDG_YIELD_TRACKER: \"0x62B49Bc3bF252a5DB26D88ccc7E61119e3179B4f\",\r\n    XGMT_YIELD_TRACKER: \"0x5F235A582e0993eE9466FeEb8F7B4682993a57d0\",\r\n    GMT_USDG_FARM_TRACKER_XGMT: \"0x4f8EE3aE1152422cbCaFACd4e3041ba2D859913C\",\r\n    GMT_USDG_FARM_TRACKER_NATIVE: \"0xd691B26E544Fe370f39A776964c991363aF72e56\",\r\n    XGMT_USDG_FARM_TRACKER_XGMT: \"0xfd5617CFB082Ba9bcD62d654603972AE312bC695\",\r\n    XGMT_USDG_FARM_TRACKER_NATIVE: \"0x0354387DD85b7D8aaD1611B3D167A384d6AE0c28\",\r\n    GMT_GMX_IOU: \"0x47052469970C2484729875CC9E2dd2683fcE71fb\",\r\n    XGMT_GMX_IOU: \"0xeB3733DFe3b68C9d26898De2493A3Bb59FDb4A7B\",\r\n    GMT_USDG_GMX_IOU: \"0x481312655F81b5e249780A6a49735335BF6Ca7f4\",\r\n    XGMT_USDG_GMX_IOU: \"0x8095F1A92526C304623483018aA28cC6E62EB1e1\",\r\n  },\r\n  421611: {\r\n    // arbitrum testnet\r\n    Vault: \"0xBc9BC47A7aB63db1E0030dC7B60DDcDe29CF4Ffb\",\r\n    Router: \"0xe0d4662cdfa2d71477A7DF367d5541421FAC2547\",\r\n    VaultReader: \"0xFc371E380262536c819D12B9569106bf032cC41c\",\r\n    Reader: \"0x2E093c70E3A7E4919611d2555dFd8D697d2fC0a1\",\r\n    GlpManager: \"0xD875d99E09118d2Be80579b9d23E83469077b498\",\r\n    RewardRouter: \"0x0000000000000000000000000000000000000000\",\r\n    RewardReader: \"0x0000000000000000000000000000000000000000\",\r\n    NATIVE_TOKEN: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n    GLP: \"0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    GMX: \"0x0000000000000000000000000000000000000000\",\r\n    ES_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    BN_GMX: \"0x0000000000000000000000000000000000000000\",\r\n    USDG: \"0xBCDCaF67193Bf5C57be08623278fCB69f4cA9e68\",\r\n    ES_GMX_IOU: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    BonusGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGmxTracker: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n    FeeGlpTracker: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    StakedGmxDistributor: \"0x0000000000000000000000000000000000000000\",\r\n    StakedGlpDistributor: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    GmxVester: \"0x0000000000000000000000000000000000000000\",\r\n    GlpVester: \"0x0000000000000000000000000000000000000000\",\r\n\r\n    OrderBook: \"0xebD147E5136879520dDaDf1cA8FBa48050EFf016\",\r\n    OrderBookReader: \"0xC492c8d82DC576Ad870707bb40EDb63E2026111E\",\r\n\r\n    PositionRouter: \"0xB4bB78cd12B097603e2b55D2556c09C17a5815F8\",\r\n    PositionManager: \"0x168aDa266c2f10C1F37973B213d6178551030e44\",\r\n\r\n    // UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0x0000000000000000000000000000000000000000\",\r\n    ReferralReader: \"0x0000000000000000000000000000000000000000\",\r\n  },\r\n  42161: {\r\n    // arbitrum mainnet\r\n    Vault: \"0x489ee077994B6658eAfA855C308275EAd8097C4A\",\r\n    Router: \"0xaBBc5F99639c9B6bCb58544ddf04EFA6802F4064\",\r\n    VaultReader: \"0xfebB9f4CAC4cD523598fE1C5771181440143F24A\",\r\n    Reader: \"0x2b43c90D1B727cEe1Df34925bcd5Ace52Ec37694\",\r\n    GlpManager: \"0x321F653eED006AD1C29D174e17d96351BDe22649\",\r\n    RewardRouter: \"0xA906F338CB21815cBc4Bc87ace9e68c87eF8d8F1\",\r\n    RewardReader: \"0x8BFb8e82Ee4569aee78D03235ff465Bd436D40E0\",\r\n    NATIVE_TOKEN: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n    GLP: \"0x4277f8F2c384827B5273592FF7CeBd9f2C1ac258\",\r\n    GMX: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    ES_GMX: \"0xf42Ae1D54fd613C9bb14810b0588FaAa09a426cA\",\r\n    BN_GMX: \"0x35247165119B69A40edD5304969560D0ef486921\",\r\n    USDG: \"0x45096e7aA921f27590f8F19e457794EB09678141\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\",\r\n    StakedGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    BonusGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    FeeGmxTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n    StakedGlpTracker: \"0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    FeeGlpTracker: \"0x4e971a87900b931fF39d1Aad67697F49835400b6\",\r\n\r\n    StakedGmxDistributor: \"0x23208B91A98c7C1CD9FE63085BFf68311494F193\",\r\n    StakedGlpDistributor: \"0x60519b48ec4183a61ca2B8e37869E675FD203b34\",\r\n\r\n    GmxVester: \"0x199070DDfd1CFb69173aa2F7e20906F26B363004\",\r\n    GlpVester: \"0xA75287d2f8b217273E7FCD7E86eF07D33972042E\",\r\n\r\n    OrderBook: \"0x09f77E8A13De9a35a7231028187e9fD5DB8a2ACB\",\r\n    OrderExecutor: \"0x7257ac5D0a0aaC04AA7bA2AC0A6Eb742E332c3fB\",\r\n    OrderBookReader: \"0xa27C20A7CF0e1C68C0460706bB674f98F362Bc21\",\r\n\r\n    PositionRouter: \"0x3D6bA331e3D9702C5e8A8d254e5d8a285F223aba\",\r\n    PositionManager: \"0x87a4088Bd721F83b6c2E5102e2FA47022Cb1c831\",\r\n\r\n    UniswapGmxEthPool: \"0x80A9ae39310abf666A87C743d6ebBD0E8C42158E\",\r\n    ReferralStorage: \"0xe6fab3f0c7199b0d34d7fbe83394fc0e0d06e99d\",\r\n    ReferralReader: \"0x8Aa382760BCdCe8644C33e6C2D52f6304A76F5c8\",\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    Vault: \"0x9ab2De34A33fB459b538c43f251eB825645e8595\",\r\n    Router: \"0x5F719c2F1095F7B9fc68a68e35B51194f4b6abe8\",\r\n    VaultReader: \"0x66eC8fc33A26feAEAe156afA3Cb46923651F6f0D\",\r\n    Reader: \"0x2eFEE1950ededC65De687b40Fd30a7B5f4544aBd\",\r\n    GlpManager: \"0xe1ae4d4b06A5Fe1fc288f6B4CD72f9F8323B107F\",\r\n    RewardRouter: \"0x82147C5A7E850eA4E28155DF107F2590fD4ba327\",\r\n    RewardReader: \"0x04Fc11Bd28763872d143637a7c768bD96E44c1b6\",\r\n    NATIVE_TOKEN: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n    GLP: \"0x01234181085565ed162a948b6a5e88758CD7c7b8\",\r\n    GMX: \"0x62edc0692BD897D2295872a9FFCac5425011c661\",\r\n    ES_GMX: \"0xFf1489227BbAAC61a9209A08929E4c2a526DdD17\",\r\n    BN_GMX: \"0x8087a341D32D445d9aC8aCc9c14F5781E04A26d2\",\r\n    USDG: \"0xc0253c3cC6aa5Ab407b5795a04c28fB063273894\",\r\n    ES_GMX_IOU: \"0x6260101218eC4cCfFF1b778936C6f2400f95A954\", // placeholder address\r\n\r\n    StakedGmxTracker: \"0x2bD10f8E93B3669b6d42E74eEedC65dd1B0a1342\",\r\n    BonusGmxTracker: \"0x908C4D94D34924765f1eDc22A1DD098397c59dD4\",\r\n    FeeGmxTracker: \"0x4d268a7d4C16ceB5a606c173Bd974984343fea13\",\r\n    StakedGlpTracker: \"0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    FeeGlpTracker: \"0xd2D1162512F927a7e282Ef43a362659E4F2a728F\",\r\n\r\n    StakedGmxDistributor: \"0xfc5A1A6EB076a2C7aD06eD22C90d7E710E35ad0a\",\r\n    StakedGlpDistributor: \"0xDd593Cf40734199afc9207eBe9ffF23dA4Bf7720\",\r\n\r\n    GmxVester: \"0x472361d3cA5F49c8E633FB50385BfaD1e018b445\",\r\n    GlpVester: \"0x62331A7Bd1dfB3A7642B7db50B5509E57CA3154A\",\r\n\r\n    OrderBook: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderExecutor: \"0x4296e307f108B2f583FF2F7B7270ee7831574Ae5\",\r\n    OrderBookReader: \"0xccFE3E576f8145403d3ce8f3c2f6519Dae40683B\",\r\n\r\n    PositionRouter: \"0x195256074192170d1530527abC9943759c7167d8\",\r\n    PositionManager: \"0xF2ec2e52c3b5F8b8bd5A3f93945d05628A233216\",\r\n\r\n    TraderJoeGmxAvaxPool: \"0x0c91a070f862666bbcce281346be45766d874d98\",\r\n    ReferralStorage: \"0x827ed045002ecdabeb6e2b0d1604cf5fc3d322f8\",\r\n    ReferralReader: \"0x505Ce16D3017be7D76a7C2631C0590E71A975083\",\r\n  },\r\n};\r\n\r\nexport function getContract(chainId, name) {\r\n  if (!CONTRACTS[chainId]) {\r\n    throw new Error(`Unknown chainId ${chainId}`);\r\n  }\r\n  if (!CONTRACTS[chainId][name]) {\r\n    throw new Error(`Unknown contract \"${name}\" for chainId ${chainId}`);\r\n  }\r\n  return CONTRACTS[chainId][name];\r\n}\r\n\r\nexport const XGMT_EXCLUDED_ACCOUNTS = [\r\n  \"0x330eef6b9b1ea6edd620c825c9919dc8b611d5d5\",\r\n  \"0xd9b1c23411adbb984b1c4be515fafc47a12898b2\",\r\n  \"0xa633158288520807f91ccc98aa58e0ea43acb400\",\r\n  \"0xffd0a93b4362052a336a7b22494f1b77018dd34b\",\r\n];\r\n","import { ethers } from \"ethers\";\r\nimport { getContract } from \"./Addresses\";\r\n\r\nconst TOKENS = {\r\n  56: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 18,\r\n      address: \"0x7130d2A12B9BCbFAe4f2634d864A1Ee1Ce3Ead9c\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-bitcoin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/14108/small/Binance-bitcoin.png\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x2170Ed0880ac9A755fd29B2688956BD959F933F8\",\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/ethereum\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: getContract(56, \"NATIVE_TOKEN\"),\r\n      isWrapped: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/825/small/binance-coin-logo.png\",\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(56, \"USDG\"),\r\n      isUsdg: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-gambit\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/15886/small/usdg-02.png\",\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0xe9e7CEA3DedcA5984780Bafc599bD69ADd087D56\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/binance-usd\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9576/small/BUSD.png\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 18,\r\n      address: \"0x8AC76a51cc950d9822D68b83fE1Ad97B32Cd580d\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/small/USD_Coin_icon.png\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 18,\r\n      address: \"0x55d398326f99059fF775485246999027B3197955\",\r\n      isStable: true,\r\n      coingeckoUrl: \"https://www.coingecko.com/en/coins/tether\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/small/Tether-logo.png\",\r\n    },\r\n  ],\r\n  97: [\r\n    {\r\n      name: \"Bitcoin (BTCB)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0xb19C12715134bee7c4b1Ca593ee9E430dABe7b56\",\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: \"0x1958f7C067226c7C8Ac310Dc994D0cebAbfb2B02\",\r\n    },\r\n    {\r\n      name: \"Binance Coin\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n    },\r\n    {\r\n      name: \"Wrapped Binance Coin\",\r\n      symbol: \"WBNB\",\r\n      decimals: 18,\r\n      address: \"0x612777Eea37a44F7a95E3B101C39e1E2695fa6C2\",\r\n      isWrapped: true,\r\n      baseSymbol: \"BNB\",\r\n    },\r\n    {\r\n      name: \"USD Gambit\",\r\n      symbol: \"USDG\",\r\n      decimals: 18,\r\n      address: getContract(97, \"USDG\"),\r\n      isUsdg: true,\r\n    },\r\n    {\r\n      name: \"Binance USD\",\r\n      symbol: \"BUSD\",\r\n      decimals: 18,\r\n      address: \"0x3F223C4E5ac67099CB695834b20cCd5E5D5AA9Ef\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  421611: [\r\n    {\r\n      name: \"Bitcoin\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x27960f9A322BE96A1535E6c19B3958e80E6a2670\",\r\n      isShortable: true,\r\n    },\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n    },\r\n    // https://github.com/OffchainLabs/arbitrum/blob/950c2f91b2e951cd3764394e0a73eac3797aecf3/packages/arb-ts/src/lib/networks.ts#L65\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0xB47e6A5f8b33b3F17603C83a0535A9dcD7E32681\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xf0DCd4737A20ED33481A49De94C599944a3Ca737\",\r\n      isStable: true,\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0x818ED84bA1927945b631016e0d402Db50cE8865f\",\r\n      isStable: true,\r\n    },\r\n  ],\r\n  42161: [\r\n    {\r\n      name: \"Ethereum\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Wrapped Ethereum\",\r\n      symbol: \"WETH\",\r\n      decimals: 18,\r\n      address: \"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1\",\r\n      isWrapped: true,\r\n      baseSymbol: \"ETH\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/2518/thumb/weth.png?1628852295\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC)\",\r\n      symbol: \"BTC\",\r\n      decimals: 8,\r\n      address: \"0x2f2a2543B76A4166549F7aaB2e75Bef0aefC5B0f\",\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Chainlink\",\r\n      symbol: \"LINK\",\r\n      decimals: 18,\r\n      address: \"0xf97f4df75117a78c1A5a0DBb814Af92458539FB4\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/877/thumb/chainlink-new-logo.png?1547034700\",\r\n    },\r\n    {\r\n      name: \"Uniswap\",\r\n      symbol: \"UNI\",\r\n      decimals: 18,\r\n      address: \"0xFa7F8980b0f1E64A2062791cc3b0871572f1F7f0\",\r\n      isStable: false,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12504/thumb/uniswap-uni.png?1600306604\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      decimals: 6,\r\n      address: \"0xFF970A61A04b1cA14834A43f5dE4533eBDDB5CC8\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Tether\",\r\n      symbol: \"USDT\",\r\n      decimals: 6,\r\n      address: \"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/325/thumb/Tether-logo.png?1598003707\",\r\n    },\r\n    {\r\n      name: \"Dai\",\r\n      symbol: \"DAI\",\r\n      decimals: 18,\r\n      address: \"0xDA10009cBd5D07dd0CeCc66161FC93D7c9000da1\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/9956/thumb/4943.png?1636636734\",\r\n    },\r\n    {\r\n      name: \"Frax\",\r\n      symbol: \"FRAX\",\r\n      decimals: 18,\r\n      address: \"0x17FC002b466eEc40DaE837Fc4bE5c67993ddBd6F\",\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/13422/small/frax_logo.png?1608476506\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      decimals: 18,\r\n      address: \"0xFEa7a6a0B346362BF88A9e4A88416B77a57D6c2A\",\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"Avalanche\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n      address: ethers.constants.AddressZero,\r\n      isNative: true,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Wrapped AVAX\",\r\n      symbol: \"WAVAX\",\r\n      decimals: 18,\r\n      address: \"0xB31f66AA3C1e785363F0875A1B74E27b85FD66c7\",\r\n      isWrapped: true,\r\n      baseSymbol: \"AVAX\",\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/12559/small/coin-round-red.png?1604021818\",\r\n    },\r\n    {\r\n      name: \"Ethereum (WETH.e)\",\r\n      symbol: \"ETH\",\r\n      address: \"0x49D5c2BdFfac6CE2BFdB6640F4F80f226bc10bAB\",\r\n      decimals: 18,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/279/small/ethereum.png?1595348880\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (WBTC.e)\",\r\n      symbol: \"BTC\",\r\n      address: \"0x50b7545627a5162F82A992c33b87aDc75187B218\",\r\n      decimals: 8,\r\n      isShortable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/7598/thumb/wrapped_bitcoin_wbtc.png?1548822744\",\r\n    },\r\n    {\r\n      name: \"Bitcoin (BTC.b)\",\r\n      symbol: \"BTC.b\",\r\n      address: \"0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n      decimals: 8,\r\n      isShortable: false,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/26115/thumb/btcb.png?1655921693\",\r\n    },\r\n    {\r\n      name: \"USD Coin (USDC.e)\",\r\n      symbol: \"USDC.e\",\r\n      address: \"0xA7D7079b0FEaD91F3e65f86E8915Cb59c1a4C664\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"USD Coin\",\r\n      symbol: \"USDC\",\r\n      address: \"0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E\",\r\n      decimals: 6,\r\n      isStable: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/6319/thumb/USD_Coin_icon.png?1547042389\",\r\n    },\r\n    {\r\n      name: \"Magic Internet Money\",\r\n      symbol: \"MIM\",\r\n      address: \"0x130966628846BFd36ff31a822705796e8cb8C18D\",\r\n      decimals: 18,\r\n      isStable: true,\r\n      isTempHidden: true,\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/16786/small/mimlogopng.png\",\r\n    },\r\n  ],\r\n};\r\n\r\nconst ADDITIONAL_TOKENS = {\r\n  42161: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(42161, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(42161, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n  43114: [\r\n    {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      address: getContract(43114, \"GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"Escrowed GMX\",\r\n      symbol: \"esGMX\",\r\n      address: getContract(43114, \"ES_GMX\"),\r\n      decimals: 18,\r\n    },\r\n    {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      address: getContract(42161, \"GLP\"),\r\n      decimals: 18,\r\n    },\r\n  ],\r\n};\r\n\r\nconst CHAIN_IDS = [56, 97, 42161, 421611, 43114];\r\n\r\nconst TOKENS_MAP = {};\r\nconst TOKENS_BY_SYMBOL_MAP = {};\r\n\r\nfor (let j = 0; j < CHAIN_IDS.length; j++) {\r\n  const chainId = CHAIN_IDS[j];\r\n  TOKENS_MAP[chainId] = {};\r\n  TOKENS_BY_SYMBOL_MAP[chainId] = {};\r\n  let tokens = TOKENS[chainId];\r\n  if (ADDITIONAL_TOKENS[chainId]) {\r\n    tokens = tokens.concat(ADDITIONAL_TOKENS[chainId]);\r\n  }\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = tokens[i];\r\n    TOKENS_MAP[chainId][token.address] = token;\r\n    TOKENS_BY_SYMBOL_MAP[chainId][token.symbol] = token;\r\n  }\r\n}\r\n\r\nconst WRAPPED_TOKENS_MAP = {};\r\nconst NATIVE_TOKENS_MAP = {};\r\nfor (const chainId of CHAIN_IDS) {\r\n  for (const token of TOKENS[chainId]) {\r\n    if (token.isWrapped) {\r\n      WRAPPED_TOKENS_MAP[chainId] = token;\r\n    } else if (token.isNative) {\r\n      NATIVE_TOKENS_MAP[chainId] = token;\r\n    }\r\n  }\r\n}\r\n\r\nexport function getWrappedToken(chainId) {\r\n  return WRAPPED_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getNativeToken(chainId) {\r\n  return NATIVE_TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getTokens(chainId) {\r\n  return TOKENS[chainId];\r\n}\r\n\r\nexport function isValidToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  return address in TOKENS_MAP[chainId];\r\n}\r\n\r\nexport function getToken(chainId, address) {\r\n  if (!TOKENS_MAP[chainId]) {\r\n    throw new Error(`Incorrect chainId ${chainId}`);\r\n  }\r\n  if (!TOKENS_MAP[chainId][address]) {\r\n    throw new Error(`Incorrect address \"${address}\" for chainId ${chainId}`);\r\n  }\r\n  return TOKENS_MAP[chainId][address];\r\n}\r\n\r\nexport function getTokenBySymbol(chainId, symbol) {\r\n  const token = TOKENS_BY_SYMBOL_MAP[chainId][symbol];\r\n  if (!token) {\r\n    throw new Error(`Incorrect symbol \"${symbol}\" for chainId ${chainId}`);\r\n  }\r\n  return token;\r\n}\r\n\r\nexport function getWhitelistedTokens(chainId) {\r\n  return TOKENS[chainId].filter((token) => token.symbol !== \"USDG\");\r\n}\r\n\r\nexport function getVisibleTokens(chainId) {\r\n  return getWhitelistedTokens(chainId).filter((token) => !token.isWrapped && !token.isTempHidden);\r\n}\r\n","import React, { useCallback, useEffect, useRef, useState } from \"react\";\r\nimport { InjectedConnector } from \"@web3-react/injected-connector\";\r\nimport {\r\n  UserRejectedRequestError as UserRejectedRequestErrorWalletConnect,\r\n  WalletConnectConnector,\r\n} from \"@web3-react/walletconnect-connector\";\r\nimport { toast } from \"react-toastify\";\r\nimport { UnsupportedChainIdError, useWeb3React } from \"@web3-react/core\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { ethers } from \"ethers\";\r\nimport { format as formatDateFn } from \"date-fns\";\r\nimport Token from \"../abis/Token.json\";\r\nimport _ from \"lodash\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBookReader from \"../abis/OrderBookReader.json\";\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\n\r\nimport { getWhitelistedTokens, isValidToken } from \"../config/Tokens\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport const UI_VERSION = \"1.3\";\r\n\r\n// use a random placeholder account instead of the zero address as the zero address might have tokens\r\nexport const PLACEHOLDER_ACCOUNT = ethers.Wallet.createRandom().address;\r\n\r\nexport const MAINNET = 56;\r\nexport const AVALANCHE = 43114;\r\nexport const TESTNET = 97;\r\nexport const ARBITRUM_TESTNET = 421611;\r\nexport const ARBITRUM = 42161;\r\n// TODO take it from web3\r\nexport const DEFAULT_CHAIN_ID = ARBITRUM;\r\nexport const CHAIN_ID = DEFAULT_CHAIN_ID;\r\n\r\nexport const MIN_PROFIT_TIME = 0;\r\n\r\nconst SELECTED_NETWORK_LOCAL_STORAGE_KEY = \"SELECTED_NETWORK\";\r\n\r\nexport const IS_NETWORK_DISABLED = {\r\n  [ARBITRUM]: false,\r\n  [AVALANCHE]: false,\r\n};\r\n\r\nconst CHAIN_NAMES_MAP = {\r\n  [MAINNET]: \"BSC\",\r\n  [TESTNET]: \"BSC Testnet\",\r\n  [ARBITRUM_TESTNET]: \"ArbRinkeby\",\r\n  [ARBITRUM]: \"Arbitrum\",\r\n  [AVALANCHE]: \"Avalanche\",\r\n};\r\n\r\nconst alchemyWhitelistedDomains = [\"gmx.io\", \"app.gmx.io\"];\r\n\r\nexport function getDefaultArbitrumRpcUrl() {\r\n  return \"https://arb1.arbitrum.io/rpc\";\r\n}\r\n\r\nexport function getAlchemyHttpUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"https://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"https://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nexport function getAlchemyWsUrl() {\r\n  if (alchemyWhitelistedDomains.includes(window.location.host)) {\r\n    return \"wss://arb-mainnet.g.alchemy.com/v2/ha7CFsr1bx5ZItuR6VZBbhKozcKDY4LZ\";\r\n  }\r\n  return \"wss://arb-mainnet.g.alchemy.com/v2/EmVYwUw0N2tXOuG0SZfe5Z04rzBsCbr2\";\r\n}\r\n\r\nconst ARBITRUM_RPC_PROVIDERS = [getDefaultArbitrumRpcUrl()];\r\nconst AVALANCHE_RPC_PROVIDERS = [\"https://api.avax.network/ext/bc/C/rpc\"];\r\nexport const WALLET_CONNECT_LOCALSTORAGE_KEY = \"walletconnect\";\r\nexport const WALLET_LINK_LOCALSTORAGE_PREFIX = \"-walletlink\";\r\nexport const SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY = \"eagerconnect\";\r\nexport const CURRENT_PROVIDER_LOCALSTORAGE_KEY = \"currentprovider\";\r\nexport const LANGUAGE_LOCALSTORAGE_KEY = \"LANGUAGE_KEY\";\r\n\r\nexport function getChainName(chainId) {\r\n  return CHAIN_NAMES_MAP[chainId];\r\n}\r\n\r\nexport const USDG_ADDRESS = getContract(CHAIN_ID, \"USDG\");\r\nexport const MAX_LEVERAGE = 100 * 10000;\r\n\r\nexport const MAX_PRICE_DEVIATION_BASIS_POINTS = 750;\r\nexport const DEFAULT_GAS_LIMIT = 1 * 1000 * 1000;\r\nexport const SECONDS_PER_YEAR = 31536000;\r\nexport const USDG_DECIMALS = 18;\r\nexport const USD_DECIMALS = 30;\r\nexport const BASIS_POINTS_DIVISOR = 10000;\r\nexport const DEPOSIT_FEE = 30;\r\nexport const DUST_BNB = \"2000000000000000\";\r\nexport const DUST_USD = expandDecimals(1, USD_DECIMALS);\r\nexport const PRECISION = expandDecimals(1, 30);\r\nexport const GLP_DECIMALS = 18;\r\nexport const GMX_DECIMALS = 18;\r\nexport const DEFAULT_MAX_USDG_AMOUNT = expandDecimals(200 * 1000 * 1000, 18);\r\n\r\nexport const TAX_BASIS_POINTS = 50;\r\nexport const STABLE_TAX_BASIS_POINTS = 5;\r\nexport const MINT_BURN_FEE_BASIS_POINTS = 25;\r\nexport const SWAP_FEE_BASIS_POINTS = 30;\r\nexport const STABLE_SWAP_FEE_BASIS_POINTS = 1;\r\nexport const MARGIN_FEE_BASIS_POINTS = 10;\r\n\r\nexport const LIQUIDATION_FEE = expandDecimals(5, USD_DECIMALS);\r\n\r\nexport const TRADES_PAGE_SIZE = 100;\r\n\r\nexport const GLP_COOLDOWN_DURATION = 15 * 60;\r\nexport const THRESHOLD_REDEMPTION_VALUE = expandDecimals(993, 27); // 0.993\r\nexport const FUNDING_RATE_PRECISION = 1000000;\r\n\r\nexport const SWAP = \"Swap\";\r\nexport const INCREASE = \"Increase\";\r\nexport const DECREASE = \"Decrease\";\r\nexport const LONG = \"Long\";\r\nexport const SHORT = \"Short\";\r\n\r\nexport const MARKET = \"Market\";\r\nexport const LIMIT = \"Limit\";\r\nexport const STOP = \"Stop\";\r\n// export const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT, STOP];\r\nexport const LEVERAGE_ORDER_OPTIONS = [MARKET, LIMIT];\r\nexport const SWAP_ORDER_OPTIONS = [MARKET, LIMIT];\r\n// export const SWAP_OPTIONS = [LONG, SHORT, SWAP];\r\nexport const SWAP_OPTIONS = [LONG, SHORT];\r\nexport const DEFAULT_SLIPPAGE_AMOUNT = 30;\r\nexport const DEFAULT_HIGHER_SLIPPAGE_AMOUNT = 100;\r\n\r\nexport const SLIPPAGE_BPS_KEY = \"Exchange-swap-slippage-basis-points-v3\";\r\nexport const CLOSE_POSITION_RECEIVE_TOKEN_KEY = \"Close-position-receive-token\";\r\nexport const IS_PNL_IN_LEVERAGE_KEY = \"Exchange-swap-is-pnl-in-leverage\";\r\nexport const SHOW_PNL_AFTER_FEES_KEY = \"Exchange-swap-show-pnl-after-fees\";\r\nexport const DISABLE_ORDER_VALIDATION_KEY = \"disable-order-validation\";\r\nexport const SHOULD_SHOW_POSITION_LINES_KEY = \"Exchange-swap-should-show-position-lines\";\r\nexport const REFERRAL_CODE_KEY = \"GMX-referralCode\";\r\nexport const REFERRAL_CODE_QUERY_PARAM = \"ref\";\r\nexport const REFERRALS_SELECTED_TAB_KEY = \"Referrals-selected-tab\";\r\nexport const MAX_REFERRAL_CODE_LENGTH = 20;\r\n\r\nexport const TRIGGER_PREFIX_ABOVE = \">\";\r\nexport const TRIGGER_PREFIX_BELOW = \"<\";\r\n\r\nexport const MIN_PROFIT_BIPS = 0;\r\n\r\nexport const GLPPOOLCOLORS = {\r\n  ETH: \"#6062a6\",\r\n  BTC: \"#F7931A\",\r\n  \"BTC.b\": \"#F7931A\",\r\n  USDC: \"#2775CA\",\r\n  \"USDC.e\": \"#2A5ADA\",\r\n  USDT: \"#67B18A\",\r\n  MIM: \"#9695F8\",\r\n  FRAX: \"#000\",\r\n  DAI: \"#FAC044\",\r\n  UNI: \"#E9167C\",\r\n  AVAX: \"#E84142\",\r\n  LINK: \"#3256D6\",\r\n};\r\n\r\nexport const HIGH_EXECUTION_FEES_MAP = {\r\n  [ARBITRUM]: 3, // 3 USD\r\n  [AVALANCHE]: 3, // 3 USD\r\n};\r\n\r\nexport function getHighExecutionFee(chainId) {\r\n  return HIGH_EXECUTION_FEES_MAP[chainId] || 3;\r\n}\r\n\r\nexport const ICONLINKS = {\r\n  [ARBITRUM_TESTNET]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://testnet.arbiscan.io/token/0xb4f81Fa74e06b5f762A104e47276BA9b2929cb27\",\r\n    },\r\n  },\r\n  [ARBITRUM]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a\",\r\n    },\r\n    GLP: {\r\n      arbitrum: \"https://arbiscan.io/token/0x1aDDD80E6039594eE970E5872D247bf0414C8903\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/ethereum\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      arbitrum: \"https://arbiscan.io/address/0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f\",\r\n    },\r\n    LINK: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/chainlink\",\r\n      arbitrum: \"https://arbiscan.io/address/0xf97f4df75117a78c1a5a0dbb814af92458539fb4\",\r\n    },\r\n    UNI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/uniswap\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      arbitrum: \"https://arbiscan.io/address/0xff970a61a04b1ca14834a43f5de4533ebddb5cc8\",\r\n    },\r\n    USDT: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/tether\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9\",\r\n    },\r\n    DAI: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/dai\",\r\n      arbitrum: \"https://arbiscan.io/address/0xda10009cbd5d07dd0cecc66161fc93d7c9000da1\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      arbitrum: \"https://arbiscan.io/address/0xfea7a6a0b346362bf88a9e4a88416b77a57d6c2a\",\r\n    },\r\n    FRAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/frax\",\r\n      arbitrum: \"https://arbiscan.io/address/0x17fc002b466eec40dae837fc4be5c67993ddbd6f\",\r\n    },\r\n  },\r\n  [AVALANCHE]: {\r\n    GMX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/gmx\",\r\n      avalanche: \"https://snowtrace.io/address/0x62edc0692bd897d2295872a9ffcac5425011c661\",\r\n    },\r\n    GLP: {\r\n      avalanche: \"https://snowtrace.io/address/0x9e295B5B976a184B14aD8cd72413aD846C299660\",\r\n    },\r\n    AVAX: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/avalanche\",\r\n    },\r\n    ETH: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/weth\",\r\n      avalanche: \"https://snowtrace.io/address/0x49d5c2bdffac6ce2bfdb6640f4f80f226bc10bab\",\r\n    },\r\n    BTC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x50b7545627a5162f82a992c33b87adc75187b218\",\r\n    },\r\n    \"BTC.b\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/wrapped-bitcoin\",\r\n      avalanche: \"https://snowtrace.io/address/0x152b9d0FdC40C096757F570A51E494bd4b943E50\",\r\n    },\r\n    MIM: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/magic-internet-money\",\r\n      avalanche: \"https://snowtrace.io/address/0x130966628846bfd36ff31a822705796e8cb8c18d\",\r\n    },\r\n    \"USDC.e\": {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin-avalanche-bridged-usdc-e\",\r\n      avalanche: \"https://snowtrace.io/address/0xa7d7079b0fead91f3e65f86e8915cb59c1a4c664\",\r\n    },\r\n    USDC: {\r\n      coingecko: \"https://www.coingecko.com/en/coins/usd-coin\",\r\n      avalanche: \"https://snowtrace.io/address/0xb97ef9ef8734c71904d8002f8b6bc66dd9c48a6e\",\r\n    },\r\n  },\r\n};\r\n\r\nexport const platformTokens = {\r\n  42161: {\r\n    // arbitrum\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(ARBITRUM, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n  43114: {\r\n    // avalanche\r\n    GMX: {\r\n      name: \"GMX\",\r\n      symbol: \"GMX\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"GMX\"),\r\n      imageUrl: \"https://assets.coingecko.com/coins/images/18323/small/arbit.png?1631532468\",\r\n    },\r\n    GLP: {\r\n      name: \"GMX LP\",\r\n      symbol: \"GLP\",\r\n      decimals: 18,\r\n      address: getContract(AVALANCHE, \"StakedGlpTracker\"), // address of fsGLP token because user only holds fsGLP\r\n      imageUrl: \"https://github.com/gmx-io/gmx-assets/blob/main/GMX-Assets/PNG/GLP_LOGO%20ONLY.png?raw=true\",\r\n    },\r\n  },\r\n};\r\n\r\nconst supportedChainIds = [ARBITRUM, AVALANCHE];\r\nif (isDevelopment()) {\r\n  supportedChainIds.push(ARBITRUM_TESTNET);\r\n}\r\nconst injectedConnector = new InjectedConnector({\r\n  supportedChainIds,\r\n});\r\n\r\nconst getWalletConnectConnector = () => {\r\n  const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n  return new WalletConnectConnector({\r\n    rpc: {\r\n      [AVALANCHE]: AVALANCHE_RPC_PROVIDERS[0],\r\n      [ARBITRUM]: ARBITRUM_RPC_PROVIDERS[0],\r\n      [ARBITRUM_TESTNET]: \"https://rinkeby.arbitrum.io/rpc\",\r\n    },\r\n    qrcode: true,\r\n    chainId,\r\n  });\r\n};\r\n\r\nexport function isSupportedChain(chainId) {\r\n  return supportedChainIds.includes(chainId);\r\n}\r\n\r\nexport function deserialize(data) {\r\n  for (const [key, value] of Object.entries(data)) {\r\n    if (value._type === \"BigNumber\") {\r\n      data[key] = bigNumberify(value.value);\r\n    }\r\n  }\r\n  return data;\r\n}\r\n\r\nexport function isHomeSite() {\r\n  return process.env.REACT_APP_IS_HOME_SITE === \"true\";\r\n}\r\n\r\nexport const helperToast = {\r\n  success: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content, opts) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n\r\nexport function useLocalStorageByChainId(chainId, key, defaultValue) {\r\n  const [internalValue, setInternalValue] = useLocalStorage(key, {});\r\n\r\n  const setValue = useCallback(\r\n    (value) => {\r\n      setInternalValue((internalValue) => {\r\n        if (typeof value === \"function\") {\r\n          value = value(internalValue[chainId] || defaultValue);\r\n        }\r\n        const newInternalValue = {\r\n          ...internalValue,\r\n          [chainId]: value,\r\n        };\r\n        return newInternalValue;\r\n      });\r\n    },\r\n    [chainId, setInternalValue, defaultValue]\r\n  );\r\n\r\n  let value;\r\n  if (chainId in internalValue) {\r\n    value = internalValue[chainId];\r\n  } else {\r\n    value = defaultValue;\r\n  }\r\n\r\n  return [value, setValue];\r\n}\r\n\r\nexport function useLocalStorageSerializeKey(key, value, opts) {\r\n  key = JSON.stringify(key);\r\n  return useLocalStorage(key, value, opts);\r\n}\r\n\r\nfunction getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd) {\r\n  // Limit/stop orders are executed with price specified by user\r\n  if (orderOption && orderOption !== MARKET && triggerPriceUsd) {\r\n    return triggerPriceUsd;\r\n  }\r\n\r\n  // Market orders are executed with current market price\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n  return max ? info.maxPrice : info.minPrice;\r\n}\r\n\r\nexport function getLiquidationPriceFromDelta({ liquidationAmount, size, collateral, averagePrice, isLong }) {\r\n  if (!size || size.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  if (liquidationAmount.gt(collateral)) {\r\n    const liquidationDelta = liquidationAmount.sub(collateral);\r\n    const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n    return isLong ? averagePrice.add(priceDelta) : averagePrice.sub(priceDelta);\r\n  }\r\n\r\n  const liquidationDelta = collateral.sub(liquidationAmount);\r\n  const priceDelta = liquidationDelta.mul(averagePrice).div(size);\r\n\r\n  return isLong ? averagePrice.sub(priceDelta) : averagePrice.add(priceDelta);\r\n}\r\n\r\nexport const replaceNativeTokenAddress = (path, nativeTokenAddress) => {\r\n  if (!path) {\r\n    return;\r\n  }\r\n\r\n  let updatedPath = [];\r\n  for (let i = 0; i < path.length; i++) {\r\n    let address = path[i];\r\n    if (address === AddressZero) {\r\n      address = nativeTokenAddress;\r\n    }\r\n    updatedPath.push(address);\r\n  }\r\n\r\n  return updatedPath;\r\n};\r\n\r\nexport function getMarginFee(sizeDelta) {\r\n  if (!sizeDelta) {\r\n    return bigNumberify(0);\r\n  }\r\n  const afterFeeUsd = sizeDelta.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n  return sizeDelta.sub(afterFeeUsd);\r\n}\r\n\r\nexport function getServerBaseUrl(chainId) {\r\n  if (!chainId) {\r\n    throw new Error(\"chainId is not provided\");\r\n  }\r\n  if (document.location.hostname.includes(\"deploy-preview\")) {\r\n    const fromLocalStorage = localStorage.getItem(\"SERVER_BASE_URL\");\r\n    if (fromLocalStorage) {\r\n      return fromLocalStorage;\r\n    }\r\n  }\r\n  if (chainId === MAINNET) {\r\n    return \"https://gambit-server-staging.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://gambit-server-devnet.uc.r.appspot.com\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://gmx-avax-server.uc.r.appspot.com\";\r\n  }\r\n  return \"https://gmx-server-mainnet.uw.r.appspot.com\";\r\n}\r\n\r\nexport function getServerUrl(chainId, path) {\r\n  return `${getServerBaseUrl(chainId)}${path}`;\r\n}\r\n\r\nexport function isTriggerRatioInverted(fromTokenInfo, toTokenInfo) {\r\n  if (!toTokenInfo || !fromTokenInfo) return false;\r\n  if (toTokenInfo.isStable || toTokenInfo.isUsdg) return true;\r\n  if (toTokenInfo.maxPrice) return toTokenInfo.maxPrice.lt(fromTokenInfo.maxPrice);\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRate(tokenAInfo, tokenBInfo, inverted) {\r\n  if (!tokenAInfo || !tokenAInfo.minPrice || !tokenBInfo || !tokenBInfo.maxPrice) {\r\n    return;\r\n  }\r\n  if (inverted) {\r\n    return tokenAInfo.minPrice.mul(PRECISION).div(tokenBInfo.maxPrice);\r\n  }\r\n  return tokenBInfo.maxPrice.mul(PRECISION).div(tokenAInfo.minPrice);\r\n}\r\n\r\nexport function getMostAbundantStableToken(chainId, infoTokens) {\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  let availableAmount;\r\n  let stableToken = whitelistedTokens.find((t) => t.isStable);\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const info = getTokenInfo(infoTokens, whitelistedTokens[i].address);\r\n    if (!info.isStable || !info.availableAmount) {\r\n      continue;\r\n    }\r\n\r\n    const adjustedAvailableAmount = adjustForDecimals(info.availableAmount, info.decimals, USD_DECIMALS);\r\n    if (!availableAmount || adjustedAvailableAmount.gt(availableAmount)) {\r\n      availableAmount = adjustedAvailableAmount;\r\n      stableToken = info;\r\n    }\r\n  }\r\n  return stableToken;\r\n}\r\n\r\nexport function shouldInvertTriggerRatio(tokenA, tokenB) {\r\n  if (tokenB.isStable || tokenB.isUsdg) return true;\r\n  if (tokenB.maxPrice && tokenA.maxPrice && tokenB.maxPrice.lt(tokenA.maxPrice)) return true;\r\n  return false;\r\n}\r\n\r\nexport function getExchangeRateDisplay(rate, tokenA, tokenB, opts = {}) {\r\n  if (!rate || !tokenA || !tokenB) return \"...\";\r\n  if (shouldInvertTriggerRatio(tokenA, tokenB)) {\r\n    [tokenA, tokenB] = [tokenB, tokenA];\r\n    rate = PRECISION.mul(PRECISION).div(rate);\r\n  }\r\n  const rateValue = formatAmount(rate, USD_DECIMALS, tokenA.isStable || tokenA.isUsdg ? 2 : 4, true);\r\n  if (opts.omitSymbols) {\r\n    return rateValue;\r\n  }\r\n  return `${rateValue} ${tokenA.symbol} / ${tokenB.symbol}`;\r\n}\r\n\r\nconst adjustForDecimalsFactory = (n) => (number) => {\r\n  if (n === 0) {\r\n    return number;\r\n  }\r\n  if (n > 0) {\r\n    return number.mul(expandDecimals(1, n));\r\n  }\r\n  return number.div(expandDecimals(1, -n));\r\n};\r\n\r\nexport function adjustForDecimals(amount, divDecimals, mulDecimals) {\r\n  return amount.mul(expandDecimals(1, mulDecimals)).div(expandDecimals(1, divDecimals));\r\n}\r\n\r\nexport function getTargetUsdgAmount(token, usdgSupply, totalTokenWeights) {\r\n  if (!token || !token.weight || !usdgSupply) {\r\n    return;\r\n  }\r\n\r\n  if (usdgSupply.eq(0)) {\r\n    return bigNumberify(0);\r\n  }\r\n\r\n  return token.weight.mul(usdgSupply).div(totalTokenWeights);\r\n}\r\n\r\nexport function getFeeBasisPoints(\r\n  token,\r\n  usdgDelta,\r\n  feeBasisPoints,\r\n  taxBasisPoints,\r\n  increment,\r\n  usdgSupply,\r\n  totalTokenWeights\r\n) {\r\n  if (!token || !token.usdgAmount || !usdgSupply || !totalTokenWeights) {\r\n    return 0;\r\n  }\r\n\r\n  feeBasisPoints = bigNumberify(feeBasisPoints);\r\n  taxBasisPoints = bigNumberify(taxBasisPoints);\r\n\r\n  const initialAmount = token.usdgAmount;\r\n  let nextAmount = initialAmount.add(usdgDelta);\r\n  if (!increment) {\r\n    nextAmount = usdgDelta.gt(initialAmount) ? bigNumberify(0) : initialAmount.sub(usdgDelta);\r\n  }\r\n\r\n  const targetAmount = getTargetUsdgAmount(token, usdgSupply, totalTokenWeights);\r\n  if (!targetAmount || targetAmount.eq(0)) {\r\n    return feeBasisPoints.toNumber();\r\n  }\r\n\r\n  const initialDiff = initialAmount.gt(targetAmount)\r\n    ? initialAmount.sub(targetAmount)\r\n    : targetAmount.sub(initialAmount);\r\n  const nextDiff = nextAmount.gt(targetAmount) ? nextAmount.sub(targetAmount) : targetAmount.sub(nextAmount);\r\n\r\n  if (nextDiff.lt(initialDiff)) {\r\n    const rebateBps = taxBasisPoints.mul(initialDiff).div(targetAmount);\r\n    return rebateBps.gt(feeBasisPoints) ? 0 : feeBasisPoints.sub(rebateBps).toNumber();\r\n  }\r\n\r\n  let averageDiff = initialDiff.add(nextDiff).div(2);\r\n  if (averageDiff.gt(targetAmount)) {\r\n    averageDiff = targetAmount;\r\n  }\r\n  const taxBps = taxBasisPoints.mul(averageDiff).div(targetAmount);\r\n  return feeBasisPoints.add(taxBps).toNumber();\r\n}\r\n\r\nexport function getBuyGlpToAmount(fromAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!fromAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = fromAmount.mul(swapToken.minPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = fromAmount.mul(swapToken.minPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpFromAmount(toAmount, swapTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0), feeBasisPoints: 0 };\r\n  if (!toAmount || !swapTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const swapToken = getTokenInfo(infoTokens, swapTokenAddress);\r\n  if (!swapToken || !swapToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let glpAmount = toAmount.mul(swapToken.maxPrice).div(glpPrice);\r\n  glpAmount = adjustForDecimals(glpAmount, swapToken.decimals, USDG_DECIMALS);\r\n\r\n  let usdgAmount = toAmount.mul(swapToken.maxPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, swapToken.decimals, USDG_DECIMALS);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    swapToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  glpAmount = glpAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: glpAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getBuyGlpFromAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.minPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.minPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getSellGlpToAmount(toAmount, fromTokenAddress, infoTokens, glpPrice, usdgSupply, totalTokenWeights) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!toAmount || !fromTokenAddress || !infoTokens || !glpPrice || !usdgSupply || !totalTokenWeights) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  if (!fromToken || !fromToken.maxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  let fromAmount = toAmount.mul(glpPrice).div(fromToken.maxPrice);\r\n  fromAmount = adjustForDecimals(fromAmount, GLP_DECIMALS, fromToken.decimals);\r\n\r\n  const usdgAmount = toAmount.mul(glpPrice).div(PRECISION);\r\n  const feeBasisPoints = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    MINT_BURN_FEE_BASIS_POINTS,\r\n    TAX_BASIS_POINTS,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n\r\n  fromAmount = fromAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n  return { amount: fromAmount, feeBasisPoints };\r\n}\r\n\r\nexport function getNextFromAmount(\r\n  chainId,\r\n  toAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n\r\n  if (!toAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: toAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromToken || !fromTokenMinPrice || !toToken || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(fromToken.decimals - toToken.decimals);\r\n\r\n  let fromAmountBasedOnRatio;\r\n  if (ratio && !ratio.isZero()) {\r\n    fromAmountBasedOnRatio = toAmount.mul(ratio).div(PRECISION);\r\n  }\r\n\r\n  const fromAmount =\r\n    ratio && !ratio.isZero() ? fromAmountBasedOnRatio : toAmount.mul(toTokenMaxPrice).div(fromTokenMinPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, toToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(fromAmount.mul(BASIS_POINTS_DIVISOR).div(BASIS_POINTS_DIVISOR - feeBasisPoints)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getNextToAmount(\r\n  chainId,\r\n  fromAmount,\r\n  fromTokenAddress,\r\n  toTokenAddress,\r\n  infoTokens,\r\n  toTokenPriceUsd,\r\n  ratio,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  forSwap\r\n) {\r\n  const defaultValue = { amount: bigNumberify(0) };\r\n  if (!fromAmount || !fromTokenAddress || !toTokenAddress || !infoTokens) {\r\n    return defaultValue;\r\n  }\r\n\r\n  if (fromTokenAddress === toTokenAddress) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  if (fromToken.isNative && toToken.isWrapped) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  if (fromToken.isWrapped && toToken.isNative) {\r\n    return { amount: fromAmount };\r\n  }\r\n\r\n  // the realtime price should be used if it is for a transaction to open / close a position\r\n  // or if the transaction involves doing a swap and opening / closing a position\r\n  // otherwise use the contract price instead of realtime price for swaps\r\n\r\n  let fromTokenMinPrice;\r\n  if (fromToken) {\r\n    fromTokenMinPrice = forSwap ? fromToken.contractMinPrice : fromToken.minPrice;\r\n  }\r\n\r\n  let toTokenMaxPrice;\r\n  if (toToken) {\r\n    toTokenMaxPrice = forSwap ? toToken.contractMaxPrice : toToken.maxPrice;\r\n  }\r\n\r\n  if (!fromTokenMinPrice || !toTokenMaxPrice) {\r\n    return defaultValue;\r\n  }\r\n\r\n  const adjustDecimals = adjustForDecimalsFactory(toToken.decimals - fromToken.decimals);\r\n\r\n  let toAmountBasedOnRatio = bigNumberify(0);\r\n  if (ratio && !ratio.isZero()) {\r\n    toAmountBasedOnRatio = fromAmount.mul(PRECISION).div(ratio);\r\n  }\r\n\r\n  if (toTokenAddress === USDG_ADDRESS) {\r\n    const feeBasisPoints = getSwapFeeBasisPoints(fromToken.isStable);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio;\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const toAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n    return {\r\n      amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n      feeBasisPoints,\r\n    };\r\n  }\r\n\r\n  if (fromTokenAddress === USDG_ADDRESS) {\r\n    const redemptionValue = toToken.redemptionAmount\r\n      .mul(toTokenPriceUsd || toTokenMaxPrice)\r\n      .div(expandDecimals(1, toToken.decimals));\r\n\r\n    if (redemptionValue.gt(THRESHOLD_REDEMPTION_VALUE)) {\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const expectedAmount = fromAmount;\r\n\r\n    const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n    if (!stableToken || stableToken.availableAmount.lt(expectedAmount)) {\r\n      const toAmount =\r\n        ratio && !ratio.isZero()\r\n          ? toAmountBasedOnRatio\r\n          : fromAmount.mul(toToken.redemptionAmount).div(expandDecimals(1, toToken.decimals));\r\n      const feeBasisPoints = getSwapFeeBasisPoints(toToken.isStable);\r\n      return {\r\n        amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n        feeBasisPoints,\r\n      };\r\n    }\r\n\r\n    const feeBasisPoints0 = getSwapFeeBasisPoints(true);\r\n    const feeBasisPoints1 = getSwapFeeBasisPoints(false);\r\n\r\n    if (ratio && !ratio.isZero()) {\r\n      const toAmount = toAmountBasedOnRatio\r\n        .mul(BASIS_POINTS_DIVISOR - feeBasisPoints0 - feeBasisPoints1)\r\n        .div(BASIS_POINTS_DIVISOR);\r\n      return {\r\n        amount: adjustDecimals(toAmount),\r\n        path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n        feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n      };\r\n    }\r\n\r\n    // get toAmount for USDG => stableToken\r\n    let toAmount = fromAmount.mul(PRECISION).div(stableToken.maxPrice);\r\n    // apply USDG => stableToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints0).div(BASIS_POINTS_DIVISOR);\r\n\r\n    // get toAmount for stableToken => toToken\r\n    toAmount = toAmount.mul(stableToken.minPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n    // apply stableToken => toToken fees\r\n    toAmount = toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints1).div(BASIS_POINTS_DIVISOR);\r\n\r\n    return {\r\n      amount: adjustDecimals(toAmount),\r\n      path: [USDG_ADDRESS, stableToken.address, toToken.address],\r\n      feeBasisPoints: feeBasisPoints0 + feeBasisPoints1,\r\n    };\r\n  }\r\n\r\n  const toAmount =\r\n    ratio && !ratio.isZero()\r\n      ? toAmountBasedOnRatio\r\n      : fromAmount.mul(fromTokenMinPrice).div(toTokenPriceUsd || toTokenMaxPrice);\r\n\r\n  let usdgAmount = fromAmount.mul(fromTokenMinPrice).div(PRECISION);\r\n  usdgAmount = adjustForDecimals(usdgAmount, fromToken.decimals, USDG_DECIMALS);\r\n  const swapFeeBasisPoints =\r\n    fromToken.isStable && toToken.isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n  const taxBasisPoints = fromToken.isStable && toToken.isStable ? STABLE_TAX_BASIS_POINTS : TAX_BASIS_POINTS;\r\n  const feeBasisPoints0 = getFeeBasisPoints(\r\n    fromToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    true,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints1 = getFeeBasisPoints(\r\n    toToken,\r\n    usdgAmount,\r\n    swapFeeBasisPoints,\r\n    taxBasisPoints,\r\n    false,\r\n    usdgSupply,\r\n    totalTokenWeights\r\n  );\r\n  const feeBasisPoints = feeBasisPoints0 > feeBasisPoints1 ? feeBasisPoints0 : feeBasisPoints1;\r\n\r\n  return {\r\n    amount: adjustDecimals(toAmount.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR)),\r\n    feeBasisPoints,\r\n  };\r\n}\r\n\r\nexport function getProfitPrice(closePrice, position) {\r\n  let profitPrice;\r\n  if (position && position.averagePrice && closePrice) {\r\n    profitPrice = position.isLong\r\n      ? position.averagePrice.mul(BASIS_POINTS_DIVISOR + MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR)\r\n      : position.averagePrice.mul(BASIS_POINTS_DIVISOR - MIN_PROFIT_BIPS).div(BASIS_POINTS_DIVISOR);\r\n  }\r\n  return profitPrice;\r\n}\r\n\r\nexport function calculatePositionDelta(\r\n  price,\r\n  { size, collateral, isLong, averagePrice, lastIncreasedTime },\r\n  sizeDelta\r\n) {\r\n  if (!sizeDelta) {\r\n    sizeDelta = size;\r\n  }\r\n  const priceDelta = averagePrice.gt(price) ? averagePrice.sub(price) : price.sub(averagePrice);\r\n  let delta = sizeDelta.mul(priceDelta).div(averagePrice);\r\n  const pendingDelta = delta;\r\n\r\n  const minProfitExpired = lastIncreasedTime + MIN_PROFIT_TIME < Date.now() / 1000;\r\n  const hasProfit = isLong ? price.gt(averagePrice) : price.lt(averagePrice);\r\n  if (!minProfitExpired && hasProfit && delta.mul(BASIS_POINTS_DIVISOR).lte(size.mul(MIN_PROFIT_BIPS))) {\r\n    delta = bigNumberify(0);\r\n  }\r\n\r\n  const deltaPercentage = delta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n  const pendingDeltaPercentage = pendingDelta.mul(BASIS_POINTS_DIVISOR).div(collateral);\r\n\r\n  return {\r\n    delta,\r\n    pendingDelta,\r\n    pendingDeltaPercentage,\r\n    hasProfit,\r\n    deltaPercentage,\r\n  };\r\n}\r\n\r\nexport function getDeltaStr({ delta, deltaPercentage, hasProfit }) {\r\n  let deltaStr;\r\n  let deltaPercentageStr;\r\n\r\n  if (delta.gt(0)) {\r\n    deltaStr = hasProfit ? \"+\" : \"-\";\r\n    deltaPercentageStr = hasProfit ? \"+\" : \"-\";\r\n  } else {\r\n    deltaStr = \"\";\r\n    deltaPercentageStr = \"\";\r\n  }\r\n  deltaStr += `$${formatAmount(delta, USD_DECIMALS, 2, true)}`;\r\n  deltaPercentageStr += `${formatAmount(deltaPercentage, 2, 2)}%`;\r\n\r\n  return { deltaStr, deltaPercentageStr };\r\n}\r\n\r\nexport function getLeverage({\r\n  size,\r\n  sizeDelta,\r\n  increaseSize,\r\n  collateral,\r\n  collateralDelta,\r\n  increaseCollateral,\r\n  entryFundingRate,\r\n  cumulativeFundingRate,\r\n  hasProfit,\r\n  delta,\r\n  includeDelta,\r\n}) {\r\n  if (!size && !sizeDelta) {\r\n    return;\r\n  }\r\n  if (!collateral && !collateralDelta) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n  }\r\n\r\n  let remainingCollateral = collateral ? collateral : bigNumberify(0);\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = collateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(collateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  if (delta && includeDelta) {\r\n    if (hasProfit) {\r\n      remainingCollateral = remainingCollateral.add(delta);\r\n    } else {\r\n      if (delta.gt(remainingCollateral)) {\r\n        return;\r\n      }\r\n\r\n      remainingCollateral = remainingCollateral.sub(delta);\r\n    }\r\n  }\r\n\r\n  if (remainingCollateral.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  remainingCollateral = sizeDelta\r\n    ? remainingCollateral.mul(BASIS_POINTS_DIVISOR - MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR)\r\n    : remainingCollateral;\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    remainingCollateral = remainingCollateral.sub(fundingFee);\r\n  }\r\n\r\n  return nextSize.mul(BASIS_POINTS_DIVISOR).div(remainingCollateral);\r\n}\r\n\r\nexport function getLiquidationPrice(data) {\r\n  let {\r\n    isLong,\r\n    size,\r\n    collateral,\r\n    averagePrice,\r\n    entryFundingRate,\r\n    cumulativeFundingRate,\r\n    sizeDelta,\r\n    collateralDelta,\r\n    increaseCollateral,\r\n    increaseSize,\r\n    delta,\r\n    hasProfit,\r\n    includeDelta,\r\n  } = data;\r\n  if (!size || !collateral || !averagePrice) {\r\n    return;\r\n  }\r\n\r\n  let nextSize = size ? size : bigNumberify(0);\r\n  let remainingCollateral = collateral;\r\n\r\n  if (sizeDelta) {\r\n    if (increaseSize) {\r\n      nextSize = size.add(sizeDelta);\r\n    } else {\r\n      if (sizeDelta.gte(size)) {\r\n        return;\r\n      }\r\n      nextSize = size.sub(sizeDelta);\r\n    }\r\n\r\n    if (includeDelta && !hasProfit) {\r\n      const adjustedDelta = sizeDelta.mul(delta).div(size);\r\n      remainingCollateral = remainingCollateral.sub(adjustedDelta);\r\n    }\r\n  }\r\n\r\n  if (collateralDelta) {\r\n    if (increaseCollateral) {\r\n      remainingCollateral = remainingCollateral.add(collateralDelta);\r\n    } else {\r\n      if (collateralDelta.gte(remainingCollateral)) {\r\n        return;\r\n      }\r\n      remainingCollateral = remainingCollateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  let positionFee = getMarginFee(size).add(LIQUIDATION_FEE);\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    const fundingFee = size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n    positionFee = positionFee.add(fundingFee);\r\n  }\r\n\r\n  const liquidationPriceForFees = getLiquidationPriceFromDelta({\r\n    liquidationAmount: positionFee,\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  const liquidationPriceForMaxLeverage = getLiquidationPriceFromDelta({\r\n    liquidationAmount: nextSize.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE),\r\n    size: nextSize,\r\n    collateral: remainingCollateral,\r\n    averagePrice,\r\n    isLong,\r\n  });\r\n\r\n  if (!liquidationPriceForFees) {\r\n    return liquidationPriceForMaxLeverage;\r\n  }\r\n  if (!liquidationPriceForMaxLeverage) {\r\n    return liquidationPriceForFees;\r\n  }\r\n\r\n  if (isLong) {\r\n    // return the higher price\r\n    return liquidationPriceForFees.gt(liquidationPriceForMaxLeverage)\r\n      ? liquidationPriceForFees\r\n      : liquidationPriceForMaxLeverage;\r\n  }\r\n\r\n  // return the lower price\r\n  return liquidationPriceForFees.lt(liquidationPriceForMaxLeverage)\r\n    ? liquidationPriceForFees\r\n    : liquidationPriceForMaxLeverage;\r\n}\r\n\r\nexport function getUsd(amount, tokenAddress, max, infoTokens, orderOption, triggerPriceUsd) {\r\n  if (!amount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return amount.mul(PRECISION).div(expandDecimals(1, 18));\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  const price = getTriggerPrice(tokenAddress, max, info, orderOption, triggerPriceUsd);\r\n  if (!price) {\r\n    return;\r\n  }\r\n\r\n  return amount.mul(price).div(expandDecimals(1, info.decimals));\r\n}\r\n\r\nexport function getPositionKey(account, collateralTokenAddress, indexTokenAddress, isLong, nativeTokenAddress) {\r\n  const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n  const tokenAddress1 = indexTokenAddress === AddressZero ? nativeTokenAddress : indexTokenAddress;\r\n  return account + \":\" + tokenAddress0 + \":\" + tokenAddress1 + \":\" + isLong;\r\n}\r\n\r\nexport function getPositionContractKey(account, collateralToken, indexToken, isLong) {\r\n  return ethers.utils.solidityKeccak256(\r\n    [\"address\", \"address\", \"address\", \"bool\"],\r\n    [account, collateralToken, indexToken, isLong]\r\n  );\r\n}\r\n\r\nexport function getSwapFeeBasisPoints(isStable) {\r\n  return isStable ? STABLE_SWAP_FEE_BASIS_POINTS : SWAP_FEE_BASIS_POINTS;\r\n}\r\n\r\n// BSC TESTNET\r\n// const RPC_PROVIDERS = [\r\n//   \"https://data-seed-prebsc-1-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s1.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s2.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-1-s3.binance.org:8545\",\r\n//   \"https://data-seed-prebsc-2-s3.binance.org:8545\"\r\n// ]\r\n\r\n// BSC MAINNET\r\nexport const BSC_RPC_PROVIDERS = [\r\n  \"https://bsc-dataseed.binance.org\",\r\n  \"https://bsc-dataseed1.defibit.io\",\r\n  \"https://bsc-dataseed1.ninicoin.io\",\r\n  \"https://bsc-dataseed2.defibit.io\",\r\n  \"https://bsc-dataseed3.defibit.io\",\r\n  \"https://bsc-dataseed4.defibit.io\",\r\n  \"https://bsc-dataseed2.ninicoin.io\",\r\n  \"https://bsc-dataseed3.ninicoin.io\",\r\n  \"https://bsc-dataseed4.ninicoin.io\",\r\n  \"https://bsc-dataseed1.binance.org\",\r\n  \"https://bsc-dataseed2.binance.org\",\r\n  \"https://bsc-dataseed3.binance.org\",\r\n  \"https://bsc-dataseed4.binance.org\",\r\n];\r\n\r\nconst RPC_PROVIDERS = {\r\n  [MAINNET]: BSC_RPC_PROVIDERS,\r\n  [ARBITRUM]: ARBITRUM_RPC_PROVIDERS,\r\n  [AVALANCHE]: AVALANCHE_RPC_PROVIDERS,\r\n};\r\n\r\nconst FALLBACK_PROVIDERS = {\r\n  [ARBITRUM]: [getAlchemyHttpUrl()],\r\n  [AVALANCHE]: [\"https://avax-mainnet.gateway.pokt.network/v1/lb/626f37766c499d003aada23b\"],\r\n};\r\n\r\nexport function shortenAddress(address, length) {\r\n  if (!length) {\r\n    return \"\";\r\n  }\r\n  if (!address) {\r\n    return address;\r\n  }\r\n  if (address.length < 10) {\r\n    return address;\r\n  }\r\n  let left = Math.floor((length - 3) / 2) + 1;\r\n  return address.substring(0, left) + \"...\" + address.substring(address.length - (length - (left + 3)), address.length);\r\n}\r\n\r\nexport function formatDateTime(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy, h:mm a\");\r\n}\r\n\r\nexport function getTimeRemaining(time) {\r\n  const now = parseInt(Date.now() / 1000);\r\n  if (time < now) {\r\n    return \"0h 0m\";\r\n  }\r\n  const diff = time - now;\r\n  const hours = parseInt(diff / (60 * 60));\r\n  const minutes = parseInt((diff - hours * 60 * 60) / 60);\r\n  return `${hours}h ${minutes}m`;\r\n}\r\n\r\nexport function formatDate(time) {\r\n  return formatDateFn(time * 1000, \"dd MMM yyyy\");\r\n}\r\n\r\nexport function hasMetaMaskWalletExtension() {\r\n  return window.ethereum;\r\n}\r\n\r\nexport function hasCoinBaseWalletExtension() {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet) {\r\n    return false;\r\n  }\r\n  return window.ethereum.isCoinbaseWallet || ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n}\r\n\r\nexport function activateInjectedProvider(providerName) {\r\n  const { ethereum } = window;\r\n\r\n  if (!ethereum?.providers && !ethereum?.isCoinbaseWallet && !ethereum?.isMetaMask) {\r\n    return undefined;\r\n  }\r\n\r\n  let provider;\r\n  if (ethereum?.providers) {\r\n    switch (providerName) {\r\n      case \"CoinBase\":\r\n        provider = ethereum.providers.find(({ isCoinbaseWallet }) => isCoinbaseWallet);\r\n        break;\r\n      case \"MetaMask\":\r\n      default:\r\n        provider = ethereum.providers.find(({ isMetaMask }) => isMetaMask);\r\n        break;\r\n    }\r\n  }\r\n\r\n  if (provider) {\r\n    ethereum.setSelectedProvider(provider);\r\n  }\r\n}\r\n\r\nexport function getInjectedConnector() {\r\n  return injectedConnector;\r\n}\r\n\r\nexport function useChainId() {\r\n  let { chainId } = useWeb3React();\r\n\r\n  if (!chainId) {\r\n    const chainIdFromLocalStorage = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n    if (chainIdFromLocalStorage) {\r\n      chainId = parseInt(chainIdFromLocalStorage);\r\n      if (!chainId) {\r\n        // localstorage value is invalid\r\n        localStorage.removeItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY);\r\n      }\r\n    }\r\n  }\r\n\r\n  if (!chainId || !supportedChainIds.includes(chainId)) {\r\n    chainId = DEFAULT_CHAIN_ID;\r\n  }\r\n  return { chainId };\r\n}\r\n\r\nexport function useENS(address) {\r\n  const [ensName, setENSName] = useState();\r\n\r\n  useEffect(() => {\r\n    async function resolveENS() {\r\n      if (address) {\r\n        const provider = new ethers.providers.JsonRpcProvider(\"https://rpc.ankr.com/eth\");\r\n        const name = await provider.lookupAddress(address.toLowerCase());\r\n        if (name) setENSName(name);\r\n      }\r\n    }\r\n    resolveENS();\r\n  }, [address]);\r\n\r\n  return { ensName };\r\n}\r\n\r\nexport function clearWalletConnectData() {\r\n  localStorage.removeItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n}\r\n\r\nexport function clearWalletLinkData() {\r\n  Object.entries(localStorage)\r\n    .map((x) => x[0])\r\n    .filter((x) => x.startsWith(WALLET_LINK_LOCALSTORAGE_PREFIX))\r\n    .map((x) => localStorage.removeItem(x));\r\n}\r\n\r\nexport function useEagerConnect(setActivatingConnector) {\r\n  const { activate, active } = useWeb3React();\r\n  const [tried, setTried] = useState(false);\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      if (Boolean(localStorage.getItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY)) !== true) {\r\n        // only works with WalletConnect\r\n        clearWalletConnectData();\r\n        // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n        clearWalletLinkData();\r\n        return;\r\n      }\r\n\r\n      let shouldTryWalletConnect = false;\r\n      try {\r\n        // naive validation to not trigger Wallet Connect if data is corrupted\r\n        const rawData = localStorage.getItem(WALLET_CONNECT_LOCALSTORAGE_KEY);\r\n        if (rawData) {\r\n          const data = JSON.parse(rawData);\r\n          if (data && data.connected) {\r\n            shouldTryWalletConnect = true;\r\n          }\r\n        }\r\n      } catch (ex) {\r\n        if (ex instanceof SyntaxError) {\r\n          // rawData is not a valid json\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      if (shouldTryWalletConnect) {\r\n        try {\r\n          const connector = getWalletConnectConnector();\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n          // in case Wallet Connect is activated no need to check injected wallet\r\n          return;\r\n        } catch (ex) {\r\n          // assume data in localstorage is corrupted and delete it to not retry on next page load\r\n          clearWalletConnectData();\r\n        }\r\n      }\r\n\r\n      try {\r\n        const connector = getInjectedConnector();\r\n        const currentProviderName = localStorage.getItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY) ?? false;\r\n        if (currentProviderName !== false) {\r\n          activateInjectedProvider(currentProviderName);\r\n        }\r\n        const authorized = await connector.isAuthorized();\r\n        if (authorized) {\r\n          setActivatingConnector(connector);\r\n          await activate(connector, undefined, true);\r\n        }\r\n      } catch (ex) {}\r\n\r\n      setTried(true);\r\n    })();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []); // intentionally only running on mount (make sure it's only mounted once :))\r\n\r\n  // if the connection worked, wait until we get confirmation of that to flip the flag\r\n  useEffect(() => {\r\n    if (!tried && active) {\r\n      setTried(true);\r\n    }\r\n  }, [tried, active]);\r\n\r\n  return tried;\r\n}\r\n\r\nexport function useInactiveListener(suppress = false) {\r\n  const injected = getInjectedConnector();\r\n  const { active, error, activate } = useWeb3React();\r\n\r\n  useEffect(() => {\r\n    const { ethereum } = window;\r\n    if (ethereum && ethereum.on && !active && !error && !suppress) {\r\n      const handleConnect = () => {\r\n        activate(injected);\r\n      };\r\n      const handleChainChanged = (chainId) => {\r\n        activate(injected);\r\n      };\r\n      const handleAccountsChanged = (accounts) => {\r\n        if (accounts.length > 0) {\r\n          activate(injected);\r\n        }\r\n      };\r\n      const handleNetworkChanged = (networkId) => {\r\n        activate(injected);\r\n      };\r\n\r\n      ethereum.on(\"connect\", handleConnect);\r\n      ethereum.on(\"chainChanged\", handleChainChanged);\r\n      ethereum.on(\"accountsChanged\", handleAccountsChanged);\r\n      ethereum.on(\"networkChanged\", handleNetworkChanged);\r\n\r\n      return () => {\r\n        if (ethereum.removeListener) {\r\n          ethereum.removeListener(\"connect\", handleConnect);\r\n          ethereum.removeListener(\"chainChanged\", handleChainChanged);\r\n          ethereum.removeListener(\"accountsChanged\", handleAccountsChanged);\r\n          ethereum.removeListener(\"networkChanged\", handleNetworkChanged);\r\n        }\r\n      };\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [active, error, suppress, activate]);\r\n}\r\n\r\nexport function getProvider(library, chainId) {\r\n  let provider;\r\n  if (library) {\r\n    return library.getSigner();\r\n  }\r\n  provider = _.sample(RPC_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function getFallbackProvider(chainId) {\r\n  if (!FALLBACK_PROVIDERS[chainId]) {\r\n    return;\r\n  }\r\n\r\n  const provider = _.sample(FALLBACK_PROVIDERS[chainId]);\r\n  return new ethers.providers.StaticJsonRpcProvider(provider, { chainId });\r\n}\r\n\r\nexport function bigNumberify(n) {\r\n  try {\r\n    return ethers.BigNumber.from(n);\r\n  } catch (e) {\r\n    console.error(\"bigNumberify error\", e);\r\n    return undefined;\r\n  }\r\n}\r\n\r\nexport function expandDecimals(n, decimals) {\r\n  return bigNumberify(n).mul(bigNumberify(10).pow(decimals));\r\n}\r\n\r\nexport const trimZeroDecimals = (amount) => {\r\n  if (parseFloat(amount) === parseInt(amount)) {\r\n    return parseInt(amount).toString();\r\n  }\r\n  return amount;\r\n};\r\n\r\nexport const limitDecimals = (amount, maxDecimals) => {\r\n  let amountStr = amount.toString();\r\n  if (maxDecimals === undefined) {\r\n    return amountStr;\r\n  }\r\n  if (maxDecimals === 0) {\r\n    return amountStr.split(\".\")[0];\r\n  }\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    let decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals > maxDecimals) {\r\n      amountStr = amountStr.substr(0, amountStr.length - (decimals - maxDecimals));\r\n    }\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const padDecimals = (amount, minDecimals) => {\r\n  let amountStr = amount.toString();\r\n  const dotIndex = amountStr.indexOf(\".\");\r\n  if (dotIndex !== -1) {\r\n    const decimals = amountStr.length - dotIndex - 1;\r\n    if (decimals < minDecimals) {\r\n      amountStr = amountStr.padEnd(amountStr.length + (minDecimals - decimals), \"0\");\r\n    }\r\n  } else {\r\n    amountStr = amountStr + \".0000\";\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatKeyAmount = (map, key, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!map || !map[key]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(map[key], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nexport const formatArrayAmount = (arr, index, tokenDecimals, displayDecimals, useCommas) => {\r\n  if (!arr || !arr[index]) {\r\n    return \"...\";\r\n  }\r\n\r\n  return formatAmount(arr[index], tokenDecimals, displayDecimals, useCommas);\r\n};\r\n\r\nfunction _parseOrdersData(ordersData, account, indexes, extractor, uintPropsLength, addressPropsLength) {\r\n  if (!ordersData || ordersData.length === 0) {\r\n    return [];\r\n  }\r\n  const [uintProps, addressProps] = ordersData;\r\n  const count = uintProps.length / uintPropsLength;\r\n\r\n  const orders = [];\r\n  for (let i = 0; i < count; i++) {\r\n    const sliced = addressProps\r\n      .slice(addressPropsLength * i, addressPropsLength * (i + 1))\r\n      .concat(uintProps.slice(uintPropsLength * i, uintPropsLength * (i + 1)));\r\n\r\n    if (sliced[0] === AddressZero && sliced[1] === AddressZero) {\r\n      continue;\r\n    }\r\n\r\n    const order = extractor(sliced);\r\n    order.index = indexes[i];\r\n    order.account = account;\r\n    orders.push(order);\r\n  }\r\n\r\n  return orders;\r\n}\r\n\r\nfunction parseDecreaseOrdersData(chainId, decreaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[4].toString() === \"1\";\r\n    return {\r\n      collateralToken: sliced[0],\r\n      indexToken: sliced[1],\r\n      collateralDelta: sliced[2],\r\n      sizeDelta: sliced[3],\r\n      isLong,\r\n      triggerPrice: sliced[5],\r\n      triggerAboveThreshold: sliced[6].toString() === \"1\",\r\n      type: DECREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(decreaseOrdersData, account, indexes, extractor, 5, 2).filter((order) => {\r\n    return isValidToken(chainId, order.collateralToken) && isValidToken(chainId, order.indexToken);\r\n  });\r\n}\r\n\r\nfunction parseIncreaseOrdersData(chainId, increaseOrdersData, account, indexes) {\r\n  const extractor = (sliced) => {\r\n    const isLong = sliced[5].toString() === \"1\";\r\n    return {\r\n      purchaseToken: sliced[0],\r\n      collateralToken: sliced[1],\r\n      indexToken: sliced[2],\r\n      purchaseTokenAmount: sliced[3],\r\n      sizeDelta: sliced[4],\r\n      isLong,\r\n      triggerPrice: sliced[6],\r\n      triggerAboveThreshold: sliced[7].toString() === \"1\",\r\n      type: INCREASE,\r\n    };\r\n  };\r\n  return _parseOrdersData(increaseOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return (\r\n      isValidToken(chainId, order.purchaseToken) &&\r\n      isValidToken(chainId, order.collateralToken) &&\r\n      isValidToken(chainId, order.indexToken)\r\n    );\r\n  });\r\n}\r\n\r\nfunction parseSwapOrdersData(chainId, swapOrdersData, account, indexes) {\r\n  if (!swapOrdersData || !swapOrdersData.length) {\r\n    return [];\r\n  }\r\n\r\n  const extractor = (sliced) => {\r\n    const triggerAboveThreshold = sliced[6].toString() === \"1\";\r\n    const shouldUnwrap = sliced[7].toString() === \"1\";\r\n\r\n    return {\r\n      path: [sliced[0], sliced[1], sliced[2]].filter((address) => address !== AddressZero),\r\n      amountIn: sliced[3],\r\n      minOut: sliced[4],\r\n      triggerRatio: sliced[5],\r\n      triggerAboveThreshold,\r\n      type: SWAP,\r\n      shouldUnwrap,\r\n    };\r\n  };\r\n  return _parseOrdersData(swapOrdersData, account, indexes, extractor, 5, 3).filter((order) => {\r\n    return order.path.every((token) => isValidToken(chainId, token));\r\n  });\r\n}\r\n\r\nexport function getOrderKey(order) {\r\n  return `${order.type}-${order.account}-${order.index}`;\r\n}\r\n\r\nexport function useAccountOrders(flagOrdersEnabled, overrideAccount) {\r\n  const { library, account: connectedAccount } = useWeb3React();\r\n  const active = true; // this is used in Actions.js so set active to always be true\r\n  const account = overrideAccount || connectedAccount;\r\n\r\n  const { chainId } = useChainId();\r\n  const shouldRequest = active && account && flagOrdersEnabled;\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const orderBookReaderAddress = getContract(chainId, \"OrderBookReader\");\r\n  const key = shouldRequest ? [active, chainId, orderBookAddress, account] : false;\r\n  const {\r\n    data: orders = [],\r\n    mutate: updateOrders,\r\n    error: ordersError,\r\n  } = useSWR(key, {\r\n    dedupingInterval: 5000,\r\n    fetcher: async (active, chainId, orderBookAddress, account) => {\r\n      const provider = getProvider(library, chainId);\r\n      const orderBookContract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n      const orderBookReaderContract = new ethers.Contract(orderBookReaderAddress, OrderBookReader.abi, provider);\r\n\r\n      const fetchIndexesFromServer = () => {\r\n        const ordersIndexesUrl = `${getServerBaseUrl(chainId)}/orders_indices?account=${account}`;\r\n        return fetch(ordersIndexesUrl)\r\n          .then(async (res) => {\r\n            const json = await res.json();\r\n            const ret = {};\r\n            for (const key of Object.keys(json)) {\r\n              ret[key.toLowerCase()] = json[key].map((val) => parseInt(val.value)).sort((a, b) => a - b);\r\n            }\r\n\r\n            return ret;\r\n          })\r\n          .catch(() => ({ swap: [], increase: [], decrease: [] }));\r\n      };\r\n\r\n      const fetchLastIndex = async (type) => {\r\n        const method = type.toLowerCase() + \"OrdersIndex\";\r\n        return await orderBookContract[method](account).then((res) => bigNumberify(res._hex).toNumber());\r\n      };\r\n\r\n      const fetchLastIndexes = async () => {\r\n        const [swap, increase, decrease] = await Promise.all([\r\n          fetchLastIndex(\"swap\"),\r\n          fetchLastIndex(\"increase\"),\r\n          fetchLastIndex(\"decrease\"),\r\n        ]);\r\n\r\n        return { swap, increase, decrease };\r\n      };\r\n\r\n      const getRange = (to, from) => {\r\n        const LIMIT = 10;\r\n        const _indexes = [];\r\n        from = from || Math.max(to - LIMIT, 0);\r\n        for (let i = to - 1; i >= from; i--) {\r\n          _indexes.push(i);\r\n        }\r\n        return _indexes;\r\n      };\r\n\r\n      const getIndexes = (knownIndexes, lastIndex) => {\r\n        if (knownIndexes.length === 0) {\r\n          return getRange(lastIndex);\r\n        }\r\n        return [\r\n          ...knownIndexes,\r\n          ...getRange(lastIndex, knownIndexes[knownIndexes.length - 1] + 1).sort((a, b) => b - a),\r\n        ];\r\n      };\r\n\r\n      const getOrders = async (method, knownIndexes, lastIndex, parseFunc) => {\r\n        const indexes = getIndexes(knownIndexes, lastIndex);\r\n        const ordersData = await orderBookReaderContract[method](orderBookAddress, account, indexes);\r\n        const orders = parseFunc(chainId, ordersData, account, indexes);\r\n\r\n        return orders;\r\n      };\r\n\r\n      try {\r\n        const [serverIndexes, lastIndexes] = await Promise.all([fetchIndexesFromServer(), fetchLastIndexes()]);\r\n        const [swapOrders = [], increaseOrders = [], decreaseOrders = []] = await Promise.all([\r\n          getOrders(\"getSwapOrders\", serverIndexes.swap, lastIndexes.swap, parseSwapOrdersData),\r\n          getOrders(\"getIncreaseOrders\", serverIndexes.increase, lastIndexes.increase, parseIncreaseOrdersData),\r\n          getOrders(\"getDecreaseOrders\", serverIndexes.decrease, lastIndexes.decrease, parseDecreaseOrdersData),\r\n        ]);\r\n        return [...swapOrders, ...increaseOrders, ...decreaseOrders];\r\n      } catch (ex) {\r\n        console.error(ex);\r\n      }\r\n    },\r\n  });\r\n\r\n  return [orders, updateOrders, ordersError];\r\n}\r\n\r\nexport const formatAmount = (amount, tokenDecimals, displayDecimals, useCommas, defaultValue) => {\r\n  if (!defaultValue) {\r\n    defaultValue = \"...\";\r\n  }\r\n  if (amount === undefined || amount.toString().length === 0) {\r\n    return defaultValue;\r\n  }\r\n  if (displayDecimals === undefined) {\r\n    displayDecimals = 4;\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  if (displayDecimals !== 0) {\r\n    amountStr = padDecimals(amountStr, displayDecimals);\r\n  }\r\n  if (useCommas) {\r\n    return numberWithCommas(amountStr);\r\n  }\r\n  return amountStr;\r\n};\r\n\r\nexport const formatAmountFree = (amount, tokenDecimals, displayDecimals) => {\r\n  if (!amount) {\r\n    return \"...\";\r\n  }\r\n  let amountStr = ethers.utils.formatUnits(amount, tokenDecimals);\r\n  amountStr = limitDecimals(amountStr, displayDecimals);\r\n  return trimZeroDecimals(amountStr);\r\n};\r\n\r\nexport const parseValue = (value, tokenDecimals) => {\r\n  const pValue = parseFloat(value);\r\n  if (isNaN(pValue)) {\r\n    return undefined;\r\n  }\r\n  value = limitDecimals(value, tokenDecimals);\r\n  const amount = ethers.utils.parseUnits(value, tokenDecimals);\r\n  return bigNumberify(amount);\r\n};\r\n\r\nexport function numberWithCommas(x) {\r\n  if (!x) {\r\n    return \"...\";\r\n  }\r\n  var parts = x.toString().split(\".\");\r\n  parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n  return parts.join(\".\");\r\n}\r\n\r\nexport function getExplorerUrl(chainId) {\r\n  if (chainId === 3) {\r\n    return \"https://ropsten.etherscan.io/\";\r\n  } else if (chainId === 42) {\r\n    return \"https://kovan.etherscan.io/\";\r\n  } else if (chainId === MAINNET) {\r\n    return \"https://bscscan.com/\";\r\n  } else if (chainId === TESTNET) {\r\n    return \"https://testnet.bscscan.com/\";\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return \"https://testnet.arbiscan.io/\";\r\n  } else if (chainId === ARBITRUM) {\r\n    return \"https://arbiscan.io/\";\r\n  } else if (chainId === AVALANCHE) {\r\n    return \"https://snowtrace.io/\";\r\n  }\r\n  return \"https://etherscan.io/\";\r\n}\r\n\r\nexport function getAccountUrl(chainId, account) {\r\n  if (!account) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"address/\" + account;\r\n}\r\n\r\nexport function getTokenUrl(chainId, address) {\r\n  if (!address) {\r\n    return getExplorerUrl(chainId);\r\n  }\r\n  return getExplorerUrl(chainId) + \"token/\" + address;\r\n}\r\n\r\nexport function usePrevious(value) {\r\n  const ref = useRef();\r\n  useEffect(() => {\r\n    ref.current = value;\r\n  });\r\n  return ref.current;\r\n}\r\n\r\nexport function approveTokens({\r\n  setIsApproving,\r\n  library,\r\n  tokenAddress,\r\n  spender,\r\n  chainId,\r\n  onApproveSubmitted,\r\n  getTokenInfo,\r\n  infoTokens,\r\n  pendingTxns,\r\n  setPendingTxns,\r\n  includeMessage,\r\n}) {\r\n  setIsApproving(true);\r\n  const contract = new ethers.Contract(tokenAddress, Token.abi, library.getSigner());\r\n  contract\r\n    .approve(spender, ethers.constants.MaxUint256)\r\n    .then(async (res) => {\r\n      const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\r\n      helperToast.success(\r\n        <div>\r\n          Approval submitted!{\" \"}\r\n          <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n            View status.\r\n          </a>\r\n          <br />\r\n        </div>\r\n      );\r\n      if (onApproveSubmitted) {\r\n        onApproveSubmitted();\r\n      }\r\n      if (getTokenInfo && infoTokens && pendingTxns && setPendingTxns) {\r\n        const token = getTokenInfo(infoTokens, tokenAddress);\r\n        const pendingTxn = {\r\n          hash: res.hash,\r\n          message: includeMessage ? `${token.symbol} Approved!` : false,\r\n        };\r\n        setPendingTxns([...pendingTxns, pendingTxn]);\r\n      }\r\n    })\r\n    .catch((e) => {\r\n      console.error(e);\r\n      let failMsg;\r\n      if (\r\n        [\"not enough funds for gas\", \"failed to execute call with revert code InsufficientGasFunds\"].includes(\r\n          e.data?.message\r\n        )\r\n      ) {\r\n        failMsg = (\r\n          <div>\r\n            There is not enough ETH in your account on Arbitrum to send this transaction.\r\n            <br />\r\n            <br />\r\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              Bridge ETH to Arbitrum\r\n            </a>\r\n          </div>\r\n        );\r\n      } else if (e.message?.includes(\"User denied transaction signature\")) {\r\n        failMsg = \"Approval was cancelled\";\r\n      } else {\r\n        failMsg = \"Approval failed\";\r\n      }\r\n      helperToast.error(failMsg);\r\n    })\r\n    .finally(() => {\r\n      setIsApproving(false);\r\n    });\r\n}\r\n\r\nexport const shouldRaiseGasError = (token, amount) => {\r\n  if (!amount) {\r\n    return false;\r\n  }\r\n  if (token.address !== AddressZero) {\r\n    return false;\r\n  }\r\n  if (!token.balance) {\r\n    return false;\r\n  }\r\n  if (amount.gte(token.balance)) {\r\n    return true;\r\n  }\r\n  if (token.balance.sub(amount).lt(DUST_BNB)) {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getTokenInfo = (infoTokens, tokenAddress, replaceNative, nativeTokenAddress) => {\r\n  if (replaceNative && tokenAddress === nativeTokenAddress) {\r\n    return infoTokens[AddressZero];\r\n  }\r\n  return infoTokens[tokenAddress];\r\n};\r\n\r\nconst NETWORK_METADATA = {\r\n  [MAINNET]: {\r\n    chainId: \"0x\" + MAINNET.toString(16),\r\n    chainName: \"BSC\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: BSC_RPC_PROVIDERS,\r\n    blockExplorerUrls: [\"https://bscscan.com\"],\r\n  },\r\n  [TESTNET]: {\r\n    chainId: \"0x\" + TESTNET.toString(16),\r\n    chainName: \"BSC Testnet\",\r\n    nativeCurrency: {\r\n      name: \"BNB\",\r\n      symbol: \"BNB\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://data-seed-prebsc-1-s1.binance.org:8545/\"],\r\n    blockExplorerUrls: [\"https://testnet.bscscan.com/\"],\r\n  },\r\n  [ARBITRUM_TESTNET]: {\r\n    chainId: \"0x\" + ARBITRUM_TESTNET.toString(16),\r\n    chainName: \"Arbitrum Testnet\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: [\"https://rinkeby.arbitrum.io/rpc\"],\r\n    blockExplorerUrls: [\"https://rinkeby-explorer.arbitrum.io/\"],\r\n  },\r\n  [ARBITRUM]: {\r\n    chainId: \"0x\" + ARBITRUM.toString(16),\r\n    chainName: \"Arbitrum\",\r\n    nativeCurrency: {\r\n      name: \"ETH\",\r\n      symbol: \"ETH\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: ARBITRUM_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(ARBITRUM)],\r\n  },\r\n  [AVALANCHE]: {\r\n    chainId: \"0x\" + AVALANCHE.toString(16),\r\n    chainName: \"Avalanche\",\r\n    nativeCurrency: {\r\n      name: \"AVAX\",\r\n      symbol: \"AVAX\",\r\n      decimals: 18,\r\n    },\r\n    rpcUrls: AVALANCHE_RPC_PROVIDERS,\r\n    blockExplorerUrls: [getExplorerUrl(AVALANCHE)],\r\n  },\r\n};\r\n\r\nexport const addBscNetwork = async () => {\r\n  return addNetwork(NETWORK_METADATA[MAINNET]);\r\n};\r\n\r\nexport const addNetwork = async (metadata) => {\r\n  await window.ethereum.request({ method: \"wallet_addEthereumChain\", params: [metadata] }).catch();\r\n};\r\n\r\nexport const switchNetwork = async (chainId, active) => {\r\n  if (!active) {\r\n    // chainId in localStorage allows to switch network even if wallet is not connected\r\n    // or there is no wallet at all\r\n    localStorage.setItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY, chainId);\r\n    document.location.reload();\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const chainIdHex = \"0x\" + chainId.toString(16);\r\n    await window.ethereum.request({\r\n      method: \"wallet_switchEthereumChain\",\r\n      params: [{ chainId: chainIdHex }],\r\n    });\r\n    helperToast.success(\"Connected to \" + getChainName(chainId));\r\n    return getChainName(chainId);\r\n  } catch (ex) {\r\n    // https://docs.metamask.io/guide/rpc-api.html#other-rpc-methods\r\n    // This error code indicates that the chain has not been added to MetaMask.\r\n    // 4001 error means user has denied the request\r\n    // If the error code is not 4001, then we need to add the network\r\n    if (ex.code !== 4001) {\r\n      return await addNetwork(NETWORK_METADATA[chainId]);\r\n    }\r\n\r\n    console.error(\"error\", ex);\r\n  }\r\n};\r\n\r\nexport const getWalletConnectHandler = (activate, deactivate, setActivatingConnector) => {\r\n  const fn = async () => {\r\n    const walletConnect = getWalletConnectConnector();\r\n    setActivatingConnector(walletConnect);\r\n    activate(walletConnect, (ex) => {\r\n      if (ex instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\"Unsupported chain. Switch to Arbitrum network on your wallet and try again\");\r\n        console.warn(ex);\r\n      } else if (!(ex instanceof UserRejectedRequestErrorWalletConnect)) {\r\n        helperToast.error(ex.message);\r\n        console.warn(ex);\r\n      }\r\n      clearWalletConnectData();\r\n      deactivate();\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport const getInjectedHandler = (activate) => {\r\n  const fn = async () => {\r\n    activate(getInjectedConnector(), (e) => {\r\n      const chainId = localStorage.getItem(SELECTED_NETWORK_LOCAL_STORAGE_KEY) || DEFAULT_CHAIN_ID;\r\n\r\n      if (e instanceof UnsupportedChainIdError) {\r\n        helperToast.error(\r\n          <div>\r\n            <div>Your wallet is not connected to {getChainName(chainId)}.</div>\r\n            <br />\r\n            <div className=\"clickable underline margin-bottom\" onClick={() => switchNetwork(chainId, true)}>\r\n              Switch to {getChainName(chainId)}\r\n            </div>\r\n            <div className=\"clickable underline\" onClick={() => switchNetwork(chainId, true)}>\r\n              Add {getChainName(chainId)}\r\n            </div>\r\n          </div>\r\n        );\r\n        return;\r\n      }\r\n      const errString = e.message ?? e.toString();\r\n      helperToast.error(errString);\r\n    });\r\n  };\r\n  return fn;\r\n};\r\n\r\nexport function isMobileDevice(navigator) {\r\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n}\r\n\r\nexport function setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress) {\r\n  if (!indexPrices) {\r\n    return;\r\n  }\r\n\r\n  const tokenAddress = token.isNative ? nativeTokenAddress : token.address;\r\n\r\n  const indexPrice = indexPrices[tokenAddress];\r\n  if (!indexPrice) {\r\n    return;\r\n  }\r\n\r\n  const indexPriceBn = bigNumberify(indexPrice);\r\n  if (indexPriceBn.eq(0)) {\r\n    return;\r\n  }\r\n\r\n  const spread = token.maxPrice.sub(token.minPrice);\r\n  const spreadBps = spread.mul(BASIS_POINTS_DIVISOR).div(token.maxPrice.add(token.minPrice).div(2));\r\n\r\n  if (spreadBps.gt(MAX_PRICE_DEVIATION_BASIS_POINTS - 50)) {\r\n    // only set one of the values as there will be a spread between the index price and the Chainlink price\r\n    if (indexPriceBn.gt(token.minPrimaryPrice)) {\r\n      token.maxPrice = indexPriceBn;\r\n    } else {\r\n      token.minPrice = indexPriceBn;\r\n    }\r\n    return;\r\n  }\r\n\r\n  const halfSpreadBps = spreadBps.div(2).toNumber();\r\n  token.maxPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR + halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n  token.minPrice = indexPriceBn.mul(BASIS_POINTS_DIVISOR - halfSpreadBps).div(BASIS_POINTS_DIVISOR);\r\n}\r\n\r\nexport function getInfoTokens(\r\n  tokens,\r\n  tokenBalances,\r\n  whitelistedTokens,\r\n  vaultTokenInfo,\r\n  fundingRateInfo,\r\n  vaultPropsLength,\r\n  indexPrices,\r\n  nativeTokenAddress\r\n) {\r\n  if (!vaultPropsLength) {\r\n    vaultPropsLength = 15;\r\n  }\r\n  const fundingRatePropsLength = 2;\r\n  const infoTokens = {};\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(tokens[i]));\r\n    if (tokenBalances) {\r\n      token.balance = tokenBalances[i];\r\n    }\r\n    if (token.address === USDG_ADDRESS) {\r\n      token.minPrice = expandDecimals(1, USD_DECIMALS);\r\n      token.maxPrice = expandDecimals(1, USD_DECIMALS);\r\n    }\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  for (let i = 0; i < whitelistedTokens.length; i++) {\r\n    const token = JSON.parse(JSON.stringify(whitelistedTokens[i]));\r\n    if (vaultTokenInfo) {\r\n      token.poolAmount = vaultTokenInfo[i * vaultPropsLength];\r\n      token.reservedAmount = vaultTokenInfo[i * vaultPropsLength + 1];\r\n      token.availableAmount = token.poolAmount.sub(token.reservedAmount);\r\n      token.usdgAmount = vaultTokenInfo[i * vaultPropsLength + 2];\r\n      token.redemptionAmount = vaultTokenInfo[i * vaultPropsLength + 3];\r\n      token.weight = vaultTokenInfo[i * vaultPropsLength + 4];\r\n      token.bufferAmount = vaultTokenInfo[i * vaultPropsLength + 5];\r\n      token.maxUsdgAmount = vaultTokenInfo[i * vaultPropsLength + 6];\r\n      token.globalShortSize = vaultTokenInfo[i * vaultPropsLength + 7];\r\n      token.maxGlobalShortSize = vaultTokenInfo[i * vaultPropsLength + 8];\r\n      token.maxGlobalLongSize = vaultTokenInfo[i * vaultPropsLength + 9];\r\n      token.minPrice = vaultTokenInfo[i * vaultPropsLength + 10];\r\n      token.maxPrice = vaultTokenInfo[i * vaultPropsLength + 11];\r\n      token.guaranteedUsd = vaultTokenInfo[i * vaultPropsLength + 12];\r\n      token.maxPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 13];\r\n      token.minPrimaryPrice = vaultTokenInfo[i * vaultPropsLength + 14];\r\n\r\n      // save minPrice and maxPrice as setTokenUsingIndexPrices may override it\r\n      token.contractMinPrice = token.minPrice;\r\n      token.contractMaxPrice = token.maxPrice;\r\n\r\n      token.maxAvailableShort = bigNumberify(0);\r\n      token.hasMaxAvailableShort = false;\r\n      if (token.maxGlobalShortSize.gt(0)) {\r\n        token.hasMaxAvailableShort = true;\r\n        if (token.maxGlobalShortSize.gt(token.globalShortSize)) {\r\n          token.maxAvailableShort = token.maxGlobalShortSize.sub(token.globalShortSize);\r\n        }\r\n      }\r\n\r\n      if (token.maxUsdgAmount.eq(0)) {\r\n        token.maxUsdgAmount = DEFAULT_MAX_USDG_AMOUNT;\r\n      }\r\n\r\n      token.availableUsd = token.isStable\r\n        ? token.poolAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals))\r\n        : token.availableAmount.mul(token.minPrice).div(expandDecimals(1, token.decimals));\r\n\r\n      token.maxAvailableLong = bigNumberify(0);\r\n      token.hasMaxAvailableLong = false;\r\n      if (token.maxGlobalLongSize.gt(0)) {\r\n        token.hasMaxAvailableLong = true;\r\n\r\n        if (token.maxGlobalLongSize.gt(token.guaranteedUsd)) {\r\n          const remainingLongSize = token.maxGlobalLongSize.sub(token.guaranteedUsd);\r\n          token.maxAvailableLong = remainingLongSize.lt(token.availableUsd) ? remainingLongSize : token.availableUsd;\r\n        }\r\n      } else {\r\n        token.maxAvailableLong = token.availableUsd;\r\n      }\r\n\r\n      token.maxLongCapacity =\r\n        token.maxGlobalLongSize.gt(0) && token.maxGlobalLongSize.lt(token.availableUsd.add(token.guaranteedUsd))\r\n          ? token.maxGlobalLongSize\r\n          : token.availableUsd.add(token.guaranteedUsd);\r\n\r\n      token.managedUsd = token.availableUsd.add(token.guaranteedUsd);\r\n      token.managedAmount = token.managedUsd.mul(expandDecimals(1, token.decimals)).div(token.minPrice);\r\n\r\n      setTokenUsingIndexPrices(token, indexPrices, nativeTokenAddress);\r\n    }\r\n\r\n    if (fundingRateInfo) {\r\n      token.fundingRate = fundingRateInfo[i * fundingRatePropsLength];\r\n      token.cumulativeFundingRate = fundingRateInfo[i * fundingRatePropsLength + 1];\r\n    }\r\n\r\n    if (infoTokens[token.address]) {\r\n      token.balance = infoTokens[token.address].balance;\r\n    }\r\n\r\n    infoTokens[token.address] = token;\r\n  }\r\n\r\n  return infoTokens;\r\n}\r\n\r\nexport const CHART_PERIODS = {\r\n  \"5m\": 60 * 5,\r\n  \"15m\": 60 * 15,\r\n  \"1h\": 60 * 60,\r\n  \"4h\": 60 * 60 * 4,\r\n  \"1d\": 60 * 60 * 24,\r\n};\r\n\r\nexport function getTotalVolumeSum(volumes) {\r\n  if (!volumes || volumes.length === 0) {\r\n    return;\r\n  }\r\n\r\n  let volume = bigNumberify(0);\r\n  for (let i = 0; i < volumes.length; i++) {\r\n    volume = volume.add(volumes[i].data.volume);\r\n  }\r\n\r\n  return volume;\r\n}\r\n\r\nexport function getBalanceAndSupplyData(balances) {\r\n  if (!balances || balances.length === 0) {\r\n    return {};\r\n  }\r\n\r\n  const keys = [\"gmx\", \"esGmx\", \"glp\", \"stakedGmxTracker\"];\r\n  const balanceData = {};\r\n  const supplyData = {};\r\n  const propsLength = 2;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    balanceData[key] = balances[i * propsLength];\r\n    supplyData[key] = balances[i * propsLength + 1];\r\n  }\r\n\r\n  return { balanceData, supplyData };\r\n}\r\n\r\nexport function getDepositBalanceData(depositBalances) {\r\n  if (!depositBalances || depositBalances.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\r\n    \"gmxInStakedGmx\",\r\n    \"esGmxInStakedGmx\",\r\n    \"stakedGmxInBonusGmx\",\r\n    \"bonusGmxInFeeGmx\",\r\n    \"bnGmxInFeeGmx\",\r\n    \"glpInStakedGlp\",\r\n  ];\r\n  const data = {};\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = depositBalances[i];\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getVestingData(vestingInfo) {\r\n  if (!vestingInfo || vestingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"gmxVester\", \"glpVester\"];\r\n  const data = {};\r\n  const propsLength = 7;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      pairAmount: vestingInfo[i * propsLength],\r\n      vestedAmount: vestingInfo[i * propsLength + 1],\r\n      escrowedBalance: vestingInfo[i * propsLength + 2],\r\n      claimedAmounts: vestingInfo[i * propsLength + 3],\r\n      claimable: vestingInfo[i * propsLength + 4],\r\n      maxVestableAmount: vestingInfo[i * propsLength + 5],\r\n      averageStakedAmount: vestingInfo[i * propsLength + 6],\r\n    };\r\n\r\n    data[key + \"PairAmount\"] = data[key].pairAmount;\r\n    data[key + \"VestedAmount\"] = data[key].vestedAmount;\r\n    data[key + \"EscrowedBalance\"] = data[key].escrowedBalance;\r\n    data[key + \"ClaimSum\"] = data[key].claimedAmounts.add(data[key].claimable);\r\n    data[key + \"Claimable\"] = data[key].claimable;\r\n    data[key + \"MaxVestableAmount\"] = data[key].maxVestableAmount;\r\n    data[key + \"AverageStakedAmount\"] = data[key].averageStakedAmount;\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getStakingData(stakingInfo) {\r\n  if (!stakingInfo || stakingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"stakedGmxTracker\", \"bonusGmxTracker\", \"feeGmxTracker\", \"stakedGlpTracker\", \"feeGlpTracker\"];\r\n  const data = {};\r\n  const propsLength = 5;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      claimable: stakingInfo[i * propsLength],\r\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\r\n      averageStakedAmounts: stakingInfo[i * propsLength + 2],\r\n      cumulativeRewards: stakingInfo[i * propsLength + 3],\r\n      totalSupply: stakingInfo[i * propsLength + 4],\r\n    };\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport function getProcessedData(\r\n  balanceData,\r\n  supplyData,\r\n  depositBalanceData,\r\n  stakingData,\r\n  vestingData,\r\n  aum,\r\n  nativeTokenPrice,\r\n  stakedGmxSupply,\r\n  gmxPrice,\r\n  gmxSupply\r\n) {\r\n  if (\r\n    !balanceData ||\r\n    !supplyData ||\r\n    !depositBalanceData ||\r\n    !stakingData ||\r\n    !vestingData ||\r\n    !aum ||\r\n    !nativeTokenPrice ||\r\n    !stakedGmxSupply ||\r\n    !gmxPrice ||\r\n    !gmxSupply\r\n  ) {\r\n    return {};\r\n  }\r\n\r\n  const data = {};\r\n\r\n  data.gmxBalance = balanceData.gmx;\r\n  data.gmxBalanceUsd = balanceData.gmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.gmxSupply = bigNumberify(gmxSupply);\r\n\r\n  data.gmxSupplyUsd = data.gmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedGmxSupply = stakedGmxSupply;\r\n  data.stakedGmxSupplyUsd = stakedGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.gmxInStakedGmx = depositBalanceData.gmxInStakedGmx;\r\n  data.gmxInStakedGmxUsd = depositBalanceData.gmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxBalance = balanceData.esGmx;\r\n  data.esGmxBalanceUsd = balanceData.esGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerSupply = supplyData.stakedGmxTracker;\r\n  data.stakedGmxTrackerSupplyUsd = supplyData.stakedGmxTracker.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  data.stakedEsGmxSupply = data.stakedGmxTrackerSupply.sub(data.stakedGmxSupply);\r\n  data.stakedEsGmxSupplyUsd = data.stakedEsGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.esGmxInStakedGmx = depositBalanceData.esGmxInStakedGmx;\r\n  data.esGmxInStakedGmxUsd = depositBalanceData.esGmxInStakedGmx.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bnGmxInFeeGmx = depositBalanceData.bnGmxInFeeGmx;\r\n  data.bonusGmxInFeeGmx = depositBalanceData.bonusGmxInFeeGmx;\r\n  data.feeGmxSupply = stakingData.feeGmxTracker.totalSupply;\r\n  data.feeGmxSupplyUsd = data.feeGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGmxTrackerRewards = stakingData.stakedGmxTracker.claimable;\r\n  data.stakedGmxTrackerRewardsUsd = stakingData.stakedGmxTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.bonusGmxTrackerRewards = stakingData.bonusGmxTracker.claimable;\r\n\r\n  data.feeGmxTrackerRewards = stakingData.feeGmxTracker.claimable;\r\n  data.feeGmxTrackerRewardsUsd = stakingData.feeGmxTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.boostBasisPoints = bigNumberify(0);\r\n  if (data && data.bnGmxInFeeGmx && data.bonusGmxInFeeGmx && data.bonusGmxInFeeGmx.gt(0)) {\r\n    data.boostBasisPoints = data.bnGmxInFeeGmx.mul(BASIS_POINTS_DIVISOR).div(data.bonusGmxInFeeGmx);\r\n  }\r\n\r\n  data.stakedGmxTrackerAnnualRewardsUsd = stakingData.stakedGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForEsGmx =\r\n    data.stakedGmxTrackerSupplyUsd && data.stakedGmxTrackerSupplyUsd.gt(0)\r\n      ? data.stakedGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.stakedGmxTrackerSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGmxTrackerAnnualRewardsUsd = stakingData.feeGmxTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.gmxAprForNativeToken =\r\n    data.feeGmxSupplyUsd && data.feeGmxSupplyUsd.gt(0)\r\n      ? data.feeGmxTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.feeGmxSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.gmxBoostAprForNativeToken = data.gmxAprForNativeToken.mul(data.boostBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n  data.gmxAprTotal = data.gmxAprForNativeToken.add(data.gmxAprForEsGmx);\r\n  data.gmxAprTotalWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken).add(data.gmxAprForEsGmx);\r\n  data.gmxAprForNativeTokenWithBoost = data.gmxAprForNativeToken.add(data.gmxBoostAprForNativeToken);\r\n\r\n  data.totalGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.feeGmxTrackerRewardsUsd);\r\n\r\n  data.glpSupply = supplyData.glp;\r\n  data.glpPrice =\r\n    data.glpSupply && data.glpSupply.gt(0)\r\n      ? aum.mul(expandDecimals(1, GLP_DECIMALS)).div(data.glpSupply)\r\n      : bigNumberify(0);\r\n\r\n  data.glpSupplyUsd = supplyData.glp.mul(data.glpPrice).div(expandDecimals(1, 18));\r\n\r\n  data.glpBalance = depositBalanceData.glpInStakedGlp;\r\n  data.glpBalanceUsd = depositBalanceData.glpInStakedGlp.mul(data.glpPrice).div(expandDecimals(1, GLP_DECIMALS));\r\n\r\n  data.stakedGlpTrackerRewards = stakingData.stakedGlpTracker.claimable;\r\n  data.stakedGlpTrackerRewardsUsd = stakingData.stakedGlpTracker.claimable.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.feeGlpTrackerRewards = stakingData.feeGlpTracker.claimable;\r\n  data.feeGlpTrackerRewardsUsd = stakingData.feeGlpTracker.claimable.mul(nativeTokenPrice).div(expandDecimals(1, 18));\r\n\r\n  data.stakedGlpTrackerAnnualRewardsUsd = stakingData.stakedGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(gmxPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForEsGmx =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.stakedGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.feeGlpTrackerAnnualRewardsUsd = stakingData.feeGlpTracker.tokensPerInterval\r\n    .mul(SECONDS_PER_YEAR)\r\n    .mul(nativeTokenPrice)\r\n    .div(expandDecimals(1, 18));\r\n  data.glpAprForNativeToken =\r\n    data.glpSupplyUsd && data.glpSupplyUsd.gt(0)\r\n      ? data.feeGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.glpSupplyUsd)\r\n      : bigNumberify(0);\r\n  data.glpAprTotal = data.glpAprForNativeToken.add(data.glpAprForEsGmx);\r\n\r\n  data.totalGlpRewardsUsd = data.stakedGlpTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalEsGmxRewards = data.stakedGmxTrackerRewards.add(data.stakedGlpTrackerRewards);\r\n  data.totalEsGmxRewardsUsd = data.stakedGmxTrackerRewardsUsd.add(data.stakedGlpTrackerRewardsUsd);\r\n\r\n  data.gmxVesterRewards = vestingData.gmxVester.claimable;\r\n  data.glpVesterRewards = vestingData.glpVester.claimable;\r\n  data.totalVesterRewards = data.gmxVesterRewards.add(data.glpVesterRewards);\r\n  data.totalVesterRewardsUsd = data.totalVesterRewards.mul(gmxPrice).div(expandDecimals(1, 18));\r\n\r\n  data.totalNativeTokenRewards = data.feeGmxTrackerRewards.add(data.feeGlpTrackerRewards);\r\n  data.totalNativeTokenRewardsUsd = data.feeGmxTrackerRewardsUsd.add(data.feeGlpTrackerRewardsUsd);\r\n\r\n  data.totalRewardsUsd = data.totalEsGmxRewardsUsd.add(data.totalNativeTokenRewardsUsd).add(data.totalVesterRewardsUsd);\r\n\r\n  return data;\r\n}\r\n\r\nexport async function addTokenToMetamask(token) {\r\n  try {\r\n    const wasAdded = await window.ethereum.request({\r\n      method: \"wallet_watchAsset\",\r\n      params: {\r\n        type: \"ERC20\",\r\n        options: {\r\n          address: token.address,\r\n          symbol: token.symbol,\r\n          decimals: token.decimals,\r\n          image: token.imageUrl,\r\n        },\r\n      },\r\n    });\r\n    if (wasAdded) {\r\n      // https://github.com/MetaMask/metamask-extension/issues/11377\r\n      // We can show a toast message when the token is added to metamask but because of the bug we can't. Once the bug is fixed we can show a toast message.\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nexport function sleep(ms) {\r\n  return new Promise((resolve) => resolve(), ms);\r\n}\r\n\r\nexport function getPageTitle(data) {\r\n  return `${data} | Decentralized\r\n  Perpetual Exchange | GMX`;\r\n}\r\n\r\nexport function isHashZero(value) {\r\n  return value === ethers.constants.HashZero;\r\n}\r\nexport function isAddressZero(value) {\r\n  return value === ethers.constants.AddressZero;\r\n}\r\n\r\nexport function useDebounce(value, delay) {\r\n  // State and setters for debounced value\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n  useEffect(\r\n    () => {\r\n      // Update debounced value after delay\r\n      const handler = setTimeout(() => {\r\n        setDebouncedValue(value);\r\n      }, delay);\r\n      // Cancel the timeout if value changes (also on delay change or unmount)\r\n      // This is how we prevent debounced value from updating if value is changed ...\r\n      // .. within the delay period. Timeout gets cleared and restarted.\r\n      return () => {\r\n        clearTimeout(handler);\r\n      };\r\n    },\r\n    [value, delay] // Only re-call effect if value or delay changes\r\n  );\r\n  return debouncedValue;\r\n}\r\n\r\nexport function isDevelopment() {\r\n  return !window.location.host?.includes(\"gmx.io\") && !window.location.host?.includes(\"ipfs.io\");\r\n}\r\n\r\nexport function isLocal() {\r\n  return window.location.host?.includes(\"localhost\");\r\n}\r\n\r\nexport function getHomeUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3010\";\r\n  }\r\n\r\n  return \"https://gmx.io\";\r\n}\r\n\r\nexport function getAppBaseUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#\";\r\n}\r\n\r\nexport function getRootShareApiUrl() {\r\n  if (isLocal()) {\r\n    return \"https://gmxs.vercel.app\";\r\n  }\r\n\r\n  return \"https://share.gmx.io\";\r\n}\r\n\r\nexport function getTradePageUrl() {\r\n  if (isLocal()) {\r\n    return \"http://localhost:3011/#/trade\";\r\n  }\r\n\r\n  return \"https://app.gmx.io/#/trade\";\r\n}\r\n\r\nexport function importImage(name) {\r\n  let tokenImage = null;\r\n  try {\r\n    tokenImage = require(\"../img/\" + name);\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n  return tokenImage && tokenImage.default;\r\n}\r\n\r\nexport function getTwitterIntentURL(text, url = \"\", hashtag = \"\") {\r\n  let finalURL = \"https://twitter.com/intent/tweet?text=\";\r\n  if (text.length > 0) {\r\n    finalURL += encodeURIComponent(text.replace(/[\\r\\n]+/g, \" \"))\r\n      .replace(/\\*%7C/g, \"*|URL:\")\r\n      .replace(/%7C\\*/g, \"|*\");\r\n\r\n    if (hashtag.length > 0) {\r\n      finalURL += \"&hashtags=\" + encodeURIComponent(hashtag.replace(/#/g, \"\"));\r\n    }\r\n    if (url.length > 0) {\r\n      finalURL += \"&url=\" + encodeURIComponent(url);\r\n    }\r\n  }\r\n  return finalURL;\r\n}\r\n\r\nexport function isValidTimestamp(timestamp) {\r\n  return new Date(timestamp).getTime() > 0;\r\n}\r\n\r\nexport function getPositionForOrder(account, order, positionsMap) {\r\n  const key = getPositionKey(account, order.collateralToken, order.indexToken, order.isLong);\r\n  const position = positionsMap[key];\r\n  return position && position.size && position.size.gt(0) ? position : null;\r\n}\r\n\r\nexport function getOrderError(account, order, positionsMap, position) {\r\n  if (order.type !== DECREASE) {\r\n    return;\r\n  }\r\n\r\n  const positionForOrder = position ? position : getPositionForOrder(account, order, positionsMap);\r\n\r\n  if (!positionForOrder) {\r\n    return \"No open position, order cannot be executed unless a position is opened\";\r\n  }\r\n  if (positionForOrder.size.lt(order.sizeDelta)) {\r\n    return \"Order size is bigger than position, will only be executable if position increases\";\r\n  }\r\n\r\n  if (positionForOrder.size.gt(order.sizeDelta)) {\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(positionForOrder.collateral.sub(order.collateralDelta))) {\r\n      return \"Order cannot be executed as it would reduce the position's leverage below 1\";\r\n    }\r\n    if (positionForOrder.size.sub(order.sizeDelta).lt(expandDecimals(5, USD_DECIMALS))) {\r\n      return \"Order cannot be executed as the remaining position would be smaller than $5.00\";\r\n    }\r\n  }\r\n}\r\n\r\nexport function arrayURLFetcher(...urlArr) {\r\n  const fetcher = (url) => fetch(url).then((res) => res.json());\r\n  return Promise.all(urlArr.map(fetcher));\r\n}\r\n\r\nexport function shouldShowRedirectModal(timestamp) {\r\n  const thirtyDays = 1000 * 60 * 60 * 24 * 30;\r\n  const expiryTime = timestamp + thirtyDays;\r\n  return !isValidTimestamp(timestamp) || Date.now() > expiryTime;\r\n}\r\n","import React from \"react\";\r\nimport cx from \"classnames\";\r\nimport { t } from \"@lingui/macro\";\r\nimport \"./Footer.css\";\r\nimport logoImg from \"../../img/ic_gmx_footer.svg\";\r\nimport twitterIcon from \"../../img/ic_twitter.svg\";\r\nimport discordIcon from \"../../img/ic_discord.svg\";\r\nimport telegramIcon from \"../../img/ic_telegram.svg\";\r\nimport githubIcon from \"../../img/ic_github.svg\";\r\nimport mediumIcon from \"../../img/ic_medium.svg\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { isHomeSite, getAppBaseUrl, shouldShowRedirectModal } from \"../../lib/legacy\";\r\n\r\nconst footerLinks = {\r\n  home: [\r\n    { text: t`Terms and Conditions`, link: \"/terms-and-conditions\" },\r\n    { text: t`Referral Terms`, link: \"/referral-terms\" },\r\n    { text: t`Media Kit`, link: \"https://gmxio.gitbook.io/gmx/media-kit\", external: true },\r\n    // { text: \"Jobs\", link: \"/jobs\", isAppLink: true },\r\n  ],\r\n  app: [\r\n    { text: t`Media Kit`, link: \"https://gmxio.gitbook.io/gmx/media-kit\", external: true },\r\n    // { text: \"Jobs\", link: \"/jobs\" },\r\n  ],\r\n};\r\n\r\nconst socialLinks = [\r\n  { link: \"https://twitter.com/GMX_IO\", name: \"Twitter\", icon: twitterIcon },\r\n  { link: \"https://medium.com/@gmx.io\", name: \"Medium\", icon: mediumIcon },\r\n  { link: \"https://github.com/gmx-io\", name: \"Github\", icon: githubIcon },\r\n  { link: \"https://t.me/GMX_IO\", name: \"Telegram\", icon: telegramIcon },\r\n  { link: \"https://discord.gg/cxjZYR4gQK\", name: \"Discord\", icon: discordIcon },\r\n];\r\n\r\nexport default function Footer({ showRedirectModal, redirectPopupTimestamp }) {\r\n  const isHome = isHomeSite();\r\n\r\n  return (\r\n    <div className=\"Footer\">\r\n      <div className={cx(\"Footer-wrapper\", { home: isHome })}>\r\n        <div className=\"Footer-logo\">\r\n          <img src={logoImg} alt=\"MetaMask\" />\r\n        </div>\r\n        <div className=\"Footer-social-link-block\">\r\n          {socialLinks.map((platform) => {\r\n            return (\r\n              <a\r\n                key={platform.name}\r\n                className=\"App-social-link\"\r\n                href={platform.link}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                <img src={platform.icon} alt={platform.name} />\r\n              </a>\r\n            );\r\n          })}\r\n        </div>\r\n        <div className=\"Footer-links\">\r\n          {footerLinks[isHome ? \"home\" : \"app\"].map(({ external, text, link, isAppLink }) => {\r\n            if (external) {\r\n              return (\r\n                <a key={text} target=\"_blank\" href={link} className=\"Footer-link\" rel=\"noopener noreferrer\">\r\n                  {text}\r\n                </a>\r\n              );\r\n            }\r\n            if (isAppLink) {\r\n              if (shouldShowRedirectModal(redirectPopupTimestamp)) {\r\n                return (\r\n                  <div key={text} className=\"Footer-link a\" onClick={() => showRedirectModal(link)}>\r\n                    {text}\r\n                  </div>\r\n                );\r\n              } else {\r\n                const baseUrl = getAppBaseUrl();\r\n                return (\r\n                  <a key={text} href={baseUrl + link} className=\"Footer-link\">\r\n                    {text}\r\n                  </a>\r\n                );\r\n              }\r\n            }\r\n            return (\r\n              <NavLink key={link} to={link} className=\"Footer-link\" activeClassName=\"active\">\r\n                {text}\r\n              </NavLink>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { ethers } from \"ethers\";\r\n\r\nimport { MAINNET, TESTNET, ARBITRUM_TESTNET, ARBITRUM, AVALANCHE } from \"../lib/legacy\";\r\n\r\nconst { parseEther } = ethers.utils;\r\n\r\nconst constants = {\r\n  [MAINNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [TESTNET]: {\r\n    nativeTokenSymbol: \"BNB\",\r\n    defaultCollateralSymbol: \"BUSD\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 8,\r\n    v2: false,\r\n  },\r\n\r\n  [ARBITRUM_TESTNET]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [ARBITRUM]: {\r\n    nativeTokenSymbol: \"ETH\",\r\n    wrappedTokenSymbol: \"WETH\",\r\n    defaultCollateralSymbol: \"USDC\",\r\n    defaultFlagOrdersEnabled: false,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0003\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.000300001\"),\r\n  },\r\n\r\n  [AVALANCHE]: {\r\n    nativeTokenSymbol: \"AVAX\",\r\n    wrappedTokenSymbol: \"WAVAX\",\r\n    defaultCollateralSymbol: \"MIM\",\r\n    defaultFlagOrdersEnabled: true,\r\n    positionReaderPropsLength: 9,\r\n    v2: true,\r\n\r\n    SWAP_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    INCREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.01\"),\r\n    // contract requires that execution fee be strictly greater than instead of gte\r\n    DECREASE_ORDER_EXECUTION_GAS_FEE: parseEther(\"0.0100001\"),\r\n  },\r\n};\r\n\r\nexport const getConstant = (chainId, key) => {\r\n  if (!constants[chainId]) {\r\n    throw new Error(`Unsupported chainId ${chainId}`);\r\n  }\r\n  if (!(key in constants[chainId])) {\r\n    throw new Error(`Key ${key} does not exist for chainId ${chainId}`);\r\n  }\r\n  return constants[chainId][key];\r\n};\r\n","import { ApolloClient, InMemoryCache } from \"@apollo/client\";\r\n\r\nexport const chainlinkClient = createClient(\"https://api.thegraph.com/subgraphs/name/deividask/chainlink\");\r\nexport const arbitrumGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-stats\");\r\nexport const avalancheGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-stats\");\r\nexport const nissohGraphClient = createClient(\"https://api.thegraph.com/subgraphs/name/nissoh/gmx-vault\");\r\nexport const arbitrumReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-arbitrum-referrals\"\r\n);\r\nexport const avalancheReferralsGraphClient = createClient(\r\n  \"https://api.thegraph.com/subgraphs/name/gmx-io/gmx-avalanche-referrals\"\r\n);\r\n\r\nfunction createClient(uri) {\r\n  return new ApolloClient({\r\n    uri,\r\n    cache: new InMemoryCache(),\r\n  });\r\n}\r\n\r\nexport function get1InchSwapUrl(chainId, from, to) {\r\n  const rootUrl = `https://app.1inch.io/#/${chainId}/unified/swap`;\r\n  if (!from && !to) return rootUrl;\r\n  return `${rootUrl}/${from}/${to}`;\r\n}\r\n","// prettier-ignore\r\nimport {ethers} from \"ethers\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\nimport { getFallbackProvider, getProvider } from \"../legacy\";\r\n\r\nexport const fetcher =\r\n  (library: Web3Provider, contractInfo: any, additionalArgs: any[]) =>\r\n  (...args: any) => {\r\n    // eslint-disable-next-line\r\n    const [id, chainId, arg0, arg1, ...params] = args;\r\n    const provider = getProvider(library, chainId);\r\n\r\n    const method = ethers.utils.isAddress(arg0) ? arg1 : arg0;\r\n\r\n    const contractCall = getContractCall({\r\n      provider,\r\n      contractInfo,\r\n      arg0,\r\n      arg1,\r\n      method,\r\n      params,\r\n      additionalArgs,\r\n    });\r\n\r\n    let shouldCallFallback = true;\r\n\r\n    const handleFallback = async (resolve, reject, error) => {\r\n      if (!shouldCallFallback) {\r\n        return;\r\n      }\r\n      // prevent fallback from being called twice\r\n      shouldCallFallback = false;\r\n\r\n      const fallbackProvider = getFallbackProvider(chainId);\r\n      if (!fallbackProvider) {\r\n        reject(error);\r\n        return;\r\n      }\r\n\r\n      console.info(\"using fallbackProvider for\", method);\r\n      const fallbackContractCall = getContractCall({\r\n        provider: fallbackProvider,\r\n        contractInfo,\r\n        arg0,\r\n        arg1,\r\n        method,\r\n        params,\r\n        additionalArgs,\r\n      });\r\n\r\n      fallbackContractCall\r\n        .then((result) => resolve(result))\r\n        .catch((e) => {\r\n          console.error(\"fallback fetcher error\", id, contractInfo.contractName, method, e);\r\n          reject(e);\r\n        });\r\n    };\r\n\r\n    return new Promise(async (resolve, reject) => {\r\n      contractCall\r\n        .then((result) => {\r\n          shouldCallFallback = false;\r\n          resolve(result);\r\n        })\r\n        .catch((e) => {\r\n          console.error(\"fetcher error\", id, contractInfo.contractName, method, e);\r\n          handleFallback(resolve, reject, e);\r\n        });\r\n\r\n      setTimeout(() => {\r\n        handleFallback(resolve, reject, \"contractCall timeout\");\r\n      }, 2000);\r\n    });\r\n  };\r\n\r\nfunction getContractCall({ provider, contractInfo, arg0, arg1, method, params, additionalArgs }) {\r\n  if (ethers.utils.isAddress(arg0)) {\r\n    const address = arg0;\r\n    const contract = new ethers.Contract(address, contractInfo.abi, provider);\r\n\r\n    if (additionalArgs) {\r\n      return contract[method](...params.concat(additionalArgs));\r\n    }\r\n    return contract[method](...params);\r\n  }\r\n\r\n  if (!provider) {\r\n    return;\r\n  }\r\n\r\n  return provider[method](arg1, ...params);\r\n}\r\n","import { toast, ToastContent, ToastOptions } from \"react-toastify\";\r\n\r\nexport const helperToast = {\r\n  success: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.success(content, opts);\r\n  },\r\n  error: (content: ToastContent, opts?: ToastOptions) => {\r\n    toast.dismiss();\r\n    toast.error(content, opts);\r\n  },\r\n};\r\n","import { useState } from \"react\";\r\n\r\nexport function ToastifyDebug(props) {\r\n  const [open, setOpen] = useState(false);\r\n  return (\r\n    <div className=\"Toastify-debug\">\r\n      <span className=\"Toastify-debug-button\" onClick={() => setOpen((old) => !old)}>\r\n        {open ? \"Hide error\" : \"Show error\"}\r\n      </span>\r\n      {open && <div className=\"Toastify-debug-content\">{props.children}</div>}\r\n    </div>\r\n  );\r\n}\r\n","export const NOT_ENOUGH_FUNDS = \"NOT_ENOUGH_FUNDS\";\r\nexport const USER_DENIED = \"USER_DENIED\";\r\nexport const SLIPPAGE = \"SLIPPAGE\";\r\nexport const RPC_ERROR = \"RPC_ERROR\";\r\n\r\ntype ErrorPattern = { msg?: string; code?: number };\r\n\r\nconst TX_ERROR_PATTERNS: { [key: string]: ErrorPattern[] } = {\r\n  [NOT_ENOUGH_FUNDS]: [\r\n    { msg: \"not enough funds for gas\" },\r\n    { msg: \"failed to execute call with revert code InsufficientGasFunds\" },\r\n  ],\r\n  [USER_DENIED]: [{ msg: \"User denied transaction signature\" }],\r\n  [SLIPPAGE]: [{ msg: \"Router: mark price lower than limit\" }, { msg: \"Router: mark price higher than limit\" }],\r\n  [RPC_ERROR]: [\r\n    // @see https://eips.ethereum.org/EIPS/eip-1474#error-codes\r\n    { code: -32005 },\r\n    { msg: \"Non-200 status code\" },\r\n    { msg: \"Request limit exceeded\" },\r\n    { msg: \"Internal JSON-RPC error\" },\r\n    { msg: \"Response has no error or result\" },\r\n    { msg: \"couldn't connect to the network\" },\r\n  ],\r\n};\r\n\r\ntype TxError = {\r\n  message?: string;\r\n  code?: number;\r\n  data?: any;\r\n};\r\n\r\nexport function extractError(ex: TxError) {\r\n  if (!ex) {\r\n    return [];\r\n  }\r\n\r\n  const message = ex.data?.message || ex.message;\r\n  const code = ex.code;\r\n\r\n  if (!message && !code) {\r\n    return [];\r\n  }\r\n\r\n  for (const [type, patterns] of Object.entries(TX_ERROR_PATTERNS)) {\r\n    for (const pattern of patterns) {\r\n      const matchCode = pattern.code && code === pattern.code;\r\n      const matchMessage = pattern.msg && message && message.includes(pattern.msg);\r\n\r\n      if (matchCode || matchMessage) {\r\n        return [message, type, ex.data];\r\n      }\r\n    }\r\n  }\r\n\r\n  return [message, null, ex.data];\r\n}\r\n","import { ARBITRUM, AVALANCHE } from \"../legacy\";\r\n\r\nexport const GAS_PRICE_ADJUSTMENT_MAP = {\r\n  [ARBITRUM]: \"0\",\r\n  [AVALANCHE]: \"3000000000\", // 3 gwei\r\n};\r\n\r\nexport const MAX_GAS_PRICE_MAP = {\r\n  [AVALANCHE]: \"200000000000\", // 200 gwei\r\n};\r\n","import { bigNumberify } from \"../legacy\";\r\nimport { GAS_PRICE_ADJUSTMENT_MAP, MAX_GAS_PRICE_MAP } from \"./constants\";\r\nimport { Provider } from \"@ethersproject/providers\";\r\nimport { Contract } from \"ethers\";\r\n\r\nexport async function setGasPrice(txnOpts: any, provider: Provider, chainId: number) {\r\n  let maxGasPrice = MAX_GAS_PRICE_MAP[chainId];\r\n  const premium = GAS_PRICE_ADJUSTMENT_MAP[chainId] || bigNumberify(0);\r\n\r\n  const gasPrice = await provider.getGasPrice();\r\n\r\n  if (maxGasPrice) {\r\n    if (gasPrice.gt(maxGasPrice)) {\r\n      maxGasPrice = gasPrice;\r\n    }\r\n\r\n    const feeData = await provider.getFeeData();\r\n\r\n    // the wallet provider might not return maxPriorityFeePerGas in feeData\r\n    // in which case we should fallback to the usual getGasPrice flow handled below\r\n    if (feeData && feeData.maxPriorityFeePerGas) {\r\n      txnOpts.maxFeePerGas = maxGasPrice;\r\n      txnOpts.maxPriorityFeePerGas = feeData.maxPriorityFeePerGas.add(premium);\r\n      return;\r\n    }\r\n  }\r\n\r\n  txnOpts.gasPrice = gasPrice.add(premium);\r\n  return;\r\n}\r\n\r\nexport async function getGasLimit(contract: Contract, method, params = [], value) {\r\n  const defaultValue = bigNumberify(0);\r\n\r\n  if (!value) {\r\n    value = defaultValue;\r\n  }\r\n\r\n  let gasLimit = await contract.estimateGas[method](...params, { value });\r\n\r\n  if (gasLimit.lt(22000)) {\r\n    gasLimit = bigNumberify(22000)!;\r\n  }\r\n\r\n  return gasLimit.mul(11000).div(10000); // add a 10% buffer\r\n}\r\n","import { BigNumber, Contract } from \"ethers\";\r\nimport { helperToast } from \"../helperToast\";\r\nimport { ToastifyDebug } from \"../../components/ToastifyDebug/ToastifyDebug\";\r\nimport { extractError, NOT_ENOUGH_FUNDS, RPC_ERROR, SLIPPAGE, USER_DENIED } from \"./transactionErrors\";\r\nimport { getExplorerUrl } from \"../legacy\";\r\nimport { getGasLimit, setGasPrice } from \"./utils\";\r\n\r\nexport async function callContract(\r\n  chainId: number,\r\n  contract: Contract,\r\n  method: string,\r\n  params: any,\r\n  opts: {\r\n    value?: BigNumber | number;\r\n    gasLimit?: BigNumber | number;\r\n    sentMsg?: string;\r\n    successMsg?: string;\r\n    hideSuccessMsg?: boolean;\r\n    failMsg?: string;\r\n    setPendingTxns?: (txns: any) => void;\r\n  }\r\n) {\r\n  try {\r\n    if (!Array.isArray(params) && typeof params === \"object\" && opts === undefined) {\r\n      opts = params;\r\n      params = [];\r\n    }\r\n\r\n    if (!opts) {\r\n      opts = {};\r\n    }\r\n\r\n    const txnOpts: any = {};\r\n\r\n    if (opts.value) {\r\n      txnOpts.value = opts.value;\r\n    }\r\n\r\n    txnOpts.gasLimit = opts.gasLimit ? opts.gasLimit : await getGasLimit(contract, method, params, opts.value);\r\n\r\n    await setGasPrice(txnOpts, contract.provider, chainId);\r\n\r\n    const res = await contract[method](...params, txnOpts);\r\n    const txUrl = getExplorerUrl(chainId) + \"tx/\" + res.hash;\r\n    const sentMsg = opts.sentMsg || \"Transaction sent.\";\r\n\r\n    helperToast.success(\r\n      <div>\r\n        {sentMsg}{\" \"}\r\n        <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n          View status.\r\n        </a>\r\n        <br />\r\n      </div>\r\n    );\r\n\r\n    if (opts.setPendingTxns) {\r\n      const message = opts.hideSuccessMsg ? undefined : opts.successMsg || \"Transaction completed!\";\r\n      const pendingTxn = {\r\n        hash: res.hash,\r\n        message,\r\n      };\r\n      opts.setPendingTxns((pendingTxns) => [...pendingTxns, pendingTxn]);\r\n    }\r\n    return res;\r\n  } catch (e) {\r\n    let failMsg;\r\n\r\n    let autoCloseToast: number | boolean = 5000;\r\n\r\n    const [message, type, errorData] = extractError(e);\r\n    switch (type) {\r\n      case NOT_ENOUGH_FUNDS:\r\n        failMsg = (\r\n          <div>\r\n            There is not enough ETH in your account on Arbitrum to send this transaction.\r\n            <br />\r\n            <br />\r\n            <a href={\"https://arbitrum.io/bridge-tutorial/\"} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              Bridge ETH to Arbitrum\r\n            </a>\r\n          </div>\r\n        );\r\n        break;\r\n      case USER_DENIED:\r\n        failMsg = \"Transaction was cancelled.\";\r\n        break;\r\n      case SLIPPAGE:\r\n        failMsg =\r\n          'The mark price has changed, consider increasing your Allowed Slippage by clicking on the \"...\" icon next to your address.';\r\n        break;\r\n      case RPC_ERROR:\r\n        autoCloseToast = false;\r\n\r\n        const originalError = errorData?.error?.message || errorData?.message || message;\r\n\r\n        failMsg = (\r\n          <div>\r\n            Transaction failed due to RPC error.\r\n            <br />\r\n            <br />\r\n            Please try changing the RPC url in your wallet settings.{\" \"}\r\n            <a href=\"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              More info\r\n            </a>\r\n            <br />\r\n            {originalError && <ToastifyDebug>{originalError}</ToastifyDebug>}\r\n          </div>\r\n        );\r\n        break;\r\n      default:\r\n        autoCloseToast = false;\r\n\r\n        failMsg = (\r\n          <div>\r\n            {opts.failMsg || \"Transaction failed\"}\r\n            <br />\r\n            {message && <ToastifyDebug>{message}</ToastifyDebug>}\r\n          </div>\r\n        );\r\n    }\r\n\r\n    helperToast.error(failMsg, { autoClose: autoCloseToast });\r\n    throw e;\r\n  }\r\n}\r\n","import { useMemo } from \"react\";\r\nimport { gql } from \"@apollo/client\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { USD_DECIMALS, CHART_PERIODS, formatAmount, sleep } from \"../lib/legacy\";\r\nimport { chainlinkClient } from \"./common\";\r\n\r\nconst BigNumber = ethers.BigNumber;\r\n\r\n// Ethereum network, Chainlink Aggregator contracts\r\nconst FEED_ID_MAP = {\r\n  BTC_USD: \"0xae74faa92cb67a95ebcab07358bc222e33a34da7\",\r\n  ETH_USD: \"0x37bc7498f4ff12c19678ee8fe19d713b87f6a9e6\",\r\n  BNB_USD: \"0xc45ebd0f901ba6b2b8c7e70b717778f055ef5e6d\",\r\n  LINK_USD: \"0xdfd03bfc3465107ce570a0397b247f546a42d0fa\",\r\n  UNI_USD: \"0x68577f915131087199fe48913d8b416b3984fd38\",\r\n  SUSHI_USD: \"0x7213536a36094cd8a768a5e45203ec286cba2d74\",\r\n  AVAX_USD: \"0x0fc3657899693648bba4dbd2d8b33b82e875105d\",\r\n  AAVE_USD: \"0xe3f0dede4b499c07e12475087ab1a084b5f93bc0\",\r\n  YFI_USD: \"0x8a4d74003870064d41d4f84940550911fbfccf04\",\r\n  SPELL_USD: \"0x8640b23468815902e011948f3ab173e1e83f9879\",\r\n};\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nfunction fillGaps(prices, periodSeconds) {\r\n  if (prices.length < 2) {\r\n    return prices;\r\n  }\r\n\r\n  const newPrices = [prices[0]];\r\n  let prevTime = prices[0].time;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const { time, open } = prices[i];\r\n    if (prevTime) {\r\n      let j = (time - prevTime) / periodSeconds - 1;\r\n      while (j > 0) {\r\n        newPrices.push({\r\n          time: time - j * periodSeconds,\r\n          open,\r\n          close: open,\r\n          high: open * 1.0003,\r\n          low: open * 0.9996,\r\n        });\r\n        j--;\r\n      }\r\n    }\r\n\r\n    prevTime = time;\r\n    newPrices.push(prices[i]);\r\n  }\r\n\r\n  return newPrices;\r\n}\r\n\r\nasync function getChartPricesFromStats(chainId, symbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(symbol)) {\r\n    symbol = symbol.substr(1);\r\n  } else if (symbol === \"BTC.b\") {\r\n    symbol = \"BTC\";\r\n  }\r\n  const hostname = \"https://stats.gmx.io/\";\r\n  // const hostname = 'http://localhost:3113/'\r\n  const timeDiff = CHART_PERIODS[period] * 3000;\r\n  const from = Math.floor(Date.now() / 1000 - timeDiff);\r\n  const url = `${hostname}api/candles/${symbol}?preferableChainId=${chainId}&period=${period}&from=${from}&preferableSource=fast`;\r\n  const TIMEOUT = 5000;\r\n  const res = await new Promise(async (resolve, reject) => {\r\n    let done = false;\r\n    setTimeout(() => {\r\n      done = true;\r\n      reject(new Error(`request timeout ${url}`));\r\n    }, TIMEOUT);\r\n\r\n    let lastEx;\r\n    for (let i = 0; i < 3; i++) {\r\n      if (done) return;\r\n      try {\r\n        const res = await fetch(url);\r\n        resolve(res);\r\n        return;\r\n      } catch (ex) {\r\n        await sleep(300);\r\n        lastEx = ex;\r\n      }\r\n    }\r\n    reject(lastEx);\r\n  });\r\n  if (!res.ok) {\r\n    throw new Error(`request failed ${res.status} ${res.statusText}`);\r\n  }\r\n  const json = await res.json();\r\n  let prices = json?.prices;\r\n  if (!prices || prices.length < 10) {\r\n    throw new Error(`not enough prices data: ${prices?.length}`);\r\n  }\r\n\r\n  const OBSOLETE_THRESHOLD = Date.now() / 1000 - 60 * 30; // 30 min ago\r\n  const updatedAt = json?.updatedAt || 0;\r\n  if (updatedAt < OBSOLETE_THRESHOLD) {\r\n    throw new Error(\r\n      \"chart data is obsolete, last price record at \" +\r\n        new Date(updatedAt * 1000).toISOString() +\r\n        \" now: \" +\r\n        new Date().toISOString()\r\n    );\r\n  }\r\n\r\n  prices = prices.map(({ t, o: open, c: close, h: high, l: low }) => ({\r\n    time: t + timezoneOffset,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n  return prices;\r\n}\r\n\r\nfunction getCandlesFromPrices(prices, period) {\r\n  const periodTime = CHART_PERIODS[period];\r\n\r\n  if (prices.length < 2) {\r\n    return [];\r\n  }\r\n\r\n  const candles = [];\r\n  const first = prices[0];\r\n  let prevTsGroup = Math.floor(first[0] / periodTime) * periodTime;\r\n  let prevPrice = first[1];\r\n  let o = prevPrice;\r\n  let h = prevPrice;\r\n  let l = prevPrice;\r\n  let c = prevPrice;\r\n  for (let i = 1; i < prices.length; i++) {\r\n    const [ts, price] = prices[i];\r\n    const tsGroup = Math.floor(ts / periodTime) * periodTime;\r\n    if (prevTsGroup !== tsGroup) {\r\n      candles.push({ t: prevTsGroup + timezoneOffset, o, h, l, c });\r\n      o = c;\r\n      h = Math.max(o, c);\r\n      l = Math.min(o, c);\r\n    }\r\n    c = price;\r\n    h = Math.max(h, price);\r\n    l = Math.min(l, price);\r\n    prevTsGroup = tsGroup;\r\n  }\r\n\r\n  return candles.map(({ t: time, o: open, c: close, h: high, l: low }) => ({\r\n    time,\r\n    open,\r\n    close,\r\n    high,\r\n    low,\r\n  }));\r\n}\r\n\r\nfunction getChainlinkChartPricesFromGraph(tokenSymbol, period) {\r\n  if ([\"WBTC\", \"WETH\", \"WAVAX\"].includes(tokenSymbol)) {\r\n    tokenSymbol = tokenSymbol.substr(1);\r\n  }\r\n  const marketName = tokenSymbol + \"_USD\";\r\n  const feedId = FEED_ID_MAP[marketName];\r\n  if (!feedId) {\r\n    throw new Error(`undefined marketName ${marketName}`);\r\n  }\r\n\r\n  const PER_CHUNK = 1000;\r\n  const CHUNKS_TOTAL = 6;\r\n  const requests = [];\r\n  for (let i = 0; i < CHUNKS_TOTAL; i++) {\r\n    const query = gql(`{\r\n      rounds(\r\n        first: ${PER_CHUNK},\r\n        skip: ${i * PER_CHUNK},\r\n        orderBy: unixTimestamp,\r\n        orderDirection: desc,\r\n        where: {feed: \"${feedId}\"}\r\n      ) {\r\n        unixTimestamp,\r\n        value\r\n      }\r\n    }`);\r\n    requests.push(chainlinkClient.query({ query }));\r\n  }\r\n\r\n  return Promise.all(requests)\r\n    .then((chunks) => {\r\n      let prices = [];\r\n      const uniqTs = new Set();\r\n      chunks.forEach((chunk) => {\r\n        chunk.data.rounds.forEach((item) => {\r\n          if (uniqTs.has(item.unixTimestamp)) {\r\n            return;\r\n          }\r\n\r\n          uniqTs.add(item.unixTimestamp);\r\n          prices.push([item.unixTimestamp, Number(item.value) / 1e8]);\r\n        });\r\n      });\r\n\r\n      prices.sort(([timeA], [timeB]) => timeA - timeB);\r\n      prices = getCandlesFromPrices(prices, period);\r\n      return prices;\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n    });\r\n}\r\n\r\nexport function useChartPrices(chainId, symbol, isStable, period, currentAveragePrice) {\r\n  const swrKey = !isStable && symbol ? [\"getChartCandles\", chainId, symbol, period] : null;\r\n  let { data: prices, mutate: updatePrices } = useSWR(swrKey, {\r\n    fetcher: async (...args) => {\r\n      try {\r\n        return await getChartPricesFromStats(chainId, symbol, period);\r\n      } catch (ex) {\r\n        console.warn(ex);\r\n        console.warn(\"Switching to graph chainlink data\");\r\n        try {\r\n          return await getChainlinkChartPricesFromGraph(symbol, period);\r\n        } catch (ex2) {\r\n          console.warn(\"getChainlinkChartPricesFromGraph failed\");\r\n          console.warn(ex2);\r\n          return [];\r\n        }\r\n      }\r\n    },\r\n    dedupingInterval: 60000,\r\n    focusThrottleInterval: 60000 * 10,\r\n  });\r\n\r\n  const currentAveragePriceString = currentAveragePrice && currentAveragePrice.toString();\r\n  const retPrices = useMemo(() => {\r\n    if (isStable) {\r\n      return getStablePriceData(period);\r\n    }\r\n\r\n    if (!prices) {\r\n      return [];\r\n    }\r\n\r\n    let _prices = [...prices];\r\n    if (currentAveragePriceString && prices.length) {\r\n      _prices = appendCurrentAveragePrice(_prices, BigNumber.from(currentAveragePriceString), period);\r\n    }\r\n\r\n    return fillGaps(_prices, CHART_PERIODS[period]);\r\n  }, [prices, isStable, currentAveragePriceString, period]);\r\n\r\n  return [retPrices, updatePrices];\r\n}\r\n\r\nfunction appendCurrentAveragePrice(prices, currentAveragePrice, period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const currentCandleTime = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds + timezoneOffset;\r\n  const last = prices[prices.length - 1];\r\n  const averagePriceValue = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n  if (currentCandleTime === last.time) {\r\n    last.close = averagePriceValue;\r\n    last.high = Math.max(last.high, averagePriceValue);\r\n    last.low = Math.max(last.low, averagePriceValue);\r\n    return prices;\r\n  } else {\r\n    const newCandle = {\r\n      time: currentCandleTime,\r\n      open: last.close,\r\n      close: averagePriceValue,\r\n      high: averagePriceValue,\r\n      low: averagePriceValue,\r\n    };\r\n    return [...prices, newCandle];\r\n  }\r\n}\r\n\r\nfunction getStablePriceData(period) {\r\n  const periodSeconds = CHART_PERIODS[period];\r\n  const now = Math.floor(Date.now() / 1000 / periodSeconds) * periodSeconds;\r\n  let priceData = [];\r\n  for (let i = 100; i > 0; i--) {\r\n    priceData.push({\r\n      time: now - i * periodSeconds,\r\n      open: 1,\r\n      close: 1,\r\n      high: 1,\r\n      low: 1,\r\n    });\r\n  }\r\n  return priceData;\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Token as UniToken } from \"@uniswap/sdk-core\";\r\nimport { Pool } from \"@uniswap/v3-sdk\";\r\nimport useSWR from \"swr\";\r\n\r\nimport OrderBook from \"../abis/OrderBook.json\";\r\nimport PositionManager from \"../abis/PositionManager.json\";\r\nimport Vault from \"../abis/Vault.json\";\r\nimport Router from \"../abis/Router.json\";\r\nimport UniPool from \"../abis/UniPool.json\";\r\nimport UniswapV2 from \"../abis/UniswapV2.json\";\r\nimport Token from \"../abis/Token.json\";\r\nimport VaultReader from \"../abis/VaultReader.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { getConstant } from \"../config/chains\";\r\nimport {\r\n  ARBITRUM,\r\n  ARBITRUM_TESTNET,\r\n  AVALANCHE,\r\n  bigNumberify,\r\n  DECREASE,\r\n  expandDecimals,\r\n  getHighExecutionFee,\r\n  getInfoTokens,\r\n  getOrderKey,\r\n  getProvider,\r\n  getServerBaseUrl,\r\n  getServerUrl,\r\n  getUsd,\r\n  INCREASE,\r\n  parseValue,\r\n  replaceNativeTokenAddress,\r\n  SWAP,\r\n  UI_VERSION,\r\n  USD_DECIMALS,\r\n} from \"../lib/legacy\";\r\nimport { getTokenBySymbol, getTokens, getWhitelistedTokens } from \"../config/Tokens\";\r\n\r\nimport { arbitrumGraphClient, avalancheGraphClient, nissohGraphClient } from \"./common\";\r\nimport { groupBy } from \"lodash\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\n\r\nexport * from \"./prices\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getGmxGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheGraphClient;\r\n  } else if (chainId === ARBITRUM_TESTNET) {\r\n    return null;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function useAllOrdersStats(chainId) {\r\n  const query = gql(`{\r\n    orderStat(id: \"total\") {\r\n      openSwap\r\n      openIncrease\r\n      openDecrease\r\n      executedSwap\r\n      executedIncrease\r\n      executedDecrease\r\n      cancelledSwap\r\n      cancelledIncrease\r\n      cancelledDecrease\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    const graphClient = getGmxGraphClient(chainId);\r\n    if (graphClient) {\r\n      graphClient.query({ query }).then(setRes).catch(console.warn);\r\n    }\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.orderStat : null;\r\n}\r\n\r\nexport function useInfoTokens(library, chainId, active, tokenBalances, fundingRateInfo, vaultPropsLength) {\r\n  const tokens = getTokens(chainId);\r\n  const vaultReaderAddress = getContract(chainId, \"VaultReader\");\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n\r\n  const { data: vaultTokenInfo } = useSWR(\r\n    [`useInfoTokens:${active}`, chainId, vaultReaderAddress, \"getVaultTokenInfoV4\"],\r\n    {\r\n      fetcher: fetcher(library, VaultReader, [\r\n        vaultAddress,\r\n        positionRouterAddress,\r\n        nativeTokenAddress,\r\n        expandDecimals(1, 18),\r\n        whitelistedTokenAddresses,\r\n      ]),\r\n    }\r\n  );\r\n\r\n  const indexPricesUrl = getServerUrl(chainId, \"/prices\");\r\n  const { data: indexPrices } = useSWR([indexPricesUrl], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n    refreshInterval: 500,\r\n    refreshWhenHidden: true,\r\n  });\r\n\r\n  return {\r\n    infoTokens: getInfoTokens(\r\n      tokens,\r\n      tokenBalances,\r\n      whitelistedTokens,\r\n      vaultTokenInfo,\r\n      fundingRateInfo,\r\n      vaultPropsLength,\r\n      indexPrices,\r\n      nativeTokenAddress\r\n    ),\r\n  };\r\n}\r\n\r\nexport function useUserStat(chainId) {\r\n  const query = gql(`{\r\n    userStat(id: \"total\") {\r\n      id\r\n      uniqueCount\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query, chainId]);\r\n\r\n  return res ? res.data.userStat : null;\r\n}\r\n\r\nexport function useLiquidationsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  useEffect(() => {\r\n    if (account) {\r\n      const query = gql(`{\r\n         liquidatedPositions(\r\n           where: {account: \"${account.toLowerCase()}\"}\r\n           first: 100\r\n           orderBy: timestamp\r\n           orderDirection: desc\r\n         ) {\r\n           key\r\n           timestamp\r\n           borrowFee\r\n           loss\r\n           collateral\r\n           size\r\n           markPrice\r\n           type\r\n         }\r\n      }`);\r\n      const graphClient = getGmxGraphClient(chainId);\r\n      if (!graphClient) {\r\n        return;\r\n      }\r\n\r\n      graphClient\r\n        .query({ query })\r\n        .then((res) => {\r\n          const _data = res.data.liquidatedPositions.map((item) => {\r\n            return {\r\n              ...item,\r\n              size: bigNumberify(item.size),\r\n              collateral: bigNumberify(item.collateral),\r\n              markPrice: bigNumberify(item.markPrice),\r\n            };\r\n          });\r\n          setData(_data);\r\n        })\r\n        .catch(console.warn);\r\n    }\r\n  }, [setData, chainId, account]);\r\n\r\n  return data;\r\n}\r\n\r\nexport function useAllPositions(chainId, library) {\r\n  const count = 1000;\r\n  const query = gql(`{\r\n    aggregatedTradeOpens(\r\n      first: ${count}\r\n    ) {\r\n      account\r\n      initialPosition{\r\n        indexToken\r\n        collateralToken\r\n        isLong\r\n        sizeDelta\r\n      }\r\n      increaseList {\r\n        sizeDelta\r\n      }\r\n      decreaseList {\r\n        sizeDelta\r\n      }\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    nissohGraphClient.query({ query }).then(setRes).catch(console.warn);\r\n  }, [setRes, query]);\r\n\r\n  const key = res ? `allPositions${count}__` : false;\r\n  const { data: positions = [] } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const ret = await Promise.all(\r\n      res.data.aggregatedTradeOpens.map(async (dataItem) => {\r\n        try {\r\n          const { indexToken, collateralToken, isLong } = dataItem.initialPosition;\r\n          const positionData = await contract.getPosition(dataItem.account, collateralToken, indexToken, isLong);\r\n          const position = {\r\n            size: bigNumberify(positionData[0]),\r\n            collateral: bigNumberify(positionData[1]),\r\n            entryFundingRate: bigNumberify(positionData[3]),\r\n            account: dataItem.account,\r\n          };\r\n          position.fundingFee = await contract.getFundingFee(collateralToken, position.size, position.entryFundingRate);\r\n          position.marginFee = position.size.div(1000);\r\n          position.fee = position.fundingFee.add(position.marginFee);\r\n\r\n          const THRESHOLD = 5000;\r\n          const collateralDiffPercent = position.fee.mul(10000).div(position.collateral);\r\n          position.danger = collateralDiffPercent.gt(THRESHOLD);\r\n\r\n          return position;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n\r\n    return ret.filter(Boolean);\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nexport function useAllOrders(chainId, library) {\r\n  const query = gql(`{\r\n    orders(\r\n      first: 1000,\r\n      orderBy: createdTimestamp,\r\n      orderDirection: desc,\r\n      where: {status: \"open\"}\r\n    ) {\r\n      type\r\n      account\r\n      index\r\n      status\r\n      createdTimestamp\r\n    }\r\n  }`);\r\n\r\n  const [res, setRes] = useState();\r\n\r\n  useEffect(() => {\r\n    getGmxGraphClient(chainId).query({ query }).then(setRes);\r\n  }, [setRes, query, chainId]);\r\n\r\n  const key = res ? res.data.orders.map((order) => `${order.type}-${order.account}-${order.index}`) : null;\r\n  const { data: orders = [] } = useSWR(key, () => {\r\n    const provider = getProvider(library, chainId);\r\n    const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n    const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, provider);\r\n    return Promise.all(\r\n      res.data.orders.map(async (order) => {\r\n        try {\r\n          const type = order.type.charAt(0).toUpperCase() + order.type.substring(1);\r\n          const method = `get${type}Order`;\r\n          const orderFromChain = await contract[method](order.account, order.index);\r\n          const ret = {};\r\n          for (const [key, val] of Object.entries(orderFromChain)) {\r\n            ret[key] = val;\r\n          }\r\n          if (order.type === \"swap\") {\r\n            ret.path = [ret.path0, ret.path1, ret.path2].filter((address) => address !== AddressZero);\r\n          }\r\n          ret.type = type;\r\n          ret.index = order.index;\r\n          ret.account = order.account;\r\n          ret.createdTimestamp = order.createdTimestamp;\r\n          return ret;\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n  });\r\n\r\n  return orders.filter(Boolean);\r\n}\r\n\r\nexport function usePositionsForOrders(chainId, library, orders) {\r\n  const key = orders ? orders.map((order) => getOrderKey(order) + \"____\") : null;\r\n  const { data: positions = {} } = useSWR(key, async () => {\r\n    const provider = getProvider(library, chainId);\r\n    const vaultAddress = getContract(chainId, \"Vault\");\r\n    const contract = new ethers.Contract(vaultAddress, Vault.abi, provider);\r\n    const data = await Promise.all(\r\n      orders.map(async (order) => {\r\n        try {\r\n          const position = await contract.getPosition(\r\n            order.account,\r\n            order.collateralToken,\r\n            order.indexToken,\r\n            order.isLong\r\n          );\r\n          if (position[0].eq(0)) {\r\n            return [null, order];\r\n          }\r\n          return [position, order];\r\n        } catch (ex) {\r\n          console.error(ex);\r\n        }\r\n      })\r\n    );\r\n    return data.reduce((memo, [position, order]) => {\r\n      memo[getOrderKey(order)] = position;\r\n      return memo;\r\n    }, {});\r\n  });\r\n\r\n  return positions;\r\n}\r\n\r\nfunction invariant(condition, errorMsg) {\r\n  if (!condition) {\r\n    throw new Error(errorMsg);\r\n  }\r\n}\r\n\r\nexport function useTrades(chainId, account, forSingleAccount, afterId) {\r\n  let url =\r\n    account && account.length > 0\r\n      ? `${getServerBaseUrl(chainId)}/actions?account=${account}`\r\n      : !forSingleAccount && `${getServerBaseUrl(chainId)}/actions`;\r\n\r\n  if (afterId && afterId.length > 0) {\r\n    const urlItem = new URL(url);\r\n    urlItem.searchParams.append(\"after\", afterId);\r\n    url = urlItem.toString();\r\n  }\r\n\r\n  const { data: trades, mutate: updateTrades } = useSWR(url && url, {\r\n    dedupingInterval: 10000,\r\n    fetcher: (...args) => fetch(...args).then((res) => res.json()),\r\n  });\r\n\r\n  if (trades) {\r\n    trades.sort((item0, item1) => {\r\n      const data0 = item0.data;\r\n      const data1 = item1.data;\r\n      const time0 = parseInt(data0.timestamp);\r\n      const time1 = parseInt(data1.timestamp);\r\n      if (time1 > time0) {\r\n        return 1;\r\n      }\r\n      if (time1 < time0) {\r\n        return -1;\r\n      }\r\n\r\n      const block0 = parseInt(data0.blockNumber);\r\n      const block1 = parseInt(data1.blockNumber);\r\n\r\n      if (isNaN(block0) && isNaN(block1)) {\r\n        return 0;\r\n      }\r\n\r\n      if (isNaN(block0)) {\r\n        return 1;\r\n      }\r\n\r\n      if (isNaN(block1)) {\r\n        return -1;\r\n      }\r\n\r\n      if (block1 > block0) {\r\n        return 1;\r\n      }\r\n\r\n      if (block1 < block0) {\r\n        return -1;\r\n      }\r\n\r\n      return 0;\r\n    });\r\n  }\r\n\r\n  return { trades, updateTrades };\r\n}\r\n\r\nexport function useMinExecutionFee(library, active, chainId, infoTokens) {\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n    fetcher: fetcher(library, PositionRouter),\r\n  });\r\n\r\n  const { data: gasPrice } = useSWR([\"gasPrice\", chainId], {\r\n    fetcher: () => {\r\n      return new Promise(async (resolve, reject) => {\r\n        const provider = getProvider(library, chainId);\r\n        if (!provider) {\r\n          resolve(undefined);\r\n          return;\r\n        }\r\n\r\n        try {\r\n          const gasPrice = await provider.getGasPrice();\r\n          resolve(gasPrice);\r\n        } catch (e) {\r\n          console.error(e);\r\n        }\r\n      });\r\n    },\r\n  });\r\n\r\n  let multiplier;\r\n\r\n  // if gas prices on Arbitrum are high, the main transaction costs would come from the L2 gas usage\r\n  // for executing positions this is around 65,000 gas\r\n  // if gas prices on Ethereum are high, than the gas usage might be higher, this calculation doesn't deal with that\r\n  // case yet\r\n  if (chainId === ARBITRUM || chainId === ARBITRUM_TESTNET) {\r\n    multiplier = 65000;\r\n  }\r\n\r\n  // multiplier for Avalanche is just the average gas usage\r\n  if (chainId === AVALANCHE) {\r\n    multiplier = 700000;\r\n  }\r\n\r\n  let finalExecutionFee = minExecutionFee;\r\n\r\n  if (gasPrice && minExecutionFee) {\r\n    const estimatedExecutionFee = gasPrice.mul(multiplier);\r\n    if (estimatedExecutionFee.gt(minExecutionFee)) {\r\n      finalExecutionFee = estimatedExecutionFee;\r\n    }\r\n  }\r\n\r\n  const finalExecutionFeeUSD = getUsd(finalExecutionFee, nativeTokenAddress, false, infoTokens);\r\n  const isFeeHigh = finalExecutionFeeUSD?.gt(expandDecimals(getHighExecutionFee(chainId), USD_DECIMALS));\r\n  const errorMessage =\r\n    isFeeHigh &&\r\n    `The network cost to send transactions is high at the moment, please check the \"Execution Fee\" value before proceeding.`;\r\n\r\n  return {\r\n    minExecutionFee: finalExecutionFee,\r\n    minExecutionFeeUSD: finalExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage: errorMessage,\r\n  };\r\n}\r\n\r\nexport function useStakedGmxSupply(library, active) {\r\n  const gmxAddressArb = getContract(ARBITRUM, \"GMX\");\r\n  const stakedGmxTrackerAddressArb = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n\r\n  const { data: arbData, mutate: arbMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, ARBITRUM, gmxAddressArb, \"balanceOf\", stakedGmxTrackerAddressArb],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const gmxAddressAvax = getContract(AVALANCHE, \"GMX\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n\r\n  const { data: avaxData, mutate: avaxMutate } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, AVALANCHE, gmxAddressAvax, \"balanceOf\", stakedGmxTrackerAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  let data;\r\n  if (arbData && avaxData) {\r\n    data = arbData.add(avaxData);\r\n  }\r\n\r\n  const mutate = () => {\r\n    arbMutate();\r\n    avaxMutate();\r\n  };\r\n\r\n  return { data, mutate };\r\n}\r\n\r\nexport function useHasOutdatedUi() {\r\n  const url = getServerUrl(ARBITRUM, \"/ui_version\");\r\n  const { data, mutate } = useSWR([url], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  let hasOutdatedUi = false;\r\n\r\n  if (data && parseFloat(data) > parseFloat(UI_VERSION)) {\r\n    // hasOutdatedUi = true;\r\n    hasOutdatedUi = false;\r\n  }\r\n\r\n  return { data: hasOutdatedUi, mutate };\r\n}\r\n\r\nexport function useGmxPrice(chainId, libraries, active) {\r\n  const arbitrumLibrary = libraries && libraries.arbitrum ? libraries.arbitrum : undefined;\r\n  const { data: gmxPriceFromArbitrum, mutate: mutateFromArbitrum } = useGmxPriceFromArbitrum(arbitrumLibrary, active);\r\n  const { data: gmxPriceFromAvalanche, mutate: mutateFromAvalanche } = useGmxPriceFromAvalanche();\r\n\r\n  const gmxPrice = chainId === ARBITRUM ? gmxPriceFromArbitrum : gmxPriceFromAvalanche;\r\n  const mutate = useCallback(() => {\r\n    mutateFromAvalanche();\r\n    mutateFromArbitrum();\r\n  }, [mutateFromAvalanche, mutateFromArbitrum]);\r\n\r\n  return {\r\n    gmxPrice,\r\n    gmxPriceFromArbitrum,\r\n    gmxPriceFromAvalanche,\r\n    mutate,\r\n  };\r\n}\r\n\r\n// use only the supply endpoint on arbitrum, it includes the supply on avalanche\r\nexport function useTotalGmxSupply() {\r\n  const gmxSupplyUrlArbitrum = getServerUrl(ARBITRUM, \"/gmx_supply\");\r\n\r\n  const { data: gmxSupply, mutate: updateGmxSupply } = useSWR([gmxSupplyUrlArbitrum], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  return {\r\n    total: gmxSupply ? bigNumberify(gmxSupply) : undefined,\r\n    mutate: updateGmxSupply,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxStaked() {\r\n  const stakedGmxTrackerAddressArbitrum = getContract(ARBITRUM, \"StakedGmxTracker\");\r\n  const stakedGmxTrackerAddressAvax = getContract(AVALANCHE, \"StakedGmxTracker\");\r\n  let totalStakedGmx = useRef(bigNumberify(0));\r\n  const { data: stakedGmxSupplyArbitrum, mutate: updateStakedGmxSupplyArbitrum } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${ARBITRUM}`,\r\n      ARBITRUM,\r\n      getContract(ARBITRUM, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressArbitrum,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: stakedGmxSupplyAvax, mutate: updateStakedGmxSupplyAvax } = useSWR(\r\n    [\r\n      `StakeV2:stakedGmxSupply:${AVALANCHE}`,\r\n      AVALANCHE,\r\n      getContract(AVALANCHE, \"GMX\"),\r\n      \"balanceOf\",\r\n      stakedGmxTrackerAddressAvax,\r\n    ],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n\r\n  const mutate = useCallback(() => {\r\n    updateStakedGmxSupplyArbitrum();\r\n    updateStakedGmxSupplyAvax();\r\n  }, [updateStakedGmxSupplyArbitrum, updateStakedGmxSupplyAvax]);\r\n\r\n  if (stakedGmxSupplyArbitrum && stakedGmxSupplyAvax) {\r\n    let total = bigNumberify(stakedGmxSupplyArbitrum).add(stakedGmxSupplyAvax);\r\n    totalStakedGmx.current = total;\r\n  }\r\n\r\n  return {\r\n    avax: stakedGmxSupplyAvax,\r\n    arbitrum: stakedGmxSupplyArbitrum,\r\n    total: totalStakedGmx.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nexport function useTotalGmxInLiquidity() {\r\n  let poolAddressArbitrum = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  let poolAddressAvax = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n  let totalGMX = useRef(bigNumberify(0));\r\n\r\n  const { data: gmxInLiquidityOnArbitrum, mutate: mutateGMXInLiquidityOnArbitrum } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${ARBITRUM}`, ARBITRUM, getContract(ARBITRUM, \"GMX\"), \"balanceOf\", poolAddressArbitrum],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const { data: gmxInLiquidityOnAvax, mutate: mutateGMXInLiquidityOnAvax } = useSWR(\r\n    [`StakeV2:gmxInLiquidity:${AVALANCHE}`, AVALANCHE, getContract(AVALANCHE, \"GMX\"), \"balanceOf\", poolAddressAvax],\r\n    {\r\n      fetcher: fetcher(undefined, Token),\r\n    }\r\n  );\r\n  const mutate = useCallback(() => {\r\n    mutateGMXInLiquidityOnArbitrum();\r\n    mutateGMXInLiquidityOnAvax();\r\n  }, [mutateGMXInLiquidityOnArbitrum, mutateGMXInLiquidityOnAvax]);\r\n\r\n  if (gmxInLiquidityOnAvax && gmxInLiquidityOnArbitrum) {\r\n    let total = bigNumberify(gmxInLiquidityOnArbitrum).add(gmxInLiquidityOnAvax);\r\n    totalGMX.current = total;\r\n  }\r\n  return {\r\n    avax: gmxInLiquidityOnAvax,\r\n    arbitrum: gmxInLiquidityOnArbitrum,\r\n    total: totalGMX.current,\r\n    mutate,\r\n  };\r\n}\r\n\r\nfunction useGmxPriceFromAvalanche() {\r\n  const poolAddress = getContract(AVALANCHE, \"TraderJoeGmxAvaxPool\");\r\n\r\n  const { data, mutate: updateReserves } = useSWR([\"TraderJoeGmxAvaxReserves\", AVALANCHE, poolAddress, \"getReserves\"], {\r\n    fetcher: fetcher(undefined, UniswapV2),\r\n  });\r\n  const { _reserve0: gmxReserve, _reserve1: avaxReserve } = data || {};\r\n\r\n  const vaultAddress = getContract(AVALANCHE, \"Vault\");\r\n  const avaxAddress = getTokenBySymbol(AVALANCHE, \"WAVAX\").address;\r\n  const { data: avaxPrice, mutate: updateAvaxPrice } = useSWR(\r\n    [`StakeV2:avaxPrice`, AVALANCHE, vaultAddress, \"getMinPrice\", avaxAddress],\r\n    {\r\n      fetcher: fetcher(undefined, Vault),\r\n    }\r\n  );\r\n\r\n  const PRECISION = bigNumberify(10).pow(18);\r\n  let gmxPrice;\r\n  if (avaxReserve && gmxReserve && avaxPrice) {\r\n    gmxPrice = avaxReserve.mul(PRECISION).div(gmxReserve).mul(avaxPrice).div(PRECISION);\r\n  }\r\n\r\n  const mutate = useCallback(() => {\r\n    updateReserves(undefined, true);\r\n    updateAvaxPrice(undefined, true);\r\n  }, [updateReserves, updateAvaxPrice]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nfunction useGmxPriceFromArbitrum(library, active) {\r\n  const poolAddress = getContract(ARBITRUM, \"UniswapGmxEthPool\");\r\n  const { data: uniPoolSlot0, mutate: updateUniPoolSlot0 } = useSWR(\r\n    [`StakeV2:uniPoolSlot0:${active}`, ARBITRUM, poolAddress, \"slot0\"],\r\n    {\r\n      fetcher: fetcher(library, UniPool),\r\n    }\r\n  );\r\n\r\n  const vaultAddress = getContract(ARBITRUM, \"Vault\");\r\n  const ethAddress = getTokenBySymbol(ARBITRUM, \"WETH\").address;\r\n  const { data: ethPrice, mutate: updateEthPrice } = useSWR(\r\n    [`StakeV2:ethPrice:${active}`, ARBITRUM, vaultAddress, \"getMinPrice\", ethAddress],\r\n    {\r\n      fetcher: fetcher(library, Vault),\r\n    }\r\n  );\r\n\r\n  const gmxPrice = useMemo(() => {\r\n    if (uniPoolSlot0 && ethPrice) {\r\n      const tokenA = new UniToken(ARBITRUM, ethAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const gmxAddress = getContract(ARBITRUM, \"GMX\");\r\n      const tokenB = new UniToken(ARBITRUM, gmxAddress, 18, \"SYMBOL\", \"NAME\");\r\n\r\n      const pool = new Pool(\r\n        tokenA, // tokenA\r\n        tokenB, // tokenB\r\n        10000, // fee\r\n        uniPoolSlot0.sqrtPriceX96, // sqrtRatioX96\r\n        1, // liquidity\r\n        uniPoolSlot0.tick, // tickCurrent\r\n        []\r\n      );\r\n\r\n      const poolTokenPrice = pool.priceOf(tokenB).toSignificant(6);\r\n      const poolTokenPriceAmount = parseValue(poolTokenPrice, 18);\r\n      return poolTokenPriceAmount.mul(ethPrice).div(expandDecimals(1, 18));\r\n    }\r\n  }, [ethPrice, uniPoolSlot0, ethAddress]);\r\n\r\n  const mutate = useCallback(() => {\r\n    updateUniPoolSlot0(undefined, true);\r\n    updateEthPrice(undefined, true);\r\n  }, [updateEthPrice, updateUniPoolSlot0]);\r\n\r\n  return { data: gmxPrice, mutate };\r\n}\r\n\r\nexport async function approvePlugin(\r\n  chainId,\r\n  pluginAddress,\r\n  { library, pendingTxns, setPendingTxns, sentMsg, failMsg }\r\n) {\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const contract = new ethers.Contract(routerAddress, Router.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"approvePlugin\", [pluginAddress], {\r\n    sentMsg,\r\n    failMsg,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function createSwapOrder(\r\n  chainId,\r\n  library,\r\n  path,\r\n  amountIn,\r\n  minOut,\r\n  triggerRatio,\r\n  nativeTokenAddress,\r\n  opts = {}\r\n) {\r\n  const executionFee = getConstant(chainId, \"SWAP_ORDER_EXECUTION_GAS_FEE\");\r\n  const triggerAboveThreshold = false;\r\n  let shouldWrap = false;\r\n  let shouldUnwrap = false;\r\n  opts.value = executionFee;\r\n\r\n  if (path[0] === AddressZero) {\r\n    shouldWrap = true;\r\n    opts.value = opts.value.add(amountIn);\r\n  }\r\n  if (path[path.length - 1] === AddressZero) {\r\n    shouldUnwrap = true;\r\n  }\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n\r\n  const params = [path, amountIn, minOut, triggerRatio, triggerAboveThreshold, executionFee, shouldWrap, shouldUnwrap];\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createSwapOrder\", params, opts);\r\n}\r\n\r\nexport async function createIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  nativeTokenAddress,\r\n  path,\r\n  amountIn,\r\n  indexTokenAddress,\r\n  minOut,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  isLong,\r\n  triggerPrice,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const fromETH = path[0] === AddressZero;\r\n\r\n  path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n  const shouldWrap = fromETH;\r\n  const triggerAboveThreshold = !isLong;\r\n  const executionFee = getConstant(chainId, \"INCREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    path,\r\n    amountIn,\r\n    indexTokenAddress,\r\n    minOut,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n    executionFee,\r\n    shouldWrap,\r\n  ];\r\n\r\n  if (!opts.value) {\r\n    opts.value = fromETH ? amountIn.add(executionFee) : executionFee;\r\n  }\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createIncreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function createDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  indexTokenAddress,\r\n  sizeDelta,\r\n  collateralTokenAddress,\r\n  collateralDelta,\r\n  isLong,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts = {}\r\n) {\r\n  invariant(!isLong || indexTokenAddress === collateralTokenAddress, \"invalid token addresses\");\r\n  invariant(indexTokenAddress !== AddressZero, \"indexToken is 0\");\r\n  invariant(collateralTokenAddress !== AddressZero, \"collateralToken is 0\");\r\n\r\n  const executionFee = getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\");\r\n\r\n  const params = [\r\n    indexTokenAddress,\r\n    sizeDelta,\r\n    collateralTokenAddress,\r\n    collateralDelta,\r\n    isLong,\r\n    triggerPrice,\r\n    triggerAboveThreshold,\r\n  ];\r\n  opts.value = executionFee;\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, \"createDecreaseOrder\", params, opts);\r\n}\r\n\r\nexport async function cancelSwapOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelDecreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelDecreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function cancelIncreaseOrder(chainId, library, index, opts) {\r\n  const params = [index];\r\n  const method = \"cancelIncreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function handleCancelOrder(chainId, library, order, opts) {\r\n  let func;\r\n  if (order.type === SWAP) {\r\n    func = cancelSwapOrder;\r\n  } else if (order.type === INCREASE) {\r\n    func = cancelIncreaseOrder;\r\n  } else if (order.type === DECREASE) {\r\n    func = cancelDecreaseOrder;\r\n  }\r\n\r\n  return func(chainId, library, order.index, {\r\n    successMsg: \"Order cancelled.\",\r\n    failMsg: \"Cancel failed.\",\r\n    sentMsg: \"Cancel submitted.\",\r\n    pendingTxns: opts.pendingTxns,\r\n    setPendingTxns: opts.setPendingTxns,\r\n  });\r\n}\r\n\r\nexport async function cancelMultipleOrders(chainId, library, allIndexes = [], opts) {\r\n  const ordersWithTypes = groupBy(allIndexes, (v) => v.split(\"-\")[0]);\r\n  function getIndexes(key) {\r\n    if (!ordersWithTypes[key]) return;\r\n    return ordersWithTypes[key].map((d) => d.split(\"-\")[1]);\r\n  }\r\n  // params order => swap, increase, decrease\r\n  const params = [\"Swap\", \"Increase\", \"Decrease\"].map((key) => getIndexes(key) || []);\r\n  const method = \"cancelMultiple\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateDecreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  collateralDelta,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, collateralDelta, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateDecreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateIncreaseOrder(\r\n  chainId,\r\n  library,\r\n  index,\r\n  sizeDelta,\r\n  triggerPrice,\r\n  triggerAboveThreshold,\r\n  opts\r\n) {\r\n  const params = [index, sizeDelta, triggerPrice, triggerAboveThreshold];\r\n  const method = \"updateIncreaseOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function updateSwapOrder(chainId, library, index, minOut, triggerRatio, triggerAboveThreshold, opts) {\r\n  const params = [index, minOut, triggerRatio, triggerAboveThreshold];\r\n  const method = \"updateSwapOrder\";\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const contract = new ethers.Contract(orderBookAddress, OrderBook.abi, library.getSigner());\r\n\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport async function _executeOrder(chainId, library, method, account, index, feeReceiver, opts) {\r\n  const params = [account, index, feeReceiver];\r\n  const positionManagerAddress = getContract(chainId, \"PositionManager\");\r\n  const contract = new ethers.Contract(positionManagerAddress, PositionManager.abi, library.getSigner());\r\n  return callContract(chainId, contract, method, params, opts);\r\n}\r\n\r\nexport function executeSwapOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeSwapOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeIncreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeIncreaseOrder\", account, index, feeReceiver, opts);\r\n}\r\n\r\nexport function executeDecreaseOrder(chainId, library, account, index, feeReceiver, opts) {\r\n  return _executeOrder(chainId, library, \"executeDecreaseOrder\", account, index, feeReceiver, opts);\r\n}\r\n","export const REDIRECT_POPUP_TIMESTAMP_KEY = \"redirect-popup-timestamp\";\r\n\r\nexport const IS_TOUCH = \"ontouchstart\" in window;\r\n","import cx from \"classnames\";\r\nimport { useCallback, useState, useRef } from \"react\";\r\nimport { IS_TOUCH } from \"../../config/ui\";\r\n\r\nconst OPEN_DELAY = 0;\r\nconst CLOSE_DELAY = 100;\r\n\r\nexport default function Tooltip(props) {\r\n  const { enabled } = props;\r\n  const [visible, setVisible] = useState(false);\r\n  const intervalCloseRef = useRef(null);\r\n  const intervalOpenRef = useRef(null);\r\n\r\n  const position = props.position ?? \"left-bottom\";\r\n  const trigger = props.trigger ?? \"hover\";\r\n\r\n  const onMouseEnter = useCallback(() => {\r\n    if (trigger !== \"hover\" || IS_TOUCH) return;\r\n\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (!intervalOpenRef.current) {\r\n      intervalOpenRef.current = setTimeout(() => {\r\n        if (enabled) {\r\n          setVisible(true)\r\n        }\r\n        intervalOpenRef.current = null;\r\n      }, OPEN_DELAY);\r\n    }\r\n  }, [setVisible, intervalCloseRef, intervalOpenRef, trigger]);\r\n\r\n  const onMouseClick = useCallback(() => {\r\n    if (trigger !== \"click\" && !IS_TOUCH) return;\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n\r\n    if (enabled) {\r\n      setVisible(true)\r\n    }\r\n  }, [setVisible, intervalCloseRef, trigger]);\r\n\r\n  const onMouseLeave = useCallback(() => {\r\n    intervalCloseRef.current = setTimeout(() => {\r\n      setVisible(false);\r\n      intervalCloseRef.current = null;\r\n    }, CLOSE_DELAY);\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n  }, [setVisible, intervalCloseRef]);\r\n\r\n  const className = cx(\"Tooltip\", props.className);\r\n\r\n  return (\r\n    <span className={className} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} onClick={onMouseClick}>\r\n      <span\r\n        className={cx({ \"Tooltip-handle\": !props.disableHandleStyle }, [props.handleClassName], { active: visible })}\r\n      >\r\n        {props.handle}\r\n      </span>\r\n      {visible && <div className={cx([\"Tooltip-popup\", position])}>{props.renderContent()}</div>}\r\n    </span>\r\n  );\r\n}\r\n","export const FEES_42161 = [\r\n  { to: 1630514845, feeUsd: \"32.47\" },\r\n  { to: 1631074048, feeUsd: \"50681\" },\r\n  { to: 1631677736, feeUsd: \"124400.69\" },\r\n  { to: 1632278435, feeUsd: \"395299.56\" },\r\n  { to: 1632885416, feeUsd: \"348555.88\" },\r\n  { to: 1633507067, feeUsd: \"302888.51\" },\r\n  { to: 1634095073, feeUsd: \"325532.14\" },\r\n  { to: 1634701754, feeUsd: \"524688.53\" },\r\n  { to: 1635301669, feeUsd: \"727989.27\" },\r\n  { to: 1635914306, feeUsd: \"815838.37\" },\r\n  { to: 1636517248, feeUsd: \"1017108.52\" },\r\n  { to: 1637118096, feeUsd: \"1195695.02\" },\r\n  { to: 1637728323, feeUsd: \"611495.04\" },\r\n  { to: 1638330376, feeUsd: \"1002226.96\" },\r\n  { to: 1638931348, feeUsd: \"1225801.74\" },\r\n  { to: 1639538283, feeUsd: \"638755.06\" },\r\n  { to: 1640135388, feeUsd: \"692132.12\" },\r\n  { to: 1640740756, feeUsd: \"653857.89\" },\r\n  { to: 1641353998, feeUsd: \"932273.45\" },\r\n  { to: 1641954606, feeUsd: \"2010194.53\" },\r\n  { to: 1642557002, feeUsd: \"1424176.23\" },\r\n  { to: 1643166233, feeUsd: \"2131480.58\" },\r\n  { to: 1643765386, feeUsd: \"1184435.13\" },\r\n  { to: 1644371345, feeUsd: \"1205134.15\" },\r\n  { to: 1644979161, feeUsd: \"1206960.25\" },\r\n  { to: 1645579656, feeUsd: \"527326.47\" },\r\n  { to: 1646182611, feeUsd: \"2007742.56\" },\r\n  { to: 1646788756, feeUsd: \"2181383.87\" },\r\n  { to: 1647402638, feeUsd: \"1060151.47\" },\r\n  { to: 1648000826, feeUsd: \"1386779.30\" },\r\n  { to: 1648611300, feeUsd: \"1474852.84\" },\r\n  { to: 1649207110, feeUsd: \"1882364.25\" },\r\n  { to: 1649814371, feeUsd: \"2225265.28\" },\r\n  { to: 1650420021, feeUsd: \"1135279.21\" },\r\n  { to: 1651028602, feeUsd: \"716772.48\" },\r\n  { to: 1651635145, feeUsd: \"820730.6\" },\r\n  { to: 1652236772, feeUsd: \"1833127.03\" },\r\n  { to: 1652840724, feeUsd: \"1931425.93\" },\r\n  { to: 1653430967, feeUsd: \"877425.89\" },\r\n  { to: 1654053714, feeUsd: \"1413630.45\" },\r\n  { to: 1654653280, feeUsd: \"461654.58\" },\r\n  { to: 1655259566, feeUsd: \"1517706.31\" },\r\n  { to: 1655866071, feeUsd: \"1039442.84\" },\r\n  { to: 1656472723, feeUsd: \"493000.42\" },\r\n  { to: 1657074613, feeUsd: \"721743.61\" },\r\n  { to: 1657678876, feeUsd: \"695772.71\" },\r\n  { to: 1658283954, feeUsd: \"1252312.35\" },\r\n  { to: 1658886078, feeUsd: \"1058461.3\" },\r\n  { to: 1659494426, feeUsd: \"1772773.67\" },\r\n  { to: 1660095134, feeUsd: \"877279.21\" },\r\n  { to: 1660698120, feeUsd: \"1729561.45\" },\r\n  { to: 1661309954, feeUsd: \"2163583.24\" },\r\n  { to: 1661907895, feeUsd: \"2245327.53\" },\r\n  { to: 1662518119, feeUsd: \"2097773.87\" },\r\n  { to: 1663124371, feeUsd: \"3151643.25\" },\r\n  { to: 1663724917, feeUsd: \"3338906.37\" },\r\n];\r\n","import { FEES_42161 } from \"./FEES_42161\";\r\nimport { FEES_43113 } from \"./FEES_43113\";\r\n\r\nconst SECONDS_PER_WEEK = 604800;\r\n\r\nfunction createFeeList(data) {\r\n  const list = [];\r\n  for (let i = 0; i < data.length; i++) {\r\n    const item = data[i];\r\n    list.push({\r\n      from: item.to - SECONDS_PER_WEEK,\r\n      to: item.to,\r\n      feeUsd: item.feeUsd,\r\n    });\r\n  }\r\n  return list;\r\n}\r\n\r\nconst FEES = {\r\n  56: [],\r\n  42161: createFeeList(FEES_42161),\r\n  421611: createFeeList(FEES_42161),\r\n  43114: createFeeList(FEES_43113),\r\n};\r\n\r\nexport function getFeeHistory(chainId) {\r\n  return FEES[chainId].concat([]).reverse();\r\n}\r\n","export const FEES_43113 = [\r\n  { to: 1641430800, feeUsd: \"10\" },\r\n  { to: 1641954606, feeUsd: \"506934.29\" },\r\n  { to: 1642557082, feeUsd: \"871367.91\" },\r\n  { to: 1643166266, feeUsd: \"1416130.81\" },\r\n  { to: 1643765429, feeUsd: \"996296.58\" },\r\n  { to: 1644371345, feeUsd: \"869493.46\" },\r\n  { to: 1644979198, feeUsd: \"644299.54\" },\r\n  { to: 1645579694, feeUsd: \"559829.67\" },\r\n  { to: 1646182633, feeUsd: \"1041033.13\" },\r\n  { to: 1646788780, feeUsd: \"525648.29\" },\r\n  { to: 1647402672, feeUsd: \"491566.54\" },\r\n  { to: 1648000896, feeUsd: \"523412.47\" },\r\n  { to: 1648611331, feeUsd: \"482364.71\" },\r\n  { to: 1649207157, feeUsd: \"819772.21\" },\r\n  { to: 1649814371, feeUsd: \"536680.30\" },\r\n  { to: 1650420021, feeUsd: \"297644.50\" },\r\n  { to: 1651028602, feeUsd: \"329239.03\" },\r\n  { to: 1651635172, feeUsd: \"344748.08\" },\r\n  { to: 1652236772, feeUsd: \"809852.39\" },\r\n  { to: 1652840724, feeUsd: \"850963.06\" },\r\n  { to: 1653430967, feeUsd: \"306245.8\" },\r\n  { to: 1654053714, feeUsd: \"539435.12\" },\r\n  { to: 1654653280, feeUsd: \"840894.12\" },\r\n  { to: 1655259566, feeUsd: \"506009.43\" },\r\n  { to: 1655866071, feeUsd: \"526660.33\" },\r\n  { to: 1656472723, feeUsd: \"448733.62\" },\r\n  { to: 1657074613, feeUsd: \"392029.38\" },\r\n  { to: 1657678876, feeUsd: \"348157.7\" },\r\n  { to: 1658283954, feeUsd: \"475489.0\" },\r\n  { to: 1658886078, feeUsd: \"528324.14\" },\r\n  { to: 1659494426, feeUsd: \"411807.72\" },\r\n  { to: 1660095134, feeUsd: \"373497.82\" },\r\n  { to: 1660698120, feeUsd: \"484879.32\" },\r\n  { to: 1661309954, feeUsd: \"426656.64\" },\r\n  { to: 1661907895, feeUsd: \"494117.94\" },\r\n  { to: 1662518119, feeUsd: \"310085.65\" },\r\n  { to: 1663124371, feeUsd: \"435866.01\" },\r\n  { to: 1663724917, feeUsd: \"515306.4\" },\r\n];\r\n","import { Menu } from \"@headlessui/react\";\r\nimport { FiChevronDown } from \"react-icons/fi\";\r\nimport \"./AssetDropdown.css\";\r\nimport coingeckoIcon from \"../../img/ic_coingecko_16.svg\";\r\nimport arbitrumIcon from \"../../img/ic_arbitrum_16.svg\";\r\nimport avalancheIcon from \"../../img/ic_avalanche_16.svg\";\r\nimport metamaskIcon from \"../../img/ic_metamask_16.svg\";\r\nimport { addTokenToMetamask, ICONLINKS, platformTokens, useChainId } from \"../../lib/legacy\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\n\r\nimport { Trans } from \"@lingui/macro\";\r\n\r\nfunction AssetDropdown({ assetSymbol, assetInfo }) {\r\n  const { active } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  let { coingecko, arbitrum, avalanche } = ICONLINKS[chainId][assetSymbol] || {};\r\n  const unavailableTokenSymbols =\r\n    {\r\n      42161: [\"ETH\"],\r\n      43114: [\"AVAX\"],\r\n    }[chainId] || [];\r\n\r\n  return (\r\n    <Menu>\r\n      <Menu.Button as=\"div\" className=\"dropdown-arrow center-both\">\r\n        <FiChevronDown size={20} />\r\n      </Menu.Button>\r\n      <Menu.Items as=\"div\" className=\"asset-menu-items\">\r\n        <Menu.Item>\r\n          <>\r\n            {coingecko && (\r\n              <a href={coingecko} className=\"asset-item\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                <img src={coingeckoIcon} alt=\"Open in Coingecko\" />\r\n                <p>\r\n                  <Trans>Open in Coingecko</Trans>\r\n                </p>\r\n              </a>\r\n            )}\r\n          </>\r\n        </Menu.Item>\r\n        <Menu.Item>\r\n          <>\r\n            {arbitrum && (\r\n              <a href={arbitrum} className=\"asset-item\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                <img src={arbitrumIcon} alt=\"Open in explorer\" />\r\n                <p>\r\n                  <Trans>Open in Explorer</Trans>\r\n                </p>\r\n              </a>\r\n            )}\r\n            {avalanche && (\r\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href={avalanche} className=\"asset-item\">\r\n                <img src={avalancheIcon} alt=\"Open in explorer\" />\r\n                <p>\r\n                  <Trans>Open in Explorer</Trans>\r\n                </p>\r\n              </a>\r\n            )}\r\n          </>\r\n        </Menu.Item>\r\n        <Menu.Item>\r\n          <>\r\n            {active && unavailableTokenSymbols.indexOf(assetSymbol) < 0 && (\r\n              <div\r\n                onClick={() => {\r\n                  let token = assetInfo\r\n                    ? { ...assetInfo, image: assetInfo.imageUrl }\r\n                    : platformTokens[chainId][assetSymbol];\r\n                  addTokenToMetamask(token);\r\n                }}\r\n                className=\"asset-item\"\r\n              >\r\n                <img src={metamaskIcon} alt=\"Add to Metamask\" />\r\n                <p>\r\n                  <Trans>Add to Metamask</Trans>\r\n                </p>\r\n              </div>\r\n            )}\r\n          </>\r\n        </Menu.Item>\r\n      </Menu.Items>\r\n    </Menu>\r\n  );\r\n}\r\n\r\nexport default AssetDropdown;\r\n","import { Helmet } from \"react-helmet\";\r\n\r\nimport { t } from \"@lingui/macro\";\r\n\r\nfunction SEO(props) {\r\n  const { children, ...customMeta } = props;\r\n  const meta = {\r\n    title: t`GMX | Decentralized Perpetual Exchange`,\r\n    description: t`Trade spot or perpetual BTC, ETH, AVAX and other top cryptocurrencies with up to 30x leverage directly from your wallet on Arbitrum and Avalanche.`,\r\n    image: \"https://gmx.io/og.png\",\r\n    type: \"exchange\",\r\n    ...customMeta,\r\n  };\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>{meta.title}</title>\r\n        <meta name=\"robots\" content=\"follow, index\" />\r\n        <meta content={meta.description} name=\"description\" />\r\n        <meta property=\"og:type\" content={meta.type} />\r\n        <meta property=\"og:site_name\" content=\"GMX\" />\r\n        <meta property=\"og:description\" content={meta.description} />\r\n        <meta property=\"og:title\" content={meta.title} />\r\n        <meta property=\"og:image\" content={meta.image} />\r\n        <meta name=\"twitter:card\" content=\"summary_large_image\" />\r\n        <meta name=\"twitter:site\" content=\"@gmx_io\" />\r\n        <meta name=\"twitter:title\" content={meta.title} />\r\n        <meta name=\"twitter:description\" content={meta.description} />\r\n        <meta name=\"twitter:image\" content={meta.image} />\r\n      </Helmet>\r\n      {children}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SEO;\r\n","import \"./StatsTooltip.css\";\r\ntype Props = {\r\n  label: string;\r\n  value: number | [number];\r\n  showDollar?: boolean;\r\n};\r\n\r\nexport default function StatsTooltipRow({ label, value, showDollar = true }: Props) {\r\n  function renderValue() {\r\n    if (Array.isArray(value)) {\r\n      return (\r\n        <ul className=\"Tooltip-row-values\">\r\n          {value.map((v, i) => (\r\n            <li key={i}>{v}</li>\r\n          ))}\r\n        </ul>\r\n      );\r\n    }\r\n    return (\r\n      <span className=\"Tooltip-row-value\">\r\n        {showDollar && \"$\"}\r\n        {value}\r\n      </span>\r\n    );\r\n  }\r\n  return (\r\n    <div className=\"Tooltip-row\">\r\n      <span className=\"label\">{label}:</span>\r\n      {renderValue()}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport useSWR from \"swr\";\r\nimport { PieChart, Pie, Cell, Tooltip } from \"recharts\";\r\nimport TooltipComponent from \"../../components/Tooltip/Tooltip\";\r\n\r\nimport hexToRgba from \"hex-to-rgba\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { getWhitelistedTokens, getTokenBySymbol } from \"../../config/Tokens\";\r\nimport { getFeeHistory } from \"../../config/Fees\";\r\n\r\nimport {\r\n  formatAmount,\r\n  formatKeyAmount,\r\n  expandDecimals,\r\n  bigNumberify,\r\n  numberWithCommas,\r\n  formatDate,\r\n  getServerUrl,\r\n  getChainName,\r\n  useChainId,\r\n  USD_DECIMALS,\r\n  GMX_DECIMALS,\r\n  GLP_DECIMALS,\r\n  BASIS_POINTS_DIVISOR,\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  GLPPOOLCOLORS,\r\n  DEFAULT_MAX_USDG_AMOUNT,\r\n  getPageTitle,\r\n  importImage,\r\n  arrayURLFetcher,\r\n} from \"../../lib/legacy\";\r\nimport {\r\n  useTotalGmxInLiquidity,\r\n  useGmxPrice,\r\n  useTotalGmxStaked,\r\n  useTotalGmxSupply,\r\n  useInfoTokens,\r\n} from \"../../domain/legacy\";\r\n\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport VaultV2 from \"../../abis/VaultV2.json\";\r\nimport ReaderV2 from \"../../abis/ReaderV2.json\";\r\nimport GlpManager from \"../../abis/GlpManager.json\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\n\r\nimport \"./DashboardV2.css\";\r\n\r\nimport gmx40Icon from \"../../img/ic_gmx_40.svg\";\r\nimport glp40Icon from \"../../img/ic_glp_40.svg\";\r\nimport avalanche16Icon from \"../../img/ic_avalanche_16.svg\";\r\nimport arbitrum16Icon from \"../../img/ic_arbitrum_16.svg\";\r\nimport arbitrum24Icon from \"../../img/ic_arbitrum_24.svg\";\r\nimport avalanche24Icon from \"../../img/ic_avalanche_24.svg\";\r\n\r\nimport AssetDropdown from \"./AssetDropdown\";\r\nimport SEO from \"../../components/Common/SEO\";\r\nimport useTotalVolume from \"../../domain/useTotalVolume\";\r\nimport StatsTooltip from \"../../components/StatsTooltip/StatsTooltip\";\r\nimport StatsTooltipRow from \"../../components/StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nconst ACTIVE_CHAIN_IDS = [ARBITRUM, AVALANCHE];\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getVolumeInfo(hourlyVolumes) {\r\n  if (!hourlyVolumes || hourlyVolumes.length === 0) {\r\n    return {};\r\n  }\r\n  const dailyVolumes = hourlyVolumes.map((hourlyVolume) => {\r\n    const secondsPerHour = 60 * 60;\r\n    const minTime = parseInt(Date.now() / 1000 / secondsPerHour) * secondsPerHour - 24 * secondsPerHour;\r\n    const info = {};\r\n    let totalVolume = bigNumberify(0);\r\n    for (let i = 0; i < hourlyVolume.length; i++) {\r\n      const item = hourlyVolume[i].data;\r\n      if (parseInt(item.timestamp) < minTime) {\r\n        break;\r\n      }\r\n\r\n      if (!info[item.token]) {\r\n        info[item.token] = bigNumberify(0);\r\n      }\r\n\r\n      info[item.token] = info[item.token].add(item.volume);\r\n      totalVolume = totalVolume.add(item.volume);\r\n    }\r\n    info.totalVolume = totalVolume;\r\n    return info;\r\n  });\r\n  return dailyVolumes.reduce(\r\n    (acc, cv, index) => {\r\n      acc.totalVolume = acc.totalVolume.add(cv.totalVolume);\r\n      acc[ACTIVE_CHAIN_IDS[index]] = cv;\r\n      return acc;\r\n    },\r\n    { totalVolume: bigNumberify(0) }\r\n  );\r\n}\r\n\r\nfunction getPositionStats(positionStats) {\r\n  if (!positionStats || positionStats.length === 0) {\r\n    return null;\r\n  }\r\n  return positionStats.reduce(\r\n    (acc, cv, i) => {\r\n      acc.totalLongPositionSizes = acc.totalLongPositionSizes.add(cv.totalLongPositionSizes);\r\n      acc.totalShortPositionSizes = acc.totalShortPositionSizes.add(cv.totalShortPositionSizes);\r\n      acc[ACTIVE_CHAIN_IDS[i]] = cv;\r\n      return acc;\r\n    },\r\n    {\r\n      totalLongPositionSizes: bigNumberify(0),\r\n      totalShortPositionSizes: bigNumberify(0),\r\n    }\r\n  );\r\n}\r\n\r\nfunction getCurrentFeesUsd(tokenAddresses, fees, infoTokens) {\r\n  if (!fees || !infoTokens) {\r\n    return bigNumberify(0);\r\n  }\r\n\r\n  let currentFeesUsd = bigNumberify(0);\r\n  for (let i = 0; i < tokenAddresses.length; i++) {\r\n    const tokenAddress = tokenAddresses[i];\r\n    const tokenInfo = infoTokens[tokenAddress];\r\n    if (!tokenInfo || !tokenInfo.contractMinPrice) {\r\n      continue;\r\n    }\r\n\r\n    const feeUsd = fees[i].mul(tokenInfo.contractMinPrice).div(expandDecimals(1, tokenInfo.decimals));\r\n    currentFeesUsd = currentFeesUsd.add(feeUsd);\r\n  }\r\n\r\n  return currentFeesUsd;\r\n}\r\n\r\nexport default function DashboardV2() {\r\n  const { active, library } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  const totalVolume = useTotalVolume();\r\n\r\n  const chainName = getChainName(chainId);\r\n\r\n  const { data: positionStats } = useSWR(\r\n    ACTIVE_CHAIN_IDS.map((chainId) => getServerUrl(chainId, \"/position_stats\")),\r\n    {\r\n      fetcher: arrayURLFetcher,\r\n    }\r\n  );\r\n\r\n  const { data: hourlyVolumes } = useSWR(\r\n    ACTIVE_CHAIN_IDS.map((chainId) => getServerUrl(chainId, \"/hourly_volume\")),\r\n    {\r\n      fetcher: arrayURLFetcher,\r\n    }\r\n  );\r\n\r\n  let { total: totalGmxSupply } = useTotalGmxSupply();\r\n\r\n  const currentVolumeInfo = getVolumeInfo(hourlyVolumes);\r\n\r\n  const positionStatsInfo = getPositionStats(positionStats);\r\n\r\n  function getWhitelistedTokenAddresses(chainId) {\r\n    const whitelistedTokens = getWhitelistedTokens(chainId);\r\n    return whitelistedTokens.map((token) => token.address);\r\n  }\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n  const tokenList = whitelistedTokens.filter((t) => !t.isWrapped);\r\n  const visibleTokens = tokenList.filter((t) => !t.isTempHidden);\r\n\r\n  const readerAddress = getContract(chainId, \"Reader\");\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const glpManagerAddress = getContract(chainId, \"GlpManager\");\r\n\r\n  const gmxAddress = getContract(chainId, \"GMX\");\r\n  const glpAddress = getContract(chainId, \"GLP\");\r\n  const usdgAddress = getContract(chainId, \"USDG\");\r\n\r\n  const tokensForSupplyQuery = [gmxAddress, glpAddress, usdgAddress];\r\n\r\n  const { data: aums } = useSWR([`Dashboard:getAums:${active}`, chainId, glpManagerAddress, \"getAums\"], {\r\n    fetcher: fetcher(library, GlpManager),\r\n  });\r\n\r\n  const { data: fees } = useSWR([`Dashboard:fees:${active}`, chainId, readerAddress, \"getFees\", vaultAddress], {\r\n    fetcher: fetcher(library, ReaderV2, [whitelistedTokenAddresses]),\r\n  });\r\n\r\n  const { data: totalSupplies } = useSWR(\r\n    [`Dashboard:totalSupplies:${active}`, chainId, readerAddress, \"getTokenBalancesWithSupplies\", AddressZero],\r\n    {\r\n      fetcher: fetcher(library, ReaderV2, [tokensForSupplyQuery]),\r\n    }\r\n  );\r\n\r\n  const { data: totalTokenWeights } = useSWR(\r\n    [`GlpSwap:totalTokenWeights:${active}`, chainId, vaultAddress, \"totalTokenWeights\"],\r\n    {\r\n      fetcher: fetcher(library, VaultV2),\r\n    }\r\n  );\r\n\r\n  const { infoTokens } = useInfoTokens(library, chainId, active, undefined, undefined);\r\n  const { infoTokens: infoTokensArbitrum } = useInfoTokens(null, ARBITRUM, active, undefined, undefined);\r\n  const { infoTokens: infoTokensAvax } = useInfoTokens(null, AVALANCHE, active, undefined, undefined);\r\n\r\n  const { data: currentFees } = useSWR(\r\n    infoTokensArbitrum[AddressZero].contractMinPrice && infoTokensAvax[AddressZero].contractMinPrice\r\n      ? \"Dashboard:currentFees\"\r\n      : null,\r\n    {\r\n      fetcher: () => {\r\n        return Promise.all(\r\n          ACTIVE_CHAIN_IDS.map((chainId) =>\r\n            fetcher(null, ReaderV2, [getWhitelistedTokenAddresses(chainId)])(\r\n              `Dashboard:fees:${chainId}`,\r\n              chainId,\r\n              getContract(chainId, \"Reader\"),\r\n              \"getFees\",\r\n              getContract(chainId, \"Vault\")\r\n            )\r\n          )\r\n        ).then((fees) => {\r\n          return fees.reduce(\r\n            (acc, cv, i) => {\r\n              const feeUSD = getCurrentFeesUsd(\r\n                getWhitelistedTokenAddresses(ACTIVE_CHAIN_IDS[i]),\r\n                cv,\r\n                ACTIVE_CHAIN_IDS[i] === ARBITRUM ? infoTokensArbitrum : infoTokensAvax\r\n              );\r\n              acc[ACTIVE_CHAIN_IDS[i]] = feeUSD;\r\n              acc.total = acc.total.add(feeUSD);\r\n              return acc;\r\n            },\r\n            { total: bigNumberify(0) }\r\n          );\r\n        });\r\n      },\r\n    }\r\n  );\r\n\r\n  const eth = infoTokens[getTokenBySymbol(chainId, \"ETH\").address];\r\n  const currentFeesUsd = getCurrentFeesUsd(whitelistedTokenAddresses, fees, infoTokens);\r\n  const feeHistory = getFeeHistory(chainId);\r\n  const shouldIncludeCurrrentFees = feeHistory.length && parseInt(Date.now() / 1000) - feeHistory[0].to > 60 * 60;\r\n  let totalFeesDistributed = shouldIncludeCurrrentFees\r\n    ? parseFloat(bigNumberify(formatAmount(currentFeesUsd, USD_DECIMALS - 2, 0, false)).toNumber()) / 100\r\n    : 0;\r\n\r\n  const totalFees = ACTIVE_CHAIN_IDS.map((chainId) =>\r\n    getFeeHistory(chainId).reduce((acc, fee) => acc + parseFloat(fee.feeUsd), totalFeesDistributed)\r\n  )\r\n    .map((v) => Math.round(v))\r\n    .reduce(\r\n      (acc, cv, i) => {\r\n        acc[ACTIVE_CHAIN_IDS[i]] = cv;\r\n        acc.total = acc.total + cv;\r\n        return acc;\r\n      },\r\n      { total: 0 }\r\n    );\r\n\r\n  const { gmxPrice, gmxPriceFromArbitrum, gmxPriceFromAvalanche } = useGmxPrice(\r\n    chainId,\r\n    { arbitrum: chainId === ARBITRUM ? library : undefined },\r\n    active\r\n  );\r\n\r\n  let { total: totalGmxInLiquidity } = useTotalGmxInLiquidity(chainId, active);\r\n\r\n  let { avax: avaxStakedGmx, arbitrum: arbitrumStakedGmx, total: totalStakedGmx } = useTotalGmxStaked();\r\n\r\n  let gmxMarketCap;\r\n  if (gmxPrice && totalGmxSupply) {\r\n    gmxMarketCap = gmxPrice.mul(totalGmxSupply).div(expandDecimals(1, GMX_DECIMALS));\r\n  }\r\n\r\n  let stakedGmxSupplyUsd;\r\n  if (gmxPrice && totalStakedGmx) {\r\n    stakedGmxSupplyUsd = totalStakedGmx.mul(gmxPrice).div(expandDecimals(1, GMX_DECIMALS));\r\n  }\r\n\r\n  let aum;\r\n  if (aums && aums.length > 0) {\r\n    aum = aums[0].add(aums[1]).div(2);\r\n  }\r\n\r\n  let glpPrice;\r\n  let glpSupply;\r\n  let glpMarketCap;\r\n  if (aum && totalSupplies && totalSupplies[3]) {\r\n    glpSupply = totalSupplies[3];\r\n    glpPrice =\r\n      aum && aum.gt(0) && glpSupply.gt(0)\r\n        ? aum.mul(expandDecimals(1, GLP_DECIMALS)).div(glpSupply)\r\n        : expandDecimals(1, USD_DECIMALS);\r\n    glpMarketCap = glpPrice.mul(glpSupply).div(expandDecimals(1, GLP_DECIMALS));\r\n  }\r\n\r\n  let tvl;\r\n  if (glpMarketCap && gmxPrice && totalStakedGmx) {\r\n    tvl = glpMarketCap.add(gmxPrice.mul(totalStakedGmx).div(expandDecimals(1, GMX_DECIMALS)));\r\n  }\r\n\r\n  const ethFloorPriceFund = expandDecimals(350 + 148 + 384, 18);\r\n  const glpFloorPriceFund = expandDecimals(660001, 18);\r\n  const usdcFloorPriceFund = expandDecimals(784598 + 200000, 30);\r\n\r\n  let totalFloorPriceFundUsd;\r\n\r\n  if (eth && eth.contractMinPrice && glpPrice) {\r\n    const ethFloorPriceFundUsd = ethFloorPriceFund.mul(eth.contractMinPrice).div(expandDecimals(1, eth.decimals));\r\n    const glpFloorPriceFundUsd = glpFloorPriceFund.mul(glpPrice).div(expandDecimals(1, 18));\r\n\r\n    totalFloorPriceFundUsd = ethFloorPriceFundUsd.add(glpFloorPriceFundUsd).add(usdcFloorPriceFund);\r\n  }\r\n\r\n  let adjustedUsdgSupply = bigNumberify(0);\r\n\r\n  for (let i = 0; i < tokenList.length; i++) {\r\n    const token = tokenList[i];\r\n    const tokenInfo = infoTokens[token.address];\r\n    if (tokenInfo && tokenInfo.usdgAmount) {\r\n      adjustedUsdgSupply = adjustedUsdgSupply.add(tokenInfo.usdgAmount);\r\n    }\r\n  }\r\n\r\n  const getWeightText = (tokenInfo) => {\r\n    if (\r\n      !tokenInfo.weight ||\r\n      !tokenInfo.usdgAmount ||\r\n      !adjustedUsdgSupply ||\r\n      adjustedUsdgSupply.eq(0) ||\r\n      !totalTokenWeights\r\n    ) {\r\n      return \"...\";\r\n    }\r\n\r\n    const currentWeightBps = tokenInfo.usdgAmount.mul(BASIS_POINTS_DIVISOR).div(adjustedUsdgSupply);\r\n    // use add(1).div(10).mul(10) to round numbers up\r\n    const targetWeightBps = tokenInfo.weight.mul(BASIS_POINTS_DIVISOR).div(totalTokenWeights).add(1).div(10).mul(10);\r\n\r\n    const weightText = `${formatAmount(currentWeightBps, 2, 2, false)}% / ${formatAmount(\r\n      targetWeightBps,\r\n      2,\r\n      2,\r\n      false\r\n    )}%`;\r\n\r\n    return (\r\n      <TooltipComponent\r\n        handle={weightText}\r\n        position=\"right-bottom\"\r\n        renderContent={() => {\r\n          return (\r\n            <>\r\n              <StatsTooltipRow\r\n                label={t`Current Weight`}\r\n                value={`${formatAmount(currentWeightBps, 2, 2, false)}%`}\r\n                showDollar={false}\r\n              />\r\n              <StatsTooltipRow\r\n                label={t`Target Weight`}\r\n                value={`${formatAmount(targetWeightBps, 2, 2, false)}%`}\r\n                showDollar={false}\r\n              />\r\n              <br />\r\n              {currentWeightBps.lt(targetWeightBps) && (\r\n                <div className=\"text-white\">\r\n                  <Trans>\r\n                    {tokenInfo.symbol} is below its target weight.\r\n                    <br />\r\n                    <br />\r\n                    Get lower fees to{\" \"}\r\n                    <Link to=\"/buy_glp\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                      buy GLP\r\n                    </Link>{\" \"}\r\n                    with {tokenInfo.symbol},&nbsp; and to{\" \"}\r\n                    <Link to=\"/trade\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                      swap\r\n                    </Link>{\" \"}\r\n                    {tokenInfo.symbol} for other tokens.\r\n                  </Trans>\r\n                </div>\r\n              )}\r\n              {currentWeightBps.gt(targetWeightBps) && (\r\n                <div className=\"text-white\">\r\n                  <Trans>\r\n                    {tokenInfo.symbol} is above its target weight.\r\n                    <br />\r\n                    <br />\r\n                    Get lower fees to{\" \"}\r\n                    <Link to=\"/trade\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                      swap\r\n                    </Link>{\" \"}\r\n                    tokens for {tokenInfo.symbol}.\r\n                  </Trans>\r\n                </div>\r\n              )}\r\n              <br />\r\n              <div>\r\n                <a href=\"https://gmxio.gitbook.io/gmx/glp\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>More Info</Trans>\r\n                </a>\r\n              </div>\r\n            </>\r\n          );\r\n        }}\r\n      />\r\n    );\r\n  };\r\n\r\n  let stakedPercent = 0;\r\n\r\n  if (totalGmxSupply && !totalGmxSupply.isZero() && !totalStakedGmx.isZero()) {\r\n    stakedPercent = totalStakedGmx.mul(100).div(totalGmxSupply).toNumber();\r\n  }\r\n\r\n  let liquidityPercent = 0;\r\n\r\n  if (totalGmxSupply && !totalGmxSupply.isZero() && totalGmxInLiquidity) {\r\n    liquidityPercent = totalGmxInLiquidity.mul(100).div(totalGmxSupply).toNumber();\r\n  }\r\n\r\n  let notStakedPercent = 100 - stakedPercent - liquidityPercent;\r\n\r\n  let gmxDistributionData = [\r\n    {\r\n      name: \"staked\",\r\n      value: stakedPercent,\r\n      color: \"#4353fa\",\r\n    },\r\n    {\r\n      name: \"in liquidity\",\r\n      value: liquidityPercent,\r\n      color: \"#0598fa\",\r\n    },\r\n    {\r\n      name: \"not staked\",\r\n      value: notStakedPercent,\r\n      color: \"#5c0af5\",\r\n    },\r\n  ];\r\n\r\n  const totalStatsStartDate = chainId === AVALANCHE ? \"06 Jan 2022\" : \"01 Sep 2021\";\r\n\r\n  let stableGlp = 0;\r\n  let totalGlp = 0;\r\n\r\n  let glpPool = tokenList.map((token) => {\r\n    const tokenInfo = infoTokens[token.address];\r\n    if (tokenInfo.usdgAmount && adjustedUsdgSupply && adjustedUsdgSupply.gt(0)) {\r\n      const currentWeightBps = tokenInfo.usdgAmount.mul(BASIS_POINTS_DIVISOR).div(adjustedUsdgSupply);\r\n      if (tokenInfo.isStable) {\r\n        stableGlp += parseFloat(`${formatAmount(currentWeightBps, 2, 2, false)}`);\r\n      }\r\n      totalGlp += parseFloat(`${formatAmount(currentWeightBps, 2, 2, false)}`);\r\n      return {\r\n        fullname: token.name,\r\n        name: token.symbol,\r\n        value: parseFloat(`${formatAmount(currentWeightBps, 2, 2, false)}`),\r\n      };\r\n    }\r\n    return null;\r\n  });\r\n\r\n  let stablePercentage = totalGlp > 0 ? ((stableGlp * 100) / totalGlp).toFixed(2) : \"0.0\";\r\n\r\n  glpPool = glpPool.filter(function (element) {\r\n    return element !== null;\r\n  });\r\n\r\n  glpPool = glpPool.sort(function (a, b) {\r\n    if (a.value < b.value) return 1;\r\n    else return -1;\r\n  });\r\n\r\n  gmxDistributionData = gmxDistributionData.sort(function (a, b) {\r\n    if (a.value < b.value) return 1;\r\n    else return -1;\r\n  });\r\n\r\n  const [gmxActiveIndex, setGMXActiveIndex] = useState(null);\r\n\r\n  const onGMXDistributionChartEnter = (_, index) => {\r\n    setGMXActiveIndex(index);\r\n  };\r\n\r\n  const onGMXDistributionChartLeave = (_, index) => {\r\n    setGMXActiveIndex(null);\r\n  };\r\n\r\n  const [glpActiveIndex, setGLPActiveIndex] = useState(null);\r\n\r\n  const onGLPPoolChartEnter = (_, index) => {\r\n    setGLPActiveIndex(index);\r\n  };\r\n\r\n  const onGLPPoolChartLeave = (_, index) => {\r\n    setGLPActiveIndex(null);\r\n  };\r\n\r\n  const CustomTooltip = ({ active, payload }) => {\r\n    if (active && payload && payload.length) {\r\n      return (\r\n        <div className=\"stats-label\">\r\n          <div className=\"stats-label-color\" style={{ backgroundColor: payload[0].color }}></div>\r\n          {payload[0].value}% {payload[0].name}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <SEO title={getPageTitle(\"Dashboard\")}>\r\n      <div className=\"default-container DashboardV2 page-layout\">\r\n        <div className=\"section-title-block\">\r\n          <div className=\"section-title-icon\"></div>\r\n          <div className=\"section-title-content\">\r\n            <div className=\"Page-title\">\r\n              <Trans>Stats</Trans> {chainId === AVALANCHE && <img src={avalanche24Icon} alt=\"avalanche24Icon\" />}\r\n              {chainId === ARBITRUM && <img src={arbitrum24Icon} alt=\"arbitrum24Icon\" />}\r\n            </div>\r\n            <div className=\"Page-description\">\r\n              <Trans>\r\n                {chainName} Total Stats start from {totalStatsStartDate}.<br /> For detailed stats:\r\n              </Trans>{\" \"}\r\n              {chainId === ARBITRUM && (\r\n                <a href=\"https://stats.gmx.io\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  https://stats.gmx.io\r\n                </a>\r\n              )}\r\n              {chainId === AVALANCHE && (\r\n                <a href=\"https://stats.gmx.io/avalanche\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  https://stats.gmx.io/avalanche\r\n                </a>\r\n              )}\r\n              .\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"DashboardV2-content\">\r\n          <div className=\"DashboardV2-cards\">\r\n            <div className=\"App-card\">\r\n              <div className=\"App-card-title\">\r\n                <Trans>Overview</Trans>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-content\">\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">AUM</div>\r\n                  <div>\r\n                    <TooltipComponent\r\n                      handle={`$${formatAmount(tvl, USD_DECIMALS, 0, true)}`}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => (\r\n                        <span>{t`Assets Under Management: GMX staked (All chains) + GLP pool (${chainName})`}</span>\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">GLP Pool</div>\r\n                  <div>\r\n                    <TooltipComponent\r\n                      handle={`$${formatAmount(aum, USD_DECIMALS, 0, true)}`}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => <span>{t`Total value of tokens in GLP pool (${chainName})`}</span>}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>24h Volume</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <TooltipComponent\r\n                      position=\"right-bottom\"\r\n                      className=\"nowrap\"\r\n                      handle={`$${formatAmount(currentVolumeInfo?.[chainId]?.totalVolume, USD_DECIMALS, 0, true)}`}\r\n                      renderContent={() => (\r\n                        <StatsTooltip\r\n                          title={t`Volume`}\r\n                          arbitrumValue={currentVolumeInfo?.[ARBITRUM].totalVolume}\r\n                          avaxValue={currentVolumeInfo?.[AVALANCHE].totalVolume}\r\n                          total={currentVolumeInfo?.totalVolume}\r\n                        />\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Long Positions</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <TooltipComponent\r\n                      position=\"right-bottom\"\r\n                      className=\"nowrap\"\r\n                      handle={`$${formatAmount(\r\n                        positionStatsInfo?.[chainId]?.totalLongPositionSizes,\r\n                        USD_DECIMALS,\r\n                        0,\r\n                        true\r\n                      )}`}\r\n                      renderContent={() => (\r\n                        <StatsTooltip\r\n                          title={t`Long Positions`}\r\n                          arbitrumValue={positionStatsInfo?.[ARBITRUM].totalLongPositionSizes}\r\n                          avaxValue={positionStatsInfo?.[AVALANCHE].totalLongPositionSizes}\r\n                          total={positionStatsInfo?.totalLongPositionSizes}\r\n                        />\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Short Positions</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <TooltipComponent\r\n                      position=\"right-bottom\"\r\n                      className=\"nowrap\"\r\n                      handle={`$${formatAmount(\r\n                        positionStatsInfo?.[chainId]?.totalShortPositionSizes,\r\n                        USD_DECIMALS,\r\n                        0,\r\n                        true\r\n                      )}`}\r\n                      renderContent={() => (\r\n                        <StatsTooltip\r\n                          title={t`Short Positions`}\r\n                          arbitrumValue={positionStatsInfo?.[ARBITRUM].totalShortPositionSizes}\r\n                          avaxValue={positionStatsInfo?.[AVALANCHE].totalShortPositionSizes}\r\n                          total={positionStatsInfo?.totalShortPositionSizes}\r\n                        />\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                {feeHistory.length ? (\r\n                  <div className=\"App-card-row\">\r\n                    <div className=\"label\">\r\n                      <Trans>Fees since</Trans> {formatDate(feeHistory[0].to)}\r\n                    </div>\r\n                    <div>\r\n                      <TooltipComponent\r\n                        position=\"right-bottom\"\r\n                        className=\"nowrap\"\r\n                        handle={`$${formatAmount(currentFees?.[chainId], USD_DECIMALS, 2, true)}`}\r\n                        renderContent={() => (\r\n                          <StatsTooltip\r\n                            title={t`Fees`}\r\n                            arbitrumValue={currentFees?.[ARBITRUM]}\r\n                            avaxValue={currentFees?.[AVALANCHE]}\r\n                            total={currentFees?.total}\r\n                          />\r\n                        )}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card\">\r\n              <div className=\"App-card-title\">\r\n                <Trans>Total Stats</Trans>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-content\">\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Total Fees</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <TooltipComponent\r\n                      position=\"right-bottom\"\r\n                      className=\"nowrap\"\r\n                      handle={`$${numberWithCommas(totalFees?.[chainId])}`}\r\n                      renderContent={() => (\r\n                        <StatsTooltip\r\n                          title={t`Total Fees`}\r\n                          arbitrumValue={totalFees?.[ARBITRUM]}\r\n                          avaxValue={totalFees?.[AVALANCHE]}\r\n                          total={totalFees?.total}\r\n                          decimalsForConversion={0}\r\n                        />\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Total Volume</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <TooltipComponent\r\n                      position=\"right-bottom\"\r\n                      className=\"nowrap\"\r\n                      handle={`$${formatAmount(totalVolume?.[chainId], USD_DECIMALS, 0, true)}`}\r\n                      renderContent={() => (\r\n                        <StatsTooltip\r\n                          title={t`Total Volume`}\r\n                          arbitrumValue={totalVolume?.[ARBITRUM]}\r\n                          avaxValue={totalVolume?.[AVALANCHE]}\r\n                          total={totalVolume?.total}\r\n                        />\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Floor Price Fund</Trans>\r\n                  </div>\r\n                  <div>${formatAmount(totalFloorPriceFundUsd, 30, 0, true)}</div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"Tab-title-section\">\r\n            <div className=\"Page-title\">\r\n              Tokens {chainId === AVALANCHE && <img src={avalanche24Icon} alt=\"avalanche24Icon\" />}\r\n              {chainId === ARBITRUM && <img src={arbitrum24Icon} alt=\"arbitrum24Icon\" />}\r\n            </div>\r\n            <div className=\"Page-description\">\r\n              <Trans>Platform and GLP index tokens.</Trans>\r\n            </div>\r\n          </div>\r\n          <div className=\"DashboardV2-token-cards\">\r\n            <div className=\"stats-wrapper stats-wrapper--gmx\">\r\n              <div className=\"App-card\">\r\n                <div className=\"stats-block\">\r\n                  <div className=\"App-card-title\">\r\n                    <div className=\"App-card-title-mark\">\r\n                      <div className=\"App-card-title-mark-icon\">\r\n                        <img src={gmx40Icon} alt=\"gmx40Icon\" />\r\n                      </div>\r\n                      <div className=\"App-card-title-mark-info\">\r\n                        <div className=\"App-card-title-mark-title\">GMX</div>\r\n                        <div className=\"App-card-title-mark-subtitle\">GMX</div>\r\n                      </div>\r\n                      <div>\r\n                        <AssetDropdown assetSymbol=\"GMX\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">Price</div>\r\n                      <div>\r\n                        {!gmxPrice && \"...\"}\r\n                        {gmxPrice && (\r\n                          <TooltipComponent\r\n                            position=\"right-bottom\"\r\n                            className=\"nowrap\"\r\n                            handle={\"$\" + formatAmount(gmxPrice, USD_DECIMALS, 2, true)}\r\n                            renderContent={() => (\r\n                              <>\r\n                                <StatsTooltipRow\r\n                                  label=\"Price on Arbitrum\"\r\n                                  value={formatAmount(gmxPriceFromArbitrum, USD_DECIMALS, 2, true)}\r\n                                  showDollar={true}\r\n                                />\r\n                                <StatsTooltipRow\r\n                                  label=\"Price on Avalanche\"\r\n                                  value={formatAmount(gmxPriceFromAvalanche, USD_DECIMALS, 2, true)}\r\n                                  showDollar={true}\r\n                                />\r\n                              </>\r\n                            )}\r\n                          />\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Supply</Trans>\r\n                      </div>\r\n                      <div>{formatAmount(totalGmxSupply, GMX_DECIMALS, 0, true)} GMX</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Total Staked</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <TooltipComponent\r\n                          position=\"right-bottom\"\r\n                          className=\"nowrap\"\r\n                          handle={`$${formatAmount(stakedGmxSupplyUsd, USD_DECIMALS, 0, true)}`}\r\n                          renderContent={() => (\r\n                            <StatsTooltip\r\n                              title={t`Staked`}\r\n                              arbitrumValue={arbitrumStakedGmx}\r\n                              avaxValue={avaxStakedGmx}\r\n                              total={totalStakedGmx}\r\n                              decimalsForConversion={GMX_DECIMALS}\r\n                              showDollar={false}\r\n                            />\r\n                          )}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Market Cap</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(gmxMarketCap, USD_DECIMALS, 0, true)}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"stats-piechart\" onMouseLeave={onGMXDistributionChartLeave}>\r\n                  {gmxDistributionData.length > 0 && (\r\n                    <PieChart width={210} height={210}>\r\n                      <Pie\r\n                        data={gmxDistributionData}\r\n                        cx={100}\r\n                        cy={100}\r\n                        innerRadius={73}\r\n                        outerRadius={80}\r\n                        fill=\"#8884d8\"\r\n                        dataKey=\"value\"\r\n                        startAngle={90}\r\n                        endAngle={-270}\r\n                        paddingAngle={2}\r\n                        onMouseEnter={onGMXDistributionChartEnter}\r\n                        onMouseOut={onGMXDistributionChartLeave}\r\n                        onMouseLeave={onGMXDistributionChartLeave}\r\n                      >\r\n                        {gmxDistributionData.map((entry, index) => (\r\n                          <Cell\r\n                            key={`cell-${index}`}\r\n                            fill={entry.color}\r\n                            style={{\r\n                              filter:\r\n                                gmxActiveIndex === index\r\n                                  ? `drop-shadow(0px 0px 6px ${hexToRgba(entry.color, 0.7)})`\r\n                                  : \"none\",\r\n                              cursor: \"pointer\",\r\n                            }}\r\n                            stroke={entry.color}\r\n                            strokeWidth={gmxActiveIndex === index ? 1 : 1}\r\n                          />\r\n                        ))}\r\n                      </Pie>\r\n                      <text x={\"50%\"} y={\"50%\"} fill=\"white\" textAnchor=\"middle\" dominantBaseline=\"middle\">\r\n                        <Trans>Distribution</Trans>\r\n                      </text>\r\n                      <Tooltip content={<CustomTooltip />} />\r\n                    </PieChart>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card\">\r\n                <div className=\"stats-block\">\r\n                  <div className=\"App-card-title\">\r\n                    <div className=\"App-card-title-mark\">\r\n                      <div className=\"App-card-title-mark-icon\">\r\n                        <img src={glp40Icon} alt=\"glp40Icon\" />\r\n                        {chainId === ARBITRUM ? (\r\n                          <img src={arbitrum16Icon} alt=\"arbitrum16Icon\" className=\"selected-network-symbol\" />\r\n                        ) : (\r\n                          <img src={avalanche16Icon} alt=\"avalanche16Icon\" className=\"selected-network-symbol\" />\r\n                        )}\r\n                      </div>\r\n                      <div className=\"App-card-title-mark-info\">\r\n                        <div className=\"App-card-title-mark-title\">GLP</div>\r\n                        <div className=\"App-card-title-mark-subtitle\">GLP</div>\r\n                      </div>\r\n                      <div>\r\n                        <AssetDropdown assetSymbol=\"GLP\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Price</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(glpPrice, USD_DECIMALS, 3, true)}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Supply</Trans>\r\n                      </div>\r\n                      <div>{formatAmount(glpSupply, GLP_DECIMALS, 0, true)} GLP</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Total Staked</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(glpMarketCap, USD_DECIMALS, 0, true)}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Market Cap</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(glpMarketCap, USD_DECIMALS, 0, true)}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Stablecoin Percentage</Trans>\r\n                      </div>\r\n                      <div>{stablePercentage}%</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"stats-piechart\" onMouseOut={onGLPPoolChartLeave}>\r\n                  {glpPool.length > 0 && (\r\n                    <PieChart width={210} height={210}>\r\n                      <Pie\r\n                        data={glpPool}\r\n                        cx={100}\r\n                        cy={100}\r\n                        innerRadius={73}\r\n                        outerRadius={80}\r\n                        fill=\"#8884d8\"\r\n                        dataKey=\"value\"\r\n                        startAngle={90}\r\n                        endAngle={-270}\r\n                        onMouseEnter={onGLPPoolChartEnter}\r\n                        onMouseOut={onGLPPoolChartLeave}\r\n                        onMouseLeave={onGLPPoolChartLeave}\r\n                        paddingAngle={2}\r\n                      >\r\n                        {glpPool.map((entry, index) => (\r\n                          <Cell\r\n                            key={`cell-${index}`}\r\n                            fill={GLPPOOLCOLORS[entry.name]}\r\n                            style={{\r\n                              filter:\r\n                                glpActiveIndex === index\r\n                                  ? `drop-shadow(0px 0px 6px ${hexToRgba(GLPPOOLCOLORS[entry.name], 0.7)})`\r\n                                  : \"none\",\r\n                              cursor: \"pointer\",\r\n                            }}\r\n                            stroke={GLPPOOLCOLORS[entry.name]}\r\n                            strokeWidth={glpActiveIndex === index ? 1 : 1}\r\n                          />\r\n                        ))}\r\n                      </Pie>\r\n                      <text x={\"50%\"} y={\"50%\"} fill=\"white\" textAnchor=\"middle\" dominantBaseline=\"middle\">\r\n                        GLP Pool\r\n                      </text>\r\n                      <Tooltip content={<CustomTooltip />} />\r\n                    </PieChart>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"token-table-wrapper App-card\">\r\n              <div className=\"App-card-title\">\r\n                <Trans>GLP Index Composition</Trans>{\" \"}\r\n                {chainId === AVALANCHE && <img src={avalanche16Icon} alt=\"avalanche16Icon\" />}\r\n                {chainId === ARBITRUM && <img src={arbitrum16Icon} alt=\"arbitrum16Icon\" />}\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <table className=\"token-table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>\r\n                      <Trans>TOKEN</Trans>\r\n                    </th>\r\n                    <th>\r\n                      <Trans>PRICE</Trans>\r\n                    </th>\r\n                    <th>\r\n                      <Trans>POOL</Trans>\r\n                    </th>\r\n                    <th>\r\n                      <Trans>WEIGHT</Trans>\r\n                    </th>\r\n                    <th>\r\n                      <Trans>UTILIZATION</Trans>\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {visibleTokens.map((token) => {\r\n                    const tokenInfo = infoTokens[token.address];\r\n                    let utilization = bigNumberify(0);\r\n                    if (tokenInfo && tokenInfo.reservedAmount && tokenInfo.poolAmount && tokenInfo.poolAmount.gt(0)) {\r\n                      utilization = tokenInfo.reservedAmount.mul(BASIS_POINTS_DIVISOR).div(tokenInfo.poolAmount);\r\n                    }\r\n                    let maxUsdgAmount = DEFAULT_MAX_USDG_AMOUNT;\r\n                    if (tokenInfo.maxUsdgAmount && tokenInfo.maxUsdgAmount.gt(0)) {\r\n                      maxUsdgAmount = tokenInfo.maxUsdgAmount;\r\n                    }\r\n                    const tokenImage = importImage(\"ic_\" + token.symbol.toLowerCase() + \"_40.svg\");\r\n\r\n                    return (\r\n                      <tr key={token.symbol}>\r\n                        <td>\r\n                          <div className=\"token-symbol-wrapper\">\r\n                            <div className=\"App-card-title-info\">\r\n                              <div className=\"App-card-title-info-icon\">\r\n                                <img src={tokenImage} alt={token.symbol} width=\"40px\" />\r\n                              </div>\r\n                              <div className=\"App-card-title-info-text\">\r\n                                <div className=\"App-card-info-title\">{token.name}</div>\r\n                                <div className=\"App-card-info-subtitle\">{token.symbol}</div>\r\n                              </div>\r\n                              <div>\r\n                                <AssetDropdown assetSymbol={token.symbol} assetInfo={token} />\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                        </td>\r\n                        <td>${formatKeyAmount(tokenInfo, \"minPrice\", USD_DECIMALS, 2, true)}</td>\r\n                        <td>\r\n                          <TooltipComponent\r\n                            handle={`$${formatKeyAmount(tokenInfo, \"managedUsd\", USD_DECIMALS, 0, true)}`}\r\n                            position=\"right-bottom\"\r\n                            renderContent={() => {\r\n                              return (\r\n                                <>\r\n                                  <StatsTooltipRow\r\n                                    label=\"Pool Amount\"\r\n                                    value={`${formatKeyAmount(tokenInfo, \"managedAmount\", token.decimals, 0, true)} ${\r\n                                      token.symbol\r\n                                    }`}\r\n                                    showDollar={false}\r\n                                  />\r\n                                  <StatsTooltipRow\r\n                                    label=\"Target Min Amount\"\r\n                                    value={`${formatKeyAmount(tokenInfo, \"bufferAmount\", token.decimals, 0, true)} ${\r\n                                      token.symbol\r\n                                    }`}\r\n                                    showDollar={false}\r\n                                  />\r\n                                  <StatsTooltipRow\r\n                                    label={`Max ${tokenInfo.symbol} Capacity`}\r\n                                    value={formatAmount(maxUsdgAmount, 18, 0, true)}\r\n                                    showDollar={true}\r\n                                  />\r\n                                </>\r\n                              );\r\n                            }}\r\n                          />\r\n                        </td>\r\n                        <td>{getWeightText(tokenInfo)}</td>\r\n                        <td>{formatAmount(utilization, 2, 2, false)}%</td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n            <div className=\"token-grid\">\r\n              {visibleTokens.map((token) => {\r\n                const tokenInfo = infoTokens[token.address];\r\n                let utilization = bigNumberify(0);\r\n                if (tokenInfo && tokenInfo.reservedAmount && tokenInfo.poolAmount && tokenInfo.poolAmount.gt(0)) {\r\n                  utilization = tokenInfo.reservedAmount.mul(BASIS_POINTS_DIVISOR).div(tokenInfo.poolAmount);\r\n                }\r\n                let maxUsdgAmount = DEFAULT_MAX_USDG_AMOUNT;\r\n                if (tokenInfo.maxUsdgAmount && tokenInfo.maxUsdgAmount.gt(0)) {\r\n                  maxUsdgAmount = tokenInfo.maxUsdgAmount;\r\n                }\r\n\r\n                const tokenImage = importImage(\"ic_\" + token.symbol.toLowerCase() + \"_24.svg\");\r\n                return (\r\n                  <div className=\"App-card\" key={token.symbol}>\r\n                    <div className=\"App-card-title\">\r\n                      <div className=\"mobile-token-card\">\r\n                        <img src={tokenImage} alt={token.symbol} width=\"20px\" />\r\n                        <div className=\"token-symbol-text\">{token.symbol}</div>\r\n                        <div>\r\n                          <AssetDropdown assetSymbol={token.symbol} assetInfo={token} />\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-divider\"></div>\r\n                    <div className=\"App-card-content\">\r\n                      <div className=\"App-card-row\">\r\n                        <div className=\"label\">Price</div>\r\n                        <div>${formatKeyAmount(tokenInfo, \"minPrice\", USD_DECIMALS, 2, true)}</div>\r\n                      </div>\r\n                      <div className=\"App-card-row\">\r\n                        <div className=\"label\">Pool</div>\r\n                        <div>\r\n                          <TooltipComponent\r\n                            handle={`$${formatKeyAmount(tokenInfo, \"managedUsd\", USD_DECIMALS, 0, true)}`}\r\n                            position=\"right-bottom\"\r\n                            renderContent={() => {\r\n                              return (\r\n                                <>\r\n                                  <StatsTooltipRow\r\n                                    label=\"Pool Amount\"\r\n                                    value={`${formatKeyAmount(tokenInfo, \"managedAmount\", token.decimals, 0, true)} ${\r\n                                      token.symbol\r\n                                    }`}\r\n                                    showDollar={false}\r\n                                  />\r\n                                  <StatsTooltipRow\r\n                                    label=\"Target Min Amount\"\r\n                                    value={`${formatKeyAmount(tokenInfo, \"bufferAmount\", token.decimals, 0, true)} ${\r\n                                      token.symbol\r\n                                    }`}\r\n                                    showDollar={false}\r\n                                  />\r\n                                  <StatsTooltipRow\r\n                                    label={`Max ${tokenInfo.symbol} Capacity`}\r\n                                    value={formatAmount(maxUsdgAmount, 18, 0, true)}\r\n                                  />\r\n                                </>\r\n                              );\r\n                            }}\r\n                          />\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"App-card-row\">\r\n                        <div className=\"label\">Weight</div>\r\n                        <div>{getWeightText(tokenInfo)}</div>\r\n                      </div>\r\n                      <div className=\"App-card-row\">\r\n                        <div className=\"label\">Utilization</div>\r\n                        <div>{formatAmount(utilization, 2, 2, false)}%</div>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <Footer />\r\n      </div>\r\n    </SEO>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Trans } from \"@lingui/macro\";\r\nimport SEO from \"../../components/Common/SEO\";\r\n\r\nimport Footer from \"../../components/Footer/Footer\";\r\nimport { getPageTitle, ARBITRUM, AVALANCHE } from \"../../lib/legacy\";\r\n\r\nimport arbitrumIcon from \"../../img/ic_arbitrum_16.svg\";\r\nimport avalancheIcon from \"../../img/ic_avalanche_16.svg\";\r\n\r\nimport \"./Ecosystem.css\";\r\n\r\nconst NETWORK_ICONS = {\r\n  [ARBITRUM]: arbitrumIcon,\r\n  [AVALANCHE]: avalancheIcon,\r\n};\r\n\r\nconst NETWORK_ICON_ALTS = {\r\n  [ARBITRUM]: \"Arbitrum Icon\",\r\n  [AVALANCHE]: \"Avalanche Icon\",\r\n};\r\n\r\nexport default function Ecosystem() {\r\n  const gmxPages = [\r\n    {\r\n      title: \"GMX Governance\",\r\n      link: \"https://gov.gmx.io/\",\r\n      linkLabel: \"gov.gmx.io\",\r\n      about: \"GMX Governance Page\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Stats\",\r\n      link: \"https://stats.gmx.io/\",\r\n      linkLabel: \"stats.gmx.io\",\r\n      about: \"GMX Stats Page\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Proposals\",\r\n      link: \"https://snapshot.org/#/gmx.eth\",\r\n      linkLabel: \"snapshot.org\",\r\n      about: \"GMX Proposals Voting page\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Announcements\",\r\n      link: \"https://t.me/GMX_Announcements\",\r\n      linkLabel: \"t.me\",\r\n      about: \"GMX Announcements and Updates\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n  ];\r\n\r\n  const communityProjects = [\r\n    {\r\n      title: \"GMX Blueberry Club\",\r\n      link: \"https://www.blueberry.club/\",\r\n      linkLabel: \"blueberry.club\",\r\n      about: \"GMX Blueberry NFTs\",\r\n      creatorLabel: \"@xm92boi\",\r\n      creatorLink: \"https://t.me/xm92boi\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n    {\r\n      title: \"GMX Leaderboard\",\r\n      link: \"https://www.gmx.house/\",\r\n      linkLabel: \"gmx.house\",\r\n      about: \"Leaderboard for GMX traders\",\r\n      creatorLabel: \"@Itburnz\",\r\n      creatorLink: \"https://t.me/Itburnz\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Positions Bot\",\r\n      link: \"https://t.me/GMXPositions\",\r\n      linkLabel: \"t.me\",\r\n      about: \"Telegram bot for GMX position updates\",\r\n      creatorLabel: \"@zhongfu\",\r\n      creatorLink: \"https://t.me/zhongfu\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Blueberry Pulse\",\r\n      link: \"https://blueberrypulse.substack.com/\",\r\n      linkLabel: \"substack.com\",\r\n      about: \"GMX Weekly Updates\",\r\n      creatorLabel: \"@puroscohiba\",\r\n      creatorLink: \"https://t.me/puroscohiba\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"DegenClip\",\r\n      link: \"https://degenclip.com/gmx\",\r\n      linkLabel: \"degenclip.com\",\r\n      about: \"Community curated tweet collection\",\r\n      creatorLabel: \"@ox21l\",\r\n      creatorLink: \"https://t.me/ox21l\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Yield Simulator\",\r\n      link: \"https://gmx.defisims.com/\",\r\n      linkLabel: \"defisims.com\",\r\n      about: \"Yield simulator for GMX\",\r\n      creatorLabel: \"@kyzoeth\",\r\n      creatorLink: \"https://twitter.com/kyzoeth\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Returns Calculator\",\r\n      link: \"https://docs.google.com/spreadsheets/u/4/d/1mQZlztz_NpTg5qQiYIzc_Ls1OTLfMOUtmEQN-WW8jj4/copy\",\r\n      linkLabel: \"docs.google.com\",\r\n      about: \"Returns calculator for GMX and GLP\",\r\n      creatorLabel: \"@AStoicTrader1\",\r\n      creatorLink: \"https://twitter.com/AStoicTrader1\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Compound Calculator\",\r\n      link: \"https://docs.google.com/spreadsheets/d/14DiIE1wZkK9-Y5xSx1PzIgmpcj4ccz1YVw5nwzIWLgI/edit#gid=0\",\r\n      linkLabel: \"docs.google.com\",\r\n      about: \"Optimal compound interval calculator\",\r\n      creatorLabel: \"@ChasenKaminsky\",\r\n      creatorLink: \"https://twitter.com/ChasenKaminsky\",\r\n      chainIds: [AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Trading Stats\",\r\n      link: \"https://t.me/GMXTradingStats\",\r\n      linkLabel: \"t.me\",\r\n      about: \"Telegram bot for Open Interest on GMX\",\r\n      creatorLabel: \"@SniperMonke01\",\r\n      creatorLink: \"https://twitter.com/SniperMonke01\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Staking Bot\",\r\n      link: \"https://t.me/GMX_Staking_bot\",\r\n      linkLabel: \"t.me\",\r\n      about: \"GMX staking rewards updates and insights\",\r\n      creatorLabel: \"@GMX_Staking_bot\",\r\n      creatorLink: \"https://twitter.com/GMX_Staking_bot\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Staking Calculator\",\r\n      link: \"https://gmxstaking.com\",\r\n      linkLabel: \"gmxstaking.com\",\r\n      about: \"GMX staking calculator\",\r\n      creatorLabel: \"@n1njawtf\",\r\n      creatorLink: \"https://t.me/n1njawtf\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n  ];\r\n\r\n  const dashboardProjects = [\r\n    {\r\n      title: \"GMX Referrals Dashboard\",\r\n      link: \"https://www.gmxreferrals.com/\",\r\n      linkLabel: \"gmxreferrals.com\",\r\n      about: \"Dashboard for GMX referral stats\",\r\n      creatorLabel: \"@kyzoeth\",\r\n      creatorLink: \"https://twitter.com/kyzoeth\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Terminal\",\r\n      link: \"https://gmxterminal.com\",\r\n      linkLabel: \"gmxterminal.com\",\r\n      about: \"GMX explorer for stats and traders\",\r\n      creatorLabel: \"@vipineth\",\r\n      creatorLink: \"https://t.me/vipineth\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n    {\r\n      title: \"GMX Analytics\",\r\n      link: \"https://gmxstats.com/\",\r\n      linkLabel: \"gmxstats.com\",\r\n      about: \"Financial reports and protocol analytics\",\r\n      creatorLabel: \"@CryptoMessiah\",\r\n      creatorLink: \"https://t.me/LarpCapital\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"TokenTerminal\",\r\n      link: \"https://tokenterminal.com/terminal/projects/gmx\",\r\n      linkLabel: \"tokenterminal.com\",\r\n      about: \"GMX fundamentals\",\r\n      creatorLabel: \"@tokenterminal\",\r\n      creatorLink: \"https://twitter.com/tokenterminal\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"CryptoFees\",\r\n      link: \"https://cryptofees.info\",\r\n      linkLabel: \"cryptofees.info\",\r\n      about: \"Fees generated by GMX\",\r\n      creatorLabel: \"@CryptoFeesInfo\",\r\n      creatorLink: \"https://twitter.com/CryptoFeesInfo\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Shogun Dashboard (Dune Arbitrum)\",\r\n      link: \"https://dune.com/shogun/gmx-analytics-arbitrum\",\r\n      linkLabel: \"dune.com\",\r\n      about: \"Protocol analytics\",\r\n      creatorLabel: \"@JamesCliffyz\",\r\n      creatorLink: \"https://twitter.com/JamesCliffyz\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n    {\r\n      title: \"Shogun Dashboard (Dune Avalanche)\",\r\n      link: \"https://dune.com/shogun/gmx-analytics-avalanche\",\r\n      linkLabel: \"dune.com\",\r\n      about: \"Protocol analytics\",\r\n      creatorLabel: \"@JamesCliffyz\",\r\n      creatorLink: \"https://twitter.com/JamesCliffyz\",\r\n      chainIds: [AVALANCHE],\r\n    },\r\n    {\r\n      title: \"GMX Perpetuals Data\",\r\n      link: \"https://app.laevitas.ch/altsderivs/GMX/perpetualswaps\",\r\n      linkLabel: \"laevitas.ch\",\r\n      about: \"GMX Perpetuals Data\",\r\n      creatorLabel: \"@laevitas1\",\r\n      creatorLink: \"https://twitter.com/laevitas1\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n    {\r\n      title: \"GMX Blueberry Leaderboard\",\r\n      link: \"https://www.blueberryboard.com\",\r\n      linkLabel: \"blueberryboard.com\",\r\n      about: \"GBC NFTs APR tracker and rewards\",\r\n      creatorLabel: \"@kyzoeth\",\r\n      creatorLink: \"https://twitter.com/kyzoeth\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n  ];\r\n\r\n  const integrations = [\r\n    {\r\n      title: \"DeBank\",\r\n      link: \"debank.com\",\r\n      linkLabe: \"debank.com\",\r\n      about: \"DeFi Portfolio Tracker\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1439711532884152324\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Defi Llama\",\r\n      link: \"https://defillama.com\",\r\n      linkLabel: \"defillama.com\",\r\n      about: \"Decentralized Finance Dashboard\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1438124768033660938\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Dopex\",\r\n      link: \"https://dopex.io\",\r\n      linkLabel: \"dopex.io\",\r\n      about: \"Decentralized Options Protocol\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1482445801523716099\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Rook\",\r\n      link: \"https://www.rook.fi/\",\r\n      linkLabel: \"rook.fi\",\r\n      about: \"MEV Optimizer\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/Rook/status/1509613786600116251\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Jones DAO\",\r\n      link: \"https://jonesdao.io\",\r\n      linkLabel: \"jonesdao.io\",\r\n      about: \"Decentralized Options Strategies\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1482788805635678212\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n    {\r\n      title: \"Yield Yak Optimizer\",\r\n      link: \"https://yieldyak.com/\",\r\n      linkLabel: \"yieldyak.com\",\r\n      about: \"Yield Optimizer on Avalanche\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1484601407378378754\",\r\n      chainIds: [AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Vovo Finance\",\r\n      link: \"https://vovo.finance/\",\r\n      linkLabel: \"vovo.finance\",\r\n      about: \"Structured Products\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/VovoFinance/status/1531517177790345217\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n    {\r\n      title: \"Stabilize Protocol\",\r\n      link: \"https://www.stabilize.finance/\",\r\n      linkLabel: \"stabilize.finance\",\r\n      about: \"Yield Vaults\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/StabilizePro/status/1532348674986082306\",\r\n      chainIds: [ARBITRUM],\r\n    },\r\n    {\r\n      title: \"DODO\",\r\n      link: \"https://dodoex.io/\",\r\n      linkLabel: \"dodoex.io\",\r\n      about: \"Decentralized Trading Protocol\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1438899138549145605\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Open Ocean\",\r\n      link: \"https://openocean.finance/\",\r\n      linkLabel: \"openocean.finance\",\r\n      about: \"DEX Aggregator\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1495780826016989191\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Paraswap\",\r\n      link: \"https://www.paraswap.io/\",\r\n      linkLabel: \"paraswap.io\",\r\n      about: \"DEX Aggregator\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/paraswap/status/1546869879336222728\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"1inch\",\r\n      link: \"https://1inch.io/\",\r\n      linkLabel: \"1inch.io\",\r\n      about: \"DEX Aggregator\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/GMX_IO/status/1522247451410845696\",\r\n      chainIds: [ARBITRUM, AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Firebird Finance\",\r\n      link: \"https://app.firebird.finance/swap\",\r\n      linkLabel: \"firebird.finance\",\r\n      about: \"DEX Aggregator\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/financefirebird/status/1561767094064238595\",\r\n      chainIds: [AVALANCHE],\r\n    },\r\n    {\r\n      title: \"Yield Yak Swap\",\r\n      link: \"https://yieldyak.com/swap\",\r\n      linkLabel: \"yieldyak.com\",\r\n      about: \"DEX Aggregator\",\r\n      announcementLabel: \"twitter.com\",\r\n      announcementLink: \"https://twitter.com/yieldyak_/status/1484458884827947008\",\r\n      chainIds: [AVALANCHE],\r\n    },\r\n  ];\r\n\r\n  const telegramGroups = [\r\n    {\r\n      title: \"GMX\",\r\n      link: \"https://t.me/GMX_IO\",\r\n      linkLabel: \"t.me\",\r\n      about: \"Telegram Group\",\r\n    },\r\n    {\r\n      title: \"GMX (Chinese)\",\r\n      link: \"https://t.me/gmxch\",\r\n      linkLabel: \"t.me\",\r\n      about: \"Telegram Group (Chinese)\",\r\n    },\r\n    {\r\n      title: \"GMX (Portuguese)\",\r\n      link: \"https://t.me/GMX_Portuguese\",\r\n      linkLabel: \"t.me\",\r\n      about: \"Telegram Group (Portuguese)\",\r\n    },\r\n    {\r\n      title: \"GMX Trading Chat\",\r\n      link: \"https://t.me/gambittradingchat\",\r\n      linkLabel: \"t.me\",\r\n      about: \"GMX community discussion\",\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <SEO title={getPageTitle(\"Ecosystem Projects\")}>\r\n      <div className=\"default-container page-layout\">\r\n        <div>\r\n          <div className=\"section-title-block\">\r\n            <div className=\"section-title-icon\"></div>\r\n            <div className=\"section-title-content\">\r\n              <div className=\"Page-title\">\r\n                <Trans>GMX Pages</Trans>\r\n              </div>\r\n              <div className=\"Page-description\">\r\n                <Trans>GMX ecosystem pages.</Trans>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"DashboardV2-projects\">\r\n            {gmxPages.map((item) => {\r\n              const linkLabel = item.linkLabel ? item.linkLabel : item.link;\r\n              return (\r\n                <div className=\"App-card\" key={item.title}>\r\n                  <div className=\"App-card-title\">\r\n                    {item.title}\r\n                    <div className=\"App-card-title-icon\">\r\n                      {item.chainIds.map((network) => (\r\n                        <img key={network} src={NETWORK_ICONS[network]} alt={NETWORK_ICON_ALTS[network]} />\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Link</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {linkLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>About</Trans>\r\n                      </div>\r\n                      <div>{item.about}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"Tab-title-section\">\r\n            <div className=\"Page-title\">\r\n              <Trans>Community Projects</Trans>\r\n            </div>\r\n            <div className=\"Page-description\">\r\n              <Trans>Projects developed by the GMX community.</Trans>\r\n            </div>\r\n          </div>\r\n          <div className=\"DashboardV2-projects\">\r\n            {communityProjects.map((item) => {\r\n              const linkLabel = item.linkLabel ? item.linkLabel : item.link;\r\n              return (\r\n                <div className=\"App-card\" key={item.title}>\r\n                  <div className=\"App-card-title\">\r\n                    {item.title}\r\n                    <div className=\"App-card-title-icon\">\r\n                      {item.chainIds.map((network) => (\r\n                        <img key={network} src={NETWORK_ICONS[network]} alt={NETWORK_ICON_ALTS[network]} />\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Link</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {linkLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>About</Trans>\r\n                      </div>\r\n                      <div>{item.about}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Creator</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.creatorLink} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {item.creatorLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"Tab-title-section\">\r\n            <div className=\"Page-title\">\r\n              <Trans>Dashboards</Trans>\r\n            </div>\r\n            <div className=\"Page-description\">\r\n              <Trans>GMX dashboards and analytics.</Trans>\r\n            </div>\r\n          </div>\r\n          <div className=\"DashboardV2-projects\">\r\n            {dashboardProjects.map((item) => {\r\n              const linkLabel = item.linkLabel ? item.linkLabel : item.link;\r\n              return (\r\n                <div className=\"App-card\" key={item.title}>\r\n                  <div className=\"App-card-title\">\r\n                    {item.title}\r\n                    <div className=\"App-card-title-icon\">\r\n                      {item.chainIds.map((network) => (\r\n                        <img key={network} src={NETWORK_ICONS[network]} alt={NETWORK_ICON_ALTS[network]} />\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Link</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {linkLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>About</Trans>\r\n                      </div>\r\n                      <div>{item.about}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Creator</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.creatorLink} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {item.creatorLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"Tab-title-section\">\r\n            <div className=\"Page-title\">\r\n              <Trans>Partnerships and Integrations</Trans>\r\n            </div>\r\n            <div className=\"Page-description\">\r\n              <Trans>Projects integrated with GMX.</Trans>\r\n            </div>\r\n          </div>\r\n          <div className=\"DashboardV2-projects\">\r\n            {integrations.map((item) => {\r\n              const linkLabel = item.linkLabel ? item.linkLabel : item.link;\r\n              return (\r\n                <div key={item.title} className=\"App-card\">\r\n                  <div className=\"App-card-title\">\r\n                    {item.title}\r\n                    <div className=\"App-card-title-icon\">\r\n                      {item.chainIds.map((network) => (\r\n                        <img key={network} src={NETWORK_ICONS[network]} alt={NETWORK_ICON_ALTS[network]} />\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Link</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {linkLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>About</Trans>\r\n                      </div>\r\n                      <div>{item.about}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Announcement</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.announcementLink} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {item.announcementLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n          <div className=\"Tab-title-section\">\r\n            <div className=\"Page-title\">\r\n              <Trans>Telegram Groups</Trans>\r\n            </div>\r\n            <div className=\"Page-description\">\r\n              <Trans>Community-led Telegram groups.</Trans>\r\n            </div>\r\n          </div>\r\n          <div className=\"DashboardV2-projects\">\r\n            {telegramGroups.map((item) => {\r\n              const linkLabel = item.linkLabel ? item.linkLabel : item.link;\r\n              return (\r\n                <div className=\"App-card\" key={item.title}>\r\n                  <div className=\"App-card-title\">{item.title}</div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Link</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <a href={item.link} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          {linkLabel}\r\n                        </a>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>About</Trans>\r\n                      </div>\r\n                      <div>{item.about}</div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n        <Footer />\r\n      </div>\r\n    </SEO>\r\n  );\r\n}\r\n","import { disableBodyScroll, enableBodyScroll, clearAllBodyScrollLocks } from \"body-scroll-lock\";\r\nimport { RefObject, useEffect } from \"react\";\r\n\r\nexport const TOUCH_MOVE_CONTAINER_CLASS_NAME = \"DiableScroll-touch-move-container\";\r\n\r\n// @see https://github.com/willmcpo/body-scroll-lock#allowtouchmove\r\nconst allowTouchMoveFn = (el: HTMLElement) => {\r\n  while (el && el !== document.body) {\r\n    if (el.className?.includes?.(TOUCH_MOVE_CONTAINER_CLASS_NAME)) return true;\r\n\r\n    el = el.parentElement as HTMLElement;\r\n  }\r\n};\r\n\r\nexport default function useLockBodyScroll(\r\n  ref: RefObject<HTMLElement>,\r\n  isVisible: boolean,\r\n  opts: {\r\n    disableLock?: boolean;\r\n    allowTouchMove?: boolean;\r\n  } = {}\r\n) {\r\n  useEffect(() => {\r\n    if (opts.disableLock) {\r\n      return;\r\n    }\r\n\r\n    if (ref.current) {\r\n      if (isVisible) {\r\n        disableBodyScroll(ref.current, {\r\n          allowTouchMove: opts.allowTouchMove ? allowTouchMoveFn : undefined,\r\n        });\r\n      } else {\r\n        enableBodyScroll(ref.current);\r\n      }\r\n    }\r\n\r\n    return () => clearAllBodyScrollLocks();\r\n\r\n    // needs ref.current in deps, not just ref\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [ref.current, opts.allowTouchMove, opts.disableLock, isVisible]);\r\n}\r\n","import React, { useRef, useEffect } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\n\r\nimport { MdClose } from \"react-icons/md\";\r\n\r\nimport \"./Modal.scss\";\r\nimport useLockBodyScroll, { TOUCH_MOVE_CONTAINER_CLASS_NAME } from \"../../lib/useLockBodyScroll\";\r\n\r\nexport default function Modal(props) {\r\n  const { isVisible, setIsVisible, className, zIndex, onAfterOpen, disableBodyScrollLock, allowContentTouchMove } =\r\n    props;\r\n\r\n  const modalRef = useRef(null);\r\n\r\n  useLockBodyScroll(modalRef, isVisible, {\r\n    disableLock: false,\r\n    allowTouchMove: allowContentTouchMove,\r\n  });\r\n\r\n\r\n  useEffect(() => {\r\n    function close(e) {\r\n      if (e.keyCode === 27) {\r\n        setIsVisible(false);\r\n      }\r\n    }\r\n    window.addEventListener(\"keydown\", close);\r\n    return () => window.removeEventListener(\"keydown\", close);\r\n  }, [setIsVisible]);\r\n\r\n  useEffect(() => {\r\n    if (typeof onAfterOpen === \"function\") onAfterOpen();\r\n  }, [onAfterOpen]);\r\n\r\n  const fadeVariants = {\r\n    hidden: { opacity: 0 },\r\n    visible: { opacity: 1 },\r\n  };\r\n\r\n  if (!isVisible) {\r\n    return <></>;\r\n  }\r\n\r\n  return (\r\n    <AnimatePresence>\r\n      {isVisible && (\r\n        <motion.div\r\n          className={cx(\"Modal\", className)}\r\n          style={{ zIndex }}\r\n          initial=\"hidden\"\r\n          animate=\"visible\"\r\n          exit=\"hidden\"\r\n          variants={fadeVariants}\r\n          transition={{ duration: 0.2 }}\r\n        >\r\n          <div\r\n            className=\"Modal-backdrop\"\r\n            style={{\r\n              overflow: isVisible ? \"hidden\" : \"visible\",\r\n              position: \"fixed\",\r\n            }}\r\n            onClick={() => setIsVisible(false)}\r\n          ></div>\r\n          <div className=\"Modal-content\">\r\n            <div className=\"Modal-title-bar\">\r\n              <div className=\"Modal-title\">{props.label}</div>\r\n              <div className=\"Modal-close-button\" onClick={() => setIsVisible(false)}>\r\n                <MdClose fontSize={20} className=\"Modal-close-icon\" />\r\n              </div>\r\n            </div>\r\n            <div className=\"divider\" />\r\n            <div className={cx(\"Modal-body\", TOUCH_MOVE_CONTAINER_CLASS_NAME)} ref={modalRef}>\r\n              {props.children}\r\n            </div>\r\n          </div>\r\n        </motion.div>\r\n      )}\r\n    </AnimatePresence>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport {\r\n  getInjectedHandler,\r\n  formatKeyAmount,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  parseValue,\r\n  useChainId,\r\n  expandDecimals,\r\n  getExplorerUrl,\r\n  approveTokens,\r\n  bigNumberify,\r\n  helperToast,\r\n  CHAIN_ID,\r\n  USD_DECIMALS,\r\n  PRECISION,\r\n} from \"../../lib/legacy\";\r\n\r\nimport { getContract, XGMT_EXCLUDED_ACCOUNTS } from \"../../config/Addresses\";\r\nimport { getTokenBySymbol } from \"../../config/Tokens\";\r\n\r\nimport Reader from \"../../abis/Reader.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport YieldToken from \"../../abis/YieldToken.json\";\r\nimport YieldFarm from \"../../abis/YieldFarm.json\";\r\n\r\nimport Modal from \"../../components/Modal/Modal\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\n\r\nimport \"./Stake.css\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\n\r\nconst BASIS_POINTS_DIVISOR = 10000;\r\nconst HOURS_PER_YEAR = 8760;\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getBalanceAndSupplyData(balances) {\r\n  if (!balances || balances.length === 0) {\r\n    return {};\r\n  }\r\n\r\n  const keys = [\r\n    \"usdg\",\r\n    \"gmt\",\r\n    \"xgmt\",\r\n    \"gmtUsdg\",\r\n    \"xgmtUsdg\",\r\n    \"gmtUsdgFarm\",\r\n    \"xgmtUsdgFarm\",\r\n    \"autoUsdg\",\r\n    \"autoUsdgFarm\",\r\n  ];\r\n  const balanceData = {};\r\n  const supplyData = {};\r\n  const propsLength = 2;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    balanceData[key] = balances[i * propsLength];\r\n    supplyData[key] = balances[i * propsLength + 1];\r\n  }\r\n\r\n  return { balanceData, supplyData };\r\n}\r\n\r\nfunction getStakingData(stakingInfo) {\r\n  if (!stakingInfo || stakingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\r\n    \"usdg\",\r\n    \"xgmt\",\r\n    \"gmtUsdgFarmXgmt\",\r\n    \"gmtUsdgFarmNative\",\r\n    \"xgmtUsdgFarmXgmt\",\r\n    \"xgmtUsdgFarmNative\",\r\n    \"autoUsdgFarmXgmt\",\r\n    \"autoUsdgFarmNative\",\r\n  ];\r\n  const data = {};\r\n  const propsLength = 2;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      claimable: stakingInfo[i * propsLength],\r\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\r\n    };\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nfunction getTotalStakedData(totalStakedInfo) {\r\n  if (!totalStakedInfo || totalStakedInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"usdg\", \"xgmt\"];\r\n  const data = {};\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = totalStakedInfo[i];\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nfunction getPairData(pairInfo) {\r\n  const keys = [\"gmtUsdg\", \"xgmtUsdg\", \"bnbBusd\", \"autoUsdg\"];\r\n  if (!pairInfo || pairInfo.length === 0 || pairInfo.length !== keys.length * 2) {\r\n    return;\r\n  }\r\n\r\n  const data = {};\r\n  const propsLength = 2;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      balance0: pairInfo[i * propsLength],\r\n      balance1: pairInfo[i * propsLength + 1],\r\n    };\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nfunction getProcessedData(balanceData, supplyData, stakingData, totalStakedData, pairData, xgmtSupply) {\r\n  if (!balanceData || !supplyData || !stakingData || !totalStakedData || !pairData || !xgmtSupply) {\r\n    return {};\r\n  }\r\n\r\n  if (!supplyData.gmtUsdg || !supplyData.xgmtUsdg || !supplyData.autoUsdg) {\r\n    return {};\r\n  }\r\n\r\n  // const gmtPrice = pairData.gmtUsdg.balance1.mul(PRECISION).div(pairData.gmtUsdg.balance0)\r\n  const xgmtPrice = pairData.xgmtUsdg.balance0.eq(0)\r\n    ? bigNumberify(0)\r\n    : pairData.xgmtUsdg.balance1.mul(PRECISION).div(pairData.xgmtUsdg.balance0);\r\n  const gmtUsdgPrice = supplyData.gmtUsdg.eq(0)\r\n    ? bigNumberify(0)\r\n    : pairData.gmtUsdg.balance1.mul(PRECISION).mul(2).div(supplyData.gmtUsdg);\r\n  const xgmtUsdgPrice = supplyData.xgmtUsdg.eq(0)\r\n    ? bigNumberify(0)\r\n    : pairData.xgmtUsdg.balance1.mul(PRECISION).mul(2).div(supplyData.xgmtUsdg);\r\n  const bnbPrice = pairData.bnbBusd.balance1.mul(PRECISION).div(pairData.bnbBusd.balance0);\r\n  const autoUsdgPrice = supplyData.autoUsdg.eq(0)\r\n    ? bigNumberify(0)\r\n    : pairData.autoUsdg.balance1.mul(PRECISION).mul(2).div(supplyData.autoUsdg);\r\n\r\n  const usdgAnnualRewardsUsd = stakingData.usdg.tokensPerInterval\r\n    .mul(bnbPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n  const xgmtAnnualRewardsUsd = stakingData.xgmt.tokensPerInterval\r\n    .mul(bnbPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n\r\n  const gmtUsdgAnnualRewardsXmgtUsd = stakingData.gmtUsdgFarmXgmt.tokensPerInterval\r\n    .mul(xgmtPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n  const gmtUsdgAnnualRewardsNativeUsd = stakingData.gmtUsdgFarmNative.tokensPerInterval\r\n    .mul(bnbPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n  const gmtUsdgTotalAnnualRewardsUsd = gmtUsdgAnnualRewardsXmgtUsd.add(gmtUsdgAnnualRewardsNativeUsd);\r\n\r\n  const xgmtUsdgAnnualRewardsXmgtUsd = stakingData.xgmtUsdgFarmXgmt.tokensPerInterval\r\n    .mul(xgmtPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n  const xgmtUsdgAnnualRewardsNativeUsd = stakingData.xgmtUsdgFarmNative.tokensPerInterval\r\n    .mul(bnbPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n  const xgmtUsdgTotalAnnualRewardsUsd = xgmtUsdgAnnualRewardsXmgtUsd.add(xgmtUsdgAnnualRewardsNativeUsd);\r\n\r\n  const autoUsdgAnnualRewardsXgmtUsd = stakingData.autoUsdgFarmXgmt.tokensPerInterval\r\n    .mul(xgmtPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n  const autoUsdgAnnualRewardsNativeUsd = stakingData.autoUsdgFarmNative.tokensPerInterval\r\n    .mul(bnbPrice)\r\n    .mul(HOURS_PER_YEAR)\r\n    .div(expandDecimals(1, 18));\r\n  const autoUsdgTotalAnnualRewardsUsd = autoUsdgAnnualRewardsXgmtUsd.add(autoUsdgAnnualRewardsNativeUsd);\r\n\r\n  const data = {};\r\n  data.usdgBalance = balanceData.usdg;\r\n  data.usdgSupply = supplyData.usdg;\r\n  data.usdgTotalStaked = totalStakedData.usdg;\r\n  data.usdgTotalStakedUsd = totalStakedData.usdg.mul(PRECISION).div(expandDecimals(1, 18));\r\n  data.usdgSupplyUsd = supplyData.usdg.mul(PRECISION).div(expandDecimals(1, 18));\r\n  data.usdgApr = data.usdgTotalStaked.eq(0)\r\n    ? undefined\r\n    : usdgAnnualRewardsUsd\r\n        .mul(BASIS_POINTS_DIVISOR)\r\n        .div(totalStakedData.usdg)\r\n        .mul(expandDecimals(1, 18))\r\n        .div(PRECISION);\r\n  data.usdgRewards = stakingData.usdg.claimable;\r\n\r\n  data.xgmtBalance = balanceData.xgmt;\r\n  data.xgmtBalanceUsd = balanceData.xgmt.mul(xgmtPrice).div(expandDecimals(1, 18));\r\n  data.xgmtSupply = xgmtSupply;\r\n  data.xgmtTotalStaked = totalStakedData.xgmt;\r\n  data.xgmtTotalStakedUsd = totalStakedData.xgmt.mul(xgmtPrice).div(expandDecimals(1, 18));\r\n  data.xgmtSupplyUsd = xgmtSupply.mul(xgmtPrice).div(expandDecimals(1, 18));\r\n  data.xgmtApr = data.xgmtSupplyUsd.eq(0)\r\n    ? bigNumberify(0)\r\n    : xgmtAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.xgmtTotalStakedUsd);\r\n  data.xgmtRewards = stakingData.xgmt.claimable;\r\n\r\n  data.gmtUsdgFarmBalance = balanceData.gmtUsdgFarm;\r\n\r\n  data.gmtUsdgBalance = balanceData.gmtUsdg;\r\n  data.gmtUsdgBalanceUsd = balanceData.gmtUsdg.mul(gmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.gmtUsdgSupply = supplyData.gmtUsdg;\r\n  data.gmtUsdgSupplyUsd = supplyData.gmtUsdg.mul(gmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.gmtUsdgStaked = balanceData.gmtUsdgFarm;\r\n  data.gmtUsdgStakedUsd = balanceData.gmtUsdgFarm.mul(gmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.gmtUsdgFarmSupplyUsd = supplyData.gmtUsdgFarm.mul(gmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.gmtUsdgApr = data.gmtUsdgSupplyUsd.eq(0)\r\n    ? bigNumberify(0)\r\n    : data.gmtUsdgFarmSupplyUsd.eq(0)\r\n    ? undefined\r\n    : gmtUsdgTotalAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.gmtUsdgSupplyUsd);\r\n  data.gmtUsdgXgmtRewards = stakingData.gmtUsdgFarmXgmt.claimable;\r\n  data.gmtUsdgNativeRewards = stakingData.gmtUsdgFarmNative.claimable;\r\n  data.gmtUsdgTotalRewards = data.gmtUsdgXgmtRewards.add(data.gmtUsdgNativeRewards);\r\n  data.gmtUsdgTotalStaked = supplyData.gmtUsdgFarm;\r\n  data.gmtUsdgTotalStakedUsd = supplyData.gmtUsdgFarm.mul(gmtUsdgPrice).div(expandDecimals(1, 18));\r\n\r\n  data.xgmtUsdgBalance = balanceData.xgmtUsdg;\r\n  data.xgmtUsdgFarmBalance = balanceData.xgmtUsdgFarm;\r\n  data.xgmtUsdgBalanceUsd = balanceData.xgmtUsdg.mul(xgmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.xgmtUsdgSupply = supplyData.xgmtUsdg;\r\n  data.xgmtUsdgSupplyUsd = supplyData.xgmtUsdg.mul(xgmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.xgmtUsdgStaked = balanceData.xgmtUsdgFarm;\r\n  data.xgmtUsdgStakedUsd = balanceData.xgmtUsdgFarm.mul(xgmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.xgmtUsdgFarmSupplyUsd = supplyData.xgmtUsdgFarm.mul(xgmtUsdgPrice).div(expandDecimals(1, 18));\r\n  data.xgmtUsdgApr = data.xgmtUsdgFarmSupplyUsd.eq(0)\r\n    ? undefined\r\n    : xgmtUsdgTotalAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.xgmtUsdgFarmSupplyUsd);\r\n  data.xgmtUsdgXgmtRewards = stakingData.xgmtUsdgFarmXgmt.claimable;\r\n  data.xgmtUsdgNativeRewards = stakingData.xgmtUsdgFarmNative.claimable;\r\n  data.xgmtUsdgTotalRewards = data.xgmtUsdgXgmtRewards.add(data.xgmtUsdgNativeRewards);\r\n  data.xgmtUsdgTotalStaked = supplyData.xgmtUsdgFarm;\r\n  data.xgmtUsdgTotalStakedUsd = supplyData.xgmtUsdgFarm.mul(xgmtUsdgPrice).div(expandDecimals(1, 18));\r\n\r\n  data.autoUsdgBalance = balanceData.autoUsdg;\r\n  data.autoUsdgFarmBalance = balanceData.autoUsdgFarm;\r\n  data.autoUsdgBalanceUsd = balanceData.autoUsdg.mul(autoUsdgPrice).div(expandDecimals(1, 18));\r\n  data.autoUsdgStaked = balanceData.autoUsdgFarm;\r\n  data.autoUsdgStakedUsd = balanceData.autoUsdgFarm.mul(autoUsdgPrice).div(expandDecimals(1, 18));\r\n  data.autoUsdgFarmSupplyUsd = supplyData.autoUsdgFarm.mul(autoUsdgPrice).div(expandDecimals(1, 18));\r\n  data.autoUsdgApr = data.autoUsdgFarmSupplyUsd.eq(0)\r\n    ? bigNumberify(0)\r\n    : autoUsdgTotalAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(data.autoUsdgFarmSupplyUsd);\r\n  data.autoUsdgXgmtRewards = stakingData.autoUsdgFarmXgmt.claimable;\r\n  data.autoUsdgNativeRewards = stakingData.autoUsdgFarmNative.claimable;\r\n  data.autoUsdgTotalRewards = data.autoUsdgXgmtRewards.add(data.autoUsdgNativeRewards);\r\n  data.autoUsdgTotalStaked = supplyData.autoUsdgFarm;\r\n  data.autoUsdgTotalStakedUsd = supplyData.autoUsdgFarm.mul(autoUsdgPrice).div(expandDecimals(1, 18));\r\n\r\n  data.totalStakedUsd = data.usdgTotalStakedUsd\r\n    .add(data.xgmtTotalStakedUsd)\r\n    .add(data.gmtUsdgTotalStakedUsd)\r\n    .add(data.xgmtUsdgTotalStakedUsd)\r\n    .add(data.autoUsdgTotalStakedUsd);\r\n\r\n  return data;\r\n}\r\n\r\nfunction StakeModal(props) {\r\n  const {\r\n    isVisible,\r\n    setIsVisible,\r\n    title,\r\n    maxAmount,\r\n    value,\r\n    setValue,\r\n    active,\r\n    account,\r\n    library,\r\n    stakingTokenSymbol,\r\n    stakingTokenAddress,\r\n    farmAddress,\r\n    chainId,\r\n  } = props;\r\n  const [isStaking, setIsStaking] = useState(false);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n\r\n  const { data: tokenAllowance, mutate: updateTokenAllowance } = useSWR(\r\n    [active, chainId, stakingTokenAddress, \"allowance\", account, farmAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (active) {\r\n      library.on(\"block\", () => {\r\n        updateTokenAllowance(undefined, true);\r\n      });\r\n      return () => {\r\n        library.removeAllListeners(\"block\");\r\n      };\r\n    }\r\n  }, [active, library, updateTokenAllowance]);\r\n\r\n  let amount = parseValue(value, 18);\r\n  const needApproval = tokenAllowance && amount && amount.gt(tokenAllowance);\r\n\r\n  const getError = () => {\r\n    if (!amount || amount.eq(0)) {\r\n      return \"Enter an amount\";\r\n    }\r\n    if (maxAmount && amount.gt(maxAmount)) {\r\n      return \"Max amount exceeded\";\r\n    }\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (needApproval) {\r\n      approveTokens({\r\n        setIsApproving,\r\n        library,\r\n        tokenAddress: stakingTokenAddress,\r\n        spender: farmAddress,\r\n        chainId: CHAIN_ID,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsStaking(true);\r\n    const contract = new ethers.Contract(farmAddress, YieldFarm.abi, library.getSigner());\r\n    contract\r\n      .stake(amount)\r\n      .then(async (res) => {\r\n        const txUrl = getExplorerUrl(CHAIN_ID) + \"tx/\" + res.hash;\r\n        helperToast.success(\r\n          <div>\r\n            Stake submitted!{\" \"}\r\n            <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              View status.\r\n            </a>\r\n            <br />\r\n          </div>\r\n        );\r\n        setIsVisible(false);\r\n      })\r\n      .catch((e) => {\r\n        console.error(e);\r\n        helperToast.error(\"Stake failed\");\r\n      })\r\n      .finally(() => {\r\n        setIsStaking(false);\r\n      });\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isApproving) {\r\n      return false;\r\n    }\r\n    if (isStaking) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isApproving) {\r\n      return `Approving ${stakingTokenSymbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return `Approve ${stakingTokenSymbol}`;\r\n    }\r\n    if (isStaking) {\r\n      return \"Staking...\";\r\n    }\r\n    return \"Stake\";\r\n  };\r\n\r\n  return (\r\n    <div className=\"StakeModal\">\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title}>\r\n        <div className=\"Exchange-swap-section\">\r\n          <div className=\"Exchange-swap-section-top\">\r\n            <div className=\"muted\">\r\n              <div className=\"Exchange-swap-usd\">Stake</div>\r\n            </div>\r\n            <div className=\"muted align-right clickable\" onClick={() => setValue(formatAmountFree(maxAmount, 18, 18))}>\r\n              Max: {formatAmount(maxAmount, 18, 4, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-section-bottom\">\r\n            <div>\r\n              <input\r\n                type=\"number\"\r\n                placeholder=\"0.0\"\r\n                className=\"Exchange-swap-input\"\r\n                value={value}\r\n                onChange={(e) => setValue(e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"PositionEditor-token-symbol\">{stakingTokenSymbol}</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction UnstakeModal(props) {\r\n  const { isVisible, setIsVisible, title, maxAmount, value, setValue, library, stakingTokenSymbol, farmAddress } =\r\n    props;\r\n  const [isUnstaking, setIsUnstaking] = useState(false);\r\n\r\n  let amount = parseValue(value, 18);\r\n\r\n  const getError = () => {\r\n    if (!amount) {\r\n      return \"Enter an amount\";\r\n    }\r\n    if (amount.gt(maxAmount)) {\r\n      return \"Max amount exceeded\";\r\n    }\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    setIsUnstaking(true);\r\n    const contract = new ethers.Contract(farmAddress, YieldFarm.abi, library.getSigner());\r\n    contract\r\n      .unstake(amount)\r\n      .then(async (res) => {\r\n        const txUrl = getExplorerUrl(CHAIN_ID) + \"tx/\" + res.hash;\r\n        helperToast.success(\r\n          <div>\r\n            Unstake submitted!{\" \"}\r\n            <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              View status.\r\n            </a>\r\n            <br />\r\n          </div>\r\n        );\r\n        setIsVisible(false);\r\n      })\r\n      .catch((e) => {\r\n        console.error(e);\r\n        helperToast.error(\"Unstake failed\");\r\n      })\r\n      .finally(() => {\r\n        setIsUnstaking(false);\r\n      });\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isUnstaking) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isUnstaking) {\r\n      return \"Unstaking...\";\r\n    }\r\n    return \"Unstake\";\r\n  };\r\n\r\n  return (\r\n    <div className=\"StakeModal\">\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title}>\r\n        <div className=\"Exchange-swap-section\">\r\n          <div className=\"Exchange-swap-section-top\">\r\n            <div className=\"muted\">\r\n              <div className=\"Exchange-swap-usd\">Unstake</div>\r\n            </div>\r\n            <div className=\"muted align-right clickable\" onClick={() => setValue(formatAmountFree(maxAmount, 18, 18))}>\r\n              Max: {formatAmount(maxAmount, 18, 4, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-section-bottom\">\r\n            <div>\r\n              <input\r\n                type=\"number\"\r\n                placeholder=\"0.0\"\r\n                className=\"Exchange-swap-input\"\r\n                value={value}\r\n                onChange={(e) => setValue(e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"PositionEditor-token-symbol\">{stakingTokenSymbol}</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function StakeV1() {\r\n  const { chainId } = useChainId();\r\n  const [isStakeModalVisible, setIsStakeModalVisible] = useState(false);\r\n  const [stakeModalTitle, setStakeModalTitle] = useState(\"\");\r\n  const [stakeModalMaxAmount, setStakeModalMaxAmount] = useState(undefined);\r\n  const [stakeValue, setStakeValue] = useState(\"\");\r\n  const [stakingTokenAddress, setStakingTokenAddress] = useState(\"\");\r\n  const [stakingFarmAddress, setStakingFarmAddress] = useState(\"\");\r\n\r\n  const [isUnstakeModalVisible, setIsUnstakeModalVisible] = useState(false);\r\n  const [unstakeModalTitle, setUnstakeModalTitle] = useState(\"\");\r\n  const [unstakeModalMaxAmount, setUnstakeModalMaxAmount] = useState(undefined);\r\n  const [unstakeValue, setUnstakeValue] = useState(\"\");\r\n  const [unstakingFarmAddress, setUnstakingFarmAddress] = useState(\"\");\r\n\r\n  const { activate, active, account, library } = useWeb3React();\r\n  const connectWallet = getInjectedHandler(activate);\r\n\r\n  const readerAddress = getContract(CHAIN_ID, \"Reader\");\r\n  const ammFactoryAddressV2 = getContract(CHAIN_ID, \"AmmFactoryV2\");\r\n  const usdgAddress = getContract(CHAIN_ID, \"USDG\");\r\n  const gmtAddress = getContract(CHAIN_ID, \"GMT\");\r\n  const xgmtAddress = getContract(CHAIN_ID, \"XGMT\");\r\n  const autoAddress = getContract(CHAIN_ID, \"AUTO\");\r\n  const nativeTokenAddress = getContract(CHAIN_ID, \"NATIVE_TOKEN\");\r\n  const busdAddress = getTokenBySymbol(CHAIN_ID, \"BUSD\").address;\r\n\r\n  const gmtUsdgPairAddress = getContract(CHAIN_ID, \"GMT_USDG_PAIR\");\r\n  const xgmtUsdgPairAddress = getContract(CHAIN_ID, \"XGMT_USDG_PAIR\");\r\n  const autoUsdgPairAddress = getContract(CHAIN_ID, \"AUTO_USDG_PAIR\");\r\n  const gmtUsdgFarmAddress = getContract(CHAIN_ID, \"GMT_USDG_FARM\");\r\n  const xgmtUsdgFarmAddress = getContract(CHAIN_ID, \"XGMT_USDG_FARM\");\r\n  const autoUsdgFarmAddress = getContract(CHAIN_ID, \"AUTO_USDG_FARM\");\r\n\r\n  const usdgYieldTracker = getContract(CHAIN_ID, \"USDG_YIELD_TRACKER\");\r\n  const xgmtYieldTracker = getContract(CHAIN_ID, \"XGMT_YIELD_TRACKER\");\r\n  const gmtUsdgFarmTrackerXgmt = getContract(CHAIN_ID, \"GMT_USDG_FARM_TRACKER_XGMT\");\r\n  const gmtUsdgFarmTrackerNative = getContract(CHAIN_ID, \"GMT_USDG_FARM_TRACKER_NATIVE\");\r\n  const xgmtUsdgFarmTrackerXgmt = getContract(CHAIN_ID, \"XGMT_USDG_FARM_TRACKER_XGMT\");\r\n  const xgmtUsdgFarmTrackerNative = getContract(CHAIN_ID, \"XGMT_USDG_FARM_TRACKER_NATIVE\");\r\n  const autoUsdgFarmTrackerXgmt = getContract(CHAIN_ID, \"AUTO_USDG_FARM_TRACKER_XGMT\");\r\n  const autoUsdgFarmTrackerNative = getContract(CHAIN_ID, \"AUTO_USDG_FARM_TRACKER_NATIVE\");\r\n\r\n  const tokens = [\r\n    usdgAddress,\r\n    gmtAddress,\r\n    xgmtAddress,\r\n    gmtUsdgPairAddress,\r\n    xgmtUsdgPairAddress,\r\n    gmtUsdgFarmAddress,\r\n    xgmtUsdgFarmAddress,\r\n    autoUsdgPairAddress,\r\n    autoUsdgFarmAddress,\r\n  ];\r\n\r\n  const yieldTrackers = [\r\n    usdgYieldTracker,\r\n    xgmtYieldTracker,\r\n    gmtUsdgFarmTrackerXgmt,\r\n    gmtUsdgFarmTrackerNative,\r\n    xgmtUsdgFarmTrackerXgmt,\r\n    xgmtUsdgFarmTrackerNative,\r\n    autoUsdgFarmTrackerXgmt,\r\n    autoUsdgFarmTrackerNative,\r\n  ];\r\n\r\n  const pairTokens = [\r\n    gmtAddress,\r\n    usdgAddress,\r\n    xgmtAddress,\r\n    usdgAddress,\r\n    nativeTokenAddress,\r\n    busdAddress,\r\n    autoAddress,\r\n    usdgAddress,\r\n  ];\r\n\r\n  const yieldTokens = [usdgAddress, xgmtAddress];\r\n\r\n  const { data: xgmtSupply, mutate: updateXgmtSupply } = useSWR(\r\n    [active, chainId, readerAddress, \"getTokenSupply\", xgmtAddress],\r\n    {\r\n      fetcher: fetcher(library, Reader, [XGMT_EXCLUDED_ACCOUNTS]),\r\n    }\r\n  );\r\n\r\n  const { data: balances, mutate: updateBalances } = useSWR(\r\n    [\"Stake:balances\", chainId, readerAddress, \"getTokenBalancesWithSupplies\", account || AddressZero],\r\n    {\r\n      fetcher: fetcher(library, Reader, [tokens]),\r\n    }\r\n  );\r\n\r\n  const { data: stakingInfo, mutate: updateStakingInfo } = useSWR(\r\n    [active, chainId, readerAddress, \"getStakingInfo\", account || AddressZero],\r\n    {\r\n      fetcher: fetcher(library, Reader, [yieldTrackers]),\r\n    }\r\n  );\r\n\r\n  const { data: totalStakedInfo, mutate: updateTotalStakedInfo } = useSWR(\r\n    [active, chainId, readerAddress, \"getTotalStaked\"],\r\n    {\r\n      fetcher: fetcher(library, Reader, [yieldTokens]),\r\n    }\r\n  );\r\n\r\n  const { data: pairInfo, mutate: updatePairInfo } = useSWR(\r\n    [active, chainId, readerAddress, \"getPairInfo\", ammFactoryAddressV2],\r\n    {\r\n      fetcher: fetcher(library, Reader, [pairTokens]),\r\n    }\r\n  );\r\n\r\n  const { balanceData, supplyData } = getBalanceAndSupplyData(balances);\r\n  const stakingData = getStakingData(stakingInfo);\r\n  const pairData = getPairData(pairInfo);\r\n  const totalStakedData = getTotalStakedData(totalStakedInfo);\r\n\r\n  const processedData = getProcessedData(balanceData, supplyData, stakingData, totalStakedData, pairData, xgmtSupply);\r\n\r\n  const buyXgmtUrl = `https://exchange.pancakeswap.finance/#/swap?outputCurrency=${xgmtAddress}&inputCurrency=${usdgAddress}`;\r\n  const buyGmtUrl = `https://exchange.pancakeswap.finance/#/swap?outputCurrency=${gmtAddress}&inputCurrency=${usdgAddress}`;\r\n\r\n  const addGmtUsdgLpUrl = `https://exchange.pancakeswap.finance/#/add/${gmtAddress}/${usdgAddress}`;\r\n  const addXgmtUsdgLpUrl = `https://exchange.pancakeswap.finance/#/add/${xgmtAddress}/${usdgAddress}`;\r\n\r\n  const buyAutoUrl = `https://exchange.pancakeswap.finance/#/swap?outputCurrency=${autoAddress}&inputCurrency=${nativeTokenAddress}`;\r\n  const addAutoUsdgLpUrl = `https://exchange.pancakeswap.finance/#/add/${autoAddress}/${usdgAddress}`;\r\n\r\n  useEffect(() => {\r\n    if (active) {\r\n      library.on(\"block\", () => {\r\n        updateXgmtSupply(undefined, true);\r\n        updateBalances(undefined, true);\r\n        updateStakingInfo(undefined, true);\r\n        updateTotalStakedInfo(undefined, true);\r\n        updatePairInfo(undefined, true);\r\n      });\r\n      return () => {\r\n        library.removeAllListeners(\"block\");\r\n      };\r\n    }\r\n  }, [active, library, updateXgmtSupply, updateBalances, updateStakingInfo, updateTotalStakedInfo, updatePairInfo]);\r\n\r\n  const claim = (farmAddress, rewards) => {\r\n    if (!active || !account) {\r\n      helperToast.error(\"Wallet not yet connected\");\r\n      return;\r\n    }\r\n    if (chainId !== CHAIN_ID) {\r\n      helperToast.error(\"Incorrect Network\");\r\n      return;\r\n    }\r\n    if (!rewards || rewards.eq(0)) {\r\n      helperToast.error(\"No rewards to claim yet\");\r\n      return;\r\n    }\r\n\r\n    const contract = new ethers.Contract(farmAddress, YieldToken.abi, library.getSigner());\r\n    contract\r\n      .claim(account)\r\n      .then(async (res) => {\r\n        const txUrl = getExplorerUrl(CHAIN_ID) + \"tx/\" + res.hash;\r\n        helperToast.success(\r\n          <div>\r\n            Claim submitted!{\" \"}\r\n            <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n              View status.\r\n            </a>\r\n            <br />\r\n          </div>\r\n        );\r\n      })\r\n      .catch((e) => {\r\n        console.error(e);\r\n        helperToast.error(\"Claim failed\");\r\n      });\r\n  };\r\n\r\n  const showUnstakeGmtUsdgModal = () => {\r\n    setIsUnstakeModalVisible(true);\r\n    setUnstakeModalTitle(\"Unstake GMT-USDG\");\r\n    setUnstakeModalMaxAmount(processedData.gmtUsdgFarmBalance);\r\n    setUnstakeValue(\"\");\r\n    setUnstakingFarmAddress(gmtUsdgFarmAddress);\r\n  };\r\n\r\n  const showUnstakeXgmtUsdgModal = () => {\r\n    setIsUnstakeModalVisible(true);\r\n    setUnstakeModalTitle(\"Unstake xGMT-USDG\");\r\n    setUnstakeModalMaxAmount(processedData.xgmtUsdgFarmBalance);\r\n    setUnstakeValue(\"\");\r\n    setUnstakingFarmAddress(xgmtUsdgFarmAddress);\r\n  };\r\n\r\n  const showStakeAutoUsdgModal = () => {\r\n    setIsStakeModalVisible(true);\r\n    setStakeModalTitle(\"Stake AUTO-USDG\");\r\n    setStakeModalMaxAmount(processedData.autoUsdgBalance);\r\n    setStakeValue(\"\");\r\n    setStakingTokenAddress(autoUsdgPairAddress);\r\n    setStakingFarmAddress(autoUsdgFarmAddress);\r\n  };\r\n\r\n  const showUnstakeAutoUsdgModal = () => {\r\n    setIsUnstakeModalVisible(true);\r\n    setUnstakeModalTitle(\"Unstake AUTO-USDG\");\r\n    setUnstakeModalMaxAmount(processedData.autoUsdgFarmBalance);\r\n    setUnstakeValue(\"\");\r\n    setUnstakingFarmAddress(autoUsdgFarmAddress);\r\n  };\r\n\r\n  const hasFeeDistribution = true;\r\n\r\n  return (\r\n    <div className=\"Stake Page page-layout\">\r\n      <StakeModal\r\n        isVisible={isStakeModalVisible}\r\n        setIsVisible={setIsStakeModalVisible}\r\n        title={stakeModalTitle}\r\n        maxAmount={stakeModalMaxAmount}\r\n        value={stakeValue}\r\n        setValue={setStakeValue}\r\n        active={active}\r\n        account={account}\r\n        library={library}\r\n        stakingTokenAddress={stakingTokenAddress}\r\n        farmAddress={stakingFarmAddress}\r\n      />\r\n      <UnstakeModal\r\n        isVisible={isUnstakeModalVisible}\r\n        setIsVisible={setIsUnstakeModalVisible}\r\n        title={unstakeModalTitle}\r\n        maxAmount={unstakeModalMaxAmount}\r\n        value={unstakeValue}\r\n        setValue={setUnstakeValue}\r\n        active={active}\r\n        account={account}\r\n        library={library}\r\n        farmAddress={unstakingFarmAddress}\r\n      />\r\n      <div className=\"Stake-title App-hero\">\r\n        <div className=\"Stake-title-primary App-hero-primary\">\r\n          ${formatKeyAmount(processedData, \"totalStakedUsd\", 30, 0, true)}\r\n        </div>\r\n        <div className=\"Stake-title-secondary\">Total Assets Staked</div>\r\n      </div>\r\n      <div className=\"Stake-note\">\r\n        The Gambit protocol is in beta, please read the&nbsp;\r\n        <a href=\"https://gambit.gitbook.io/gambit/staking\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n          staking details\r\n        </a>\r\n        &nbsp; before participating.\r\n      </div>\r\n      <div className=\"App-warning Stake-warning\">\r\n        The <Link to=\"/migrate\">GMX migration</Link> is in progress, please migrate your GMT, xGMT, GMT-USDG and\r\n        xGMT-USDG tokens.\r\n        <br />\r\n        USDG tokens will continue to function as before and do not need to be migrated.\r\n      </div>\r\n      <div className=\"Stake-cards\">\r\n        <div className=\"App-card primary\">\r\n          <div className=\"Stake-card-title App-card-title\">USDG</div>\r\n          <div className=\"Stake-card-bottom App-card-content\">\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">APR</div>\r\n              <div>\r\n                {!hasFeeDistribution && \"TBC\"}\r\n                {hasFeeDistribution && `${formatKeyAmount(processedData, \"usdgApr\", 2, 2, true)}%`}\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"usdgBalance\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"usdgBalance\", 18, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Wallet</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"usdgBalance\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"usdgBalance\", 18, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">Rewards</div>\r\n              <div>\r\n                {!hasFeeDistribution && \"TBC\"}\r\n                {hasFeeDistribution && `${formatKeyAmount(processedData, \"usdgRewards\", 18, 8, true)} WBNB`}\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Total Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"usdgTotalStaked\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"usdgTotalStakedUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Total Supply</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"usdgSupply\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"usdgSupplyUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-options\">\r\n              <Link className=\"App-button-option App-card-option\" to=\"/trade\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                Get USDG\r\n              </Link>\r\n              {active && (\r\n                <button\r\n                  className=\"App-button-option App-card-option\"\r\n                  onClick={() => claim(usdgAddress, processedData.usdgRewards)}\r\n                >\r\n                  Claim\r\n                </button>\r\n              )}\r\n              {!active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={connectWallet}>\r\n                  Connect Wallet\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"App-card\">\r\n          <div className=\"Stake-card-title App-card-title\">xGMT</div>\r\n          <div className=\"Stake-card-bottom App-card-content\">\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">APR</div>\r\n              <div>\r\n                0.00% (<Link to=\"/migrate\">Migrate</Link>)\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"xgmtBalance\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"xgmtBalanceUsd\", USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Wallet</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"xgmtBalance\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"xgmtBalanceUsd\", USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">Rewards</div>\r\n              <div>\r\n                {!hasFeeDistribution && \"TBC\"}\r\n                {hasFeeDistribution && `${formatKeyAmount(processedData, \"xgmtRewards\", 18, 8, true)} WBNB`}\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Total Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"xgmtTotalStaked\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"xgmtTotalStakedUsd\", USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Total Supply</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"xgmtSupply\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"xgmtSupplyUsd\", USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-options\">\r\n              <a\r\n                className=\"App-button-option App-card-option\"\r\n                href={buyXgmtUrl}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Get xGMT\r\n              </a>\r\n              {active && (\r\n                <button\r\n                  className=\"App-button-option App-card-option\"\r\n                  onClick={() => claim(xgmtAddress, processedData.xgmtRewards)}\r\n                >\r\n                  Claim\r\n                </button>\r\n              )}\r\n              {!active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={connectWallet}>\r\n                  Connect Wallet\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"App-card\">\r\n          <div className=\"Stake-card-title App-card-title\">GMT-USDG LP</div>\r\n          <div className=\"Stake-card-bottom App-card-content\">\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">APR</div>\r\n              <div>\r\n                0.00% (<Link to=\"/migrate\">Migrate</Link>)\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"gmtUsdgStaked\", 18, 4, true)} ($\r\n                {formatKeyAmount(processedData, \"gmtUsdgStakedUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Wallet</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"gmtUsdgBalance\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"gmtUsdgBalanceUsd\", USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">Rewards</div>\r\n              <div>\r\n                {hasFeeDistribution &&\r\n                  processedData.gmtUsdgNativeRewards &&\r\n                  processedData.gmtUsdgNativeRewards.gt(0) &&\r\n                  `${formatKeyAmount(processedData, \"gmtUsdgNativeRewards\", 18, 8, true)} WBNB, `}\r\n                {formatKeyAmount(processedData, \"gmtUsdgXgmtRewards\", 18, 4, true)} xGMT\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Total Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"gmtUsdgTotalStaked\", 18, 4, true)} ($\r\n                {formatKeyAmount(processedData, \"gmtUsdgTotalStakedUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-options\">\r\n              <a\r\n                className=\"App-button-option App-card-option\"\r\n                href={buyGmtUrl}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Get GMT\r\n              </a>\r\n              <a\r\n                className=\"App-button-option App-card-option\"\r\n                href={addGmtUsdgLpUrl}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Create\r\n              </a>\r\n              {active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={() => showUnstakeGmtUsdgModal()}>\r\n                  Unstake\r\n                </button>\r\n              )}\r\n              {active && (\r\n                <button\r\n                  className=\"App-button-option App-card-option\"\r\n                  onClick={() => claim(gmtUsdgFarmAddress, processedData.gmtUsdgTotalRewards)}\r\n                >\r\n                  Claim\r\n                </button>\r\n              )}\r\n              {!active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={connectWallet}>\r\n                  Connect Wallet\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"App-card\">\r\n          <div className=\"Stake-card-title App-card-title\">xGMT-USDG LP</div>\r\n          <div className=\"Stake-card-bottom App-card-content\">\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">APR</div>\r\n              <div>\r\n                0.00% (<Link to=\"/migrate\">Migrate</Link>)\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"xgmtUsdgStaked\", 18, 4, true)} ($\r\n                {formatKeyAmount(processedData, \"xgmtUsdgStakedUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Wallet</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"xgmtUsdgBalance\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"xgmtUsdgBalanceUsd\", USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">Rewards</div>\r\n              <div>\r\n                {hasFeeDistribution &&\r\n                  processedData.xgmtUsdgNativeRewards &&\r\n                  processedData.xgmtUsdgNativeRewards.gt(0) &&\r\n                  `${formatKeyAmount(processedData, \"xgmtUsdgNativeRewards\", 18, 8, true)} WBNB, `}\r\n                {formatKeyAmount(processedData, \"xgmtUsdgXgmtRewards\", 18, 4, true)} xGMT\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Total Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"xgmtUsdgTotalStaked\", 18, 4, true)} ($\r\n                {formatKeyAmount(processedData, \"xgmtUsdgTotalStakedUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-options\">\r\n              <a\r\n                className=\"App-button-option App-card-option\"\r\n                href={buyXgmtUrl}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Get xGMT\r\n              </a>\r\n              <a\r\n                className=\"App-button-option App-card-option\"\r\n                href={addXgmtUsdgLpUrl}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Create\r\n              </a>\r\n              {active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={() => showUnstakeXgmtUsdgModal()}>\r\n                  Unstake\r\n                </button>\r\n              )}\r\n              {active && (\r\n                <button\r\n                  className=\"App-button-option App-card-option\"\r\n                  onClick={() => claim(xgmtUsdgFarmAddress, processedData.xgmtUsdgTotalRewards)}\r\n                >\r\n                  Claim\r\n                </button>\r\n              )}\r\n              {!active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={connectWallet}>\r\n                  Connect Wallet\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"App-card\">\r\n          <div className=\"Stake-card-title App-card-title\">AUTO-USDG LP</div>\r\n          <div className=\"Stake-card-bottom App-card-content\">\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">APR</div>\r\n              <div>{formatKeyAmount(processedData, \"autoUsdgApr\", 2, 2, true)}%</div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"autoUsdgStaked\", 18, 4, true)} ($\r\n                {formatKeyAmount(processedData, \"autoUsdgStakedUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Wallet</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"autoUsdgBalance\", 18, 2, true)} ($\r\n                {formatKeyAmount(processedData, \"autoUsdgBalanceUsd\", USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">Rewards</div>\r\n              <div>{formatKeyAmount(processedData, \"autoUsdgXgmtRewards\", 18, 4, true)} xGMT</div>\r\n            </div>\r\n            <div className=\"Stake-info App-card-row\">\r\n              <div className=\"label\">Total Staked</div>\r\n              <div>\r\n                {formatKeyAmount(processedData, \"autoUsdgTotalStaked\", 18, 4, true)} ($\r\n                {formatKeyAmount(processedData, \"autoUsdgTotalStakedUsd\", 30, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-options\">\r\n              <a\r\n                className=\"App-button-option App-card-option\"\r\n                href={buyAutoUrl}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Get AUTO\r\n              </a>\r\n              <a\r\n                className=\"App-button-option App-card-option\"\r\n                href={addAutoUsdgLpUrl}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                Create\r\n              </a>\r\n              {active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={() => showStakeAutoUsdgModal()}>\r\n                  Stake\r\n                </button>\r\n              )}\r\n              {active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={() => showUnstakeAutoUsdgModal()}>\r\n                  Unstake\r\n                </button>\r\n              )}\r\n              {active && (\r\n                <button\r\n                  className=\"App-button-option App-card-option\"\r\n                  onClick={() => claim(autoUsdgFarmAddress, processedData.autoUsdgTotalRewards)}\r\n                >\r\n                  Claim\r\n                </button>\r\n              )}\r\n              {!active && (\r\n                <button className=\"App-button-option App-card-option\" onClick={connectWallet}>\r\n                  Connect Wallet\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Footer />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Checkbox.scss\";\r\nimport { ImCheckboxUnchecked, ImCheckboxChecked } from \"react-icons/im\";\r\n\r\nexport default function Checkbox(props) {\r\n  const { isChecked, setIsChecked, disabled, className } = props;\r\n\r\n  return (\r\n    <div\r\n      className={cx(\"Checkbox\", { disabled, selected: isChecked }, className)}\r\n      onClick={() => setIsChecked(!isChecked)}\r\n    >\r\n      <span className=\"Checkbox-icon-wrapper\">\r\n        {isChecked && <ImCheckboxChecked className=\"App-icon Checkbox-icon active\" />}\r\n        {!isChecked && <ImCheckboxUnchecked className=\"App-icon Checkbox-icon inactive\" />}\r\n      </span>\r\n      <span className=\"Checkbox-label\">{props.children}</span>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useCallback } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\n\r\nimport Modal from \"../../components/Modal/Modal\";\r\nimport Checkbox from \"../../components/Checkbox/Checkbox\";\r\nimport Tooltip from \"../../components/Tooltip/Tooltip\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\n\r\nimport Vault from \"../../abis/Vault.json\";\r\nimport ReaderV2 from \"../../abis/ReaderV2.json\";\r\nimport Vester from \"../../abis/Vester.json\";\r\nimport RewardRouter from \"../../abis/RewardRouter.json\";\r\nimport RewardReader from \"../../abis/RewardReader.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport GlpManager from \"../../abis/GlpManager.json\";\r\n\r\nimport { ethers } from \"ethers\";\r\nimport {\r\n  helperToast,\r\n  bigNumberify,\r\n  formatAmount,\r\n  formatKeyAmount,\r\n  formatAmountFree,\r\n  getChainName,\r\n  expandDecimals,\r\n  parseValue,\r\n  approveTokens,\r\n  getServerUrl,\r\n  useLocalStorageSerializeKey,\r\n  useChainId,\r\n  GLP_DECIMALS,\r\n  USD_DECIMALS,\r\n  BASIS_POINTS_DIVISOR,\r\n  ARBITRUM,\r\n  PLACEHOLDER_ACCOUNT,\r\n  getBalanceAndSupplyData,\r\n  getDepositBalanceData,\r\n  getVestingData,\r\n  getStakingData,\r\n  getProcessedData,\r\n  getPageTitle,\r\n} from \"../../lib/legacy\";\r\nimport { useGmxPrice, useTotalGmxStaked, useTotalGmxSupply } from \"../../domain/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\n\r\nimport useSWR from \"swr\";\r\n\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport \"./StakeV2.css\";\r\nimport SEO from \"../../components/Common/SEO\";\r\nimport StatsTooltip from \"../../components/StatsTooltip/StatsTooltip\";\r\nimport StatsTooltipRow from \"../../components/StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction StakeModal(props) {\r\n  const {\r\n    isVisible,\r\n    setIsVisible,\r\n    chainId,\r\n    title,\r\n    maxAmount,\r\n    value,\r\n    setValue,\r\n    active,\r\n    account,\r\n    library,\r\n    stakingTokenSymbol,\r\n    stakingTokenAddress,\r\n    farmAddress,\r\n    rewardRouterAddress,\r\n    stakeMethodName,\r\n    setPendingTxns,\r\n  } = props;\r\n  const [isStaking, setIsStaking] = useState(false);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n\r\n  const { data: tokenAllowance } = useSWR(\r\n    active && stakingTokenAddress && [active, chainId, stakingTokenAddress, \"allowance\", account, farmAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  let amount = parseValue(value, 18);\r\n  const needApproval = farmAddress !== AddressZero && tokenAllowance && amount && amount.gt(tokenAllowance);\r\n\r\n  const getError = () => {\r\n    if (!amount || amount.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (maxAmount && amount.gt(maxAmount)) {\r\n      return t`Max amount exceeded`;\r\n    }\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (needApproval) {\r\n      approveTokens({\r\n        setIsApproving,\r\n        library,\r\n        tokenAddress: stakingTokenAddress,\r\n        spender: farmAddress,\r\n        chainId,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsStaking(true);\r\n    const contract = new ethers.Contract(rewardRouterAddress, RewardRouter.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, stakeMethodName, [amount], {\r\n      sentMsg: t`Stake submitted!`,\r\n      failMsg: t`Stake failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setIsVisible(false);\r\n      })\r\n      .finally(() => {\r\n        setIsStaking(false);\r\n      });\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isApproving) {\r\n      return false;\r\n    }\r\n    if (isStaking) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isApproving) {\r\n      return t`Approving ${stakingTokenSymbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${stakingTokenSymbol}`;\r\n    }\r\n    if (isStaking) {\r\n      return t`Staking...`;\r\n    }\r\n    return t`Stake`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"StakeModal\">\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title}>\r\n        <div className=\"Exchange-swap-section\">\r\n          <div className=\"Exchange-swap-section-top\">\r\n            <div className=\"muted\">\r\n              <div className=\"Exchange-swap-usd\">\r\n                <Trans>Stake</Trans>\r\n              </div>\r\n            </div>\r\n            <div className=\"muted align-right clickable\" onClick={() => setValue(formatAmountFree(maxAmount, 18, 18))}>\r\n              Max: {formatAmount(maxAmount, 18, 4, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-section-bottom\">\r\n            <div>\r\n              <input\r\n                type=\"number\"\r\n                placeholder=\"0.0\"\r\n                className=\"Exchange-swap-input\"\r\n                value={value}\r\n                onChange={(e) => setValue(e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"PositionEditor-token-symbol\">{stakingTokenSymbol}</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction UnstakeModal(props) {\r\n  const {\r\n    isVisible,\r\n    setIsVisible,\r\n    chainId,\r\n    title,\r\n    maxAmount,\r\n    value,\r\n    setValue,\r\n    library,\r\n    unstakingTokenSymbol,\r\n    rewardRouterAddress,\r\n    unstakeMethodName,\r\n    multiplierPointsAmount,\r\n    reservedAmount,\r\n    bonusGmxInFeeGmx,\r\n    setPendingTxns,\r\n  } = props;\r\n  const [isUnstaking, setIsUnstaking] = useState(false);\r\n\r\n  let amount = parseValue(value, 18);\r\n  let burnAmount;\r\n\r\n  if (\r\n    multiplierPointsAmount &&\r\n    multiplierPointsAmount.gt(0) &&\r\n    amount &&\r\n    amount.gt(0) &&\r\n    bonusGmxInFeeGmx &&\r\n    bonusGmxInFeeGmx.gt(0)\r\n  ) {\r\n    burnAmount = multiplierPointsAmount.mul(amount).div(bonusGmxInFeeGmx);\r\n  }\r\n\r\n  const shouldShowReductionAmount = true;\r\n  let rewardReductionBasisPoints;\r\n  if (burnAmount && bonusGmxInFeeGmx) {\r\n    rewardReductionBasisPoints = burnAmount.mul(BASIS_POINTS_DIVISOR).div(bonusGmxInFeeGmx);\r\n  }\r\n\r\n  const getError = () => {\r\n    if (!amount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (amount.gt(maxAmount)) {\r\n      return t`Max amount exceeded`;\r\n    }\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    setIsUnstaking(true);\r\n    const contract = new ethers.Contract(rewardRouterAddress, RewardRouter.abi, library.getSigner());\r\n    callContract(chainId, contract, unstakeMethodName, [amount], {\r\n      sentMsg: t`Unstake submitted!`,\r\n      failMsg: t`Unstake failed.`,\r\n      successMsg: t`Unstake completed!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setIsVisible(false);\r\n      })\r\n      .finally(() => {\r\n        setIsUnstaking(false);\r\n      });\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isUnstaking) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isUnstaking) {\r\n      return t`Unstaking...`;\r\n    }\r\n    return t`Unstake`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"StakeModal\">\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title}>\r\n        <div className=\"Exchange-swap-section\">\r\n          <div className=\"Exchange-swap-section-top\">\r\n            <div className=\"muted\">\r\n              <div className=\"Exchange-swap-usd\">\r\n                Unstake\r\n                <Trans>Unstake</Trans>\r\n              </div>\r\n            </div>\r\n            <div className=\"muted align-right clickable\" onClick={() => setValue(formatAmountFree(maxAmount, 18, 18))}>\r\n              <Trans>Max</Trans>: {formatAmount(maxAmount, 18, 4, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-section-bottom\">\r\n            <div>\r\n              <input\r\n                type=\"number\"\r\n                placeholder=\"0.0\"\r\n                className=\"Exchange-swap-input\"\r\n                value={value}\r\n                onChange={(e) => setValue(e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"PositionEditor-token-symbol\">{unstakingTokenSymbol}</div>\r\n          </div>\r\n        </div>\r\n        {reservedAmount && reservedAmount.gt(0) && (\r\n          <div className=\"Modal-note\">\r\n            You have {formatAmount(reservedAmount, 18, 2, true)} tokens reserved for vesting.\r\n          </div>\r\n        )}\r\n        {burnAmount && burnAmount.gt(0) && rewardReductionBasisPoints && rewardReductionBasisPoints.gt(0) && (\r\n          <div className=\"Modal-note\">\r\n            Unstaking will burn&nbsp;\r\n            <a href=\"https://gmxio.gitbook.io/gmx/rewards\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n              {formatAmount(burnAmount, 18, 4, true)} Multiplier Points\r\n            </a>\r\n            .&nbsp;\r\n            {shouldShowReductionAmount && (\r\n              <span>Boost Percentage: -{formatAmount(rewardReductionBasisPoints, 2, 2)}%.</span>\r\n            )}\r\n          </div>\r\n        )}\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction VesterDepositModal(props) {\r\n  const {\r\n    isVisible,\r\n    setIsVisible,\r\n    chainId,\r\n    title,\r\n    maxAmount,\r\n    value,\r\n    setValue,\r\n    balance,\r\n    vestedAmount,\r\n    averageStakedAmount,\r\n    maxVestableAmount,\r\n    library,\r\n    stakeTokenLabel,\r\n    reserveAmount,\r\n    maxReserveAmount,\r\n    vesterAddress,\r\n    setPendingTxns,\r\n  } = props;\r\n  const [isDepositing, setIsDepositing] = useState(false);\r\n\r\n  let amount = parseValue(value, 18);\r\n\r\n  let nextReserveAmount = reserveAmount;\r\n\r\n  let nextDepositAmount = vestedAmount;\r\n  if (amount) {\r\n    nextDepositAmount = vestedAmount.add(amount);\r\n  }\r\n\r\n  let additionalReserveAmount = bigNumberify(0);\r\n  if (amount && averageStakedAmount && maxVestableAmount && maxVestableAmount.gt(0)) {\r\n    nextReserveAmount = nextDepositAmount.mul(averageStakedAmount).div(maxVestableAmount);\r\n    if (nextReserveAmount.gt(reserveAmount)) {\r\n      additionalReserveAmount = nextReserveAmount.sub(reserveAmount);\r\n    }\r\n  }\r\n\r\n  const getError = () => {\r\n    if (!amount || amount.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (maxAmount && amount.gt(maxAmount)) {\r\n      return t`Max amount exceeded`;\r\n    }\r\n    if (nextReserveAmount.gt(maxReserveAmount)) {\r\n      return t`Insufficient staked tokens`;\r\n    }\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    setIsDepositing(true);\r\n    const contract = new ethers.Contract(vesterAddress, Vester.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, \"deposit\", [amount], {\r\n      sentMsg: t`Deposit submitted!`,\r\n      failMsg: t`Deposit failed!`,\r\n      successMsg: t`Deposited!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setIsVisible(false);\r\n      })\r\n      .finally(() => {\r\n        setIsDepositing(false);\r\n      });\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isDepositing) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isDepositing) {\r\n      return t`Depositing...`;\r\n    }\r\n    return t`Deposit`;\r\n  };\r\n\r\n  return (\r\n    <SEO title={getPageTitle(\"Earn\")}>\r\n      <div className=\"StakeModal\">\r\n        <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title} className=\"non-scrollable\">\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                <div className=\"Exchange-swap-usd\">\r\n                  <Trans>Deposit</Trans>\r\n                </div>\r\n              </div>\r\n              <div\r\n                className=\"muted align-right clickable\"\r\n                onClick={() => setValue(formatAmountFree(maxAmount, 18, 18))}\r\n              >\r\n                <Trans>Max</Trans>: {formatAmount(maxAmount, 18, 4, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div>\r\n                <input\r\n                  type=\"number\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={value}\r\n                  onChange={(e) => setValue(e.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">esGMX</div>\r\n            </div>\r\n          </div>\r\n          <div className=\"VesterDepositModal-info-rows\">\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">Wallet</div>\r\n              <div className=\"align-right\">{formatAmount(balance, 18, 2, true)} esGMX</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Vault Capacity</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  handle={`${formatAmount(nextDepositAmount, 18, 2, true)} / ${formatAmount(\r\n                    maxVestableAmount,\r\n                    18,\r\n                    2,\r\n                    true\r\n                  )}`}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div>\r\n                        <p className=\"text-white\">\r\n                          <Trans>Vault Capacity for your Account</Trans>\r\n                        </p>\r\n                        <br />\r\n                        <StatsTooltipRow\r\n                          showDollar={false}\r\n                          label={t`Deposited`}\r\n                          value={`${formatAmount(vestedAmount, 18, 2, true)} esGMX`}\r\n                        />\r\n                        <StatsTooltipRow\r\n                          showDollar={false}\r\n                          label={t`Max Capacity`}\r\n                          value={`${formatAmount(maxVestableAmount, 18, 2, true)} esGMX`}\r\n                        />\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Reserve Amount</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  handle={`${formatAmount(\r\n                    reserveAmount && reserveAmount.gte(additionalReserveAmount)\r\n                      ? reserveAmount\r\n                      : additionalReserveAmount,\r\n                    18,\r\n                    2,\r\n                    true\r\n                  )} / ${formatAmount(maxReserveAmount, 18, 2, true)}`}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label={t`Current Reserved`}\r\n                          value={formatAmount(reserveAmount, 18, 2, true)}\r\n                          showDollar={false}\r\n                        />\r\n                        <StatsTooltipRow\r\n                          label={t`Additional reserve required`}\r\n                          value={formatAmount(additionalReserveAmount, 18, 2, true)}\r\n                          showDollar={false}\r\n                        />\r\n                        <br />\r\n\r\n                        {amount && nextReserveAmount.gt(maxReserveAmount) && (\r\n                          <Trans>\r\n                            You need a total of at least {formatAmount(nextReserveAmount, 18, 2, true)}{\" \"}\r\n                            {stakeTokenLabel} to vest {formatAmount(amount, 18, 2, true)} esGMX.\r\n                          </Trans>\r\n                        )}\r\n                      </>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-button-container\">\r\n            <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n              {getPrimaryText()}\r\n            </button>\r\n          </div>\r\n        </Modal>\r\n      </div>\r\n    </SEO>\r\n  );\r\n}\r\n\r\nfunction VesterWithdrawModal(props) {\r\n  const { isVisible, setIsVisible, chainId, title, library, vesterAddress, setPendingTxns } = props;\r\n  const [isWithdrawing, setIsWithdrawing] = useState(false);\r\n\r\n  const onClickPrimary = () => {\r\n    setIsWithdrawing(true);\r\n    const contract = new ethers.Contract(vesterAddress, Vester.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, \"withdraw\", [], {\r\n      sentMsg: t`Withdraw submitted.`,\r\n      failMsg: t`Withdraw failed.`,\r\n      successMsg: t`Withdrawn!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setIsVisible(false);\r\n      })\r\n      .finally(() => {\r\n        setIsWithdrawing(false);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"StakeModal\">\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title}>\r\n        <Trans>\r\n          <div>\r\n            This will withdraw and unreserve all tokens as well as pause vesting.\r\n            <br />\r\n            <br />\r\n            esGMX tokens that have been converted to GMX will remain as GMX tokens.\r\n            <br />\r\n            <br />\r\n            To claim GMX tokens without withdrawing, use the \"Claim\" button under the Total Rewards section.\r\n            <br />\r\n            <br />\r\n          </div>\r\n        </Trans>\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={isWithdrawing}>\r\n            {!isWithdrawing && \"Confirm Withdraw\"}\r\n            {isWithdrawing && \"Confirming...\"}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction CompoundModal(props) {\r\n  const {\r\n    isVisible,\r\n    setIsVisible,\r\n    rewardRouterAddress,\r\n    active,\r\n    account,\r\n    library,\r\n    chainId,\r\n    setPendingTxns,\r\n    totalVesterRewards,\r\n    nativeTokenSymbol,\r\n    wrappedTokenSymbol,\r\n  } = props;\r\n  const [isCompounding, setIsCompounding] = useState(false);\r\n  const [shouldClaimGmx, setShouldClaimGmx] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-compound-should-claim-gmx\"],\r\n    true\r\n  );\r\n  const [shouldStakeGmx, setShouldStakeGmx] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-compound-should-stake-gmx\"],\r\n    true\r\n  );\r\n  const [shouldClaimEsGmx, setShouldClaimEsGmx] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-compound-should-claim-es-gmx\"],\r\n    true\r\n  );\r\n  const [shouldStakeEsGmx, setShouldStakeEsGmx] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-compound-should-stake-es-gmx\"],\r\n    true\r\n  );\r\n  const [shouldStakeMultiplierPoints, setShouldStakeMultiplierPoints] = useState(true);\r\n  const [shouldClaimWeth, setShouldClaimWeth] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-compound-should-claim-weth\"],\r\n    true\r\n  );\r\n  const [shouldConvertWeth, setShouldConvertWeth] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-compound-should-convert-weth\"],\r\n    true\r\n  );\r\n\r\n  const gmxAddress = getContract(chainId, \"GMX\");\r\n  const stakedGmxTrackerAddress = getContract(chainId, \"StakedGmxTracker\");\r\n\r\n  const [isApproving, setIsApproving] = useState(false);\r\n\r\n  const { data: tokenAllowance } = useSWR(\r\n    active && [active, chainId, gmxAddress, \"allowance\", account, stakedGmxTrackerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const needApproval = shouldStakeGmx && tokenAllowance && totalVesterRewards && totalVesterRewards.gt(tokenAllowance);\r\n\r\n  const isPrimaryEnabled = () => {\r\n    return !isCompounding && !isApproving && !isCompounding;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (isApproving) {\r\n      return t`Approving GMX...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve GMX`;\r\n    }\r\n    if (isCompounding) {\r\n      return t`Compounding...`;\r\n    }\r\n    return t`Compound`;\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (needApproval) {\r\n      approveTokens({\r\n        setIsApproving,\r\n        library,\r\n        tokenAddress: gmxAddress,\r\n        spender: stakedGmxTrackerAddress,\r\n        chainId,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsCompounding(true);\r\n\r\n    const contract = new ethers.Contract(rewardRouterAddress, RewardRouter.abi, library.getSigner());\r\n    callContract(\r\n      chainId,\r\n      contract,\r\n      \"handleRewards\",\r\n      [\r\n        shouldClaimGmx || shouldStakeGmx,\r\n        shouldStakeGmx,\r\n        shouldClaimEsGmx || shouldStakeEsGmx,\r\n        shouldStakeEsGmx,\r\n        shouldStakeMultiplierPoints,\r\n        shouldClaimWeth || shouldConvertWeth,\r\n        shouldConvertWeth,\r\n      ],\r\n      {\r\n        sentMsg: t`Compound submitted!`,\r\n        failMsg: t`Compound failed.`,\r\n        successMsg: t`Compound completed!`,\r\n        setPendingTxns,\r\n      }\r\n    )\r\n      .then(async (res) => {\r\n        setIsVisible(false);\r\n      })\r\n      .finally(() => {\r\n        setIsCompounding(false);\r\n      });\r\n  };\r\n\r\n  const toggleShouldStakeGmx = (value) => {\r\n    if (value) {\r\n      setShouldClaimGmx(true);\r\n    }\r\n    setShouldStakeGmx(value);\r\n  };\r\n\r\n  const toggleShouldStakeEsGmx = (value) => {\r\n    if (value) {\r\n      setShouldClaimEsGmx(true);\r\n    }\r\n    setShouldStakeEsGmx(value);\r\n  };\r\n\r\n  const toggleConvertWeth = (value) => {\r\n    if (value) {\r\n      setShouldClaimWeth(true);\r\n    }\r\n    setShouldConvertWeth(value);\r\n  };\r\n\r\n  return (\r\n    <div className=\"StakeModal\">\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label=\"Compound Rewards\">\r\n        <div className=\"CompoundModal-menu\">\r\n          <div>\r\n            <Checkbox\r\n              isChecked={shouldStakeMultiplierPoints}\r\n              setIsChecked={setShouldStakeMultiplierPoints}\r\n              disabled={true}\r\n            >\r\n              <Trans>Stake Multiplier Points</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldClaimGmx} setIsChecked={setShouldClaimGmx} disabled={shouldStakeGmx}>\r\n              <Trans>Claim GMX Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldStakeGmx} setIsChecked={toggleShouldStakeGmx}>\r\n              <Trans>Stake GMX Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldClaimEsGmx} setIsChecked={setShouldClaimEsGmx} disabled={shouldStakeEsGmx}>\r\n              <Trans>Claim esGMX Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldStakeEsGmx} setIsChecked={toggleShouldStakeEsGmx}>\r\n              <Trans>Stake esGMX Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldClaimWeth} setIsChecked={setShouldClaimWeth} disabled={shouldConvertWeth}>\r\n              <Trans>Claim {wrappedTokenSymbol} Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldConvertWeth} setIsChecked={toggleConvertWeth}>\r\n              Convert {wrappedTokenSymbol} to {nativeTokenSymbol}\r\n            </Checkbox>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction ClaimModal(props) {\r\n  const {\r\n    isVisible,\r\n    setIsVisible,\r\n    rewardRouterAddress,\r\n    library,\r\n    chainId,\r\n    setPendingTxns,\r\n    nativeTokenSymbol,\r\n    wrappedTokenSymbol,\r\n  } = props;\r\n  const [isClaiming, setIsClaiming] = useState(false);\r\n  const [shouldClaimGmx, setShouldClaimGmx] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-claim-should-claim-gmx\"],\r\n    true\r\n  );\r\n  const [shouldClaimEsGmx, setShouldClaimEsGmx] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-claim-should-claim-es-gmx\"],\r\n    true\r\n  );\r\n  const [shouldClaimWeth, setShouldClaimWeth] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-claim-should-claim-weth\"],\r\n    true\r\n  );\r\n  const [shouldConvertWeth, setShouldConvertWeth] = useLocalStorageSerializeKey(\r\n    [chainId, \"StakeV2-claim-should-convert-weth\"],\r\n    true\r\n  );\r\n\r\n  const isPrimaryEnabled = () => {\r\n    return !isClaiming;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (isClaiming) {\r\n      return t`Claiming...`;\r\n    }\r\n    return t`Claim`;\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    setIsClaiming(true);\r\n\r\n    const contract = new ethers.Contract(rewardRouterAddress, RewardRouter.abi, library.getSigner());\r\n    callContract(\r\n      chainId,\r\n      contract,\r\n      \"handleRewards\",\r\n      [\r\n        shouldClaimGmx,\r\n        false, // shouldStakeGmx\r\n        shouldClaimEsGmx,\r\n        false, // shouldStakeEsGmx\r\n        false, // shouldStakeMultiplierPoints\r\n        shouldClaimWeth,\r\n        shouldConvertWeth,\r\n      ],\r\n      {\r\n        sentMsg: t`Claim submitted.`,\r\n        failMsg: t`Claim failed.`,\r\n        successMsg: t`Claim completed!`,\r\n        setPendingTxns,\r\n      }\r\n    )\r\n      .then(async (res) => {\r\n        setIsVisible(false);\r\n      })\r\n      .finally(() => {\r\n        setIsClaiming(false);\r\n      });\r\n  };\r\n\r\n  const toggleConvertWeth = (value) => {\r\n    if (value) {\r\n      setShouldClaimWeth(true);\r\n    }\r\n    setShouldConvertWeth(value);\r\n  };\r\n\r\n  return (\r\n    <div className=\"StakeModal\">\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label=\"Claim Rewards\">\r\n        <div className=\"CompoundModal-menu\">\r\n          <div>\r\n            <Checkbox isChecked={shouldClaimGmx} setIsChecked={setShouldClaimGmx}>\r\n              <Trans>Claim GMX Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldClaimEsGmx} setIsChecked={setShouldClaimEsGmx}>\r\n              <Trans>Claim esGMX Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldClaimWeth} setIsChecked={setShouldClaimWeth} disabled={shouldConvertWeth}>\r\n              <Trans>Claim {wrappedTokenSymbol} Rewards</Trans>\r\n            </Checkbox>\r\n          </div>\r\n          <div>\r\n            <Checkbox isChecked={shouldConvertWeth} setIsChecked={toggleConvertWeth}>\r\n              <Trans>\r\n                Convert {wrappedTokenSymbol} to {nativeTokenSymbol}\r\n              </Trans>\r\n            </Checkbox>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function StakeV2({ setPendingTxns, connectWallet }) {\r\n  const { active, library, account } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n\r\n  const chainName = getChainName(chainId);\r\n\r\n  const hasInsurance = true;\r\n\r\n  const [isStakeModalVisible, setIsStakeModalVisible] = useState(false);\r\n  const [stakeModalTitle, setStakeModalTitle] = useState(\"\");\r\n  const [stakeModalMaxAmount, setStakeModalMaxAmount] = useState(undefined);\r\n  const [stakeValue, setStakeValue] = useState(\"\");\r\n  const [stakingTokenSymbol, setStakingTokenSymbol] = useState(\"\");\r\n  const [stakingTokenAddress, setStakingTokenAddress] = useState(\"\");\r\n  const [stakingFarmAddress, setStakingFarmAddress] = useState(\"\");\r\n  const [stakeMethodName, setStakeMethodName] = useState(\"\");\r\n\r\n  const [isUnstakeModalVisible, setIsUnstakeModalVisible] = useState(false);\r\n  const [unstakeModalTitle, setUnstakeModalTitle] = useState(\"\");\r\n  const [unstakeModalMaxAmount, setUnstakeModalMaxAmount] = useState(undefined);\r\n  const [unstakeModalReservedAmount, setUnstakeModalReservedAmount] = useState(undefined);\r\n  const [unstakeValue, setUnstakeValue] = useState(\"\");\r\n  const [unstakingTokenSymbol, setUnstakingTokenSymbol] = useState(\"\");\r\n  const [unstakeMethodName, setUnstakeMethodName] = useState(\"\");\r\n\r\n  const [isVesterDepositModalVisible, setIsVesterDepositModalVisible] = useState(false);\r\n  const [vesterDepositTitle, setVesterDepositTitle] = useState(\"\");\r\n  const [vesterDepositStakeTokenLabel, setVesterDepositStakeTokenLabel] = useState(\"\");\r\n  const [vesterDepositMaxAmount, setVesterDepositMaxAmount] = useState(\"\");\r\n  const [vesterDepositBalance, setVesterDepositBalance] = useState(\"\");\r\n  const [vesterDepositEscrowedBalance, setVesterDepositEscrowedBalance] = useState(\"\");\r\n  const [vesterDepositVestedAmount, setVesterDepositVestedAmount] = useState(\"\");\r\n  const [vesterDepositAverageStakedAmount, setVesterDepositAverageStakedAmount] = useState(\"\");\r\n  const [vesterDepositMaxVestableAmount, setVesterDepositMaxVestableAmount] = useState(\"\");\r\n  const [vesterDepositValue, setVesterDepositValue] = useState(\"\");\r\n  const [vesterDepositReserveAmount, setVesterDepositReserveAmount] = useState(\"\");\r\n  const [vesterDepositMaxReserveAmount, setVesterDepositMaxReserveAmount] = useState(\"\");\r\n  const [vesterDepositAddress, setVesterDepositAddress] = useState(\"\");\r\n\r\n  const [isVesterWithdrawModalVisible, setIsVesterWithdrawModalVisible] = useState(false);\r\n  const [vesterWithdrawTitle, setVesterWithdrawTitle] = useState(false);\r\n  const [vesterWithdrawAddress, setVesterWithdrawAddress] = useState(\"\");\r\n\r\n  const [isCompoundModalVisible, setIsCompoundModalVisible] = useState(false);\r\n  const [isClaimModalVisible, setIsClaimModalVisible] = useState(false);\r\n\r\n  const rewardRouterAddress = getContract(chainId, \"RewardRouter\");\r\n  const rewardReaderAddress = getContract(chainId, \"RewardReader\");\r\n  const readerAddress = getContract(chainId, \"Reader\");\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const gmxAddress = getContract(chainId, \"GMX\");\r\n  const esGmxAddress = getContract(chainId, \"ES_GMX\");\r\n  const bnGmxAddress = getContract(chainId, \"BN_GMX\");\r\n  const glpAddress = getContract(chainId, \"GLP\");\r\n\r\n  const stakedGmxTrackerAddress = getContract(chainId, \"StakedGmxTracker\");\r\n  const bonusGmxTrackerAddress = getContract(chainId, \"BonusGmxTracker\");\r\n  const feeGmxTrackerAddress = getContract(chainId, \"FeeGmxTracker\");\r\n\r\n  const stakedGlpTrackerAddress = getContract(chainId, \"StakedGlpTracker\");\r\n  const feeGlpTrackerAddress = getContract(chainId, \"FeeGlpTracker\");\r\n\r\n  const glpManagerAddress = getContract(chainId, \"GlpManager\");\r\n\r\n  const stakedGmxDistributorAddress = getContract(chainId, \"StakedGmxDistributor\");\r\n  const stakedGlpDistributorAddress = getContract(chainId, \"StakedGlpDistributor\");\r\n\r\n  const gmxVesterAddress = getContract(chainId, \"GmxVester\");\r\n  const glpVesterAddress = getContract(chainId, \"GlpVester\");\r\n\r\n  const vesterAddresses = [gmxVesterAddress, glpVesterAddress];\r\n\r\n  const excludedEsGmxAccounts = [stakedGmxDistributorAddress, stakedGlpDistributorAddress];\r\n\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n  const wrappedTokenSymbol = getConstant(chainId, \"wrappedTokenSymbol\");\r\n\r\n  const walletTokens = [gmxAddress, esGmxAddress, glpAddress, stakedGmxTrackerAddress];\r\n  const depositTokens = [\r\n    gmxAddress,\r\n    esGmxAddress,\r\n    stakedGmxTrackerAddress,\r\n    bonusGmxTrackerAddress,\r\n    bnGmxAddress,\r\n    glpAddress,\r\n  ];\r\n  const rewardTrackersForDepositBalances = [\r\n    stakedGmxTrackerAddress,\r\n    stakedGmxTrackerAddress,\r\n    bonusGmxTrackerAddress,\r\n    feeGmxTrackerAddress,\r\n    feeGmxTrackerAddress,\r\n    feeGlpTrackerAddress,\r\n  ];\r\n  const rewardTrackersForStakingInfo = [\r\n    stakedGmxTrackerAddress,\r\n    bonusGmxTrackerAddress,\r\n    feeGmxTrackerAddress,\r\n    stakedGlpTrackerAddress,\r\n    feeGlpTrackerAddress,\r\n  ];\r\n\r\n  const { data: walletBalances } = useSWR(\r\n    [\r\n      `StakeV2:walletBalances:${active}`,\r\n      chainId,\r\n      readerAddress,\r\n      \"getTokenBalancesWithSupplies\",\r\n      account || PLACEHOLDER_ACCOUNT,\r\n    ],\r\n    {\r\n      fetcher: fetcher(library, ReaderV2, [walletTokens]),\r\n    }\r\n  );\r\n\r\n  const { data: depositBalances } = useSWR(\r\n    [\r\n      `StakeV2:depositBalances:${active}`,\r\n      chainId,\r\n      rewardReaderAddress,\r\n      \"getDepositBalances\",\r\n      account || PLACEHOLDER_ACCOUNT,\r\n    ],\r\n    {\r\n      fetcher: fetcher(library, RewardReader, [depositTokens, rewardTrackersForDepositBalances]),\r\n    }\r\n  );\r\n\r\n  const { data: stakingInfo } = useSWR(\r\n    [`StakeV2:stakingInfo:${active}`, chainId, rewardReaderAddress, \"getStakingInfo\", account || PLACEHOLDER_ACCOUNT],\r\n    {\r\n      fetcher: fetcher(library, RewardReader, [rewardTrackersForStakingInfo]),\r\n    }\r\n  );\r\n\r\n  const { data: stakedGmxSupply } = useSWR(\r\n    [`StakeV2:stakedGmxSupply:${active}`, chainId, gmxAddress, \"balanceOf\", stakedGmxTrackerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const { data: aums } = useSWR([`StakeV2:getAums:${active}`, chainId, glpManagerAddress, \"getAums\"], {\r\n    fetcher: fetcher(library, GlpManager),\r\n  });\r\n\r\n  const { data: nativeTokenPrice } = useSWR(\r\n    [`StakeV2:nativeTokenPrice:${active}`, chainId, vaultAddress, \"getMinPrice\", nativeTokenAddress],\r\n    {\r\n      fetcher: fetcher(library, Vault),\r\n    }\r\n  );\r\n\r\n  const { data: esGmxSupply } = useSWR(\r\n    [`StakeV2:esGmxSupply:${active}`, chainId, readerAddress, \"getTokenSupply\", esGmxAddress],\r\n    {\r\n      fetcher: fetcher(library, ReaderV2, [excludedEsGmxAccounts]),\r\n    }\r\n  );\r\n\r\n  const { data: vestingInfo } = useSWR(\r\n    [`StakeV2:vestingInfo:${active}`, chainId, readerAddress, \"getVestingInfo\", account || PLACEHOLDER_ACCOUNT],\r\n    {\r\n      fetcher: fetcher(library, ReaderV2, [vesterAddresses]),\r\n    }\r\n  );\r\n\r\n  const { gmxPrice, gmxPriceFromArbitrum, gmxPriceFromAvalanche } = useGmxPrice(\r\n    chainId,\r\n    { arbitrum: chainId === ARBITRUM ? library : undefined },\r\n    active\r\n  );\r\n\r\n  let { total: totalGmxSupply } = useTotalGmxSupply();\r\n\r\n  let { avax: avaxGmxStaked, arbitrum: arbitrumGmxStaked, total: totalGmxStaked } = useTotalGmxStaked();\r\n\r\n  const gmxSupplyUrl = getServerUrl(chainId, \"/gmx_supply\");\r\n  const { data: gmxSupply } = useSWR([gmxSupplyUrl], {\r\n    fetcher: (...args) => fetch(...args).then((res) => res.text()),\r\n  });\r\n\r\n  const isGmxTransferEnabled = true;\r\n\r\n  let esGmxSupplyUsd;\r\n  if (esGmxSupply && gmxPrice) {\r\n    esGmxSupplyUsd = esGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  }\r\n\r\n  let aum;\r\n  if (aums && aums.length > 0) {\r\n    aum = aums[0].add(aums[1]).div(2);\r\n  }\r\n\r\n  const { balanceData, supplyData } = getBalanceAndSupplyData(walletBalances);\r\n  const depositBalanceData = getDepositBalanceData(depositBalances);\r\n  const stakingData = getStakingData(stakingInfo);\r\n  const vestingData = getVestingData(vestingInfo);\r\n\r\n  const processedData = getProcessedData(\r\n    balanceData,\r\n    supplyData,\r\n    depositBalanceData,\r\n    stakingData,\r\n    vestingData,\r\n    aum,\r\n    nativeTokenPrice,\r\n    stakedGmxSupply,\r\n    gmxPrice,\r\n    gmxSupply\r\n  );\r\n\r\n  let hasMultiplierPoints = false;\r\n  let multiplierPointsAmount;\r\n  if (processedData && processedData.bonusGmxTrackerRewards && processedData.bnGmxInFeeGmx) {\r\n    multiplierPointsAmount = processedData.bonusGmxTrackerRewards.add(processedData.bnGmxInFeeGmx);\r\n    if (multiplierPointsAmount.gt(0)) {\r\n      hasMultiplierPoints = true;\r\n    }\r\n  }\r\n  let totalRewardTokens;\r\n  if (processedData && processedData.bnGmxInFeeGmx && processedData.bonusGmxInFeeGmx) {\r\n    totalRewardTokens = processedData.bnGmxInFeeGmx.add(processedData.bonusGmxInFeeGmx);\r\n  }\r\n\r\n  let totalRewardTokensAndGlp;\r\n  if (totalRewardTokens && processedData && processedData.glpBalance) {\r\n    totalRewardTokensAndGlp = totalRewardTokens.add(processedData.glpBalance);\r\n  }\r\n\r\n  const bonusGmxInFeeGmx = processedData ? processedData.bonusGmxInFeeGmx : undefined;\r\n\r\n  let stakedGmxSupplyUsd;\r\n  if (!totalGmxStaked.isZero() && gmxPrice) {\r\n    stakedGmxSupplyUsd = totalGmxStaked.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  }\r\n\r\n  let totalSupplyUsd;\r\n  if (totalGmxSupply && !totalGmxSupply.isZero() && gmxPrice) {\r\n    totalSupplyUsd = totalGmxSupply.mul(gmxPrice).div(expandDecimals(1, 18));\r\n  }\r\n\r\n  let maxUnstakeableGmx = bigNumberify(0);\r\n  if (\r\n    totalRewardTokens &&\r\n    vestingData &&\r\n    vestingData.gmxVesterPairAmount &&\r\n    multiplierPointsAmount &&\r\n    processedData.bonusGmxInFeeGmx\r\n  ) {\r\n    const availableTokens = totalRewardTokens.sub(vestingData.gmxVesterPairAmount);\r\n    const stakedTokens = processedData.bonusGmxInFeeGmx;\r\n    const divisor = multiplierPointsAmount.add(stakedTokens);\r\n    if (divisor.gt(0)) {\r\n      maxUnstakeableGmx = availableTokens.mul(stakedTokens).div(divisor);\r\n    }\r\n  }\r\n\r\n  const showStakeGmxModal = () => {\r\n    if (!isGmxTransferEnabled) {\r\n      helperToast.error(t`GMX transfers not yet enabled`);\r\n      return;\r\n    }\r\n\r\n    setIsStakeModalVisible(true);\r\n    setStakeModalTitle(\"Stake GMX\");\r\n    setStakeModalMaxAmount(processedData.gmxBalance);\r\n    setStakeValue(\"\");\r\n    setStakingTokenSymbol(\"GMX\");\r\n    setStakingTokenAddress(gmxAddress);\r\n    setStakingFarmAddress(stakedGmxTrackerAddress);\r\n    setStakeMethodName(\"stakeGmx\");\r\n  };\r\n\r\n  const showStakeEsGmxModal = () => {\r\n    setIsStakeModalVisible(true);\r\n    setStakeModalTitle(\"Stake esGMX\");\r\n    setStakeModalMaxAmount(processedData.esGmxBalance);\r\n    setStakeValue(\"\");\r\n    setStakingTokenSymbol(\"esGMX\");\r\n    setStakingTokenAddress(esGmxAddress);\r\n    setStakingFarmAddress(AddressZero);\r\n    setStakeMethodName(\"stakeEsGmx\");\r\n  };\r\n\r\n  const showGmxVesterDepositModal = () => {\r\n    let remainingVestableAmount = vestingData.gmxVester.maxVestableAmount.sub(vestingData.gmxVester.vestedAmount);\r\n    if (processedData.esGmxBalance.lt(remainingVestableAmount)) {\r\n      remainingVestableAmount = processedData.esGmxBalance;\r\n    }\r\n\r\n    setIsVesterDepositModalVisible(true);\r\n    setVesterDepositTitle(\"GMX Vault\");\r\n    setVesterDepositStakeTokenLabel(\"staked GMX + esGMX + Multiplier Points\");\r\n    setVesterDepositMaxAmount(remainingVestableAmount);\r\n    setVesterDepositBalance(processedData.esGmxBalance);\r\n    setVesterDepositEscrowedBalance(vestingData.gmxVester.escrowedBalance);\r\n    setVesterDepositVestedAmount(vestingData.gmxVester.vestedAmount);\r\n    setVesterDepositMaxVestableAmount(vestingData.gmxVester.maxVestableAmount);\r\n    setVesterDepositAverageStakedAmount(vestingData.gmxVester.averageStakedAmount);\r\n    setVesterDepositReserveAmount(vestingData.gmxVester.pairAmount);\r\n    setVesterDepositMaxReserveAmount(totalRewardTokens);\r\n    setVesterDepositValue(\"\");\r\n    setVesterDepositAddress(gmxVesterAddress);\r\n  };\r\n\r\n  const showGlpVesterDepositModal = () => {\r\n    let remainingVestableAmount = vestingData.glpVester.maxVestableAmount.sub(vestingData.glpVester.vestedAmount);\r\n    if (processedData.esGmxBalance.lt(remainingVestableAmount)) {\r\n      remainingVestableAmount = processedData.esGmxBalance;\r\n    }\r\n\r\n    setIsVesterDepositModalVisible(true);\r\n    setVesterDepositTitle(\"GLP Vault\");\r\n    setVesterDepositStakeTokenLabel(\"staked GLP\");\r\n    setVesterDepositMaxAmount(remainingVestableAmount);\r\n    setVesterDepositBalance(processedData.esGmxBalance);\r\n    setVesterDepositEscrowedBalance(vestingData.glpVester.escrowedBalance);\r\n    setVesterDepositVestedAmount(vestingData.glpVester.vestedAmount);\r\n    setVesterDepositMaxVestableAmount(vestingData.glpVester.maxVestableAmount);\r\n    setVesterDepositAverageStakedAmount(vestingData.glpVester.averageStakedAmount);\r\n    setVesterDepositReserveAmount(vestingData.glpVester.pairAmount);\r\n    setVesterDepositMaxReserveAmount(processedData.glpBalance);\r\n    setVesterDepositValue(\"\");\r\n    setVesterDepositAddress(glpVesterAddress);\r\n  };\r\n\r\n  const showGmxVesterWithdrawModal = () => {\r\n    if (!vestingData || !vestingData.gmxVesterVestedAmount || vestingData.gmxVesterVestedAmount.eq(0)) {\r\n      helperToast.error(t`You have not deposited any tokens for vesting.`);\r\n      return;\r\n    }\r\n\r\n    setIsVesterWithdrawModalVisible(true);\r\n    setVesterWithdrawTitle(t`Withdraw from GMX Vault`);\r\n    setVesterWithdrawAddress(gmxVesterAddress);\r\n  };\r\n\r\n  const showGlpVesterWithdrawModal = () => {\r\n    if (!vestingData || !vestingData.glpVesterVestedAmount || vestingData.glpVesterVestedAmount.eq(0)) {\r\n      helperToast.error(t`You have not deposited any tokens for vesting.`);\r\n      return;\r\n    }\r\n\r\n    setIsVesterWithdrawModalVisible(true);\r\n    setVesterWithdrawTitle(t`Withdraw from GLP Vault`);\r\n    setVesterWithdrawAddress(glpVesterAddress);\r\n  };\r\n\r\n  const showUnstakeGmxModal = () => {\r\n    if (!isGmxTransferEnabled) {\r\n      helperToast.error(t`GMX transfers not yet enabled`);\r\n      return;\r\n    }\r\n    setIsUnstakeModalVisible(true);\r\n    setUnstakeModalTitle(t`Unstake GMX`);\r\n    let maxAmount = processedData.gmxInStakedGmx;\r\n    if (\r\n      processedData.gmxInStakedGmx &&\r\n      vestingData &&\r\n      vestingData.gmxVesterPairAmount.gt(0) &&\r\n      maxUnstakeableGmx &&\r\n      maxUnstakeableGmx.lt(processedData.gmxInStakedGmx)\r\n    ) {\r\n      maxAmount = maxUnstakeableGmx;\r\n    }\r\n    setUnstakeModalMaxAmount(maxAmount);\r\n    setUnstakeModalReservedAmount(vestingData.gmxVesterPairAmount);\r\n    setUnstakeValue(\"\");\r\n    setUnstakingTokenSymbol(\"GMX\");\r\n    setUnstakeMethodName(\"unstakeGmx\");\r\n  };\r\n\r\n  const showUnstakeEsGmxModal = () => {\r\n    setIsUnstakeModalVisible(true);\r\n    setUnstakeModalTitle(\"Unstake esGMX\");\r\n    let maxAmount = processedData.esGmxInStakedGmx;\r\n    if (\r\n      processedData.esGmxInStakedGmx &&\r\n      vestingData &&\r\n      vestingData.gmxVesterPairAmount.gt(0) &&\r\n      maxUnstakeableGmx &&\r\n      maxUnstakeableGmx.lt(processedData.esGmxInStakedGmx)\r\n    ) {\r\n      maxAmount = maxUnstakeableGmx;\r\n    }\r\n    setUnstakeModalMaxAmount(maxAmount);\r\n    setUnstakeModalReservedAmount(vestingData.gmxVesterPairAmount);\r\n    setUnstakeValue(\"\");\r\n    setUnstakingTokenSymbol(\"esGMX\");\r\n    setUnstakeMethodName(\"unstakeEsGmx\");\r\n  };\r\n\r\n  const renderMultiplierPointsLabel = useCallback(() => {\r\n    return t`Multiplier Points APR`;\r\n  }, []);\r\n\r\n  const renderMultiplierPointsValue = useCallback(() => {\r\n    return (\r\n      <Tooltip\r\n        handle={`100.00%`}\r\n        position=\"right-bottom\"\r\n        renderContent={() => {\r\n          return (\r\n            <Trans>\r\n              Boost your rewards with Multiplier Points.&nbsp;\r\n              <a href=\"https://gmxio.gitbook.io/gmx/rewards#multiplier-points\" rel=\"noreferrer\" target=\"_blank\">\r\n                More info\r\n              </a>\r\n              .\r\n            </Trans>\r\n          );\r\n        }}\r\n      />\r\n    );\r\n  }, []);\r\n\r\n  let earnMsg;\r\n  if (totalRewardTokensAndGlp && totalRewardTokensAndGlp.gt(0)) {\r\n    let gmxAmountStr;\r\n    if (processedData.gmxInStakedGmx && processedData.gmxInStakedGmx.gt(0)) {\r\n      gmxAmountStr = formatAmount(processedData.gmxInStakedGmx, 18, 2, true) + \" GMX\";\r\n    }\r\n    let esGmxAmountStr;\r\n    if (processedData.esGmxInStakedGmx && processedData.esGmxInStakedGmx.gt(0)) {\r\n      esGmxAmountStr = formatAmount(processedData.esGmxInStakedGmx, 18, 2, true) + \" esGMX\";\r\n    }\r\n    let mpAmountStr;\r\n    if (processedData.bonusGmxInFeeGmx && processedData.bnGmxInFeeGmx.gt(0)) {\r\n      mpAmountStr = formatAmount(processedData.bnGmxInFeeGmx, 18, 2, true) + \" MP\";\r\n    }\r\n    let glpStr;\r\n    if (processedData.glpBalance && processedData.glpBalance.gt(0)) {\r\n      glpStr = formatAmount(processedData.glpBalance, 18, 2, true) + \" GLP\";\r\n    }\r\n    const amountStr = [gmxAmountStr, esGmxAmountStr, mpAmountStr, glpStr].filter((s) => s).join(\", \");\r\n    earnMsg = (\r\n      <div>\r\n        <Trans>\r\n          You are earning {nativeTokenSymbol} rewards with {formatAmount(totalRewardTokensAndGlp, 18, 2, true)} tokens.\r\n          <br />\r\n          Tokens: {amountStr}.\r\n        </Trans>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"default-container page-layout\">\r\n      <StakeModal\r\n        isVisible={isStakeModalVisible}\r\n        setIsVisible={setIsStakeModalVisible}\r\n        chainId={chainId}\r\n        title={stakeModalTitle}\r\n        maxAmount={stakeModalMaxAmount}\r\n        value={stakeValue}\r\n        setValue={setStakeValue}\r\n        active={active}\r\n        account={account}\r\n        library={library}\r\n        stakingTokenSymbol={stakingTokenSymbol}\r\n        stakingTokenAddress={stakingTokenAddress}\r\n        farmAddress={stakingFarmAddress}\r\n        rewardRouterAddress={rewardRouterAddress}\r\n        stakeMethodName={stakeMethodName}\r\n        hasMultiplierPoints={hasMultiplierPoints}\r\n        setPendingTxns={setPendingTxns}\r\n        nativeTokenSymbol={nativeTokenSymbol}\r\n        wrappedTokenSymbol={wrappedTokenSymbol}\r\n      />\r\n      <UnstakeModal\r\n        setPendingTxns={setPendingTxns}\r\n        isVisible={isUnstakeModalVisible}\r\n        setIsVisible={setIsUnstakeModalVisible}\r\n        chainId={chainId}\r\n        title={unstakeModalTitle}\r\n        maxAmount={unstakeModalMaxAmount}\r\n        reservedAmount={unstakeModalReservedAmount}\r\n        value={unstakeValue}\r\n        setValue={setUnstakeValue}\r\n        library={library}\r\n        unstakingTokenSymbol={unstakingTokenSymbol}\r\n        rewardRouterAddress={rewardRouterAddress}\r\n        unstakeMethodName={unstakeMethodName}\r\n        multiplierPointsAmount={multiplierPointsAmount}\r\n        bonusGmxInFeeGmx={bonusGmxInFeeGmx}\r\n      />\r\n      <VesterDepositModal\r\n        isVisible={isVesterDepositModalVisible}\r\n        setIsVisible={setIsVesterDepositModalVisible}\r\n        chainId={chainId}\r\n        title={vesterDepositTitle}\r\n        stakeTokenLabel={vesterDepositStakeTokenLabel}\r\n        maxAmount={vesterDepositMaxAmount}\r\n        balance={vesterDepositBalance}\r\n        escrowedBalance={vesterDepositEscrowedBalance}\r\n        vestedAmount={vesterDepositVestedAmount}\r\n        averageStakedAmount={vesterDepositAverageStakedAmount}\r\n        maxVestableAmount={vesterDepositMaxVestableAmount}\r\n        reserveAmount={vesterDepositReserveAmount}\r\n        maxReserveAmount={vesterDepositMaxReserveAmount}\r\n        value={vesterDepositValue}\r\n        setValue={setVesterDepositValue}\r\n        library={library}\r\n        vesterAddress={vesterDepositAddress}\r\n        setPendingTxns={setPendingTxns}\r\n      />\r\n      <VesterWithdrawModal\r\n        isVisible={isVesterWithdrawModalVisible}\r\n        setIsVisible={setIsVesterWithdrawModalVisible}\r\n        vesterAddress={vesterWithdrawAddress}\r\n        chainId={chainId}\r\n        title={vesterWithdrawTitle}\r\n        library={library}\r\n        setPendingTxns={setPendingTxns}\r\n      />\r\n      <CompoundModal\r\n        active={active}\r\n        account={account}\r\n        setPendingTxns={setPendingTxns}\r\n        isVisible={isCompoundModalVisible}\r\n        setIsVisible={setIsCompoundModalVisible}\r\n        rewardRouterAddress={rewardRouterAddress}\r\n        totalVesterRewards={processedData.totalVesterRewards}\r\n        wrappedTokenSymbol={wrappedTokenSymbol}\r\n        nativeTokenSymbol={nativeTokenSymbol}\r\n        library={library}\r\n        chainId={chainId}\r\n      />\r\n      <ClaimModal\r\n        active={active}\r\n        account={account}\r\n        setPendingTxns={setPendingTxns}\r\n        isVisible={isClaimModalVisible}\r\n        setIsVisible={setIsClaimModalVisible}\r\n        rewardRouterAddress={rewardRouterAddress}\r\n        totalVesterRewards={processedData.totalVesterRewards}\r\n        wrappedTokenSymbol={wrappedTokenSymbol}\r\n        nativeTokenSymbol={nativeTokenSymbol}\r\n        library={library}\r\n        chainId={chainId}\r\n      />\r\n      <div className=\"section-title-block\">\r\n        <div className=\"section-title-icon\"></div>\r\n        <div className=\"section-title-content\">\r\n          <div className=\"Page-title\">\r\n            <Trans>Earn</Trans>\r\n          </div>\r\n          <div className=\"Page-description\">\r\n            <Trans>\r\n              Stake{\" \"}\r\n              <a href=\"https://gmxio.gitbook.io/gmx/tokenomics\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                GMX\r\n              </a>{\" \"}\r\n              and{\" \"}\r\n              <a href=\"https://gmxio.gitbook.io/gmx/glp\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                GLP\r\n              </a>{\" \"}\r\n              to earn rewards.\r\n            </Trans>\r\n          </div>\r\n          {earnMsg && <div className=\"Page-description\">{earnMsg}</div>}\r\n        </div>\r\n      </div>\r\n      <div className=\"StakeV2-content\">\r\n        <div className=\"StakeV2-cards\">\r\n          <div className=\"App-card StakeV2-gmx-card\">\r\n            <div className=\"App-card-title\">GMX</div>\r\n            <div className=\"App-card-divider\"></div>\r\n            <div className=\"App-card-content\">\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Price</Trans>\r\n                </div>\r\n                <div>\r\n                  {!gmxPrice && \"...\"}\r\n                  {gmxPrice && (\r\n                    <Tooltip\r\n                      position=\"right-bottom\"\r\n                      className=\"nowrap\"\r\n                      handle={\"$\" + formatAmount(gmxPrice, USD_DECIMALS, 2, true)}\r\n                      renderContent={() => (\r\n                        <>\r\n                          <StatsTooltipRow\r\n                            label=\"Price on Avalanche\"\r\n                            value={formatAmount(gmxPriceFromAvalanche, USD_DECIMALS, 2, true)}\r\n                          />\r\n                          <StatsTooltipRow\r\n                            label=\"Price on Arbitrum\"\r\n                            value={formatAmount(gmxPriceFromArbitrum, USD_DECIMALS, 2, true)}\r\n                          />\r\n                        </>\r\n                      )}\r\n                    />\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Wallet</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"gmxBalance\", 18, 2, true)} GMX ($\r\n                  {formatKeyAmount(processedData, \"gmxBalanceUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Staked</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"gmxInStakedGmx\", 18, 2, true)} GMX ($\r\n                  {formatKeyAmount(processedData, \"gmxInStakedGmxUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">APR</div>\r\n                <div>\r\n                  <Tooltip\r\n                    handle={`${formatKeyAmount(processedData, \"gmxAprTotalWithBoost\", 2, 2, true)}%`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          <StatsTooltipRow\r\n                            label=\"Escrowed GMX APR\"\r\n                            showDollar={false}\r\n                            value={`${formatKeyAmount(processedData, \"gmxAprForEsGmx\", 2, 2, true)}%`}\r\n                          />\r\n                          {(!processedData.gmxBoostAprForNativeToken ||\r\n                            processedData.gmxBoostAprForNativeToken.eq(0)) && (\r\n                            <StatsTooltipRow\r\n                              label={`${nativeTokenSymbol} APR`}\r\n                              showDollar={false}\r\n                              value={`${formatKeyAmount(processedData, \"gmxAprForNativeToken\", 2, 2, true)}%`}\r\n                            />\r\n                          )}\r\n                          {processedData.gmxBoostAprForNativeToken && processedData.gmxBoostAprForNativeToken.gt(0) && (\r\n                            <div>\r\n                              <br />\r\n\r\n                              <StatsTooltipRow\r\n                                label={`${nativeTokenSymbol} Base APR`}\r\n                                showDollar={false}\r\n                                value={`${formatKeyAmount(processedData, \"gmxAprForNativeToken\", 2, 2, true)}%`}\r\n                              />\r\n                              <StatsTooltipRow\r\n                                label={`${nativeTokenSymbol} Boosted APR`}\r\n                                showDollar={false}\r\n                                value={`${formatKeyAmount(processedData, \"gmxBoostAprForNativeToken\", 2, 2, true)}%`}\r\n                              />\r\n                              <div className=\"Tooltip-divider\" />\r\n                              <StatsTooltipRow\r\n                                label={`${nativeTokenSymbol} Total APR`}\r\n                                showDollar={false}\r\n                                value={`${formatKeyAmount(\r\n                                  processedData,\r\n                                  \"gmxAprForNativeTokenWithBoost\",\r\n                                  2,\r\n                                  2,\r\n                                  true\r\n                                )}%`}\r\n                              />\r\n\r\n                              <br />\r\n\r\n                              <Trans>The Boosted APR is from your staked Multiplier Points.</Trans>\r\n                            </div>\r\n                          )}\r\n                          <div>\r\n                            <br />\r\n                            <Trans>\r\n                              APRs are updated weekly on Wednesday and will depend on the fees collected for the week.\r\n                            </Trans>\r\n                          </div>\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Rewards</Trans>\r\n                </div>\r\n                <div>\r\n                  <Tooltip\r\n                    handle={`$${formatKeyAmount(processedData, \"totalGmxRewardsUsd\", USD_DECIMALS, 2, true)}`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          <StatsTooltipRow\r\n                            label={`${nativeTokenSymbol} (${wrappedTokenSymbol})`}\r\n                            value={`${formatKeyAmount(\r\n                              processedData,\r\n                              \"feeGmxTrackerRewards\",\r\n                              18,\r\n                              4\r\n                            )} ($${formatKeyAmount(processedData, \"feeGmxTrackerRewardsUsd\", USD_DECIMALS, 2, true)})`}\r\n                            showDollar={false}\r\n                          />\r\n                          <StatsTooltipRow\r\n                            label=\"Escrowed GMX\"\r\n                            value={`${formatKeyAmount(\r\n                              processedData,\r\n                              \"stakedGmxTrackerRewards\",\r\n                              18,\r\n                              4\r\n                            )} ($${formatKeyAmount(\r\n                              processedData,\r\n                              \"stakedGmxTrackerRewardsUsd\",\r\n                              USD_DECIMALS,\r\n                              2,\r\n                              true\r\n                            )})`}\r\n                            showDollar={false}\r\n                          />\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">{renderMultiplierPointsLabel()}</div>\r\n                <div>{renderMultiplierPointsValue()}</div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Boost Percentage</Trans>\r\n                </div>\r\n                <div>\r\n                  <Tooltip\r\n                    handle={`${formatAmount(processedData.boostBasisPoints, 2, 2, false)}%`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          You are earning {formatAmount(processedData.boostBasisPoints, 2, 2, false)}% more{\" \"}\r\n                          {nativeTokenSymbol} rewards using {formatAmount(processedData.bnGmxInFeeGmx, 18, 4, 2, true)}{\" \"}\r\n                          Staked Multiplier Points.\r\n                          <br />\r\n                          <br />\r\n                          Use the \"Compound\" button to stake your Multiplier Points.\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Total Staked</Trans>\r\n                </div>\r\n                <div>\r\n                  {!totalGmxStaked && \"...\"}\r\n                  {totalGmxStaked && (\r\n                    <Tooltip\r\n                      position=\"right-bottom\"\r\n                      className=\"nowrap\"\r\n                      handle={\r\n                        formatAmount(totalGmxStaked, 18, 0, true) +\r\n                        \" GMX\" +\r\n                        ` ($${formatAmount(stakedGmxSupplyUsd, USD_DECIMALS, 0, true)})`\r\n                      }\r\n                      renderContent={() => (\r\n                        <StatsTooltip\r\n                          showDollar={false}\r\n                          title=\"Staked\"\r\n                          avaxValue={avaxGmxStaked}\r\n                          arbitrumValue={arbitrumGmxStaked}\r\n                          total={totalGmxStaked}\r\n                          decimalsForConversion={18}\r\n                          symbol=\"GMX\"\r\n                        />\r\n                      )}\r\n                    />\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Total Supply</Trans>\r\n                </div>\r\n                {!totalGmxSupply && \"...\"}\r\n                {totalGmxSupply && (\r\n                  <div>\r\n                    {formatAmount(totalGmxSupply, 18, 0, true)} GMX ($\r\n                    {formatAmount(totalSupplyUsd, USD_DECIMALS, 0, true)})\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-options\">\r\n                <Link className=\"App-button-option App-card-option\" to=\"/buy_gmx\">\r\n                  Buy GMX\r\n                </Link>\r\n                {active && (\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => showStakeGmxModal()}>\r\n                    Stake\r\n                  </button>\r\n                )}\r\n                {active && (\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => showUnstakeGmxModal()}>\r\n                    Unstake\r\n                  </button>\r\n                )}\r\n                {active && (\r\n                  <Link className=\"App-button-option App-card-option\" to=\"/begin_account_transfer\">\r\n                    Transfer Account\r\n                  </Link>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"App-card primary StakeV2-total-rewards-card\">\r\n            <div className=\"App-card-title\">\r\n              <Trans>Total Rewards</Trans>\r\n            </div>\r\n            <div className=\"App-card-divider\"></div>\r\n            <div className=\"App-card-content\">\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  {nativeTokenSymbol} ({wrappedTokenSymbol})\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"totalNativeTokenRewards\", 18, 4, true)} ($\r\n                  {formatKeyAmount(processedData, \"totalNativeTokenRewardsUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">GMX</div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"totalVesterRewards\", 18, 4, true)} ($\r\n                  {formatKeyAmount(processedData, \"totalVesterRewardsUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">Escrowed GMX</div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"totalEsGmxRewards\", 18, 4, true)} ($\r\n                  {formatKeyAmount(processedData, \"totalEsGmxRewardsUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">Multiplier Points</div>\r\n                <div>{formatKeyAmount(processedData, \"bonusGmxTrackerRewards\", 18, 4, true)}</div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">Staked Multiplier Points</div>\r\n                <div>{formatKeyAmount(processedData, \"bnGmxInFeeGmx\", 18, 4, true)}</div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Total</Trans>\r\n                </div>\r\n                <div>${formatKeyAmount(processedData, \"totalRewardsUsd\", USD_DECIMALS, 2, true)}</div>\r\n              </div>\r\n              <div className=\"App-card-bottom-placeholder\">\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  {active && (\r\n                    <button className=\"App-button-option App-card-option\">\r\n                      <Trans>Compound</Trans>\r\n                    </button>\r\n                  )}\r\n                  {active && (\r\n                    <button className=\"App-button-option App-card-option\">\r\n                      <Trans>Claim</Trans>\r\n                    </button>\r\n                  )}\r\n                  {!active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => connectWallet()}>\r\n                      Connect Wallet\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-bottom\">\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  {active && (\r\n                    <button\r\n                      className=\"App-button-option App-card-option\"\r\n                      onClick={() => setIsCompoundModalVisible(true)}\r\n                    >\r\n                      <Trans>Compound</Trans>\r\n                    </button>\r\n                  )}\r\n                  {active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => setIsClaimModalVisible(true)}>\r\n                      <Trans>Claim</Trans>\r\n                    </button>\r\n                  )}\r\n                  {!active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => connectWallet()}>\r\n                      <Trans>Connect Wallet</Trans>\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"App-card\">\r\n            <div className=\"App-card-title\">GLP ({chainName})</div>\r\n            <div className=\"App-card-divider\"></div>\r\n            <div className=\"App-card-content\">\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Price</Trans>\r\n                </div>\r\n                <div>${formatKeyAmount(processedData, \"glpPrice\", USD_DECIMALS, 3, true)}</div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Wallet</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"glpBalance\", GLP_DECIMALS, 2, true)} GLP ($\r\n                  {formatKeyAmount(processedData, \"glpBalanceUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Staked</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"glpBalance\", GLP_DECIMALS, 2, true)} GLP ($\r\n                  {formatKeyAmount(processedData, \"glpBalanceUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">APR</div>\r\n                <div>\r\n                  <Tooltip\r\n                    handle={`${formatKeyAmount(processedData, \"glpAprTotal\", 2, 2, true)}%`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          <StatsTooltipRow\r\n                            label={`${nativeTokenSymbol} (${wrappedTokenSymbol}) APR`}\r\n                            value={`${formatKeyAmount(processedData, \"glpAprForNativeToken\", 2, 2, true)}%`}\r\n                            showDollar={false}\r\n                          />\r\n                          <StatsTooltipRow\r\n                            label=\"Escrowed GMX APR\"\r\n                            value={`${formatKeyAmount(processedData, \"glpAprForEsGmx\", 2, 2, true)}%`}\r\n                            showDollar={false}\r\n                          />\r\n                          <br />\r\n\r\n                          <Trans>\r\n                            APRs are updated weekly on Wednesday and will depend on the fees collected for the week.\r\n                          </Trans>\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Rewards</Trans>\r\n                </div>\r\n                <div>\r\n                  <Tooltip\r\n                    handle={`$${formatKeyAmount(processedData, \"totalGlpRewardsUsd\", USD_DECIMALS, 2, true)}`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          <StatsTooltipRow\r\n                            label={`${nativeTokenSymbol} (${wrappedTokenSymbol})`}\r\n                            value={`${formatKeyAmount(\r\n                              processedData,\r\n                              \"feeGlpTrackerRewards\",\r\n                              18,\r\n                              4\r\n                            )} ($${formatKeyAmount(processedData, \"feeGlpTrackerRewardsUsd\", USD_DECIMALS, 2, true)})`}\r\n                            showDollar={false}\r\n                          />\r\n                          <StatsTooltipRow\r\n                            label=\"Escrowed GMX\"\r\n                            value={`${formatKeyAmount(\r\n                              processedData,\r\n                              \"stakedGlpTrackerRewards\",\r\n                              18,\r\n                              4\r\n                            )} ($${formatKeyAmount(\r\n                              processedData,\r\n                              \"stakedGlpTrackerRewardsUsd\",\r\n                              USD_DECIMALS,\r\n                              2,\r\n                              true\r\n                            )})`}\r\n                            showDollar={false}\r\n                          />\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Total Staked</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"glpSupply\", 18, 2, true)} GLP ($\r\n                  {formatKeyAmount(processedData, \"glpSupplyUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Total Supply</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"glpSupply\", 18, 2, true)} GLP ($\r\n                  {formatKeyAmount(processedData, \"glpSupplyUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-options\">\r\n                <Link className=\"App-button-option App-card-option\" to=\"/buy_glp\">\r\n                  <Trans>Buy GLP</Trans>\r\n                </Link>\r\n                <Link className=\"App-button-option App-card-option\" to=\"/buy_glp#redeem\">\r\n                  <Trans>Sell GLP</Trans>\r\n                </Link>\r\n                {hasInsurance && (\r\n                  <a\r\n                    className=\"App-button-option App-card-option\"\r\n                    href=\"https://app.insurace.io/Insurance/Cart?id=124&referrer=545066382753150189457177837072918687520318754040\"\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                  >\r\n                    <Trans>Purchase Insurance</Trans>\r\n                  </a>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"App-card\">\r\n            <div className=\"App-card-title\">Escrowed GMX</div>\r\n            <div className=\"App-card-divider\"></div>\r\n            <div className=\"App-card-content\">\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Price</Trans>\r\n                </div>\r\n                <div>${formatAmount(gmxPrice, USD_DECIMALS, 2, true)}</div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Wallet</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"esGmxBalance\", 18, 2, true)} esGMX ($\r\n                  {formatKeyAmount(processedData, \"esGmxBalanceUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Staked</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"esGmxInStakedGmx\", 18, 2, true)} esGMX ($\r\n                  {formatKeyAmount(processedData, \"esGmxInStakedGmxUsd\", USD_DECIMALS, 2, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">APR</div>\r\n                <div>\r\n                  <div>\r\n                    <Tooltip\r\n                      handle={`${formatKeyAmount(processedData, \"gmxAprTotalWithBoost\", 2, 2, true)}%`}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => {\r\n                        return (\r\n                          <>\r\n                            <StatsTooltipRow\r\n                              label={`${nativeTokenSymbol} (${wrappedTokenSymbol}) Base APR`}\r\n                              value={`${formatKeyAmount(processedData, \"gmxAprForNativeToken\", 2, 2, true)}%`}\r\n                              showDollar={false}\r\n                            />\r\n                            {processedData.bnGmxInFeeGmx && processedData.bnGmxInFeeGmx.gt(0) && (\r\n                              <StatsTooltipRow\r\n                                label={`${nativeTokenSymbol} (${wrappedTokenSymbol}) Boosted APR`}\r\n                                value={`${formatKeyAmount(processedData, \"gmxBoostAprForNativeToken\", 2, 2, true)}%`}\r\n                                showDollar={false}\r\n                              />\r\n                            )}\r\n                            <StatsTooltipRow\r\n                              label=\"Escrowed GMX APR\"\r\n                              value={`${formatKeyAmount(processedData, \"gmxAprForEsGmx\", 2, 2, true)}%`}\r\n                              showDollar={false}\r\n                            />\r\n                          </>\r\n                        );\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">{renderMultiplierPointsLabel()}</div>\r\n                <div>{renderMultiplierPointsValue()}</div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Total Staked</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatKeyAmount(processedData, \"stakedEsGmxSupply\", 18, 0, true)} esGMX ($\r\n                  {formatKeyAmount(processedData, \"stakedEsGmxSupplyUsd\", USD_DECIMALS, 0, true)})\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Total Supply</Trans>\r\n                </div>\r\n                <div>\r\n                  {formatAmount(esGmxSupply, 18, 0, true)} esGMX (${formatAmount(esGmxSupplyUsd, USD_DECIMALS, 0, true)}\r\n                  )\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-options\">\r\n                {active && (\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => showStakeEsGmxModal()}>\r\n                    <Trans>Stake</Trans>\r\n                  </button>\r\n                )}\r\n                {active && (\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => showUnstakeEsGmxModal()}>\r\n                    <Trans>Unstake</Trans>\r\n                  </button>\r\n                )}\r\n                {!active && (\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => connectWallet()}>\r\n                    <Trans> Connect Wallet</Trans>\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div>\r\n        <div className=\"Tab-title-section\">\r\n          <div className=\"Page-title\">Vest</div>\r\n          <div className=\"Page-description\">\r\n            <Trans>\r\n              Convert esGMX tokens to GMX tokens.\r\n              <br />\r\n              Please read the{\" \"}\r\n              <a href=\"https://gmxio.gitbook.io/gmx/rewards#vesting\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                vesting details\r\n              </a>{\" \"}\r\n              before using the vaults.\r\n            </Trans>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <div className=\"StakeV2-cards\">\r\n            <div className=\"App-card StakeV2-gmx-card\">\r\n              <div className=\"App-card-title\">GMX Vault</div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-content\">\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Staked Tokens</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <Tooltip\r\n                      handle={formatAmount(totalRewardTokens, 18, 2, true)}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => {\r\n                        return (\r\n                          <>\r\n                            <StatsTooltipRow\r\n                              showDollar={false}\r\n                              label=\"GMX\"\r\n                              value={formatAmount(processedData.gmxInStakedGmx, 18, 2, true)}\r\n                            />\r\n\r\n                            <StatsTooltipRow\r\n                              showDollar={false}\r\n                              label=\"esGMX\"\r\n                              value={formatAmount(processedData.esGmxInStakedGmx, 18, 2, true)}\r\n                            />\r\n                            <StatsTooltipRow\r\n                              showDollar={false}\r\n                              label=\"Multiplier Points\"\r\n                              value={formatAmount(processedData.bnGmxInFeeGmx, 18, 2, true)}\r\n                            />\r\n                          </>\r\n                        );\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Reserved for Vesting</Trans>\r\n                  </div>\r\n                  <div>\r\n                    {formatKeyAmount(vestingData, \"gmxVesterPairAmount\", 18, 2, true)} /{\" \"}\r\n                    {formatAmount(totalRewardTokens, 18, 2, true)}\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Vesting Status</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <Tooltip\r\n                      handle={`${formatKeyAmount(vestingData, \"gmxVesterClaimSum\", 18, 4, true)} / ${formatKeyAmount(\r\n                        vestingData,\r\n                        \"gmxVesterVestedAmount\",\r\n                        18,\r\n                        4,\r\n                        true\r\n                      )}`}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => {\r\n                        return (\r\n                          <div>\r\n                            {formatKeyAmount(vestingData, \"gmxVesterClaimSum\", 18, 4, true)} tokens have been converted\r\n                            to GMX from the {formatKeyAmount(vestingData, \"gmxVesterVestedAmount\", 18, 4, true)} esGMX\r\n                            deposited for vesting.\r\n                          </div>\r\n                        );\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Claimable</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <Tooltip\r\n                      handle={`${formatKeyAmount(vestingData, \"gmxVesterClaimable\", 18, 4, true)} GMX`}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => (\r\n                        <Trans>\r\n                          {formatKeyAmount(vestingData, \"gmxVesterClaimable\", 18, 4, true)} GMX tokens can be claimed,\r\n                          use the options under the Total Rewards section to claim them.\r\n                        </Trans>\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  {!active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => connectWallet()}>\r\n                      <Trans>Connect Wallet</Trans>\r\n                    </button>\r\n                  )}\r\n                  {active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => showGmxVesterDepositModal()}>\r\n                      <Trans>Deposit</Trans>\r\n                    </button>\r\n                  )}\r\n                  {active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => showGmxVesterWithdrawModal()}>\r\n                      <Trans>Withdraw</Trans>\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card StakeV2-gmx-card\">\r\n              <div className=\"App-card-title\">GLP Vault</div>\r\n              <div className=\"App-card-divider\"></div>\r\n              <div className=\"App-card-content\">\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Staked Tokens</Trans>\r\n                  </div>\r\n                  <div>{formatAmount(processedData.glpBalance, 18, 2, true)} GLP</div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Reserved for Vesting</Trans>\r\n                  </div>\r\n                  <div>\r\n                    {formatKeyAmount(vestingData, \"glpVesterPairAmount\", 18, 2, true)} /{\" \"}\r\n                    {formatAmount(processedData.glpBalance, 18, 2, true)}\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">\r\n                    <Trans>Vesting Status</Trans>\r\n                  </div>\r\n                  <div>\r\n                    <Tooltip\r\n                      handle={`${formatKeyAmount(vestingData, \"glpVesterClaimSum\", 18, 4, true)} / ${formatKeyAmount(\r\n                        vestingData,\r\n                        \"glpVesterVestedAmount\",\r\n                        18,\r\n                        4,\r\n                        true\r\n                      )}`}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => {\r\n                        return (\r\n                          <div>\r\n                            {formatKeyAmount(vestingData, \"glpVesterClaimSum\", 18, 4, true)} tokens have been converted\r\n                            to GMX from the {formatKeyAmount(vestingData, \"glpVesterVestedAmount\", 18, 4, true)} esGMX\r\n                            deposited for vesting.\r\n                          </div>\r\n                        );\r\n                      }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-row\">\r\n                  <div className=\"label\">Claimable</div>\r\n                  <div>\r\n                    <Tooltip\r\n                      handle={`${formatKeyAmount(vestingData, \"glpVesterClaimable\", 18, 4, true)} GMX`}\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => (\r\n                        <Trans>\r\n                          {formatKeyAmount(vestingData, \"glpVesterClaimable\", 18, 4, true)} GMX tokens can be claimed,\r\n                          use the options under the Total Rewards section to claim them.\r\n                        </Trans>\r\n                      )}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  {!active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => connectWallet()}>\r\n                      <Trans>Connect Wallet</Trans>\r\n                    </button>\r\n                  )}\r\n                  {active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => showGlpVesterDepositModal()}>\r\n                      <Trans>Deposit</Trans>\r\n                    </button>\r\n                  )}\r\n                  {active && (\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => showGlpVesterWithdrawModal()}>\r\n                      <Trans>Withdraw</Trans>\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <Footer />\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Tab.css\";\r\n\r\nexport default function Tab(props) {\r\n  const { options, option, setOption, onChange, type = \"block\", className, optionLabels, icons } = props;\r\n  const onClick = (opt) => {\r\n    if (setOption) {\r\n      setOption(opt);\r\n    }\r\n    if (onChange) {\r\n      onChange(opt);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cx(\"Tab\", type, className)}>\r\n      {options.map((opt) => {\r\n        const label = optionLabels && optionLabels[opt] ? optionLabels[opt] : opt;\r\n        return (\r\n          <div className={cx(\"Tab-option\", \"muted\", { active: opt === option })} onClick={() => onClick(opt)} key={opt}>\r\n            {icons && icons[opt] && <img className=\"Tab-option-icon\" src={opt === option ? icons[opt + '_active'] : icons[opt]} alt={option} />}\r\n            {label}\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useMemo } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\n\r\nexport default function Portal({ children }) {\r\n  const root = document.body;\r\n\r\n  const el = useMemo(() => document.createElement(\"div\"), []);\r\n\r\n  useEffect(() => {\r\n    root.appendChild(el);\r\n    return () => root.removeChild(el);\r\n  }, [root, el]);\r\n\r\n  return createPortal(children, el);\r\n}\r\n","import { useCallback, useRef, useState } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport \"./Tooltip.css\";\r\nimport { IS_TOUCH } from \"../../config/ui\";\r\nimport Portal from \"../Common/Portal\";\r\n\r\nconst OPEN_DELAY = 0;\r\nconst CLOSE_DELAY = 100;\r\n\r\nexport default function TooltipWithPortal(props) {\r\n  const [visible, setVisible] = useState(false);\r\n  const [coords, setCoords] = useState({});\r\n  const [tooltipWidth, setTooltipWidth] = useState();\r\n  const intervalCloseRef = useRef(null);\r\n  const intervalOpenRef = useRef(null);\r\n\r\n  const position = props.position ?? \"left-bottom\";\r\n  const trigger = props.trigger ?? \"hover\";\r\n  const handlerRef = useRef();\r\n\r\n  const updateTooltipCoords = useCallback(() => {\r\n    const rect = handlerRef.current.getBoundingClientRect();\r\n\r\n    setCoords({\r\n      height: rect.height,\r\n      width: rect.width,\r\n      left: rect.x,\r\n      top: rect.y + window.scrollY,\r\n    });\r\n\r\n    if (props.fitHandleWidth) {\r\n      setTooltipWidth(`${rect.width}px`);\r\n    }\r\n  }, [handlerRef, props.fitHandleWidth]);\r\n\r\n  const onMouseEnter = useCallback(() => {\r\n    if (trigger !== \"hover\" || IS_TOUCH) return;\r\n\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (!intervalOpenRef.current) {\r\n      intervalOpenRef.current = setTimeout(() => {\r\n        setVisible(true);\r\n        intervalOpenRef.current = null;\r\n      }, OPEN_DELAY);\r\n    }\r\n    updateTooltipCoords();\r\n  }, [setVisible, intervalCloseRef, intervalOpenRef, trigger, updateTooltipCoords]);\r\n\r\n  const onMouseClick = useCallback(() => {\r\n    if (trigger !== \"click\" && !IS_TOUCH) return;\r\n    if (intervalCloseRef.current) {\r\n      clearInterval(intervalCloseRef.current);\r\n      intervalCloseRef.current = null;\r\n    }\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n    updateTooltipCoords();\r\n\r\n    if (props.closeOnDoubleClick) {\r\n      setVisible((old) => !old);\r\n    } else {\r\n      setVisible(true);\r\n    }\r\n  }, [setVisible, intervalCloseRef, trigger, updateTooltipCoords, props.closeOnDoubleClick]);\r\n\r\n  const onMouseLeave = useCallback(() => {\r\n    intervalCloseRef.current = setTimeout(() => {\r\n      setVisible(false);\r\n      intervalCloseRef.current = null;\r\n    }, CLOSE_DELAY);\r\n    if (intervalOpenRef.current) {\r\n      clearInterval(intervalOpenRef.current);\r\n      intervalOpenRef.current = null;\r\n    }\r\n    updateTooltipCoords();\r\n  }, [setVisible, intervalCloseRef, updateTooltipCoords]);\r\n\r\n  const className = cx(\"Tooltip\", props.className);\r\n\r\n  return (\r\n    <span className={className} onMouseEnter={onMouseEnter} onMouseLeave={onMouseLeave} onClick={onMouseClick}>\r\n      <span\r\n        className={cx({ \"Tooltip-handle\": !props.disableHandleStyle }, [props.handleClassName], { active: visible })}\r\n        ref={handlerRef}\r\n      >\r\n        {props.handle}\r\n      </span>\r\n      {visible && coords.left && (\r\n        <Portal>\r\n          <div style={{ ...coords, position: \"absolute\" }}>\r\n            <div className={cx([\"Tooltip-popup\", position])} style={{ width: tooltipWidth }}>\r\n              {props.renderContent()}\r\n            </div>\r\n          </div>\r\n        </Portal>\r\n      )}\r\n    </span>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { formatAmount, expandDecimals, bigNumberify } from \"../../lib/legacy\";\r\n\r\nimport { getToken } from \"../../config/Tokens\";\r\n\r\n// import { BiChevronDown } from \"react-icons/bi\";\r\n\r\nimport Modal from \"../Modal/Modal\";\r\n\r\nimport dropDownIcon from \"../../img/DROP_DOWN.svg\";\r\nimport \"./TokenSelector.css\";\r\nimport TooltipWithPortal from \"../Tooltip/TooltipWithPortal\";\r\n\r\nexport default function TokenSelector(props) {\r\n  \r\n  const [isModalVisible, setIsModalVisible] = useState(false);\r\n  const [searchKeyword, setSearchKeyword] = useState(\"\");\r\n  const tokenInfo = getToken(props.chainId, props.tokenAddress);\r\n  const {\r\n    tokens,\r\n    mintingCap,\r\n    infoTokens,\r\n    showMintingCap,\r\n    disabled,\r\n    selectedTokenLabel,\r\n    showBalances = true,\r\n    showTokenImgInDropdown = false,\r\n    showSymbolImage = false,\r\n    showNewCaret = false,\r\n    getTokenState = () => ({ disabled: false, message: null }),\r\n    disableBodyScrollLock,\r\n  } = props;\r\n\r\n  const visibleTokens = tokens.filter((t) => !t.isTempHidden);\r\n\r\n  const onSelectToken = (token) => {\r\n    setIsModalVisible(false);\r\n    props.onSelectToken(token);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isModalVisible) {\r\n      setSearchKeyword(\"\");\r\n    }\r\n  }, [isModalVisible]);\r\n\r\n  if (!tokenInfo) {\r\n    return null;\r\n  }\r\n\r\n  var tokenImage = null;\r\n\r\n  try {\r\n    tokenImage = require(\"../../img/ic_\" + tokenInfo.symbol.toLowerCase() + \"_24.svg\");\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n\r\n  const onSearchKeywordChange = (e) => {\r\n    setSearchKeyword(e.target.value);\r\n  };\r\n\r\n  const filteredTokens = visibleTokens.filter((item) => {\r\n    return (\r\n      item.name.toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1 ||\r\n      item.symbol.toLowerCase().indexOf(searchKeyword.toLowerCase()) > -1\r\n    );\r\n  });\r\n\r\n  const _handleKeyDown = (e) => {\r\n    if (e.key === \"Enter\" && filteredTokens.length > 0) {\r\n      onSelectToken(filteredTokens[0]);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={cx(\"TokenSelector\", { disabled }, props.className)}>\r\n      <Modal\r\n        disableBodyScrollLock={disableBodyScrollLock}\r\n        isVisible={isModalVisible}\r\n        setIsVisible={setIsModalVisible}\r\n        label={props.label}\r\n      >\r\n        <div className=\"TokenSelector-tokens\">\r\n          {/* <div className=\"TokenSelector-token-row TokenSelector-token-input-row\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search Token\"\r\n              value={searchKeyword}\r\n              onChange={(e) => onSearchKeywordChange(e)}\r\n              onKeyDown={_handleKeyDown}\r\n              autoFocus\r\n            />\r\n          </div> */}\r\n          {filteredTokens.map((token, tokenIndex) => {\r\n            let tokenPopupImage;\r\n            try {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_\" + token.symbol.toLowerCase() + \"_40.svg\");\r\n            } catch (error) {\r\n              tokenPopupImage = require(\"../../img/ddl/ic_eth_40.svg\");\r\n            }\r\n            let info = infoTokens ? infoTokens[token.address] : {};\r\n            let mintAmount;\r\n            let balance = info.balance;\r\n            if (showMintingCap && mintingCap && info.usdgAmount) {\r\n              mintAmount = mintingCap.sub(info.usdgAmount);\r\n            }\r\n            if (mintAmount && mintAmount.lt(0)) {\r\n              mintAmount = bigNumberify(0);\r\n            }\r\n            let balanceUsd;\r\n            if (balance && info.maxPrice) {\r\n              balanceUsd = balance.mul(info.maxPrice).div(expandDecimals(1, token.decimals));\r\n            }\r\n\r\n            const tokenState = getTokenState(info) || {};\r\n\r\n            return (\r\n              <div\r\n                key={token.address}\r\n                className={cx(\"TokenSelector-token-row\", { disabled: tokenState.disabled })}\r\n                onClick={() => !tokenState.disabled && onSelectToken(token)}\r\n              >\r\n                {tokenState.disabled && tokenState.message && (\r\n                  <TooltipWithPortal\r\n                    className=\"TokenSelector-tooltip\"\r\n                    portalClassName=\"TokenSelector-tooltip-portal\"\r\n                    handle={<div className=\"TokenSelector-tooltip-backing\" />}\r\n                    position={tokenIndex < filteredTokens.length / 2 ? \"center-bottom\" : \"center-top\"}\r\n                    disableHandleStyle\r\n                    closeOnDoubleClick\r\n                    fitHandleWidth\r\n                    renderContent={() => tokenState.message}\r\n                  />\r\n                )}\r\n                <div className=\"Token-info\">\r\n                  {showTokenImgInDropdown && (\r\n                    <img src={tokenPopupImage?.default} alt={token.name} className=\"token-logo\" />\r\n                  )}\r\n                  <div className=\"Token-symbol\">\r\n                    <div className=\"Token-text\">{token.symbol}</div>\r\n                    {/* <span className=\"text-accent\">{token.name}</span> */}\r\n                  </div>\r\n                </div>\r\n                {/* <div className=\"Token-balance\">\r\n                  {showBalances && balance && (\r\n                    <div className=\"Token-text\">\r\n                      {balance.gt(0) && formatAmount(balance, token.decimals, 4, true)}\r\n                      {balance.eq(0) && \"-\"}\r\n                    </div>\r\n                  )}\r\n                  <span className=\"text-accent\">\r\n                    {mintAmount && <div>Mintable: {formatAmount(mintAmount, token.decimals, 2, true)} USDG</div>}\r\n                    {showMintingCap && !mintAmount && <div>-</div>}\r\n                    {!showMintingCap && showBalances && balanceUsd && balanceUsd.gt(0) && (\r\n                      <div>${formatAmount(balanceUsd, 30, 2, true)}</div>\r\n                    )}\r\n                  </span>\r\n                </div> */}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </Modal>\r\n      {selectedTokenLabel ? (\r\n        <div className=\"TokenSelector-box\" onClick={(e) => {\r\n          setIsModalVisible(true)\r\n        }}>\r\n          {selectedTokenLabel}\r\n          {!showNewCaret && \r\n            <svg className=\"TokenSelector-caret\" xmlns=\"http://www.w3.org/2000/svg\" width=\"13\" height=\"13\" viewBox=\"0 0 13 13\" fill=\"none\">\r\n              <path d=\"M2.60001 4.76666L7.10001 8.76666L11.6 4.76666\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n          </svg>\r\n          }\r\n        </div>\r\n      ) : (\r\n        <div className=\"TokenSelector-box\" onClick={(e) => {\r\n          setIsModalVisible(true)\r\n        }}>\r\n          {tokenInfo.symbol}\r\n          {showSymbolImage && (\r\n            <img src={tokenImage && tokenImage.default} alt={tokenInfo.symbol} className=\"TokenSelector-box-symbol\" />\r\n          )}\r\n          {showNewCaret && <img src={dropDownIcon} alt=\"dropDownIcon\" className=\"TokenSelector-box-caret\" />}\r\n          {!showNewCaret &&\r\n            <svg className=\"TokenSelector-caret\" xmlns=\"http://www.w3.org/2000/svg\" width=\"13\" height=\"13\" viewBox=\"0 0 13 13\" fill=\"none\">\r\n              <path d=\"M2.60001 4.76666L7.10001 8.76666L11.6 4.76666\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n            </svg>\r\n          }\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import cx from \"classnames\";\r\n\r\nexport default function ExchangeInfoRow(props) {\r\n  const { label, children, value, isTop, isWarning } = props;\r\n\r\n  return (\r\n    <div className={cx(\"Exchange-info-row\", { \"top-line\": isTop })}>\r\n      <div className=\"Exchange-info-label\">{label}</div>\r\n      <div className={`align-right ${isWarning ? \"Exchange-info-value-warning\" : \"\"}`}>{children || value}</div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useCallback, useState, useMemo } from \"react\";\r\nimport \"./ConfirmationBox.css\";\r\nimport {\r\n  USD_DECIMALS,\r\n  PRECISION,\r\n  BASIS_POINTS_DIVISOR,\r\n  LIMIT,\r\n  MIN_PROFIT_TIME,\r\n  INCREASE,\r\n  expandDecimals,\r\n  getExchangeRate,\r\n  getProfitPrice,\r\n  getTimeRemaining,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  useLocalStorageSerializeKey,\r\n  getExchangeRateDisplay,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  SLIPPAGE_BPS_KEY,\r\n  formatDateTime,\r\n  calculatePositionDelta,\r\n  DECREASE,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport { cancelDecreaseOrder, handleCancelOrder } from \"../../domain/legacy\";\r\nimport { getNativeToken, getToken, getWrappedToken } from \"../../config/Tokens\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\n\r\nconst HIGH_SPREAD_THRESHOLD = expandDecimals(1, USD_DECIMALS).div(100); // 1%;\r\n\r\nfunction getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress) {\r\n  if (fromTokenInfo && fromTokenInfo.maxPrice && toTokenInfo && toTokenInfo.minPrice) {\r\n    const fromDiff = fromTokenInfo.maxPrice.sub(fromTokenInfo.minPrice).div(2);\r\n    const fromSpread = fromDiff.mul(PRECISION).div(fromTokenInfo.maxPrice.add(fromTokenInfo.minPrice).div(2));\r\n    const toDiff = toTokenInfo.maxPrice.sub(toTokenInfo.minPrice).div(2);\r\n    const toSpread = toDiff.mul(PRECISION).div(toTokenInfo.maxPrice.add(toTokenInfo.minPrice).div(2));\r\n\r\n    let value = fromSpread.add(toSpread);\r\n\r\n    const fromTokenAddress = fromTokenInfo.isNative ? nativeTokenAddress : fromTokenInfo.address;\r\n    const toTokenAddress = toTokenInfo.isNative ? nativeTokenAddress : toTokenInfo.address;\r\n\r\n    if (isLong && fromTokenAddress === toTokenAddress) {\r\n      value = fromSpread;\r\n    }\r\n\r\n    return {\r\n      value,\r\n      isHigh: value.gt(HIGH_SPREAD_THRESHOLD),\r\n    };\r\n  }\r\n}\r\n\r\nexport default function ConfirmationBox(props) {\r\n  const {\r\n    fromToken,\r\n    fromTokenInfo,\r\n    toToken,\r\n    toTokenInfo,\r\n    isSwap,\r\n    isLong,\r\n    isMarketOrder,\r\n    orderOption,\r\n    isShort,\r\n    toAmount,\r\n    fromAmount,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    onConfirmationClick,\r\n    setIsConfirming,\r\n    shortCollateralAddress,\r\n    hasExistingPosition,\r\n    leverage,\r\n    existingPosition,\r\n    existingLiquidationPrice,\r\n    displayLiquidationPrice,\r\n    shortCollateralToken,\r\n    isPendingConfirmation,\r\n    triggerPriceUsd,\r\n    triggerRatio,\r\n    fees,\r\n    feesUsd,\r\n    isSubmitting,\r\n    fromUsdMin,\r\n    toUsdMax,\r\n    nextAveragePrice,\r\n    collateralTokenAddress,\r\n    feeBps,\r\n    chainId,\r\n    orders,\r\n    library,\r\n    setPendingTxns,\r\n    pendingTxns,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  } = props;\r\n\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n\r\n  const [savedSlippageAmount] = useLocalStorageSerializeKey([chainId, SLIPPAGE_BPS_KEY], DEFAULT_SLIPPAGE_AMOUNT);\r\n  const [isProfitWarningAccepted, setIsProfitWarningAccepted] = useState(false);\r\n  const [isTriggerWarningAccepted, setIsTriggerWarningAccepted] = useState(false);\r\n  const [isLimitOrdersVisible, setIsLimitOrdersVisible] = useState(false);\r\n\r\n  const onCancelOrderClick = useCallback(\r\n    (order) => {\r\n      handleCancelOrder(chainId, library, order, { pendingTxns, setPendingTxns });\r\n    },\r\n    [library, pendingTxns, setPendingTxns, chainId]\r\n  );\r\n\r\n  let minOut;\r\n  let fromTokenUsd;\r\n  let toTokenUsd;\r\n\r\n  let collateralAfterFees = fromUsdMin;\r\n  if (feesUsd) {\r\n    collateralAfterFees = fromUsdMin.sub(feesUsd);\r\n  }\r\n\r\n  if (isSwap) {\r\n    minOut = toAmount.mul(BASIS_POINTS_DIVISOR - savedSlippageAmount).div(BASIS_POINTS_DIVISOR);\r\n\r\n    fromTokenUsd = fromTokenInfo ? formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true) : 0;\r\n    toTokenUsd = toTokenInfo ? formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true) : 0;\r\n  }\r\n\r\n  const getTitle = () => {\r\n    if (!isMarketOrder) {\r\n      return \"Confirm Limit Order\";\r\n    }\r\n    if (isSwap) {\r\n      return \"Confirm Swap\";\r\n    }\r\n    return isLong ? \"Confirm Long\" : \"Confirm Short\";\r\n  };\r\n  const title = getTitle();\r\n\r\n  const existingOrder = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    for (const order of orders) {\r\n      if (order.type !== INCREASE) continue;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      if (order.isLong === isLong && sameToken) {\r\n        return order;\r\n      }\r\n    }\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const existingOrders = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    return orders.filter((order) => {\r\n      if (order.type !== INCREASE) return false;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      return order.isLong === isLong && sameToken;\r\n    });\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const existingTriggerOrders = useMemo(() => {\r\n    const wrappedToken = getWrappedToken(chainId);\r\n    return orders.filter((order) => {\r\n      if (order.type !== DECREASE) return false;\r\n      const sameToken =\r\n        order.indexToken === wrappedToken.address ? toToken.isNative : order.indexToken === toToken.address;\r\n      return order.isLong === isLong && sameToken;\r\n    });\r\n  }, [orders, chainId, isLong, toToken.address, toToken.isNative]);\r\n\r\n  const decreaseOrdersThatWillBeExecuted = useMemo(() => {\r\n    if (isSwap) return [];\r\n    return existingTriggerOrders.filter((order) => {\r\n      if (order.triggerAboveThreshold) {\r\n        return existingPosition?.markPrice.gte(order.triggerPrice);\r\n      } else {\r\n        return existingPosition?.markPrice.lte(order.triggerPrice);\r\n      }\r\n    });\r\n  }, [existingPosition, existingTriggerOrders, isSwap]);\r\n\r\n  const getError = () => {\r\n    if (!isSwap && hasExistingPosition && !isMarketOrder) {\r\n      const { delta, hasProfit } = calculatePositionDelta(triggerPriceUsd, existingPosition);\r\n      if (hasProfit && delta.eq(0)) {\r\n        return \"Invalid price, see warning\";\r\n      }\r\n    }\r\n    if (isMarketOrder && hasPendingProfit && !isProfitWarningAccepted) {\r\n      return \"Forfeit profit not checked\";\r\n    }\r\n    return false;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (decreaseOrdersThatWillBeExecuted.length > 0 && !isTriggerWarningAccepted) {\r\n      return `Accept confirmation of trigger orders`;\r\n    }\r\n\r\n    if (!isPendingConfirmation) {\r\n      const error = getError();\r\n      if (error) {\r\n        return error;\r\n      }\r\n\r\n      if (isSwap) {\r\n        return title;\r\n      }\r\n      const action = isMarketOrder ? (isLong ? \"Long\" : \"Short\") : \"Create Order\";\r\n\r\n      if (\r\n        isMarketOrder &&\r\n        MIN_PROFIT_TIME > 0 &&\r\n        hasExistingPosition &&\r\n        existingPosition.delta.eq(0) &&\r\n        existingPosition.pendingDelta.gt(0)\r\n      ) {\r\n        return isLong ? `Forfeit profit and ${action}` : `Forfeit profit and Short`;\r\n      }\r\n\r\n      return isMarketOrder && MIN_PROFIT_TIME > 0 ? `Accept minimum and ${action}` : action;\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      return \"Creating Order...\";\r\n    }\r\n    if (isSwap) {\r\n      return \"Swapping...\";\r\n    }\r\n    if (isLong) {\r\n      return \"Longing...\";\r\n    }\r\n    return \"Shorting...\";\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (getError()) {\r\n      return false;\r\n    }\r\n    if (decreaseOrdersThatWillBeExecuted.length > 0 && !isTriggerWarningAccepted) {\r\n      return false;\r\n    }\r\n    return !isPendingConfirmation && !isSubmitting;\r\n  };\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const spread = getSpread(fromTokenInfo, toTokenInfo, isLong, nativeTokenAddress);\r\n  // it's meaningless for limit/stop orders to show spread based on current prices\r\n  const showSpread = isMarketOrder && !!spread;\r\n\r\n  let allowedSlippage = savedSlippageAmount;\r\n  if (isHigherSlippageAllowed) {\r\n    allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  }\r\n\r\n  const renderSpreadWarning = useCallback(() => {\r\n    if (!isMarketOrder) {\r\n      return null;\r\n    }\r\n\r\n    if (spread && spread.isHigh) {\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          The spread is {`>`} 1%, please ensure the trade details are acceptable before comfirming\r\n        </div>\r\n      );\r\n    }\r\n  }, [isMarketOrder, spread]);\r\n\r\n  const renderFeeWarning = useCallback(() => {\r\n    if (orderOption === LIMIT || !feeBps || feeBps <= 60) {\r\n      return null;\r\n    }\r\n\r\n    if (isSwap) {\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          Fees are high to swap from {fromToken.symbol} to {toToken.symbol}.\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (!collateralTokenAddress) {\r\n      return null;\r\n    }\r\n\r\n    const collateralToken = getToken(chainId, collateralTokenAddress);\r\n    return (\r\n      <div className=\"Confirmation-box-warning\">\r\n        Fees are high to swap from {fromToken.symbol} to {collateralToken.symbol}. <br />\r\n        {collateralToken.symbol} is needed for collateral.\r\n      </div>\r\n    );\r\n  }, [feeBps, isSwap, collateralTokenAddress, chainId, fromToken.symbol, toToken.symbol, orderOption]);\r\n\r\n  const hasPendingProfit =\r\n    MIN_PROFIT_TIME > 0 && existingPosition && existingPosition.delta.eq(0) && existingPosition.pendingDelta.gt(0);\r\n\r\n  const renderMinProfitWarning = useCallback(() => {\r\n    if (MIN_PROFIT_TIME === 0) {\r\n      return null;\r\n    }\r\n    if (!isSwap) {\r\n      if (hasExistingPosition) {\r\n        const minProfitExpiration = existingPosition.lastIncreasedTime + MIN_PROFIT_TIME;\r\n        if (isMarketOrder && existingPosition.delta.eq(0) && existingPosition.pendingDelta.gt(0)) {\r\n          const profitPrice = getProfitPrice(existingPosition.markPrice, existingPosition);\r\n          return (\r\n            <div className=\"Confirmation-box-warning\">\r\n              Increasing this position at the current price will forfeit a&nbsp;\r\n              <a\r\n                href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n              >\r\n                pending profit\r\n              </a>{\" \"}\r\n              of {existingPosition.deltaStr}.<br />\r\n              <br />\r\n              Profit price: {existingPosition.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}.\r\n              This rule only applies for the next {getTimeRemaining(minProfitExpiration)}, until{\" \"}\r\n              {formatDateTime(minProfitExpiration)}.\r\n            </div>\r\n          );\r\n        }\r\n        if (!isMarketOrder) {\r\n          const { delta, hasProfit } = calculatePositionDelta(triggerPriceUsd, existingPosition);\r\n          if (hasProfit && delta.eq(0)) {\r\n            const profitPrice = getProfitPrice(existingPosition.markPrice, existingPosition);\r\n            return (\r\n              <div className=\"Confirmation-box-warning\">\r\n                This order will forfeit a&nbsp;\r\n                <a\r\n                  href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n                  target=\"_blank\"\r\n                  rel=\"noopener noreferrer\"\r\n                >\r\n                  profit\r\n                </a>{\" \"}\r\n                of {existingPosition.deltaStr}.<br />\r\n                Profit price: {existingPosition.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}.\r\n                This rule only applies for the next {getTimeRemaining(minProfitExpiration)}, until{\" \"}\r\n                {formatDateTime(minProfitExpiration)}.\r\n              </div>\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          A minimum price change of&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            1.5%\r\n          </a>{\" \"}\r\n          is required for a position to be in profit. This only applies for the first {MIN_PROFIT_TIME / 60 / 60} hours\r\n          after increasing a position.\r\n        </div>\r\n      );\r\n    }\r\n  }, [isSwap, hasExistingPosition, existingPosition, isMarketOrder, triggerPriceUsd]);\r\n\r\n  const renderExistingOrderWarning = useCallback(() => {\r\n    if (isSwap || !existingOrder) {\r\n      return;\r\n    }\r\n    const indexToken = getToken(chainId, existingOrder.indexToken);\r\n    const sizeInToken = formatAmount(\r\n      existingOrder.sizeDelta.mul(PRECISION).div(existingOrder.triggerPrice),\r\n      USD_DECIMALS,\r\n      4,\r\n      true\r\n    );\r\n    if (existingOrders?.length > 1) {\r\n      return (\r\n        <div>\r\n          <div className=\"Confirmation-box-info\">\r\n            <span>\r\n              You have multiple existing Increase {existingOrder.isLong ? \"Long\" : \"Short\"} {indexToken.symbol} limit\r\n              orders{\" \"}\r\n            </span>\r\n            <span onClick={() => setIsLimitOrdersVisible((p) => !p)} className=\"view-orders\">\r\n              ({isLimitOrdersVisible ? \"hide\" : \"view\"})\r\n            </span>\r\n          </div>\r\n          {isLimitOrdersVisible && (\r\n            <ul className=\"order-list\">\r\n              {existingOrders.map((order) => {\r\n                const { account, index, type, triggerAboveThreshold, triggerPrice } = order;\r\n                const id = `${account}-${index}`;\r\n                const triggerPricePrefix = triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n                const indexToken = getToken(chainId, order.indexToken);\r\n\r\n                return (\r\n                  <li key={id} className=\"font-sm\">\r\n                    <p>\r\n                      {type === INCREASE ? \"Increase\" : \"Decrease\"} {indexToken.symbol} {isLong ? \"Long\" : \"Short\"}{\" \"}\r\n                      &nbsp;{triggerPricePrefix} ${formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n                    </p>\r\n                    <button onClick={() => onCancelOrderClick(order)}>Cancel</button>\r\n                  </li>\r\n                );\r\n              })}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      );\r\n    }\r\n    return (\r\n      <div className=\"Confirmation-box-info\">\r\n        You have an active Limit Order to Increase {existingOrder.isLong ? \"Long\" : \"Short\"} {sizeInToken}{\" \"}\r\n        {indexToken.symbol} (${formatAmount(existingOrder.sizeDelta, USD_DECIMALS, 2, true)}) at price $\r\n        {formatAmount(existingOrder.triggerPrice, USD_DECIMALS, 2, true)}\r\n      </div>\r\n    );\r\n  }, [existingOrder, isSwap, chainId, existingOrders, isLong, isLimitOrdersVisible, onCancelOrderClick]);\r\n\r\n  const renderExistingTriggerErrors = useCallback(() => {\r\n    if (isSwap || decreaseOrdersThatWillBeExecuted?.length < 1) {\r\n      return;\r\n    }\r\n    const existingTriggerOrderLength = decreaseOrdersThatWillBeExecuted.length;\r\n    const orderText = existingTriggerOrderLength > 1 ? \"orders\" : \"order\";\r\n    return (\r\n      <>\r\n        <div className=\"Confirmation-box-warning\">\r\n          You have {existingTriggerOrderLength > 1 ? `${existingTriggerOrderLength}` : \"an\"} active trigger {orderText}{\" \"}\r\n          that might execute immediately after you open this position. Please cancel the {orderText} or accept the\r\n          confirmation to continue.\r\n        </div>\r\n        <ul className=\"order-list\">\r\n          {decreaseOrdersThatWillBeExecuted.map((order) => {\r\n            const { account, index, type, triggerAboveThreshold, triggerPrice } = order;\r\n            const id = `${account}-${index}`;\r\n            const triggerPricePrefix = triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n            const indexToken = getToken(chainId, order.indexToken);\r\n            return (\r\n              <li key={id} className=\"font-sm\">\r\n                <p>\r\n                  {type === INCREASE ? \"Increase\" : \"Decrease\"} {indexToken.symbol} {isLong ? \"Long\" : \"Short\"}\r\n                  &nbsp;{triggerPricePrefix} ${formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n                </p>\r\n                <button\r\n                  onClick={() =>\r\n                    cancelDecreaseOrder(chainId, library, index, {\r\n                      successMsg: \"Order cancelled\",\r\n                      failMsg: \"Cancel failed\",\r\n                      sentMsg: \"Cancel submitted\",\r\n                      pendingTxns,\r\n                      setPendingTxns,\r\n                    })\r\n                  }\r\n                >\r\n                  Cancel\r\n                </button>\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      </>\r\n    );\r\n  }, [decreaseOrdersThatWillBeExecuted, isSwap, chainId, library, pendingTxns, setPendingTxns, isLong]);\r\n\r\n  const renderExistingTriggerWarning = useCallback(() => {\r\n    if (\r\n      isSwap ||\r\n      existingTriggerOrders.length < 1 ||\r\n      decreaseOrdersThatWillBeExecuted.length > 0 ||\r\n      renderExistingOrderWarning()\r\n    ) {\r\n      return;\r\n    }\r\n    const existingTriggerOrderLength = existingTriggerOrders.length;\r\n    return (\r\n      <div className=\"Confirmation-box-info\">\r\n        You have {existingTriggerOrderLength > 1 ? `${existingTriggerOrderLength}` : \"an\"} active trigger{\" \"}\r\n        {existingTriggerOrderLength > 1 ? \"orders\" : \"order\"} that could impact this position.\r\n      </div>\r\n    );\r\n  }, [existingTriggerOrders, isSwap, decreaseOrdersThatWillBeExecuted, renderExistingOrderWarning]);\r\n\r\n  // TODO handle unaprproved order plugin (very unlikely case)\r\n  const renderMain = useCallback(() => {\r\n    if (isSwap) {\r\n      return (\r\n        <div className=\"Confirmation-box-main\">\r\n          <div className=\"Confirmation-box-main-label\">\r\n            <div className=\"label-title\">Pay</div>&nbsp;{formatAmount(fromAmount, fromToken.decimals, 4, true)} {fromToken.symbol} ($\r\n            {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)})\r\n          </div>\r\n          <div className=\"Confirmation-box-main-icon\"></div>\r\n          <div className=\"Confirmation-box-main-label\">\r\n            <div className=\"label-title\">Recieve</div>&nbsp;{formatAmount(toAmount, toToken.decimals, 4, true)} {toToken.symbol} ($\r\n            {formatAmount(toUsdMax, USD_DECIMALS, 2, true)})\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"Confirmation-box-main\">\r\n        <div className=\"Confirmation-box-main-label\">\r\n          <div className=\"label-title\">Pay</div>&nbsp;{formatAmount(fromAmount, fromToken.decimals, 4, true)} {fromToken.symbol} ($\r\n          {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)})\r\n        </div>\r\n        <div className=\"Confirmation-box-main-icon\"></div>\r\n        <div className=\"Confirmation-box-main-label\">\r\n          <div className=\"label-title\">{isLong ? \"Long\" : \"Short\"}</div>&nbsp;\r\n          {formatAmount(toAmount, toToken.decimals, 4, true)} {toToken.symbol} ($\r\n          {formatAmount(toUsdMax, USD_DECIMALS, 2, true)})\r\n        </div>\r\n      </div>\r\n    );\r\n  }, [isSwap, fromAmount, fromToken, toToken, fromUsdMin, toUsdMax, isLong, toAmount]);\r\n\r\n  const SWAP_ORDER_EXECUTION_GAS_FEE = getConstant(chainId, \"SWAP_ORDER_EXECUTION_GAS_FEE\");\r\n  const INCREASE_ORDER_EXECUTION_GAS_FEE = getConstant(chainId, \"INCREASE_ORDER_EXECUTION_GAS_FEE\");\r\n  const executionFee = isSwap ? SWAP_ORDER_EXECUTION_GAS_FEE : INCREASE_ORDER_EXECUTION_GAS_FEE;\r\n  const renderExecutionFee = useCallback(() => {\r\n    if (isMarketOrder) {\r\n      return null;\r\n    }\r\n    return (\r\n      <ExchangeInfoRow label=\"Execution Fee\">\r\n        {formatAmount(executionFee, 18, 4)} {getNativeToken(chainId).symbol}\r\n      </ExchangeInfoRow>\r\n    );\r\n  }, [isMarketOrder, executionFee, chainId]);\r\n\r\n  const renderAvailableLiquidity = useCallback(() => {\r\n    let availableLiquidity;\r\n    const riskThresholdBps = 5000;\r\n    let isLiquidityRisk;\r\n    const token = isSwap || isLong ? toTokenInfo : shortCollateralToken;\r\n\r\n    if (!token || !token.poolAmount || !token.availableAmount) {\r\n      return null;\r\n    }\r\n\r\n    if (isSwap) {\r\n      const poolWithoutBuffer = token.poolAmount.sub(token.bufferAmount);\r\n      availableLiquidity = token.availableAmount.gt(poolWithoutBuffer) ? poolWithoutBuffer : token.availableAmount;\r\n      isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(toAmount);\r\n    } else {\r\n      if (isShort) {\r\n        availableLiquidity = token.availableAmount;\r\n\r\n        let adjustedMaxGlobalShortSize;\r\n\r\n        if (toTokenInfo.maxAvailableShort && toTokenInfo.maxAvailableShort.gt(0)) {\r\n          adjustedMaxGlobalShortSize = toTokenInfo.maxAvailableShort\r\n            .mul(expandDecimals(1, token.decimals))\r\n            .div(expandDecimals(1, USD_DECIMALS));\r\n        }\r\n\r\n        if (adjustedMaxGlobalShortSize && adjustedMaxGlobalShortSize.lt(token.availableAmount)) {\r\n          availableLiquidity = adjustedMaxGlobalShortSize;\r\n        }\r\n\r\n        const sizeTokens = toUsdMax.mul(expandDecimals(1, token.decimals)).div(token.minPrice);\r\n        isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(sizeTokens);\r\n      } else {\r\n        availableLiquidity = token.availableAmount;\r\n        isLiquidityRisk = availableLiquidity.mul(riskThresholdBps).div(BASIS_POINTS_DIVISOR).lt(toAmount);\r\n      }\r\n    }\r\n\r\n    if (!availableLiquidity) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <ExchangeInfoRow label=\"Available Liquidity\">\r\n        <Tooltip\r\n          position=\"right-bottom\"\r\n          handleClassName={isLiquidityRisk ? \"negative\" : null}\r\n          handle={\r\n            <>\r\n              {formatAmount(availableLiquidity, token.decimals, token.isStable ? 0 : 2, true)} {token.symbol}\r\n            </>\r\n          }\r\n          renderContent={() =>\r\n            isLiquidityRisk\r\n              ? \"There may not be sufficient liquidity to execute your order when the price conditions are met\"\r\n              : \"The order will only execute if the price conditions are met and there is sufficient liquidity\"\r\n          }\r\n        />\r\n      </ExchangeInfoRow>\r\n    );\r\n  }, [toTokenInfo, shortCollateralToken, isShort, isLong, isSwap, toAmount, toUsdMax]);\r\n\r\n  const renderMarginSection = useCallback(() => {\r\n    return (\r\n      <>\r\n        <div>\r\n          {renderMain()}\r\n          {renderFeeWarning()}\r\n          {renderMinProfitWarning()}\r\n          {renderExistingOrderWarning()}\r\n          {renderExistingTriggerErrors()}\r\n          {renderExistingTriggerWarning()}\r\n          {minExecutionFeeErrorMessage && <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>}\r\n          {hasPendingProfit && isMarketOrder && (\r\n            <div className=\"PositionEditor-accept-profit-warning\">\r\n              <Checkbox isChecked={isProfitWarningAccepted} setIsChecked={setIsProfitWarningAccepted}>\r\n                <span className=\"muted\">Forfeit profit</span>\r\n              </Checkbox>\r\n            </div>\r\n          )}\r\n          {orderOption === LIMIT && renderAvailableLiquidity()}\r\n          {isShort && (\r\n            <ExchangeInfoRow label=\"Collateral In\" isTop={true}>{getToken(chainId, shortCollateralAddress).symbol}</ExchangeInfoRow>\r\n          )}\r\n          {isLong && <ExchangeInfoRow label=\"Collateral In\" isTop={true} value={toTokenInfo.symbol} />}\r\n          <ExchangeInfoRow label=\"Leverage\">\r\n            {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n              <div className=\"inline-block muted\">\r\n                {formatAmount(existingPosition.leverage, 4, 2)}x\r\n                <BsArrowRight className=\"transition-arrow\" />\r\n              </div>\r\n            )}\r\n            {toAmount && leverage && leverage.gt(0) && `${formatAmount(leverage, 4, 2)}x`}\r\n            {!toAmount && leverage && leverage.gt(0) && `-`}\r\n            {leverage && leverage.eq(0) && `-`}\r\n          </ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Liq. Price\">\r\n            {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n              <div className=\"inline-block muted\">\r\n                ${formatAmount(existingLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                <BsArrowRight className=\"transition-arrow\" />\r\n              </div>\r\n            )}\r\n            {toAmount && displayLiquidationPrice && `$${formatAmount(displayLiquidationPrice, USD_DECIMALS, 2, true)}`}\r\n            {!toAmount && displayLiquidationPrice && `-`}\r\n            {!displayLiquidationPrice && `-`}\r\n          </ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Fees\">${formatAmount(feesUsd, USD_DECIMALS, 2, true)}</ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Collateral\">\r\n            <Tooltip\r\n              handle={`$${formatAmount(collateralAfterFees, USD_DECIMALS, 2, true)}`}\r\n              position=\"right-bottom\"\r\n              renderContent={() => {\r\n                return (\r\n                  <>\r\n                    Your position's collateral after deducting fees.\r\n                    <br />\r\n                    <br />\r\n                    <StatsTooltipRow label=\"Pay Amount\" value={formatAmount(fromUsdMin, USD_DECIMALS, 2, true)} />\r\n                    <StatsTooltipRow label=\"Fees\" value={formatAmount(feesUsd, USD_DECIMALS, 2, true)} />\r\n                    <div className=\"Tooltip-divider\" />\r\n                    <StatsTooltipRow\r\n                      label=\"Collateral\"\r\n                      value={formatAmount(collateralAfterFees, USD_DECIMALS, 2, true)}\r\n                    />\r\n                  </>\r\n                );\r\n              }}\r\n            />\r\n          </ExchangeInfoRow>\r\n          {showSpread && (\r\n            <ExchangeInfoRow label=\"Spread\" isWarning={spread.isHigh} isTop={true}>\r\n              {formatAmount(spread.value.mul(100), USD_DECIMALS, 2, true)}%\r\n            </ExchangeInfoRow>\r\n          )}\r\n          {isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Entry Price\">\r\n              {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                <div className=\"inline-block muted\">\r\n                  ${formatAmount(existingPosition.averagePrice, USD_DECIMALS, 2, true)}\r\n                  <BsArrowRight className=\"transition-arrow\" />\r\n                </div>\r\n              )}\r\n              {nextAveragePrice && `$${formatAmount(nextAveragePrice, USD_DECIMALS, 2, true)}`}\r\n              {!nextAveragePrice && `-`}\r\n            </ExchangeInfoRow>\r\n          )}\r\n          {!isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Limit Price\" isTop={true}>\r\n              ${formatAmount(triggerPriceUsd, USD_DECIMALS, 2, true)}\r\n            </ExchangeInfoRow>\r\n          )}\r\n          <ExchangeInfoRow label=\"Borrow Fee\">\r\n            {isLong && toTokenInfo && formatAmount(toTokenInfo.fundingRate, 4, 4)}\r\n            {isShort && shortCollateralToken && formatAmount(shortCollateralToken.fundingRate, 4, 4)}\r\n            {((isLong && toTokenInfo && toTokenInfo.fundingRate) ||\r\n              (isShort && shortCollateralToken && shortCollateralToken.fundingRate)) &&\r\n              \"% / 1h\"}\r\n          </ExchangeInfoRow>\r\n          {isMarketOrder && (\r\n            <div className=\"PositionEditor-allow-higher-slippage\">\r\n              <ExchangeInfoRow label=\"Execution Fee\">\r\n                <Tooltip\r\n                  handle={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol}`}\r\n                  position=\"right-top\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label=\"Network fee\"\r\n                          value={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol} ($${formatAmount(\r\n                            minExecutionFeeUSD,\r\n                            USD_DECIMALS,\r\n                            2\r\n                          )})`}\r\n                        />\r\n                        <br />\r\n                        This is the network cost required to execute the postion.{\" \"}\r\n                        <a\r\n                          href=\"https://gmxio.gitbook.io/gmx/trading#execution-fee\"\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                        >\r\n                          More Info\r\n                        </a>\r\n                      </>\r\n                    );\r\n                  }}\r\n                />\r\n              </ExchangeInfoRow>\r\n            </div>\r\n          )}\r\n          <ExchangeInfoRow label=\"Allowed Slippage\">\r\n            <Tooltip\r\n              handle={`${formatAmount(allowedSlippage, 2, 2)}%`}\r\n              position=\"right-top\"\r\n              renderContent={() => {\r\n                return (\r\n                  <>\r\n                    You can change this in the settings menu on the top right of the page.\r\n                    <br />\r\n                    <br />\r\n                    Note that a low allowed slippage, e.g. less than 0.5%, may result in failed orders if prices are\r\n                    volatile.\r\n                  </>\r\n                );\r\n              }}\r\n            />\r\n          </ExchangeInfoRow>\r\n          {isMarketOrder && (\r\n            <div className=\"PositionEditor-allow-higher-slippage\">\r\n              <Checkbox isChecked={isHigherSlippageAllowed} setIsChecked={setIsHigherSlippageAllowed}>\r\n                <span className=\"muted font-sm\">Allow up to 1% slippage</span>\r\n              </Checkbox>\r\n            </div>\r\n          )}\r\n          {decreaseOrdersThatWillBeExecuted.length > 0 && (\r\n            <div className=\"PositionEditor-allow-higher-slippage\">\r\n              <Checkbox isChecked={isTriggerWarningAccepted} setIsChecked={setIsTriggerWarningAccepted}>\r\n                <span className=\"muted font-sm\">I am aware of the trigger orders</span>\r\n              </Checkbox>\r\n            </div>\r\n          )}\r\n          {renderExecutionFee()}\r\n        </div>\r\n      </>\r\n    );\r\n  }, [\r\n    renderMain,\r\n    renderMinProfitWarning,\r\n    shortCollateralAddress,\r\n    isShort,\r\n    isLong,\r\n    toTokenInfo,\r\n    nextAveragePrice,\r\n    toAmount,\r\n    hasExistingPosition,\r\n    existingPosition,\r\n    isMarketOrder,\r\n    triggerPriceUsd,\r\n    showSpread,\r\n    spread,\r\n    displayLiquidationPrice,\r\n    existingLiquidationPrice,\r\n    feesUsd,\r\n    leverage,\r\n    renderExecutionFee,\r\n    shortCollateralToken,\r\n    chainId,\r\n    renderFeeWarning,\r\n    hasPendingProfit,\r\n    isProfitWarningAccepted,\r\n    renderAvailableLiquidity,\r\n    orderOption,\r\n    fromUsdMin,\r\n    collateralAfterFees,\r\n    renderExistingOrderWarning,\r\n    renderExistingTriggerWarning,\r\n    renderExistingTriggerErrors,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    allowedSlippage,\r\n    isTriggerWarningAccepted,\r\n    decreaseOrdersThatWillBeExecuted,\r\n    minExecutionFee,\r\n    nativeTokenSymbol,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  ]);\r\n\r\n  const renderSwapSection = useCallback(() => {\r\n    return (\r\n      <>\r\n        <div>\r\n          {renderMain()}\r\n          {renderFeeWarning()}\r\n          {renderSpreadWarning()}\r\n          {orderOption === LIMIT && renderAvailableLiquidity()}\r\n          <ExchangeInfoRow label=\"Min. Receive\">\r\n            {formatAmount(minOut, toTokenInfo.decimals, 4, true)} {toTokenInfo.symbol}\r\n          </ExchangeInfoRow>\r\n          <ExchangeInfoRow label=\"Price\">\r\n            {getExchangeRateDisplay(getExchangeRate(fromTokenInfo, toTokenInfo), fromTokenInfo, toTokenInfo)}\r\n          </ExchangeInfoRow>\r\n          {!isMarketOrder && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">Limit Price</div>\r\n              <div className=\"align-right\">{getExchangeRateDisplay(triggerRatio, fromTokenInfo, toTokenInfo)}</div>\r\n            </div>\r\n          )}\r\n          {showSpread && (\r\n            <ExchangeInfoRow label=\"Spread\" isWarning={spread.isHigh}>\r\n              {formatAmount(spread.value.mul(100), USD_DECIMALS, 2, true)}%\r\n            </ExchangeInfoRow>\r\n          )}\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">Fees</div>\r\n            <div className=\"align-right\">\r\n              {formatAmount(feeBps, 2, 2, true)}% ({formatAmount(fees, fromTokenInfo.decimals, 4, true)}{\" \"}\r\n              {fromTokenInfo.symbol}: ${formatAmount(feesUsd, USD_DECIMALS, 2, true)})\r\n            </div>\r\n          </div>\r\n          {renderExecutionFee()}\r\n          {fromTokenUsd && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">{fromTokenInfo.symbol} Price</div>\r\n              <div className=\"align-right\">{fromTokenUsd} USD</div>\r\n            </div>\r\n          )}\r\n          {toTokenUsd && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">{toTokenInfo.symbol} Price</div>\r\n              <div className=\"align-right\">{toTokenUsd} USD</div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </>\r\n    );\r\n  }, [\r\n    renderMain,\r\n    renderSpreadWarning,\r\n    fromTokenInfo,\r\n    toTokenInfo,\r\n    orderOption,\r\n    showSpread,\r\n    spread,\r\n    feesUsd,\r\n    feeBps,\r\n    renderExecutionFee,\r\n    fromTokenUsd,\r\n    toTokenUsd,\r\n    triggerRatio,\r\n    fees,\r\n    isMarketOrder,\r\n    minOut,\r\n    renderFeeWarning,\r\n    renderAvailableLiquidity,\r\n  ]);\r\n\r\n  return (\r\n    <div className=\"Confirmation-box\">\r\n      <Modal isVisible={true} setIsVisible={() => setIsConfirming(false)} label={title} allowContentTouchMove>\r\n        {isSwap && renderSwapSection()}\r\n        {!isSwap && renderMarginSection()}\r\n        <div className=\"Confirmation-box-row\">\r\n          <button\r\n            onClick={onConfirmationClick}\r\n            className=\"App-cta Confirmation-box-button hlight\"\r\n            disabled={!isPrimaryEnabled()}\r\n          >\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\n\r\nimport \"./OrdersToa.css\";\r\n\r\nexport default function OrdersToa(props) {\r\n  const { setIsVisible, isPluginApproving, approveOrderBook } = props;\r\n\r\n  const [isChecked, setIsChecked] = useState(false);\r\n\r\n  const onConfirmationClick = () => {\r\n    approveOrderBook().then(() => {\r\n      setIsVisible(false);\r\n    });\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (isPluginApproving) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (!isChecked) {\r\n      return t`Accept terms to enable orders`;\r\n    }\r\n    return t`Enable Orders`;\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (isPluginApproving) {\r\n      return false;\r\n    }\r\n    return isChecked;\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      setIsVisible={setIsVisible}\r\n      isVisible={true}\r\n      label={t`Enable Orders`}\r\n      className=\"Orders-toa Modal-scrollable\"\r\n      zIndex=\"1000\"\r\n    >\r\n      <Trans>\r\n        Note that orders are not guaranteed to be executed.\r\n        <br />\r\n        <br />\r\n        This can occur in a few situations including but not exclusive to:\r\n      </Trans>\r\n      <br />\r\n      <ul>\r\n        <Trans>\r\n          <li>Insufficient liquidity to execute the order</li>\r\n          <li>The mark price which is an aggregate of exchange prices did not reach the specified price</li>\r\n          <li>The specified price was reached but not long enough for it to be executed</li>\r\n          <li>No keeper picked up the order for execution</li>\r\n        </Trans>\r\n      </ul>\r\n      <div>\r\n        <Trans>\r\n          Additionally, trigger orders are market orders and are not guaranteed to settle at the trigger price.\r\n        </Trans>\r\n      </div>\r\n      <br />\r\n      <div className=\"Orders-toa-accept-rules\">\r\n        <Checkbox isChecked={isChecked} setIsChecked={setIsChecked}>\r\n          <span className=\"muted\">\r\n            <Trans>\r\n              Accept that orders are not guaranteed to execute and trigger orders may not settle at the trigger price\r\n            </Trans>\r\n          </span>\r\n        </Checkbox>\r\n      </div>\r\n      <button disabled={!isPrimaryEnabled()} className=\"App-cta Confirmation-box-button\" onClick={onConfirmationClick}>\r\n        {getPrimaryText()}\r\n      </button>\r\n    </Modal>\r\n  );\r\n}\r\n","import {\r\n  formatAmount,\r\n  bigNumberify,\r\n  isAddressZero,\r\n  USD_DECIMALS,\r\n  MAX_REFERRAL_CODE_LENGTH,\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n} from \"../../lib/legacy\";\r\nimport { encodeReferralCode, getReferralCodeOwner } from \"../../domain/referrals\";\r\n\r\nexport const REFERRAL_CODE_REGEX = /^\\w+$/; // only number, string and underscore is allowed\r\nexport const REGEX_VERIFY_BYTES32 = /^0x[0-9a-f]{64}$/;\r\n\r\nexport function isRecentReferralCodeNotExpired(referralCodeInfo) {\r\n  const REFERRAL_DATA_MAX_TIME = 60000 * 5; // 5 minutes\r\n  if (referralCodeInfo.time) {\r\n    return referralCodeInfo.time + REFERRAL_DATA_MAX_TIME > Date.now();\r\n  }\r\n}\r\n\r\nexport async function getReferralCodeTakenStatus(account, referralCode, chainId) {\r\n  const referralCodeBytes32 = encodeReferralCode(referralCode);\r\n  const [ownerArbitrum, ownerAvax] = await Promise.all([\r\n    getReferralCodeOwner(ARBITRUM, referralCodeBytes32),\r\n    getReferralCodeOwner(AVALANCHE, referralCodeBytes32),\r\n  ]);\r\n\r\n  const takenOnArb =\r\n    !isAddressZero(ownerArbitrum) && (ownerArbitrum !== account || (ownerArbitrum === account && chainId === ARBITRUM));\r\n  const takenOnAvax =\r\n    !isAddressZero(ownerAvax) && (ownerAvax !== account || (ownerAvax === account && chainId === AVALANCHE));\r\n\r\n  const referralCodeTakenInfo = {\r\n    [ARBITRUM]: takenOnArb,\r\n    [AVALANCHE]: takenOnAvax,\r\n    both: takenOnArb && takenOnAvax,\r\n    ownerArbitrum,\r\n    ownerAvax,\r\n  };\r\n\r\n  if (referralCodeTakenInfo.both) {\r\n    return { status: \"all\", info: referralCodeTakenInfo };\r\n  }\r\n  if (referralCodeTakenInfo[chainId]) {\r\n    return { status: \"current\", info: referralCodeTakenInfo };\r\n  }\r\n  if (chainId === AVALANCHE ? referralCodeTakenInfo[ARBITRUM] : referralCodeTakenInfo[AVALANCHE]) {\r\n    return { status: \"other\", info: referralCodeTakenInfo };\r\n  }\r\n  return { status: \"none\", info: referralCodeTakenInfo };\r\n}\r\n\r\nexport function getTierIdDisplay(tierId) {\r\n  return Number(tierId) + 1;\r\n}\r\n\r\nexport const tierRebateInfo = {\r\n  0: 5,\r\n  1: 10,\r\n  2: 15,\r\n};\r\n\r\nexport const tierDiscountInfo = {\r\n  0: 5,\r\n  1: 10,\r\n  2: 10,\r\n};\r\n\r\nfunction areObjectsWithSameKeys(obj1, obj2) {\r\n  return Object.keys(obj1).every((key) => key in obj2);\r\n}\r\n\r\nexport function deserializeSampleStats(input) {\r\n  const parsedData = JSON.parse(input);\r\n  if (!Array.isArray(parsedData)) return [];\r\n  return parsedData\r\n    .map((data) => {\r\n      if (!areObjectsWithSameKeys(getSampleReferrarStat(), data)) return null;\r\n      return Object.keys(data).reduce((acc, cv) => {\r\n        const currentValue = data[cv];\r\n        if (currentValue?.type === \"BigNumber\") {\r\n          acc[cv] = bigNumberify(currentValue.hex || 0);\r\n        } else {\r\n          acc[cv] = currentValue;\r\n        }\r\n        return acc;\r\n      }, {});\r\n    })\r\n    .filter(Boolean);\r\n}\r\n\r\nexport const getSampleReferrarStat = (code = \"\", ownerOnOtherNetwork = \"\", account = \"\") => {\r\n  return {\r\n    discountUsd: bigNumberify(0),\r\n    referralCode: code,\r\n    totalRebateUsd: bigNumberify(0),\r\n    tradedReferralsCount: 0,\r\n    registeredReferralsCount: 0,\r\n    trades: 0,\r\n    volume: bigNumberify(0),\r\n    time: Date.now(),\r\n    ownerOnOtherChain: {\r\n      code: encodeReferralCode(code),\r\n      codeString: code,\r\n      owner: undefined,\r\n      isTaken: !isAddressZero(ownerOnOtherNetwork),\r\n      isTakenByCurrentUser:\r\n        !isAddressZero(ownerOnOtherNetwork) && ownerOnOtherNetwork.toLowerCase() === account.toLowerCase(),\r\n    },\r\n  };\r\n};\r\n\r\nexport function getUSDValue(value, decimals = 2) {\r\n  return `$${formatAmount(value, USD_DECIMALS, decimals, true, \"0.00\")}`;\r\n}\r\n\r\nexport function getCodeError(value) {\r\n  const trimmedValue = value.trim();\r\n  if (!trimmedValue) return \"\";\r\n\r\n  if (trimmedValue.length > MAX_REFERRAL_CODE_LENGTH) {\r\n    return `The referral code can't be more than ${MAX_REFERRAL_CODE_LENGTH} characters.`;\r\n  }\r\n\r\n  if (!REFERRAL_CODE_REGEX.test(trimmedValue)) {\r\n    return \"Only letters, numbers and underscores are allowed.\";\r\n  }\r\n  return \"\";\r\n}\r\n\r\nexport function getTwitterShareUrl(referralCode) {\r\n  const message = \"Trying out trading on @GMX_IO, up to 30x leverage on $BTC, $ETH 📈%0a%0aFor fee discounts use:\";\r\n\r\n  return `http://twitter.com/intent/tweet?text=${message}&url=https://gmx.io?ref=${referralCode}`;\r\n}\r\n","import { ethers } from \"ethers\";\r\nimport { gql } from \"@apollo/client\";\r\nimport { useState, useEffect, useMemo } from \"react\";\r\nimport useSWR from \"swr\";\r\n\r\nimport ReferralStorage from \"../abis/ReferralStorage.json\";\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  MAX_REFERRAL_CODE_LENGTH,\r\n  bigNumberify,\r\n  isAddressZero,\r\n  helperToast,\r\n  getProvider,\r\n  isHashZero,\r\n  REFERRAL_CODE_KEY,\r\n} from \"../lib/legacy\";\r\nimport { arbitrumReferralsGraphClient, avalancheReferralsGraphClient } from \"./common\";\r\nimport { getContract } from \"../config/Addresses\";\r\nimport { REGEX_VERIFY_BYTES32 } from \"../components/Referrals/referralsHelper\";\r\nimport { fetcher } from \"../lib/contracts/fetcher\";\r\nimport { callContract } from \"../lib/contracts/callContract\";\r\n\r\nconst ACTIVE_CHAINS = [ARBITRUM, AVALANCHE];\r\nconst DISTRIBUTION_TYPE_REBATES = \"1\";\r\nconst DISTRIBUTION_TYPE_DISCOUNT = \"2\";\r\n\r\nfunction getGraphClient(chainId) {\r\n  if (chainId === ARBITRUM) {\r\n    return arbitrumReferralsGraphClient;\r\n  } else if (chainId === AVALANCHE) {\r\n    return avalancheReferralsGraphClient;\r\n  }\r\n  throw new Error(`Unsupported chain ${chainId}`);\r\n}\r\n\r\nexport function decodeReferralCode(hexCode) {\r\n  try {\r\n    return ethers.utils.parseBytes32String(hexCode);\r\n  } catch (ex) {\r\n    let code = \"\";\r\n    hexCode = hexCode.substring(2);\r\n    for (let i = 0; i < 32; i++) {\r\n      code += String.fromCharCode(parseInt(hexCode.substring(i * 2, i * 2 + 2), 16));\r\n    }\r\n    return code.trim();\r\n  }\r\n}\r\n\r\nexport function encodeReferralCode(code) {\r\n  let final = code.replace(/[^\\w_]/g, \"\"); // replace everything other than numbers, string  and underscor to ''\r\n  if (final.length > MAX_REFERRAL_CODE_LENGTH) {\r\n    return ethers.constants.HashZero;\r\n  }\r\n  return ethers.utils.formatBytes32String(final);\r\n}\r\n\r\nasync function getCodeOwnersData(network, account, codes = []) {\r\n  if (codes.length === 0 || !account || !network) {\r\n    return undefined;\r\n  }\r\n  const query = gql`\r\n    query allCodes($codes: [String!]!) {\r\n      referralCodes(where: { code_in: $codes }) {\r\n        owner\r\n        id\r\n      }\r\n    }\r\n  `;\r\n  return getGraphClient(network)\r\n    .query({ query, variables: { codes } })\r\n    .then(({ data }) => {\r\n      const { referralCodes } = data;\r\n      const codeOwners = referralCodes.reduce((acc, cv) => {\r\n        acc[cv.id] = cv.owner;\r\n        return acc;\r\n      }, {});\r\n      return codes.map((code) => {\r\n        const owner = codeOwners[code];\r\n        return {\r\n          code,\r\n          codeString: decodeReferralCode(code),\r\n          owner,\r\n          isTaken: Boolean(owner),\r\n          isTakenByCurrentUser: owner && owner.toLowerCase() === account.toLowerCase(),\r\n        };\r\n      });\r\n    });\r\n}\r\n\r\nexport function useUserCodesOnAllChain(account) {\r\n  const [data, setData] = useState(null);\r\n  const query = gql`\r\n    query referralCodesOnAllChain($account: String!) {\r\n      referralCodes(first: 1000, where: { owner: $account }) {\r\n        code\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    async function main() {\r\n      const [arbitrumCodes, avalancheCodes] = await Promise.all(\r\n        ACTIVE_CHAINS.map((chainId) => {\r\n          return getGraphClient(chainId)\r\n            .query({ query, variables: { account: (account || \"\").toLowerCase() } })\r\n            .then(({ data }) => {\r\n              return data.referralCodes.map((c) => c.code);\r\n            });\r\n        })\r\n      );\r\n      const [codeOwnersOnAvax = [], codeOwnersOnArbitrum = []] = await Promise.all([\r\n        getCodeOwnersData(AVALANCHE, account, arbitrumCodes),\r\n        getCodeOwnersData(ARBITRUM, account, avalancheCodes),\r\n      ]);\r\n\r\n      setData({\r\n        [ARBITRUM]: codeOwnersOnAvax.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n        [AVALANCHE]: codeOwnersOnArbitrum.reduce((acc, cv) => {\r\n          acc[cv.code] = cv;\r\n          return acc;\r\n        }, {}),\r\n      });\r\n    }\r\n\r\n    main();\r\n  }, [account, query]);\r\n  return data;\r\n}\r\n\r\nexport function useReferralsData(chainId, account) {\r\n  const [data, setData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const ownerOnOtherChain = useUserCodesOnAllChain(account);\r\n  useEffect(() => {\r\n    if (!chainId || !account) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    const startOfDayTimestamp = Math.floor(parseInt(Date.now() / 1000) / 86400) * 86400;\r\n    const query = gql`\r\n      query referralData($typeIds: [String!]!, $account: String!, $timestamp: Int!, $referralTotalStatsId: String!) {\r\n        distributions(\r\n          first: 1000\r\n          orderBy: timestamp\r\n          orderDirection: desc\r\n          where: { receiver: $account, typeId_in: $typeIds }\r\n        ) {\r\n          receiver\r\n          amount\r\n          typeId\r\n          token\r\n          transactionHash\r\n          timestamp\r\n        }\r\n        referrerTotalStats: referrerStats(\r\n          first: 1000\r\n          orderBy: volume\r\n          orderDirection: desc\r\n          where: { period: total, referrer: $account }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referrerLastDayStats: referrerStats(\r\n          first: 1000\r\n          where: { period: daily, referrer: $account, timestamp: $timestamp }\r\n        ) {\r\n          referralCode\r\n          volume\r\n          trades\r\n          tradedReferralsCount\r\n          registeredReferralsCount\r\n          totalRebateUsd\r\n          discountUsd\r\n        }\r\n        referralCodes(first: 1000, where: { owner: $account }) {\r\n          code\r\n        }\r\n        referralTotalStats: referralStat(id: $referralTotalStatsId) {\r\n          volume\r\n          discountUsd\r\n        }\r\n        referrerTierInfo: referrer(id: $account) {\r\n          tierId\r\n          id\r\n          discountShare\r\n        }\r\n      }\r\n    `;\r\n    setLoading(true);\r\n\r\n    getGraphClient(chainId)\r\n      .query({\r\n        query,\r\n        variables: {\r\n          typeIds: [DISTRIBUTION_TYPE_REBATES, DISTRIBUTION_TYPE_DISCOUNT],\r\n          account: (account || \"\").toLowerCase(),\r\n          timestamp: startOfDayTimestamp,\r\n          referralTotalStatsId: account && `total:0:${account.toLowerCase()}`,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        const rebateDistributions = [];\r\n        const discountDistributions = [];\r\n        res.data.distributions.forEach((d) => {\r\n          const item = {\r\n            timestamp: parseInt(d.timestamp),\r\n            transactionHash: d.transactionHash,\r\n            receiver: ethers.utils.getAddress(d.receiver),\r\n            amount: bigNumberify(d.amount),\r\n            typeId: d.typeId,\r\n            token: ethers.utils.getAddress(d.token),\r\n          };\r\n          if (d.typeId === DISTRIBUTION_TYPE_REBATES) {\r\n            rebateDistributions.push(item);\r\n          } else {\r\n            discountDistributions.push(item);\r\n          }\r\n        });\r\n\r\n        function prepareStatsItem(e) {\r\n          return {\r\n            volume: bigNumberify(e.volume),\r\n            trades: parseInt(e.trades),\r\n            tradedReferralsCount: parseInt(e.tradedReferralsCount),\r\n            registeredReferralsCount: parseInt(e.registeredReferralsCount),\r\n            totalRebateUsd: bigNumberify(e.totalRebateUsd),\r\n            discountUsd: bigNumberify(e.discountUsd),\r\n            referralCode: decodeReferralCode(e.referralCode),\r\n            ownerOnOtherChain: ownerOnOtherChain?.[chainId][e.referralCode],\r\n          };\r\n        }\r\n\r\n        function getCumulativeStats(data = []) {\r\n          return data.reduce(\r\n            (acc, cv) => {\r\n              acc.totalRebateUsd = acc.totalRebateUsd.add(cv.totalRebateUsd);\r\n              acc.volume = acc.volume.add(cv.volume);\r\n              acc.discountUsd = acc.discountUsd.add(cv.discountUsd);\r\n              acc.trades = acc.trades + cv.trades;\r\n              acc.tradedReferralsCount = acc.tradedReferralsCount + cv.tradedReferralsCount;\r\n              acc.registeredReferralsCount = acc.registeredReferralsCount + cv.registeredReferralsCount;\r\n              return acc;\r\n            },\r\n            {\r\n              totalRebateUsd: bigNumberify(0),\r\n              volume: bigNumberify(0),\r\n              discountUsd: bigNumberify(0),\r\n              trades: 0,\r\n              tradedReferralsCount: 0,\r\n              registeredReferralsCount: 0,\r\n            }\r\n          );\r\n        }\r\n\r\n        let referrerTotalStats = res.data.referrerTotalStats.map(prepareStatsItem);\r\n        setData({\r\n          rebateDistributions,\r\n          discountDistributions,\r\n          referrerTotalStats,\r\n          referrerTierInfo: res.data.referrerTierInfo,\r\n          referrerLastDayStats: res.data.referrerLastDayStats.map(prepareStatsItem),\r\n          cumulativeStats: getCumulativeStats(referrerTotalStats),\r\n          codes: res.data.referralCodes.map((e) => decodeReferralCode(e.code)),\r\n          referralTotalStats: res.data.referralTotalStats\r\n            ? {\r\n                volume: bigNumberify(res.data.referralTotalStats.volume),\r\n                discountUsd: bigNumberify(res.data.referralTotalStats.discountUsd),\r\n              }\r\n            : {\r\n                volume: bigNumberify(0),\r\n                discountUsd: bigNumberify(0),\r\n              },\r\n        });\r\n      })\r\n      .catch(console.warn)\r\n      .finally(() => {\r\n        setLoading(false);\r\n      });\r\n  }, [setData, chainId, account, ownerOnOtherChain]);\r\n\r\n  return {\r\n    data: data || null,\r\n    loading,\r\n  };\r\n}\r\n\r\nexport async function registerReferralCode(chainId, referralCode, library, opts) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  return callContract(chainId, contract, \"registerCode\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function setTraderReferralCodeByUser(chainId, referralCode, library, opts) {\r\n  const referralCodeHex = encodeReferralCode(referralCode);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, library.getSigner());\r\n  const codeOwner = await contract.codeOwners(referralCodeHex);\r\n  if (isAddressZero(codeOwner)) {\r\n    const errorMsg = \"Referral code does not exist\";\r\n    helperToast.error(errorMsg);\r\n    return Promise.reject(errorMsg);\r\n  }\r\n  return callContract(chainId, contract, \"setTraderReferralCodeByUser\", [referralCodeHex], opts);\r\n}\r\n\r\nexport async function getReferralCodeOwner(chainId, referralCode) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const provider = getProvider(null, chainId);\r\n  const contract = new ethers.Contract(referralStorageAddress, ReferralStorage.abi, provider);\r\n  const codeOwner = await contract.codeOwners(referralCode);\r\n  return codeOwner;\r\n}\r\n\r\nexport function useUserReferralCode(library, chainId, account) {\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: onChainCode } = useSWR(\r\n    account && [\"ReferralStorage\", chainId, referralStorageAddress, \"traderReferralCodes\", account],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const { data: localStorageCodeOwner } = useSWR(\r\n    localStorageCode &&\r\n      REGEX_VERIFY_BYTES32.test(localStorageCode) && [\r\n        \"ReferralStorage\",\r\n        chainId,\r\n        referralStorageAddress,\r\n        \"codeOwners\",\r\n        localStorageCode,\r\n      ],\r\n    { fetcher: fetcher(library, ReferralStorage) }\r\n  );\r\n  const [attachedOnChain, userReferralCode, userReferralCodeString] = useMemo(() => {\r\n    if (onChainCode && !isHashZero(onChainCode)) {\r\n      return [true, onChainCode, decodeReferralCode(onChainCode)];\r\n    } else if (localStorageCodeOwner && !isAddressZero(localStorageCodeOwner)) {\r\n      return [false, localStorageCode, decodeReferralCode(localStorageCode)];\r\n    }\r\n    return [false];\r\n  }, [localStorageCode, localStorageCodeOwner, onChainCode]);\r\n\r\n  return {\r\n    userReferralCode,\r\n    userReferralCodeString,\r\n    attachedOnChain,\r\n  };\r\n}\r\n\r\nexport function useReferrerTier(library, chainId, account) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: referrerTier, mutate: mutateReferrerTier } = useSWR(\r\n    account && [`ReferralStorage:referrerTiers`, chainId, referralStorageAddress, \"referrerTiers\", account],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    referrerTier,\r\n    mutateReferrerTier,\r\n  };\r\n}\r\n\r\nexport function useCodeOwner(library, chainId, account, code) {\r\n  const referralStorageAddress = getContract(chainId, \"ReferralStorage\");\r\n  const { data: codeOwner, mutate: mutateCodeOwner } = useSWR(\r\n    account && code && [`ReferralStorage:codeOwners`, chainId, referralStorageAddress, \"codeOwners\", code],\r\n    {\r\n      fetcher: fetcher(library, ReferralStorage),\r\n    }\r\n  );\r\n  return {\r\n    codeOwner,\r\n    mutateCodeOwner,\r\n  };\r\n}\r\n\r\nexport async function validateReferralCodeExists(referralCode, chainId) {\r\n  const referralCodeBytes32 = encodeReferralCode(referralCode);\r\n  const referralCodeOwner = await getReferralCodeOwner(chainId, referralCodeBytes32);\r\n  return !isAddressZero(referralCodeOwner);\r\n}\r\n\r\nexport function useAffiliateCodes(chainId, account) {\r\n  const [affiliateCodes, setAffiliateCodes] = useState({ code: null, success: false });\r\n  const query = gql`\r\n    query userReferralCodes($account: String!) {\r\n      referrerTotalStats: referrerStats(\r\n        first: 1000\r\n        orderBy: volume\r\n        orderDirection: desc\r\n        where: { period: total, referrer: $account }\r\n      ) {\r\n        referralCode\r\n      }\r\n    }\r\n  `;\r\n  useEffect(() => {\r\n    if (!chainId) return;\r\n    getGraphClient(chainId)\r\n      .query({ query, variables: { account: account?.toLowerCase() } })\r\n      .then((res) => {\r\n        const parsedAffiliateCodes = res?.data?.referrerTotalStats.map((c) => decodeReferralCode(c?.referralCode));\r\n        setAffiliateCodes({ code: parsedAffiliateCodes[0], success: true });\r\n      });\r\n    return () => {\r\n      setAffiliateCodes({ code: null, success: false });\r\n    };\r\n  }, [chainId, query, account]);\r\n  return affiliateCodes;\r\n}\r\n","import { getNativeToken } from \"../../config/Tokens\";\r\nimport { ethers } from \"ethers\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport { TokenInfo, Token } from \"../../domain/tokens/types\";\r\nimport { get1InchSwapUrl } from \"../../domain/common\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\ntype Props = {\r\n  chainId: number;\r\n  modalError: string;\r\n  isShort: boolean;\r\n  isLong: boolean;\r\n  fromToken: Token;\r\n  toToken: Token;\r\n  shortCollateralToken: TokenInfo;\r\n  setModalError: () => void;\r\n};\r\n\r\nexport default function NoLiquidityErrorModal({\r\n  chainId,\r\n  fromToken,\r\n  toToken,\r\n  shortCollateralToken,\r\n  isLong,\r\n  isShort,\r\n  modalError,\r\n  setModalError,\r\n}: Props) {\r\n  const nativeToken = getNativeToken(chainId);\r\n  const inputCurrency = fromToken.address === AddressZero ? nativeToken.symbol : fromToken.address;\r\n  let outputCurrency;\r\n  if (isLong) {\r\n    outputCurrency = toToken.address === AddressZero ? nativeToken.symbol : toToken.address;\r\n  } else {\r\n    outputCurrency = shortCollateralToken.address;\r\n  }\r\n  const swapTokenSymbol = isLong ? toToken.symbol : shortCollateralToken.symbol;\r\n  const oneInchSwapUrl = get1InchSwapUrl(chainId, inputCurrency, outputCurrency);\r\n  const label =\r\n    modalError === \"BUFFER\" ? `${shortCollateralToken.symbol} Required` : `${fromToken.symbol} Pool Capacity Reached`;\r\n\r\n  return (\r\n    <Modal isVisible={Boolean(modalError)} setIsVisible={setModalError} label={label} className=\"Error-modal font-base\">\r\n      <div>\r\n        You need to select {swapTokenSymbol} as the \"Pay\" token to use it for collateral to initiate this trade.\r\n      </div>\r\n      <br />\r\n      <div>\r\n        As there is not enough liquidity in GLP to swap {fromToken.symbol} to {swapTokenSymbol}, you can use the option\r\n        below to do so:\r\n      </div>\r\n      <br />\r\n\r\n      <a href={oneInchSwapUrl} target=\"_blank\" rel=\"noreferrer\">\r\n        Buy {swapTokenSymbol} on 1inch\r\n      </a>\r\n\r\n      {isShort && (\r\n        <div>\r\n          Alternatively you can select a different \"Collateral In\" token.\r\n          <br />\r\n          <br />\r\n        </div>\r\n      )}\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useEffect, useMemo, useState } from \"react\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport { t, Trans } from \"@lingui/macro\";\r\nimport Slider, { SliderTooltip } from \"rc-slider\";\r\nimport \"rc-slider/assets/index.css\";\r\nimport \"./SwapBox.css\";\r\n\r\nimport cx from \"classnames\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\n\r\nimport { IoMdSwap } from \"react-icons/io\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  adjustForDecimals,\r\n  approveTokens,\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  BASIS_POINTS_DIVISOR,\r\n  bigNumberify,\r\n  calculatePositionDelta,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  DUST_BNB,\r\n  expandDecimals,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  getChainName,\r\n  getExchangeRate,\r\n  getExchangeRateDisplay,\r\n  getLeverage,\r\n  getLiquidationPrice,\r\n  getMostAbundantStableToken,\r\n  getNextFromAmount,\r\n  getNextToAmount,\r\n  getPositionKey,\r\n  getTokenInfo,\r\n  getUsd,\r\n  helperToast,\r\n  IS_NETWORK_DISABLED,\r\n  isSupportedChain,\r\n  isTriggerRatioInverted,\r\n  LEVERAGE_ORDER_OPTIONS,\r\n  LIMIT,\r\n  LONG,\r\n  MARGIN_FEE_BASIS_POINTS,\r\n  MARKET,\r\n  parseValue,\r\n  PRECISION,\r\n  replaceNativeTokenAddress,\r\n  SHORT,\r\n  shouldRaiseGasError,\r\n  STOP,\r\n  SWAP,\r\n  SWAP_OPTIONS,\r\n  SWAP_ORDER_OPTIONS,\r\n  USD_DECIMALS,\r\n  USDG_ADDRESS,\r\n  USDG_DECIMALS,\r\n  useLocalStorageByChainId,\r\n  useLocalStorageSerializeKey,\r\n  usePrevious,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport * as Api from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport TokenSelector from \"./TokenSelector\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport ConfirmationBox from \"./ConfirmationBox\";\r\nimport OrdersToa from \"./OrdersToa\";\r\n\r\nimport { getToken, getTokenBySymbol, getTokens, getWhitelistedTokens } from \"../../config/Tokens\";\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Router from \"../../abis/Router.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport WETH from \"../../abis/WETH.json\";\r\n\r\nimport longImg from \"../../img/ddl/long.svg\";\r\nimport shortImg from \"../../img/ddl/short.svg\";\r\nimport swapImg from \"../../img/swap.svg\";\r\nimport longActiveImg from \"../../img/ddl/long_active.svg\";\r\nimport shortActiveImg from \"../../img/ddl/short_active.svg\";\r\n\r\nimport { useUserReferralCode } from \"../../domain/referrals\";\r\nimport NoLiquidityErrorModal from \"./NoLiquidityErrorModal\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nconst SWAP_ICONS = {\r\n  [LONG]: longImg,\r\n  [SHORT]: shortImg,\r\n  [SWAP]: swapImg,\r\n  Long_active: longActiveImg,\r\n  Short_active: shortActiveImg,\r\n};\r\nconst { AddressZero } = ethers.constants;\r\n\r\nconst leverageSliderHandle = (props) => {\r\n  const { value, dragging, index, ...restProps } = props;\r\n  return (\r\n    <SliderTooltip\r\n      prefixCls=\"rc-slider-tooltip\"\r\n      overlay={`${parseFloat(value).toFixed(2)}x`}\r\n      visible={dragging}\r\n      placement=\"top\"\r\n      key={index}\r\n    >\r\n      <Slider.Handle value={value} {...restProps} />\r\n    </SliderTooltip>\r\n  );\r\n};\r\n\r\nfunction getNextAveragePrice({ size, sizeDelta, hasProfit, delta, nextPrice, isLong }) {\r\n  if (!size || !sizeDelta || !delta || !nextPrice) {\r\n    return;\r\n  }\r\n  const nextSize = size.add(sizeDelta);\r\n  let divisor;\r\n  if (isLong) {\r\n    divisor = hasProfit ? nextSize.add(delta) : nextSize.sub(delta);\r\n  } else {\r\n    divisor = hasProfit ? nextSize.sub(delta) : nextSize.add(delta);\r\n  }\r\n  if (!divisor || divisor.eq(0)) {\r\n    return;\r\n  }\r\n  const nextAveragePrice = nextPrice.mul(nextSize).div(divisor);\r\n  return nextAveragePrice;\r\n}\r\n\r\nexport default function SwapBox(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    infoTokens,\r\n    active,\r\n    library,\r\n    account,\r\n    fromTokenAddress,\r\n    setFromTokenAddress,\r\n    toTokenAddress,\r\n    setToTokenAddress,\r\n    swapOption,\r\n    setSwapOption,\r\n    positionsMap,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    tokenSelection,\r\n    setTokenSelection,\r\n    setIsConfirming,\r\n    isConfirming,\r\n    isPendingConfirmation,\r\n    setIsPendingConfirmation,\r\n    flagOrdersEnabled,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    savedSlippageAmount,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    orders,\r\n    savedIsPnlInLeverage,\r\n    orderBookApproved,\r\n    positionRouterApproved,\r\n    isWaitingForPluginApproval,\r\n    approveOrderBook,\r\n    approvePositionRouter,\r\n    setIsWaitingForPluginApproval,\r\n    isWaitingForPositionRouterApproval,\r\n    setIsWaitingForPositionRouterApproval,\r\n    isPluginApproving,\r\n    isPositionRouterApproving,\r\n    savedShouldDisableValidationForTesting,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  } = props;\r\n\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [toValue, setToValue] = useState(\"\");\r\n  const [anchorOnFromAmount, setAnchorOnFromAmount] = useState(true);\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isWaitingForApproval, setIsWaitingForApproval] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [modalError, setModalError] = useState(false);\r\n  const [isHigherSlippageAllowed, setIsHigherSlippageAllowed] = useState(false);\r\n  const { attachedOnChain, userReferralCode } = useUserReferralCode(library, chainId, account);\r\n\r\n  let allowedSlippage = savedSlippageAmount;\r\n  if (isHigherSlippageAllowed) {\r\n    allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  }\r\n\r\n  const defaultCollateralSymbol = getConstant(chainId, \"defaultCollateralSymbol\");\r\n  // TODO hack with useLocalStorageSerializeKey\r\n  const [shortCollateralAddress, setShortCollateralAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    \"Short-Collateral-Address\",\r\n    getTokenBySymbol(chainId, defaultCollateralSymbol).address\r\n  );\r\n  const isLong = swapOption === LONG;\r\n  const isShort = swapOption === SHORT;\r\n  const isSwap = swapOption === SWAP;\r\n\r\n  const getLeaderboardLink = () => {\r\n    if (chainId === ARBITRUM) {\r\n      return \"https://www.gmx.house/arbitrum/leaderboard\";\r\n    }\r\n    if (chainId === AVALANCHE) {\r\n      return \"https://www.gmx.house/avalanche/leaderboard\";\r\n    }\r\n    return \"https://www.gmx.house\";\r\n  };\r\n\r\n  function getTokenLabel() {\r\n    switch (true) {\r\n      case isLong:\r\n        return t`Long`;\r\n      case isShort:\r\n        return t`Short`;\r\n      case isSwap:\r\n        return t`Receive`;\r\n      default:\r\n        return \"\";\r\n    }\r\n  }\r\n  const [leverageOption, setLeverageOption] = useLocalStorageSerializeKey(\r\n    [chainId, \"Exchange-swap-leverage-option\"],\r\n    \"2\"\r\n  );\r\n  const [isLeverageSliderEnabled, setIsLeverageSliderEnabled] = useLocalStorageSerializeKey(\r\n    [chainId, \"Exchange-swap-leverage-slider-enabled\"],\r\n    true\r\n  );\r\n\r\n  const hasLeverageOption = isLeverageSliderEnabled && !isNaN(parseFloat(leverageOption));\r\n\r\n  const [ordersToaOpen, setOrdersToaOpen] = useState(false);\r\n\r\n  let [orderOption, setOrderOption] = useLocalStorageSerializeKey([chainId, \"Order-option\"], MARKET);\r\n  if (!flagOrdersEnabled) {\r\n    orderOption = MARKET;\r\n  }\r\n\r\n  const onOrderOptionChange = (option) => {\r\n    setOrderOption(option);\r\n  };\r\n\r\n  const isMarketOrder = orderOption === MARKET;\r\n  const orderOptions = isSwap ? SWAP_ORDER_OPTIONS : LEVERAGE_ORDER_OPTIONS;\r\n  const orderOptionLabels = { [STOP]: \"Trigger\" };\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(\"\");\r\n  const triggerPriceUsd = isMarketOrder ? 0 : parseValue(triggerPriceValue, USD_DECIMALS);\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const onTriggerRatioChange = (evt) => {\r\n    setTriggerRatioValue(evt.target.value || \"\");\r\n  };\r\n\r\n  let positionKey;\r\n  if (isLong) {\r\n    positionKey = getPositionKey(account, toTokenAddress, toTokenAddress, true, nativeTokenAddress);\r\n  }\r\n  if (isShort) {\r\n    positionKey = getPositionKey(account, shortCollateralAddress, toTokenAddress, false, nativeTokenAddress);\r\n  }\r\n\r\n  const existingPosition = positionKey ? positionsMap[positionKey] : undefined;\r\n  const hasExistingPosition = existingPosition && existingPosition.size && existingPosition.size.gt(0);\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const tokens = getTokens(chainId);\r\n  const fromTokens = tokens;\r\n  const stableTokens = tokens.filter((token) => token.isStable);\r\n  const indexTokens = whitelistedTokens.filter((token) => !token.isStable && !token.isWrapped);\r\n  const shortableTokens = indexTokens.filter((token) => token.isShortable);\r\n\r\n  let toTokens = tokens;\r\n  if (isLong) {\r\n    toTokens = indexTokens;\r\n  }\r\n  if (isShort) {\r\n    toTokens = shortableTokens;\r\n  }\r\n\r\n  const needOrderBookApproval = !isMarketOrder && !orderBookApproved;\r\n  const prevNeedOrderBookApproval = usePrevious(needOrderBookApproval);\r\n\r\n  const needPositionRouterApproval = (isLong || isShort) && isMarketOrder && !positionRouterApproved;\r\n  const prevNeedPositionRouterApproval = usePrevious(needPositionRouterApproval);\r\n\r\n  useEffect(() => {\r\n    if (!needOrderBookApproval && prevNeedOrderBookApproval && isWaitingForPluginApproval) {\r\n      setIsWaitingForPluginApproval(false);\r\n      helperToast.success(<div>Orders enabled!</div>);\r\n    }\r\n  }, [needOrderBookApproval, prevNeedOrderBookApproval, setIsWaitingForPluginApproval, isWaitingForPluginApproval]);\r\n\r\n  useEffect(() => {\r\n    if (!needPositionRouterApproval && prevNeedPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      setIsWaitingForPositionRouterApproval(false);\r\n      helperToast.success(<div>Leverage enabled!</div>);\r\n    }\r\n  }, [\r\n    needPositionRouterApproval,\r\n    prevNeedPositionRouterApproval,\r\n    setIsWaitingForPositionRouterApproval,\r\n    isWaitingForPositionRouterApproval,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (!needOrderBookApproval && prevNeedOrderBookApproval && isWaitingForPluginApproval) {\r\n      setIsWaitingForPluginApproval(false);\r\n      helperToast.success(<div>Orders enabled!</div>);\r\n    }\r\n  }, [needOrderBookApproval, prevNeedOrderBookApproval, setIsWaitingForPluginApproval, isWaitingForPluginApproval]);\r\n\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const tokenAllowanceAddress = fromTokenAddress === AddressZero ? nativeTokenAddress : fromTokenAddress;\r\n  const { data: tokenAllowance } = useSWR(\r\n    active && [active, chainId, tokenAllowanceAddress, \"allowance\", account, routerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const { data: hasOutdatedUi } = Api.useHasOutdatedUi();\r\n\r\n  const fromToken = getToken(chainId, fromTokenAddress);\r\n  const toToken = getToken(chainId, toTokenAddress);\r\n  const shortCollateralToken = getTokenInfo(infoTokens, shortCollateralAddress);\r\n\r\n  const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  const renderAvailableLongLiquidity = () => {\r\n    if (!isLong) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <div className=\"Exchange-info-row\">\r\n        <div className=\"Exchange-info-label\">\r\n          <Trans>Available Liquidity</Trans>\r\n        </div>\r\n        <div className=\"align-right\">\r\n          <Tooltip\r\n            handle={`$${formatAmount(toTokenInfo.maxAvailableLong, USD_DECIMALS, 2, true)}`}\r\n            position=\"right-bottom\"\r\n            renderContent={() => {\r\n              return (\r\n                <>\r\n                  <StatsTooltipRow\r\n                    label={`Max ${toTokenInfo.symbol} long capacity`}\r\n                    value={formatAmount(toTokenInfo.maxLongCapacity, USD_DECIMALS, 0, true)}\r\n                  />\r\n                  <StatsTooltipRow\r\n                    label={`Current ${toTokenInfo.symbol} long`}\r\n                    value={formatAmount(toTokenInfo.guaranteedUsd, USD_DECIMALS, 0, true)}\r\n                  />\r\n                </>\r\n              );\r\n            }}\r\n          ></Tooltip>\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const fromBalance = fromTokenInfo ? fromTokenInfo.balance : bigNumberify(0);\r\n  const toBalance = toTokenInfo ? toTokenInfo.balance : bigNumberify(0);\r\n\r\n  const fromAmount = parseValue(fromValue, fromToken && fromToken.decimals);\r\n  const toAmount = parseValue(toValue, toToken && toToken.decimals);\r\n\r\n  const isPotentialWrap = (fromToken.isNative && toToken.isWrapped) || (fromToken.isWrapped && toToken.isNative);\r\n  const isWrapOrUnwrap = isSwap && isPotentialWrap;\r\n  const needApproval =\r\n    fromTokenAddress !== AddressZero &&\r\n    tokenAllowance &&\r\n    fromAmount &&\r\n    fromAmount.gt(tokenAllowance) &&\r\n    !isWrapOrUnwrap;\r\n  const prevFromTokenAddress = usePrevious(fromTokenAddress);\r\n  const prevNeedApproval = usePrevious(needApproval);\r\n  const prevToTokenAddress = usePrevious(toTokenAddress);\r\n\r\n  const fromUsdMin = getUsd(fromAmount, fromTokenAddress, false, infoTokens);\r\n  const toUsdMax = getUsd(toAmount, toTokenAddress, true, infoTokens, orderOption, triggerPriceUsd);\r\n\r\n  const indexTokenAddress = toTokenAddress === AddressZero ? nativeTokenAddress : toTokenAddress;\r\n  const collateralTokenAddress = isLong ? indexTokenAddress : shortCollateralAddress;\r\n  const collateralToken = getToken(chainId, collateralTokenAddress);\r\n\r\n  const [triggerRatioValue, setTriggerRatioValue] = useState(\"\");\r\n\r\n  const triggerRatioInverted = useMemo(() => {\r\n    return isTriggerRatioInverted(fromTokenInfo, toTokenInfo);\r\n  }, [toTokenInfo, fromTokenInfo]);\r\n\r\n  const maxToTokenOut = useMemo(() => {\r\n    const value = toTokenInfo.availableAmount?.gt(toTokenInfo.poolAmount?.sub(toTokenInfo.bufferAmount))\r\n      ? toTokenInfo.poolAmount?.sub(toTokenInfo.bufferAmount)\r\n      : toTokenInfo.availableAmount;\r\n\r\n    if (!value) {\r\n      return bigNumberify(0);\r\n    }\r\n\r\n    return value.gt(0) ? value : bigNumberify(0);\r\n  }, [toTokenInfo]);\r\n\r\n  const maxToTokenOutUSD = useMemo(() => {\r\n    return getUsd(maxToTokenOut, toTokenAddress, false, infoTokens);\r\n  }, [maxToTokenOut, toTokenAddress, infoTokens]);\r\n\r\n  const maxFromTokenInUSD = useMemo(() => {\r\n    const value = fromTokenInfo.maxUsdgAmount\r\n      ?.sub(fromTokenInfo.usdgAmount)\r\n      .mul(expandDecimals(1, USD_DECIMALS))\r\n      .div(expandDecimals(1, USDG_DECIMALS));\r\n\r\n    if (!value) {\r\n      return bigNumberify(0);\r\n    }\r\n\r\n    return value.gt(0) ? value : bigNumberify(0);\r\n  }, [fromTokenInfo]);\r\n\r\n  const maxFromTokenIn = useMemo(() => {\r\n    if (!fromTokenInfo.maxPrice) {\r\n      return bigNumberify(0);\r\n    }\r\n    return maxFromTokenInUSD?.mul(expandDecimals(1, fromTokenInfo.decimals)).div(fromTokenInfo.maxPrice).toString();\r\n  }, [maxFromTokenInUSD, fromTokenInfo]);\r\n\r\n  let maxSwapAmountUsd = bigNumberify(0);\r\n\r\n  if (maxToTokenOutUSD && maxFromTokenInUSD) {\r\n    maxSwapAmountUsd = maxToTokenOutUSD.lt(maxFromTokenInUSD) ? maxToTokenOutUSD : maxFromTokenInUSD;\r\n  }\r\n\r\n  const triggerRatio = useMemo(() => {\r\n    if (!triggerRatioValue) {\r\n      return bigNumberify(0);\r\n    }\r\n    let ratio = parseValue(triggerRatioValue, USD_DECIMALS);\r\n    if (ratio.eq(0)) {\r\n      return bigNumberify(0);\r\n    }\r\n    if (triggerRatioInverted) {\r\n      ratio = PRECISION.mul(PRECISION).div(ratio);\r\n    }\r\n    return ratio;\r\n  }, [triggerRatioValue, triggerRatioInverted]);\r\n\r\n  useEffect(() => {\r\n    if (\r\n      fromToken &&\r\n      fromTokenAddress === prevFromTokenAddress &&\r\n      !needApproval &&\r\n      prevNeedApproval &&\r\n      isWaitingForApproval\r\n    ) {\r\n      setIsWaitingForApproval(false);\r\n      helperToast.success(<div>{fromToken.symbol} approved!</div>);\r\n    }\r\n  }, [\r\n    fromTokenAddress,\r\n    prevFromTokenAddress,\r\n    needApproval,\r\n    prevNeedApproval,\r\n    setIsWaitingForApproval,\r\n    fromToken.symbol,\r\n    isWaitingForApproval,\r\n    fromToken,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    if (!toTokens.find((token) => token.address === toTokenAddress)) {\r\n      setToTokenAddress(swapOption, toTokens[0].address);\r\n    }\r\n  }, [swapOption, toTokens, toTokenAddress, setToTokenAddress]);\r\n\r\n  useEffect(() => {\r\n    if (swapOption !== SHORT) {\r\n      return;\r\n    }\r\n    if (toTokenAddress === prevToTokenAddress) {\r\n      return;\r\n    }\r\n    for (let i = 0; i < stableTokens.length; i++) {\r\n      const stableToken = stableTokens[i];\r\n      const key = getPositionKey(account, stableToken.address, toTokenAddress, false, nativeTokenAddress);\r\n      const position = positionsMap[key];\r\n      if (position && position.size && position.size.gt(0)) {\r\n        setShortCollateralAddress(position.collateralToken.address);\r\n        return;\r\n      }\r\n    }\r\n  }, [\r\n    account,\r\n    toTokenAddress,\r\n    prevToTokenAddress,\r\n    swapOption,\r\n    positionsMap,\r\n    stableTokens,\r\n    nativeTokenAddress,\r\n    shortCollateralAddress,\r\n    setShortCollateralAddress,\r\n  ]);\r\n\r\n  useEffect(() => {\r\n    const updateSwapAmounts = () => {\r\n      if (anchorOnFromAmount) {\r\n        if (!fromAmount) {\r\n          setToValue(\"\");\r\n          return;\r\n        }\r\n        if (toToken) {\r\n          const { amount: nextToAmount } = getNextToAmount(\r\n            chainId,\r\n            fromAmount,\r\n            fromTokenAddress,\r\n            toTokenAddress,\r\n            infoTokens,\r\n            undefined,\r\n            !isMarketOrder && triggerRatio,\r\n            usdgSupply,\r\n            totalTokenWeights,\r\n            isSwap\r\n          );\r\n\r\n          const nextToValue = formatAmountFree(nextToAmount, toToken.decimals, toToken.decimals);\r\n          setToValue(nextToValue);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!toAmount) {\r\n        setFromValue(\"\");\r\n        return;\r\n      }\r\n      if (fromToken) {\r\n        const { amount: nextFromAmount } = getNextFromAmount(\r\n          chainId,\r\n          toAmount,\r\n          fromTokenAddress,\r\n          toTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          !isMarketOrder && triggerRatio,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        const nextFromValue = formatAmountFree(nextFromAmount, fromToken.decimals, fromToken.decimals);\r\n        setFromValue(nextFromValue);\r\n      }\r\n    };\r\n\r\n    const updateLeverageAmounts = () => {\r\n      if (!hasLeverageOption) {\r\n        return;\r\n      }\r\n      if (anchorOnFromAmount) {\r\n        if (!fromAmount) {\r\n          setToValue(\"\");\r\n          return;\r\n        }\r\n\r\n        const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n        if (toTokenInfo && toTokenInfo.maxPrice && fromUsdMin && fromUsdMin.gt(0)) {\r\n          const leverageMultiplier = parseInt(leverageOption * BASIS_POINTS_DIVISOR);\r\n          const toTokenPriceUsd =\r\n            !isMarketOrder && triggerPriceUsd && triggerPriceUsd.gt(0) ? triggerPriceUsd : toTokenInfo.maxPrice;\r\n\r\n          const { feeBasisPoints } = getNextToAmount(\r\n            chainId,\r\n            fromAmount,\r\n            fromTokenAddress,\r\n            collateralTokenAddress,\r\n            infoTokens,\r\n            undefined,\r\n            undefined,\r\n            usdgSupply,\r\n            totalTokenWeights,\r\n            isSwap\r\n          );\r\n\r\n          let fromUsdMinAfterFee = fromUsdMin;\r\n          if (feeBasisPoints) {\r\n            fromUsdMinAfterFee = fromUsdMin.mul(BASIS_POINTS_DIVISOR - feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n          }\r\n\r\n          const toNumerator = fromUsdMinAfterFee.mul(leverageMultiplier).mul(BASIS_POINTS_DIVISOR);\r\n          const toDenominator = bigNumberify(MARGIN_FEE_BASIS_POINTS)\r\n            .mul(leverageMultiplier)\r\n            .add(bigNumberify(BASIS_POINTS_DIVISOR).mul(BASIS_POINTS_DIVISOR));\r\n\r\n          const nextToUsd = toNumerator.div(toDenominator);\r\n\r\n          const nextToAmount = nextToUsd.mul(expandDecimals(1, toToken.decimals)).div(toTokenPriceUsd);\r\n\r\n          const nextToValue = formatAmountFree(nextToAmount, toToken.decimals, toToken.decimals);\r\n\r\n          setToValue(nextToValue);\r\n        }\r\n        return;\r\n      }\r\n\r\n      if (!toAmount) {\r\n        setFromValue(\"\");\r\n        return;\r\n      }\r\n\r\n      const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n      if (fromTokenInfo && fromTokenInfo.minPrice && toUsdMax && toUsdMax.gt(0)) {\r\n        const leverageMultiplier = parseInt(leverageOption * BASIS_POINTS_DIVISOR);\r\n\r\n        const baseFromAmountUsd = toUsdMax.mul(BASIS_POINTS_DIVISOR).div(leverageMultiplier);\r\n\r\n        let fees = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n\r\n        const { feeBasisPoints } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          collateralTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n\r\n        if (feeBasisPoints) {\r\n          const swapFees = baseFromAmountUsd.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n          fees = fees.add(swapFees);\r\n        }\r\n\r\n        const nextFromUsd = baseFromAmountUsd.add(fees);\r\n\r\n        const nextFromAmount = nextFromUsd.mul(expandDecimals(1, fromToken.decimals)).div(fromTokenInfo.minPrice);\r\n\r\n        const nextFromValue = formatAmountFree(nextFromAmount, fromToken.decimals, fromToken.decimals);\r\n\r\n        setFromValue(nextFromValue);\r\n      }\r\n    };\r\n\r\n    if (isSwap) {\r\n      updateSwapAmounts();\r\n    }\r\n\r\n    if (isLong || isShort) {\r\n      updateLeverageAmounts();\r\n    }\r\n  }, [\r\n    anchorOnFromAmount,\r\n    fromAmount,\r\n    toAmount,\r\n    fromToken,\r\n    toToken,\r\n    fromTokenAddress,\r\n    toTokenAddress,\r\n    infoTokens,\r\n    isSwap,\r\n    isLong,\r\n    isShort,\r\n    leverageOption,\r\n    fromUsdMin,\r\n    toUsdMax,\r\n    isMarketOrder,\r\n    triggerPriceUsd,\r\n    triggerRatio,\r\n    hasLeverageOption,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n    chainId,\r\n    collateralTokenAddress,\r\n    indexTokenAddress,\r\n  ]);\r\n\r\n  let entryMarkPrice;\r\n  let exitMarkPrice;\r\n  if (toTokenInfo) {\r\n    entryMarkPrice = swapOption === LONG ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n    exitMarkPrice = swapOption === LONG ? toTokenInfo.minPrice : toTokenInfo.maxPrice;\r\n  }\r\n\r\n  let leverage = bigNumberify(0);\r\n  if (fromUsdMin && toUsdMax && fromUsdMin.gt(0)) {\r\n    const fees = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    if (fromUsdMin.sub(fees).gt(0)) {\r\n      leverage = toUsdMax.mul(BASIS_POINTS_DIVISOR).div(fromUsdMin.sub(fees));\r\n    }\r\n  }\r\n\r\n  let nextAveragePrice = isMarketOrder ? entryMarkPrice : triggerPriceUsd;\r\n  if (hasExistingPosition) {\r\n    let nextDelta, nextHasProfit;\r\n\r\n    if (isMarketOrder) {\r\n      nextDelta = existingPosition.delta;\r\n      nextHasProfit = existingPosition.hasProfit;\r\n    } else {\r\n      const data = calculatePositionDelta(triggerPriceUsd || bigNumberify(0), existingPosition);\r\n      nextDelta = data.delta;\r\n      nextHasProfit = data.hasProfit;\r\n    }\r\n\r\n    nextAveragePrice = getNextAveragePrice({\r\n      size: existingPosition.size,\r\n      sizeDelta: toUsdMax,\r\n      hasProfit: nextHasProfit,\r\n      delta: nextDelta,\r\n      nextPrice: isMarketOrder ? entryMarkPrice : triggerPriceUsd,\r\n      isLong,\r\n    });\r\n  }\r\n\r\n  const liquidationPrice = getLiquidationPrice({\r\n    isLong,\r\n    size: hasExistingPosition ? existingPosition.size : bigNumberify(0),\r\n    collateral: hasExistingPosition ? existingPosition.collateral : bigNumberify(0),\r\n    averagePrice: nextAveragePrice,\r\n    entryFundingRate: hasExistingPosition ? existingPosition.entryFundingRate : bigNumberify(0),\r\n    cumulativeFundingRate: hasExistingPosition ? existingPosition.cumulativeFundingRate : bigNumberify(0),\r\n    sizeDelta: toUsdMax,\r\n    collateralDelta: fromUsdMin,\r\n    increaseCollateral: true,\r\n    increaseSize: true,\r\n  });\r\n\r\n  const existingLiquidationPrice = existingPosition ? getLiquidationPrice(existingPosition) : undefined;\r\n  let displayLiquidationPrice = liquidationPrice ? liquidationPrice : existingLiquidationPrice;\r\n\r\n  if (hasExistingPosition) {\r\n    const collateralDelta = fromUsdMin ? fromUsdMin : bigNumberify(0);\r\n    const sizeDelta = toUsdMax ? toUsdMax : bigNumberify(0);\r\n    leverage = getLeverage({\r\n      size: existingPosition.size,\r\n      sizeDelta,\r\n      collateral: existingPosition.collateral,\r\n      collateralDelta,\r\n      increaseCollateral: true,\r\n      entryFundingRate: existingPosition.entryFundingRate,\r\n      cumulativeFundingRate: existingPosition.cumulativeFundingRate,\r\n      increaseSize: true,\r\n      hasProfit: existingPosition.hasProfit,\r\n      delta: existingPosition.delta,\r\n      includeDelta: savedIsPnlInLeverage,\r\n    });\r\n  } else if (hasLeverageOption) {\r\n    leverage = bigNumberify(parseInt(leverageOption * BASIS_POINTS_DIVISOR));\r\n  }\r\n\r\n  const getSwapError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return [t`Swaps disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n\r\n    if (fromTokenAddress === toTokenAddress) {\r\n      return [t`Select different tokens`];\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      if ((toToken.isStable || toToken.isUsdg) && (fromToken.isStable || fromToken.isUsdg)) {\r\n        return [t`Select different tokens`];\r\n      }\r\n\r\n      if (fromToken.isNative && toToken.isWrapped) {\r\n        return [t`Select different tokens`];\r\n      }\r\n\r\n      if (toToken.isNative && fromToken.isWrapped) {\r\n        return [t`Select different tokens`];\r\n      }\r\n    }\r\n\r\n    if (!fromAmount || fromAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n    if (!toAmount || toAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n\r\n    const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n    if (!fromTokenInfo || !fromTokenInfo.minPrice) {\r\n      return [t`Incorrect network`];\r\n    }\r\n    if (\r\n      !savedShouldDisableValidationForTesting &&\r\n      fromTokenInfo &&\r\n      fromTokenInfo.balance &&\r\n      fromAmount &&\r\n      fromAmount.gt(fromTokenInfo.balance)\r\n    ) {\r\n      return [t`Insufficient ${fromTokenInfo.symbol} balance`];\r\n    }\r\n\r\n    const toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n    if (!isMarketOrder) {\r\n      if (!triggerRatioValue || triggerRatio.eq(0)) {\r\n        return [t`Enter a price`];\r\n      }\r\n\r\n      const currentRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n      if (currentRate && currentRate.lt(triggerRatio)) {\r\n        return triggerRatioInverted ? [t`Price below Mark Price`] : [t`Price above Mark Price`];\r\n      }\r\n    }\r\n\r\n    if (\r\n      !isWrapOrUnwrap &&\r\n      toToken &&\r\n      toTokenAddress !== USDG_ADDRESS &&\r\n      toTokenInfo &&\r\n      toTokenInfo.availableAmount &&\r\n      toAmount.gt(toTokenInfo.availableAmount)\r\n    ) {\r\n      return [t`Insufficient liquidity`];\r\n    }\r\n    if (\r\n      !isWrapOrUnwrap &&\r\n      toAmount &&\r\n      toTokenInfo.bufferAmount &&\r\n      toTokenInfo.poolAmount &&\r\n      toTokenInfo.bufferAmount.gt(toTokenInfo.poolAmount.sub(toAmount))\r\n    ) {\r\n      return [t`Insufficient liquidity`];\r\n    }\r\n\r\n    if (\r\n      fromUsdMin &&\r\n      fromTokenInfo.maxUsdgAmount &&\r\n      fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n      fromTokenInfo.usdgAmount &&\r\n      fromTokenInfo.maxPrice\r\n    ) {\r\n      const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n      const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n      if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n        return [`${fromTokenInfo.symbol} pool exceeded`];\r\n      }\r\n    }\r\n\r\n    return [false];\r\n  };\r\n\r\n  const getLeverageError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return [t`Leverage disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (hasOutdatedUi) {\r\n      return [t`Page outdated, please refresh`];\r\n    }\r\n\r\n    if (!toAmount || toAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n\r\n    let toTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n    if (toTokenInfo && toTokenInfo.isStable) {\r\n      return [t`${swapOption === LONG ? \"Longing\" : \"Shorting\"} ${toTokenInfo.symbol} not supported`];\r\n    }\r\n\r\n    const fromTokenInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n    if (\r\n      !savedShouldDisableValidationForTesting &&\r\n      fromTokenInfo &&\r\n      fromTokenInfo.balance &&\r\n      fromAmount &&\r\n      fromAmount.gt(fromTokenInfo.balance)\r\n    ) {\r\n      return [t`Insufficient ${fromTokenInfo.symbol} balance`];\r\n    }\r\n\r\n    if (leverage && leverage.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n    if (!isMarketOrder && (!triggerPriceValue || triggerPriceUsd.eq(0))) {\r\n      return [t`Enter a price`];\r\n    }\r\n\r\n    if (!hasExistingPosition && fromUsdMin && fromUsdMin.lt(expandDecimals(10, USD_DECIMALS))) {\r\n      return [t`Min order: 10 USD`];\r\n    }\r\n\r\n    if (leverage && leverage.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return [t`Min leverage: 1.1x`];\r\n    }\r\n\r\n    if (leverage && leverage.gt(30.5 * BASIS_POINTS_DIVISOR)) {\r\n      return [t`Max leverage: 30.5x`];\r\n    }\r\n\r\n    if (!isMarketOrder && entryMarkPrice && triggerPriceUsd && !savedShouldDisableValidationForTesting) {\r\n      if (isLong && entryMarkPrice.lt(triggerPriceUsd)) {\r\n        return [t`Price above Mark Price`];\r\n      }\r\n      if (!isLong && entryMarkPrice.gt(triggerPriceUsd)) {\r\n        return [t`Price below Mark Price`];\r\n      }\r\n    }\r\n\r\n    if (isLong) {\r\n      let requiredAmount = toAmount;\r\n      if (fromTokenAddress !== toTokenAddress) {\r\n        const { amount: swapAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          toTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        requiredAmount = requiredAmount.add(swapAmount);\r\n\r\n        if (toToken && toTokenAddress !== USDG_ADDRESS) {\r\n          if (!toTokenInfo.availableAmount) {\r\n            return [t`Liquidity data not loaded`];\r\n          }\r\n          if (toTokenInfo.availableAmount && requiredAmount.gt(toTokenInfo.availableAmount)) {\r\n            return [t`Insufficient liquidity`];\r\n          }\r\n        }\r\n\r\n        if (\r\n          toTokenInfo.poolAmount &&\r\n          toTokenInfo.bufferAmount &&\r\n          toTokenInfo.bufferAmount.gt(toTokenInfo.poolAmount.sub(swapAmount))\r\n        ) {\r\n          return [t`Insufficient liquidity`, true, \"BUFFER\"];\r\n        }\r\n\r\n        if (\r\n          fromUsdMin &&\r\n          fromTokenInfo.maxUsdgAmount &&\r\n          fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n          fromTokenInfo.minPrice &&\r\n          fromTokenInfo.usdgAmount\r\n        ) {\r\n          const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n          const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n          if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n            return [t`${fromTokenInfo.symbol} pool exceeded, try different token`, true, \"MAX_USDG\"];\r\n          }\r\n        }\r\n      }\r\n\r\n      if (toTokenInfo && toTokenInfo.maxPrice) {\r\n        const sizeUsd = toAmount.mul(toTokenInfo.maxPrice).div(expandDecimals(1, toTokenInfo.decimals));\r\n        if (\r\n          toTokenInfo.maxGlobalLongSize &&\r\n          toTokenInfo.maxGlobalLongSize.gt(0) &&\r\n          toTokenInfo.maxAvailableLong &&\r\n          sizeUsd.gt(toTokenInfo.maxAvailableLong)\r\n        ) {\r\n          return [t`Max ${toTokenInfo.symbol} long exceeded`];\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isShort) {\r\n      let stableTokenAmount = bigNumberify(0);\r\n      if (fromTokenAddress !== shortCollateralAddress && fromAmount && fromAmount.gt(0)) {\r\n        const { amount: nextToAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          shortCollateralAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        stableTokenAmount = nextToAmount;\r\n        if (stableTokenAmount.gt(shortCollateralToken.availableAmount)) {\r\n          return [t`Insufficient liquidity, change \"Profits In\"`];\r\n        }\r\n\r\n        if (\r\n          shortCollateralToken.bufferAmount &&\r\n          shortCollateralToken.poolAmount &&\r\n          shortCollateralToken.bufferAmount.gt(shortCollateralToken.poolAmount.sub(stableTokenAmount))\r\n        ) {\r\n          // suggest swapping to collateralToken\r\n          return [t`Insufficient liquidity, change \"Profits In\"`, true, \"BUFFER\"];\r\n        }\r\n\r\n        if (\r\n          fromTokenInfo.maxUsdgAmount &&\r\n          fromTokenInfo.maxUsdgAmount.gt(0) &&\r\n          fromTokenInfo.minPrice &&\r\n          fromTokenInfo.usdgAmount\r\n        ) {\r\n          const usdgFromAmount = adjustForDecimals(fromUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n          const nextUsdgAmount = fromTokenInfo.usdgAmount.add(usdgFromAmount);\r\n          if (nextUsdgAmount.gt(fromTokenInfo.maxUsdgAmount)) {\r\n            return [t`${fromTokenInfo.symbol} pool exceeded, try different token`, true, \"MAX_USDG\"];\r\n          }\r\n        }\r\n      }\r\n      if (\r\n        !shortCollateralToken ||\r\n        !fromTokenInfo ||\r\n        !toTokenInfo ||\r\n        !toTokenInfo.maxPrice ||\r\n        !shortCollateralToken.availableAmount\r\n      ) {\r\n        return [t`Fetching token info...`];\r\n      }\r\n\r\n      const sizeUsd = toAmount.mul(toTokenInfo.maxPrice).div(expandDecimals(1, toTokenInfo.decimals));\r\n      const sizeTokens = sizeUsd\r\n        .mul(expandDecimals(1, shortCollateralToken.decimals))\r\n        .div(shortCollateralToken.minPrice);\r\n\r\n      if (!toTokenInfo.maxAvailableShort) {\r\n        return [t`Liquidity data not loaded`];\r\n      }\r\n\r\n      if (\r\n        toTokenInfo.maxGlobalShortSize &&\r\n        toTokenInfo.maxGlobalShortSize.gt(0) &&\r\n        toTokenInfo.maxAvailableShort &&\r\n        sizeUsd.gt(toTokenInfo.maxAvailableShort)\r\n      ) {\r\n        return [t`Max ${toTokenInfo.symbol} short exceeded`];\r\n      }\r\n\r\n      stableTokenAmount = stableTokenAmount.add(sizeTokens);\r\n      if (stableTokenAmount.gt(shortCollateralToken.availableAmount)) {\r\n        return [t`Insufficient liquidity, change \"Profits In\"`];\r\n      }\r\n    }\r\n\r\n    return [false];\r\n  };\r\n\r\n  const getToLabel = () => {\r\n    if (isSwap) {\r\n      return t`Receive`;\r\n    }\r\n    if (isLong) {\r\n      return t`Long`;\r\n    }\r\n    return t`Short`;\r\n  };\r\n\r\n  const getError = () => {\r\n    if (isSwap) {\r\n      return getSwapError();\r\n    }\r\n    return getLeverageError();\r\n  };\r\n\r\n  const renderOrdersToa = () => {\r\n    if (!ordersToaOpen) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <OrdersToa\r\n        setIsVisible={setOrdersToaOpen}\r\n        approveOrderBook={approveOrderBook}\r\n        isPluginApproving={isPluginApproving}\r\n      />\r\n    );\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return false;\r\n    }\r\n    if (isStopOrder) {\r\n      return true;\r\n    }\r\n    if (!active) {\r\n      return true;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return false;\r\n    }\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return false;\r\n    }\r\n    if ((needApproval && isWaitingForApproval) || isApproving) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n    if (isApproving) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (isStopOrder) {\r\n      return t`Open a position`;\r\n    }\r\n    if (!active) {\r\n      return t`Connect Wallet`;\r\n    }\r\n    if (!isSupportedChain(chainId)) {\r\n      return t`Incorrect Network`;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return error;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (needApproval && isWaitingForApproval) {\r\n      return t`Waiting for Approval`;\r\n    }\r\n    if (isApproving) {\r\n      return t`Approving ${fromToken.symbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${fromToken.symbol}`;\r\n    }\r\n\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (isPluginApproving) {\r\n      return t`Enabling Orders...`;\r\n    }\r\n    if (needOrderBookApproval) {\r\n      return t`Enable Orders`;\r\n    }\r\n\r\n    if (!isMarketOrder) return `Create ${orderOption.charAt(0) + orderOption.substring(1).toLowerCase()} Order`;\r\n\r\n    if (isSwap) {\r\n      if (toUsdMax && toUsdMax.lt(fromUsdMin.mul(95).div(100))) {\r\n        return t`High Slippage, Swap Anyway`;\r\n      }\r\n      return \"Swap\";\r\n    }\r\n\r\n    if (isLong) {\r\n      const indexTokenInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n      if (indexTokenInfo && indexTokenInfo.minPrice) {\r\n        const { amount: nextToAmount } = getNextToAmount(\r\n          chainId,\r\n          fromAmount,\r\n          fromTokenAddress,\r\n          indexTokenAddress,\r\n          infoTokens,\r\n          undefined,\r\n          undefined,\r\n          usdgSupply,\r\n          totalTokenWeights,\r\n          isSwap\r\n        );\r\n        const nextToAmountUsd = nextToAmount\r\n          .mul(indexTokenInfo.minPrice)\r\n          .div(expandDecimals(1, indexTokenInfo.decimals));\r\n        if (fromTokenAddress === USDG_ADDRESS && nextToAmountUsd.lt(fromUsdMin.mul(98).div(100))) {\r\n          return t`High USDG Slippage, Long Anyway`;\r\n        }\r\n      }\r\n      return t`Long ${toToken.symbol}`;\r\n    }\r\n\r\n    return t`Short ${toToken.symbol}`;\r\n  };\r\n\r\n  const onSelectFromToken = (token) => {\r\n    setFromTokenAddress(swapOption, token.address);\r\n    setIsWaitingForApproval(false);\r\n\r\n    if (isShort && token.isStable) {\r\n      setShortCollateralAddress(token.address);\r\n    }\r\n  };\r\n\r\n  const onSelectShortCollateralAddress = (token) => {\r\n    setShortCollateralAddress(token.address);\r\n  };\r\n\r\n  const onSelectToToken = (token) => {\r\n    setToTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  const onFromValueChange = (e) => {\r\n    setAnchorOnFromAmount(true);\r\n    setFromValue(e.target.value);\r\n  };\r\n\r\n  const onToValueChange = (e) => {\r\n    setAnchorOnFromAmount(false);\r\n    setToValue(e.target.value);\r\n  };\r\n\r\n  const switchTokens = () => {\r\n    if (fromAmount && toAmount) {\r\n      if (anchorOnFromAmount) {\r\n        setToValue(formatAmountFree(fromAmount, fromToken.decimals, 8));\r\n      } else {\r\n        setFromValue(formatAmountFree(toAmount, toToken.decimals, 8));\r\n      }\r\n      setAnchorOnFromAmount(!anchorOnFromAmount);\r\n    }\r\n    setIsWaitingForApproval(false);\r\n\r\n    const updatedTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n    updatedTokenSelection[swapOption] = {\r\n      from: toTokenAddress,\r\n      to: fromTokenAddress,\r\n    };\r\n    setTokenSelection(updatedTokenSelection);\r\n  };\r\n\r\n  const wrap = async () => {\r\n    setIsSubmitting(true);\r\n\r\n    const contract = new ethers.Contract(nativeTokenAddress, WETH.abi, library.getSigner());\r\n    callContract(chainId, contract, \"deposit\", {\r\n      value: fromAmount,\r\n      sentMsg: \"Swap submitted.\",\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      failMsg: \"Swap failed.\",\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const unwrap = async () => {\r\n    setIsSubmitting(true);\r\n\r\n    const contract = new ethers.Contract(nativeTokenAddress, WETH.abi, library.getSigner());\r\n    callContract(chainId, contract, \"withdraw\", [fromAmount], {\r\n      sentMsg: t`Swap submitted!`,\r\n      failMsg: t`Swap failed.`,\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const swap = async () => {\r\n    if (fromToken.isNative && toToken.isWrapped) {\r\n      wrap();\r\n      return;\r\n    }\r\n\r\n    if (fromTokenAddress.isWrapped && toToken.isNative) {\r\n      unwrap();\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n    let path = [fromTokenAddress, toTokenAddress];\r\n    if (anchorOnFromAmount) {\r\n      const { path: multiPath } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (multiPath) {\r\n        path = multiPath;\r\n      }\r\n    } else {\r\n      const { path: multiPath } = getNextFromAmount(\r\n        chainId,\r\n        toAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (multiPath) {\r\n        path = multiPath;\r\n      }\r\n    }\r\n\r\n    let method;\r\n    let contract;\r\n    let value;\r\n    let params;\r\n    let minOut;\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, fromTokenAddress), fromAmount)) {\r\n      setIsSubmitting(false);\r\n      setIsPendingConfirmation(true);\r\n      helperToast.error(\r\n        `Leave at least ${formatAmount(DUST_BNB, 18, 3)} ${getConstant(chainId, \"nativeTokenSymbol\")} for gas`\r\n      );\r\n      return;\r\n    }\r\n\r\n    if (!isMarketOrder) {\r\n      minOut = toAmount;\r\n      Api.createSwapOrder(chainId, library, path, fromAmount, minOut, triggerRatio, nativeTokenAddress, {\r\n        sentMsg: t`Swap Order submitted!`,\r\n        successMsg: t`Swap Order created!`,\r\n        failMsg: t`Swap Order creation failed.`,\r\n        pendingTxns,\r\n        setPendingTxns,\r\n      })\r\n        .then(() => {\r\n          setIsConfirming(false);\r\n        })\r\n        .finally(() => {\r\n          setIsSubmitting(false);\r\n          setIsPendingConfirmation(false);\r\n        });\r\n      return;\r\n    }\r\n\r\n    path = replaceNativeTokenAddress(path, nativeTokenAddress);\r\n    method = \"swap\";\r\n    value = bigNumberify(0);\r\n    if (toTokenAddress === AddressZero) {\r\n      method = \"swapTokensToETH\";\r\n    }\r\n\r\n    minOut = toAmount.mul(BASIS_POINTS_DIVISOR - allowedSlippage).div(BASIS_POINTS_DIVISOR);\r\n    params = [path, fromAmount, minOut, account];\r\n    if (fromTokenAddress === AddressZero) {\r\n      method = \"swapETHToTokens\";\r\n      value = fromAmount;\r\n      params = [path, minOut, account];\r\n    }\r\n    contract = new ethers.Contract(routerAddress, Router.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: `Swap ${!isMarketOrder ? \" order \" : \"\"} submitted!`,\r\n      successMsg: `Swapped ${formatAmount(fromAmount, fromToken.decimals, 4, true)} ${\r\n        fromToken.symbol\r\n      } for ${formatAmount(toAmount, toToken.decimals, 4, true)} ${toToken.symbol}!`,\r\n      failMsg: t`Swap failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async () => {\r\n        setIsConfirming(false);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  const createIncreaseOrder = () => {\r\n    let path = [fromTokenAddress];\r\n\r\n    if (path[0] === USDG_ADDRESS) {\r\n      if (isLong) {\r\n        const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n        path.push(stableToken.address);\r\n      } else {\r\n        path.push(shortCollateralAddress);\r\n      }\r\n    }\r\n\r\n    const minOut = 0;\r\n    const indexToken = getToken(chainId, indexTokenAddress);\r\n    const successMsg = t`\r\n      Created limit order for ${indexToken.symbol} ${isLong ? \"Long\" : \"Short\"}: ${formatAmount(\r\n      toUsdMax,\r\n      USD_DECIMALS,\r\n      2\r\n    )} USD!\r\n    `;\r\n    return Api.createIncreaseOrder(\r\n      chainId,\r\n      library,\r\n      nativeTokenAddress,\r\n      path,\r\n      fromAmount,\r\n      indexTokenAddress,\r\n      minOut,\r\n      toUsdMax,\r\n      collateralTokenAddress,\r\n      isLong,\r\n      triggerPriceUsd,\r\n      {\r\n        pendingTxns,\r\n        setPendingTxns,\r\n        sentMsg: t`Limit order submitted!`,\r\n        successMsg,\r\n        failMsg: t`Limit order creation failed.`,\r\n      }\r\n    )\r\n      .then(() => {\r\n        setIsConfirming(false);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  let referralCode = ethers.constants.HashZero;\r\n  if (!attachedOnChain && userReferralCode) {\r\n    referralCode = userReferralCode;\r\n  }\r\n\r\n  const increasePosition = async () => {\r\n    alert('increasePosition')\r\n    setIsSubmitting(true);\r\n    const tokenAddress0 = fromTokenAddress === AddressZero ? nativeTokenAddress : fromTokenAddress;\r\n    const indexTokenAddress = toTokenAddress === AddressZero ? nativeTokenAddress : toTokenAddress;\r\n    let path = [indexTokenAddress]; // assume long\r\n    if (toTokenAddress !== fromTokenAddress) {\r\n      path = [tokenAddress0, indexTokenAddress];\r\n    }\r\n\r\n    if (fromTokenAddress === AddressZero && toTokenAddress === nativeTokenAddress) {\r\n      path = [nativeTokenAddress];\r\n    }\r\n\r\n    if (fromTokenAddress === nativeTokenAddress && toTokenAddress === AddressZero) {\r\n      path = [nativeTokenAddress];\r\n    }\r\n\r\n    if (isShort) {\r\n      path = [shortCollateralAddress];\r\n      if (tokenAddress0 !== shortCollateralAddress) {\r\n        path = [tokenAddress0, shortCollateralAddress];\r\n      }\r\n    }\r\n\r\n    const refPrice = isLong ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n    const priceBasisPoints = isLong ? BASIS_POINTS_DIVISOR + allowedSlippage : BASIS_POINTS_DIVISOR - allowedSlippage;\r\n    const priceLimit = refPrice.mul(priceBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n\r\n    const boundedFromAmount = fromAmount ? fromAmount : bigNumberify(0);\r\n\r\n    if (fromAmount && fromAmount.gt(0) && fromTokenAddress === USDG_ADDRESS && isLong) {\r\n      const { amount: nextToAmount, path: multiPath } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        indexTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (nextToAmount.eq(0)) {\r\n        helperToast.error(t`Insufficient liquidity`);\r\n        return;\r\n      }\r\n      if (multiPath) {\r\n        path = replaceNativeTokenAddress(multiPath);\r\n      }\r\n    }\r\n\r\n    let params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      boundedFromAmount, // _amountIn\r\n      0, // _minOut\r\n      toUsdMax, // _sizeDelta\r\n      isLong, // _isLong\r\n      priceLimit, // _acceptablePrice\r\n      minExecutionFee, // _executionFee\r\n      referralCode, // _referralCode\r\n    ];\r\n\r\n    let method = \"createIncreasePosition\";\r\n    let value = minExecutionFee;\r\n    if (fromTokenAddress === AddressZero) {\r\n      method = \"createIncreasePositionETH\";\r\n      value = boundedFromAmount.add(minExecutionFee);\r\n      params = [\r\n        path, // _path\r\n        indexTokenAddress, // _indexToken\r\n        0, // _minOut\r\n        toUsdMax, // _sizeDelta\r\n        isLong, // _isLong\r\n        priceLimit, // _acceptablePrice\r\n        minExecutionFee, // _executionFee\r\n        referralCode, // _referralCode\r\n      ];\r\n    }\r\n\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, fromTokenAddress), fromAmount)) {\r\n      setIsSubmitting(false);\r\n      setIsPendingConfirmation(false);\r\n      helperToast.error(\r\n        t`Leave at least ${formatAmount(DUST_BNB, 18, 3)} ${getConstant(chainId, \"nativeTokenSymbol\")} for gas`\r\n      );\r\n      return;\r\n    }\r\n\r\n    const contractAddress = getContract(chainId, \"PositionRouter\");\r\n    const contract = new ethers.Contract(contractAddress, PositionRouter.abi, library.getSigner());\r\n    const indexToken = getTokenInfo(infoTokens, indexTokenAddress);\r\n    const tokenSymbol = indexToken.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexToken.symbol;\r\n    const successMsg = t`Requested increase of ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"} by ${formatAmount(\r\n      toUsdMax,\r\n      USD_DECIMALS,\r\n      2\r\n    )} USD.`;\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      setPendingTxns,\r\n      sentMsg: `${isLong ? \"Long\" : \"Short\"} submitted.`,\r\n      failMsg: `${isLong ? \"Long\" : \"Short\"} failed.`,\r\n      successMsg,\r\n      // for Arbitrum, sometimes the successMsg shows after the position has already been executed\r\n      // hide the success message for Arbitrum as a workaround\r\n      hideSuccessMsg: chainId === ARBITRUM,\r\n    })\r\n      .then(async () => {\r\n        setIsConfirming(false);\r\n\r\n        const key = getPositionKey(account, path[path.length - 1], indexTokenAddress, isLong);\r\n        let nextSize = toUsdMax;\r\n        if (hasExistingPosition) {\r\n          nextSize = existingPosition.size.add(toUsdMax);\r\n        }\r\n\r\n        pendingPositions[key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            size: nextSize,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n        setIsPendingConfirmation(false);\r\n      });\r\n  };\r\n\r\n  const onSwapOptionChange = (opt) => {\r\n    setSwapOption(opt);\r\n    if (orderOption === STOP) {\r\n      setOrderOption(MARKET);\r\n    }\r\n    setAnchorOnFromAmount(true);\r\n    setFromValue(\"\");\r\n    setToValue(\"\");\r\n    setTriggerPriceValue(\"\");\r\n    setTriggerRatioValue(\"\");\r\n\r\n    if (opt === SHORT && infoTokens) {\r\n      const fromToken = getToken(chainId, tokenSelection[opt].from);\r\n      if (fromToken && fromToken.isStable) {\r\n        setShortCollateralAddress(fromToken.address);\r\n      } else {\r\n        const stableToken = getMostAbundantStableToken(chainId, infoTokens);\r\n        setShortCollateralAddress(stableToken.address);\r\n      }\r\n    }\r\n  };\r\n\r\n  const onConfirmationClick = () => {\r\n    if (!active) {\r\n      props.connectWallet();\r\n      return;\r\n    }\r\n\r\n    if (needOrderBookApproval) {\r\n      alert('onConfirmationClick: needOrderBookApproval')\r\n      approveOrderBook();\r\n      return;\r\n    }\r\n\r\n    setIsPendingConfirmation(true);\r\n\r\n    if (isSwap) {\r\n      alert('onConfirmationClick: isSwap')\r\n      swap();\r\n      return;\r\n    }\r\n\r\n    if (orderOption === LIMIT) {\r\n      alert('onConfirmationClick: createIncreaseOrder()')\r\n      createIncreaseOrder();\r\n      return;\r\n    }\r\n\r\n    increasePosition();\r\n  };\r\n\r\n  function approveFromToken() {\r\n    approveTokens({\r\n      setIsApproving,\r\n      library,\r\n      tokenAddress: fromToken.address,\r\n      spender: routerAddress,\r\n      chainId: chainId,\r\n      onApproveSubmitted: () => {\r\n        setIsWaitingForApproval(true);\r\n      },\r\n      infoTokens,\r\n      getTokenInfo,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n    });\r\n  }\r\n\r\n  const onClickPrimary = () => {\r\n    if (isStopOrder) {\r\n      alert('onClickPrimary: stopOrder')\r\n      setOrderOption(MARKET);\r\n      return;\r\n    }\r\n\r\n    if (!active) {\r\n      props.connectWallet();\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      alert('onClickPrimary: needPositionRouterApproval')\r\n      approvePositionRouter({\r\n        sentMsg: t`Enable leverage sent.`,\r\n        failMsg: t`Enable leverage failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (needApproval) {\r\n      alert('onClickPrimary: needApproval')\r\n      approveFromToken();\r\n      return;\r\n    }\r\n\r\n    if (needOrderBookApproval) {\r\n      alert('onClickPrimary: needOrderBookApproval')\r\n      setOrdersToaOpen(true);\r\n      return;\r\n    }\r\n\r\n    const [, modal, errorCode] = getError();\r\n\r\n    if (modal) {\r\n      alert('onClickPrimary: modal')\r\n      setModalError(errorCode);\r\n      return;\r\n    }\r\n\r\n    if (isSwap) {\r\n      alert('onClickPrimary: swap')\r\n      if (fromTokenAddress === AddressZero && toTokenAddress === nativeTokenAddress) {\r\n        wrap();\r\n        return;\r\n      }\r\n\r\n      if (fromTokenAddress === nativeTokenAddress && toTokenAddress === AddressZero) {\r\n        unwrap();\r\n        return;\r\n      }\r\n    }\r\n\r\n    setIsConfirming(true);\r\n    setIsHigherSlippageAllowed(false);\r\n  };\r\n\r\n  const isStopOrder = orderOption === STOP;\r\n  const showFromAndToSection = !isStopOrder;\r\n  const showTriggerPriceSection = !isSwap && !isMarketOrder && !isStopOrder;\r\n  const showTriggerRatioSection = isSwap && !isMarketOrder && !isStopOrder;\r\n\r\n  let fees;\r\n  let feesUsd;\r\n  let feeBps;\r\n  let swapFees;\r\n  let positionFee;\r\n  if (isSwap) {\r\n    if (fromAmount) {\r\n      const { feeBasisPoints } = getNextToAmount(\r\n        chainId,\r\n        fromAmount,\r\n        fromTokenAddress,\r\n        toTokenAddress,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        isSwap\r\n      );\r\n      if (feeBasisPoints !== undefined) {\r\n        fees = fromAmount.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n        const feeTokenPrice =\r\n          fromTokenInfo.address === USDG_ADDRESS ? expandDecimals(1, USD_DECIMALS) : fromTokenInfo.maxPrice;\r\n        feesUsd = fees.mul(feeTokenPrice).div(expandDecimals(1, fromTokenInfo.decimals));\r\n      }\r\n      feeBps = feeBasisPoints;\r\n    }\r\n  } else if (toUsdMax) {\r\n    positionFee = toUsdMax.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    feesUsd = positionFee;\r\n\r\n    const { feeBasisPoints } = getNextToAmount(\r\n      chainId,\r\n      fromAmount,\r\n      fromTokenAddress,\r\n      collateralTokenAddress,\r\n      infoTokens,\r\n      undefined,\r\n      undefined,\r\n      usdgSupply,\r\n      totalTokenWeights,\r\n      isSwap\r\n    );\r\n    if (feeBasisPoints) {\r\n      swapFees = fromUsdMin.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n      feesUsd = feesUsd.add(swapFees);\r\n    }\r\n    feeBps = feeBasisPoints;\r\n  }\r\n\r\n  const leverageMarks = {\r\n    2: \"2x\",\r\n    5: \"5x\",\r\n    10: \"10x\",\r\n    15: \"15x\",\r\n    20: \"20x\",\r\n    25: \"25x\",\r\n    30: \"30x\",\r\n  };\r\n\r\n  if (!fromToken || !toToken) {\r\n    return null;\r\n  }\r\n\r\n  let hasZeroBorrowFee = false;\r\n  let borrowFeeText;\r\n  if (isLong && toTokenInfo && toTokenInfo.fundingRate) {\r\n    borrowFeeText = formatAmount(toTokenInfo.fundingRate, 4, 4) + \"% / 1h\";\r\n    if (toTokenInfo.fundingRate.eq(0)) {\r\n      // hasZeroBorrowFee = true\r\n    }\r\n  }\r\n  if (isShort && shortCollateralToken && shortCollateralToken.fundingRate) {\r\n    borrowFeeText = formatAmount(shortCollateralToken.fundingRate, 4, 4) + \"% / 1h\";\r\n    if (shortCollateralToken.fundingRate.eq(0)) {\r\n      // hasZeroBorrowFee = true\r\n    }\r\n  }\r\n\r\n  function setFromValueToMaximumAvailable() {\r\n    if (!fromToken || !fromBalance) {\r\n      return;\r\n    }\r\n\r\n    const maxAvailableAmount = fromToken.isNative ? fromBalance.sub(bigNumberify(DUST_BNB).mul(2)) : fromBalance;\r\n    setFromValue(formatAmountFree(maxAvailableAmount, fromToken.decimals, fromToken.decimals));\r\n    setAnchorOnFromAmount(true);\r\n  }\r\n\r\n  function shouldShowMaxButton() {\r\n    if (!fromToken || !fromBalance) {\r\n      return false;\r\n    }\r\n    const maxAvailableAmount = fromToken.isNative ? fromBalance.sub(bigNumberify(DUST_BNB).mul(2)) : fromBalance;\r\n    return fromValue !== formatAmountFree(maxAvailableAmount, fromToken.decimals, fromToken.decimals);\r\n  }\r\n\r\n  return (\r\n    <div className=\"Exchange-swap-box\">\r\n      {/* <div className=\"Exchange-swap-wallet-box App-box\">\r\n        {active && <div className=\"Exchange-swap-account\" >\r\n        </div>}\r\n      </div> */}\r\n      <div className=\"Exchange-swap-box-inner App-box-highlight\">\r\n        <div>\r\n          <Tab\r\n            icons={SWAP_ICONS}\r\n            options={SWAP_OPTIONS}\r\n            option={swapOption}\r\n            onChange={onSwapOptionChange}\r\n            className=\"Exchange-swap-option-tabs\"\r\n          />\r\n          {flagOrdersEnabled && (\r\n            <Tab\r\n              options={orderOptions}\r\n              optionLabels={orderOptionLabels}\r\n              className=\"Exchange-swap-order-type-tabs\"\r\n              type=\"inline\"\r\n              option={orderOption}\r\n              onChange={onOrderOptionChange}\r\n            />\r\n          )}\r\n        </div>\r\n        {showFromAndToSection && (\r\n          <React.Fragment>\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  {fromUsdMin && (\r\n                    <div className=\"Exchange-swap-usd\">Pay: {formatAmount(fromUsdMin, USD_DECIMALS, 2, true)} USD</div>\r\n                  )}\r\n                  {!fromUsdMin && \"Pay\"}\r\n                </div>\r\n                {fromBalance && (\r\n                  <div className=\"muted align-right clickable\" onClick={setFromValueToMaximumAvailable}>\r\n                    Balance: {formatAmount(fromBalance, fromToken.decimals, 4, true)}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div className=\"Exchange-swap-input-container\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={fromValue}\r\n                    onChange={onFromValueChange}\r\n                  />\r\n                  {shouldShowMaxButton() && (\r\n                    <div className=\"Exchange-swap-max\" onClick={setFromValueToMaximumAvailable}>\r\n                      Max\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div>\r\n                  <TokenSelector\r\n                    label=\"Pay\"\r\n                    chainId={chainId}\r\n                    tokenAddress={fromTokenAddress}\r\n                    onSelectToken={onSelectFromToken}\r\n                    tokens={fromTokens}\r\n                    infoTokens={infoTokens}\r\n                    showMintingCap={false}\r\n                    showTokenImgInDropdown={true}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {/* <div className=\"Exchange-swap-ball-container\">\r\n              <div className=\"Exchange-swap-ball\" onClick={switchTokens}>\r\n                <IoMdSwap className=\"Exchange-swap-ball-icon\" />\r\n              </div>\r\n            </div> */}\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  {toUsdMax && (\r\n                    <div className=\"Exchange-swap-usd\">\r\n                      {getToLabel()}: {formatAmount(toUsdMax, USD_DECIMALS, 2, true)} USD\r\n                    </div>\r\n                  )}\r\n                  {!toUsdMax && getToLabel()}\r\n                </div>\r\n                {toBalance && isSwap && (\r\n                  <div className=\"muted align-right\">\r\n                    <Trans>Balance</Trans>: {formatAmount(toBalance, toToken.decimals, 4, true)}\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div>\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={toValue}\r\n                    onChange={onToValueChange}\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <TokenSelector\r\n                    label={getTokenLabel()}\r\n                    chainId={chainId}\r\n                    tokenAddress={toTokenAddress}\r\n                    onSelectToken={onSelectToToken}\r\n                    tokens={toTokens}\r\n                    infoTokens={infoTokens}\r\n                    showTokenImgInDropdown={true}\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </React.Fragment>\r\n        )}\r\n        {showTriggerRatioSection && (\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              {fromTokenInfo && toTokenInfo && (\r\n                <div\r\n                  className=\"muted align-right clickable\"\r\n                  onClick={() => {\r\n                    setTriggerRatioValue(\r\n                      formatAmountFree(\r\n                        getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted),\r\n                        USD_DECIMALS,\r\n                        10\r\n                      )\r\n                    );\r\n                  }}\r\n                >\r\n                  {formatAmount(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 4)}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input small\"\r\n                  value={triggerRatioValue}\r\n                  onChange={onTriggerRatioChange}\r\n                />\r\n              </div>\r\n              {(() => {\r\n                if (!toTokenInfo) return;\r\n                if (!fromTokenInfo) return;\r\n                const [tokenA, tokenB] = triggerRatioInverted\r\n                  ? [toTokenInfo, fromTokenInfo]\r\n                  : [fromTokenInfo, toTokenInfo];\r\n                return (\r\n                  <div className=\"PositionEditor-token-symbol\">\r\n                    {tokenA.symbol}&nbsp;per&nbsp;{tokenB.symbol}\r\n                  </div>\r\n                );\r\n              })()}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {showTriggerPriceSection && (\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div\r\n                className=\"muted align-right clickable\"\r\n                onClick={() => {\r\n                  setTriggerPriceValue(formatAmountFree(entryMarkPrice, USD_DECIMALS, 2));\r\n                }}\r\n              >\r\n                Mark: {formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={triggerPriceValue}\r\n                  onChange={onTriggerPriceChange}\r\n                />\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">USD</div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {isSwap && (\r\n          <div className=\"Exchange-swap-box-info\">\r\n            <ExchangeInfoRow label=\"Fees\">\r\n              <div>\r\n                {!fees && \"-\"}\r\n                {fees && (\r\n                  <div>\r\n                    {formatAmount(feeBps, 2, 2, false)}%&nbsp; ({formatAmount(fees, fromToken.decimals, 4, true)}{\" \"}\r\n                    {fromToken.symbol}: ${formatAmount(feesUsd, USD_DECIMALS, 2, true)})\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </ExchangeInfoRow>\r\n          </div>\r\n        )}\r\n        {(isLong || isShort) && !isStopOrder && (\r\n          <div className=\"Exchange-leverage-box\">\r\n            <div className=\"Exchange-leverage-slider-settings\">\r\n              {/* <Checkbox isChecked={isLeverageSliderEnabled} setIsChecked={setIsLeverageSliderEnabled}>\r\n                <span className=\"muted\">Leverage slider</span>\r\n              </Checkbox> */}\r\n              <div>Leverage</div>\r\n              {(isLong || isShort) && hasLeverageOption && (\r\n                <div className=\"Exchange-leverage-value\">\r\n                  {parseFloat(leverageOption).toFixed(2)}x\r\n                </div>\r\n              )}\r\n            </div>\r\n            {isLeverageSliderEnabled && (\r\n              <div\r\n                className={cx(\"Exchange-leverage-slider\", \"App-slider\", {\r\n                  positive: isLong,\r\n                  negative: isShort,\r\n                })}\r\n              >\r\n                <Slider\r\n                  min={1.2}\r\n                  max={30.5}\r\n                  step={0.1}\r\n                  marks={leverageMarks}\r\n                  handle={leverageSliderHandle}\r\n                  onChange={(value) => setLeverageOption(value)}\r\n                  value={leverageOption}\r\n                  defaultValue={leverageOption}\r\n                />\r\n              </div>\r\n            )}\r\n            {isShort && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Collateral In</Trans>\r\n                </div>\r\n\r\n                <div className=\"align-right\">\r\n                  <TokenSelector\r\n                    label=\"Collateral In\"\r\n                    chainId={chainId}\r\n                    tokenAddress={shortCollateralAddress}\r\n                    onSelectToken={onSelectShortCollateralAddress}\r\n                    tokens={stableTokens}\r\n                    showTokenImgInDropdown={true}\r\n                    disabled={true}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n            {isLong && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Collateral In</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  <Tooltip\r\n                    position=\"right-bottom\"\r\n                    handle=\"USD\"\r\n                    renderContent={() => (\r\n                      <span className=\"SwapBox-collateral-tooltip-text\">\r\n                        <Trans>\r\n                          A snapshot of the USD value of your {existingPosition?.collateralToken?.symbol} collateral is\r\n                          taken when the position is opened.\r\n                        </Trans>\r\n                        <br />\r\n                        <br />\r\n                        <Trans>\r\n                          When closing the position, you can select which token you would like to receive the profits\r\n                          in.\r\n                        </Trans>\r\n                      </span>\r\n                    )}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Entry Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                  <div className=\"inline-block muted\">\r\n                    ${formatAmount(existingPosition.averagePrice, USD_DECIMALS, 2, true)}\r\n                    <BsArrowRight className=\"transition-arrow\" />\r\n                  </div>\r\n                )}\r\n                {nextAveragePrice && `$${formatAmount(nextAveragePrice, USD_DECIMALS, 2, true)}`}\r\n                {!nextAveragePrice && `-`}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Liq. Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {hasExistingPosition && toAmount && toAmount.gt(0) && (\r\n                  <div className=\"inline-block muted\">\r\n                    ${formatAmount(existingLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                    <BsArrowRight className=\"transition-arrow\" />\r\n                  </div>\r\n                )}\r\n                {toAmount &&\r\n                  displayLiquidationPrice &&\r\n                  `$${formatAmount(displayLiquidationPrice, USD_DECIMALS, 2, true)}`}\r\n                {!toAmount && displayLiquidationPrice && `-`}\r\n                {!displayLiquidationPrice && `-`}\r\n              </div>\r\n            </div>\r\n            <ExchangeInfoRow label=\"Fees\">\r\n              <div>\r\n                {!feesUsd && \"-\"}\r\n                {feesUsd && (\r\n                  <Tooltip\r\n                    handle={`$${formatAmount(feesUsd, USD_DECIMALS, 2, true)}`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          {swapFees && (\r\n                            <div>\r\n                              {collateralToken.symbol} is required for collateral. <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Swap ${fromToken.symbol} to ${collateralToken.symbol} Fee`}\r\n                                value={formatAmount(swapFees, USD_DECIMALS, 2, true)}\r\n                              />\r\n                              <br />\r\n                            </div>\r\n                          )}\r\n                          <div>\r\n                            <StatsTooltipRow\r\n                              label={`Position Fee (0.1% of position size)`}\r\n                              value={formatAmount(positionFee, USD_DECIMALS, 2, true)}\r\n                            />\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                )}\r\n              </div>\r\n            </ExchangeInfoRow>\r\n          </div>\r\n        )}\r\n        {isStopOrder && (\r\n          <div className=\"Exchange-swap-section Exchange-trigger-order-info\">\r\n            Take-profit and stop-loss orders can be set after opening a position. <br />\r\n            <br />\r\n            There will be a \"Close\" button on each position row, clicking this will display the option to set trigger\r\n            orders. <br />\r\n            <br />\r\n            For screenshots and more information, please see the{\" \"}\r\n            <a\r\n              href=\"https://gmxio.gitbook.io/gmx/trading#stop-loss-take-profit-orders\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              docs\r\n            </a>\r\n            .\r\n          </div>\r\n        )}\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {isSwap && (\r\n        <div className=\"Exchange-swap-market-box App-box App-box-border\">\r\n          <div className=\"Exchange-swap-market-box-title\">\r\n            <Trans>Swap</Trans>\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">{fromToken.symbol} Price</div>\r\n            <div className=\"align-right\">\r\n              ${fromTokenInfo && formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">{toToken.symbol} Price</div>\r\n            <div className=\"align-right\">\r\n              ${toTokenInfo && formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Available Liquidity</Trans>\r\n            </div>\r\n\r\n            <div className=\"align-right al-swap\">\r\n              <Tooltip\r\n                handle={`$${formatAmount(maxSwapAmountUsd, USD_DECIMALS, 2, true)}`}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      <StatsTooltipRow\r\n                        label={`Max ${fromTokenInfo.symbol} in`}\r\n                        value={[\r\n                          `${formatAmount(maxFromTokenIn, fromTokenInfo.decimals, 0, true)} ${fromTokenInfo.symbol}`,\r\n                          `($${formatAmount(maxFromTokenInUSD, USD_DECIMALS, 0, true)})`,\r\n                        ]}\r\n                      />\r\n                      <StatsTooltipRow\r\n                        label={`Max ${toTokenInfo.symbol} out`}\r\n                        value={[\r\n                          `${formatAmount(maxToTokenOut, toTokenInfo.decimals, 0, true)} ${toTokenInfo.symbol}`,\r\n                          `($${formatAmount(maxToTokenOutUSD, USD_DECIMALS, 0, true)})`,\r\n                        ]}\r\n                      />\r\n                    </div>\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          {!isMarketOrder && (\r\n            <ExchangeInfoRow label=\"Price\">\r\n              {getExchangeRateDisplay(getExchangeRate(fromTokenInfo, toTokenInfo), fromToken, toToken)}\r\n            </ExchangeInfoRow>\r\n          )}\r\n        </div>\r\n      )}\r\n      {/* (isLong || isShort) && (\r\n        <div className=\"Exchange-swap-market-box App-box App-box-border\">\r\n          <div className=\"Exchange-swap-market-box-title\">\r\n            {isLong ? \"Long\" : \"Short\"}&nbsp;{toToken.symbol}\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Entry Price</Trans>\r\n            </div>\r\n            <div className=\"align-right\">\r\n              <Tooltip\r\n                handle={`$${formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)}`}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      The position will be opened at {formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)} USD with a\r\n                      max slippage of {parseFloat(savedSlippageAmount / 100.0).toFixed(2)}%.\r\n                      <br />\r\n                      <br />\r\n                      The slippage amount can be configured under Settings, found by clicking on your address at the top\r\n                      right of the page after connecting your wallet.\r\n                      <br />\r\n                      <br />\r\n                      <a\r\n                        href=\"https://gmxio.gitbook.io/gmx/trading#opening-a-position\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        More Info\r\n                      </a>\r\n                    </div>\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Exit Price</Trans>\r\n            </div>\r\n            <div className=\"align-right\">\r\n              <Tooltip\r\n                handle={`$${formatAmount(exitMarkPrice, USD_DECIMALS, 2, true)}`}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      If you have an existing position, the position will be closed at{\" \"}\r\n                      {formatAmount(entryMarkPrice, USD_DECIMALS, 2, true)} USD.\r\n                      <br />\r\n                      <br />\r\n                      This exit price will change with the price of the asset.\r\n                      <br />\r\n                      <br />\r\n                      <a\r\n                        href=\"https://gmxio.gitbook.io/gmx/trading#opening-a-position\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        More Info\r\n                      </a>\r\n                    </div>\r\n                  );\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">\r\n              <Trans>Borrow Fee</Trans>\r\n            </div>\r\n            <div className=\"align-right\">\r\n              <Tooltip\r\n                handle={borrowFeeText}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  return (\r\n                    <div>\r\n                      {hasZeroBorrowFee && (\r\n                        <div>\r\n                          {isLong && \"There are more shorts than longs, borrow fees for longing is currently zero\"}\r\n                          {isShort && \"There are more longs than shorts, borrow fees for shorting is currently zero\"}\r\n                        </div>\r\n                      )}\r\n                      {!hasZeroBorrowFee && (\r\n                        <div>\r\n                          The borrow fee is calculated as (assets borrowed) / (total assets in pool) * 0.01% per hour.\r\n                          <br />\r\n                          <br />\r\n                          {isShort && `You can change the \"Collateral In\" token above to find lower fees`}\r\n                        </div>\r\n                      )}\r\n                      <br />\r\n                      <a\r\n                        href=\"https://gmxio.gitbook.io/gmx/trading#opening-a-position\"\r\n                        target=\"_blank\"\r\n                        rel=\"noopener noreferrer\"\r\n                      >\r\n                        More Info\r\n                      </a>\r\n                    </div>\r\n                  );\r\n                }}\r\n              >\r\n                {!hasZeroBorrowFee && null}\r\n              </Tooltip>\r\n            </div>\r\n          </div>\r\n          {renderAvailableLongLiquidity()}\r\n          {isShort && toTokenInfo.hasMaxAvailableShort && (\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Available Liquidity</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  handle={`$${formatAmount(toTokenInfo.maxAvailableShort, USD_DECIMALS, 2, true)}`}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label={`Max ${toTokenInfo.symbol} short capacity`}\r\n                          value={formatAmount(toTokenInfo.maxGlobalShortSize, USD_DECIMALS, 0, true)}\r\n                        />\r\n                        <StatsTooltipRow\r\n                          label={`Current ${toTokenInfo.symbol} shorts`}\r\n                          value={formatAmount(toTokenInfo.globalShortSize, USD_DECIMALS, 0, true)}\r\n                        />\r\n                      </>\r\n                    );\r\n                  }}\r\n                ></Tooltip>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      ) */}\r\n      <NoLiquidityErrorModal\r\n        chainId={chainId}\r\n        fromToken={fromToken}\r\n        toToken={toToken}\r\n        shortCollateralToken={shortCollateralToken}\r\n        isLong={isLong}\r\n        isShort={isShort}\r\n        modalError={modalError}\r\n        setModalError={setModalError}\r\n      />\r\n      {renderOrdersToa()}\r\n      {isConfirming && (\r\n        <ConfirmationBox\r\n          library={library}\r\n          isHigherSlippageAllowed={isHigherSlippageAllowed}\r\n          setIsHigherSlippageAllowed={setIsHigherSlippageAllowed}\r\n          orders={orders}\r\n          isSwap={isSwap}\r\n          isLong={isLong}\r\n          isMarketOrder={isMarketOrder}\r\n          orderOption={orderOption}\r\n          isShort={isShort}\r\n          fromToken={fromToken}\r\n          fromTokenInfo={fromTokenInfo}\r\n          toToken={toToken}\r\n          toTokenInfo={toTokenInfo}\r\n          toAmount={toAmount}\r\n          fromAmount={fromAmount}\r\n          feeBps={feeBps}\r\n          onConfirmationClick={onConfirmationClick}\r\n          setIsConfirming={setIsConfirming}\r\n          hasExistingPosition={hasExistingPosition}\r\n          shortCollateralAddress={shortCollateralAddress}\r\n          shortCollateralToken={shortCollateralToken}\r\n          leverage={leverage}\r\n          existingPosition={existingPosition}\r\n          existingLiquidationPrice={existingLiquidationPrice}\r\n          displayLiquidationPrice={displayLiquidationPrice}\r\n          nextAveragePrice={nextAveragePrice}\r\n          triggerPriceUsd={triggerPriceUsd}\r\n          triggerRatio={triggerRatio}\r\n          fees={fees}\r\n          feesUsd={feesUsd}\r\n          isSubmitting={isSubmitting}\r\n          isPendingConfirmation={isPendingConfirmation}\r\n          fromUsdMin={fromUsdMin}\r\n          toUsdMax={toUsdMax}\r\n          collateralTokenAddress={collateralTokenAddress}\r\n          infoTokens={infoTokens}\r\n          chainId={chainId}\r\n          setPendingTxns={setPendingTxns}\r\n          pendingTxns={pendingTxns}\r\n          minExecutionFee={minExecutionFee}\r\n          minExecutionFeeUSD={minExecutionFeeUSD}\r\n          minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { Menu } from \"@headlessui/react\";\r\nimport { FaChevronDown } from \"react-icons/fa\";\r\nimport cx from \"classnames\";\r\nimport \"./ChartTokenSelector.css\";\r\nimport { getTokens, getWhitelistedTokens } from \"../../config/Tokens\";\r\nimport { LONG, SHORT, SWAP } from \"../../lib/legacy\";\r\n\r\nexport default function ChartTokenSelector(props) {\r\n  const { chainId, selectedToken, onSelectToken, swapOption } = props;\r\n\r\n  const isLong = swapOption === LONG;\r\n  const isShort = swapOption === SHORT;\r\n  const isSwap = swapOption === SWAP;\r\n\r\n  let options = getTokens(chainId);\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const indexTokens = whitelistedTokens.filter((token) => !token.isStable && !token.isWrapped);\r\n  const shortableTokens = indexTokens.filter((token) => token.isShortable);\r\n\r\n  if (isLong) {\r\n    options = indexTokens;\r\n  }\r\n  if (isShort) {\r\n    options = shortableTokens;\r\n  }\r\n\r\n  const onSelect = async (token) => {\r\n    onSelectToken(token);\r\n  };\r\n\r\n  var value = selectedToken;\r\n\r\n  return (\r\n    <Menu>\r\n      <Menu.Button as=\"div\" disabled={isSwap}>\r\n        <button className={cx(\"App-cta small transparent chart-token-selector\", { \"default-cursor\": isSwap })}>\r\n          <span className=\"chart-token-selector--current\">{value.symbol}/USD</span>\r\n          {!isSwap && (\r\n            <svg className=\"chevron-down\" xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"11\" viewBox=\"0 0 18 11\" fill=\"none\">\r\n              <path d=\"M1 1.5L9 9.5L17 1.5\" stroke=\"white\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n            </svg>\r\n          )}\r\n        </button>\r\n      </Menu.Button>\r\n      <div className=\"chart-token-menu\">\r\n        <Menu.Items as=\"div\" className=\"menu-items chart-token-menu-items\">\r\n          {options.map((option, index) => (\r\n            <Menu.Item key={index}>\r\n              <div\r\n                className=\"menu-item\"\r\n                onClick={() => {\r\n                  onSelect(option);\r\n                }}\r\n              >\r\n                <span style={{ marginLeft: 5 }} className=\"token-label\">\r\n                  {option.symbol} / USD\r\n                </span>\r\n              </div>\r\n            </Menu.Item>\r\n          ))}\r\n        </Menu.Items>\r\n      </div>\r\n    </Menu>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useRef, useCallback, useMemo } from \"react\";\r\nimport cx from \"classnames\";\r\n\r\nimport { createChart } from \"krasulya-lightweight-charts\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  SWAP,\r\n  INCREASE,\r\n  CHART_PERIODS,\r\n  getTokenInfo,\r\n  formatAmount,\r\n  formatDateTime,\r\n  usePrevious,\r\n  getLiquidationPrice,\r\n  useLocalStorageSerializeKey,\r\n  numberWithCommas,\r\n} from \"../../lib/legacy\";\r\nimport { useChartPrices } from \"../../domain/legacy\";\r\nimport Tab from \"../Tab/Tab\";\r\n\r\nimport { getTokens, getToken } from \"../../config/Tokens\";\r\nimport ChartTokenSelector from \"./ChartTokenSelector\";\r\n\r\nconst PRICE_LINE_TEXT_WIDTH = 15;\r\n\r\nconst timezoneOffset = -new Date().getTimezoneOffset() * 60;\r\n\r\nexport function getChartToken(swapOption, fromToken, toToken, chainId) {\r\n  if (!fromToken || !toToken) {\r\n    return;\r\n  }\r\n\r\n  if (swapOption !== SWAP) {\r\n    return toToken;\r\n  }\r\n\r\n  if (fromToken.isUsdg && toToken.isUsdg) {\r\n    return getTokens(chainId).find((t) => t.isStable);\r\n  }\r\n  if (fromToken.isUsdg) {\r\n    return toToken;\r\n  }\r\n  if (toToken.isUsdg) {\r\n    return fromToken;\r\n  }\r\n\r\n  if (fromToken.isStable && toToken.isStable) {\r\n    return toToken;\r\n  }\r\n  if (fromToken.isStable) {\r\n    return toToken;\r\n  }\r\n  if (toToken.isStable) {\r\n    return fromToken;\r\n  }\r\n\r\n  return toToken;\r\n}\r\n\r\nconst DEFAULT_PERIOD = \"4h\";\r\n\r\nconst getSeriesOptions = () => ({\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/area-series.md\r\n  lineColor: \"#5472cc\",\r\n  topColor: \"rgba(49, 69, 131, 0.4)\",\r\n  bottomColor: \"rgba(42, 64, 103, 0.0)\",\r\n  lineWidth: 2,\r\n  priceLineColor: \"#384263\",\r\n  downColor: \"#892C1F\",\r\n  wickDownColor: \"#892C1F\",\r\n  upColor: \"#019645\",\r\n  wickUpColor: \"#019645\",\r\n  borderVisible: false,\r\n});\r\n\r\nconst getChartOptions = (width, height) => ({\r\n  width,\r\n  height,\r\n  layout: {\r\n    backgroundColor: \"rgba(255, 255, 255, 0)\",\r\n    textColor: \"#747FA6\",\r\n    fontFamily: \"Gantari\",\r\n  },\r\n  localization: {\r\n    // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#time-format\r\n    timeFormatter: (businessDayOrTimestamp) => {\r\n      return formatDateTime(businessDayOrTimestamp - timezoneOffset);\r\n    },\r\n  },\r\n  grid: {\r\n    vertLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n    horzLines: {\r\n      visible: true,\r\n      color: \"rgba(35, 38, 59, 1)\",\r\n      style: 2,\r\n    },\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/time-scale.md#time-scale\r\n  timeScale: {\r\n    rightOffset: 5,\r\n    borderVisible: false,\r\n    barSpacing: 5,\r\n    timeVisible: true,\r\n    fixLeftEdge: true,\r\n  },\r\n  // https://github.com/tradingview/lightweight-charts/blob/master/docs/customization.md#price-axis\r\n  priceScale: {\r\n    borderVisible: false,\r\n  },\r\n  crosshair: {\r\n    horzLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    vertLine: {\r\n      color: \"#aaa\",\r\n    },\r\n    mode: 0,\r\n  },\r\n});\r\n\r\nexport default function ExchangeTVChart(props) {\r\n  const {\r\n    swapOption,\r\n    fromTokenAddress,\r\n    toTokenAddress,\r\n    infoTokens,\r\n    chainId,\r\n    positions,\r\n    savedShouldShowPositionLines,\r\n    orders,\r\n    setToTokenAddress,\r\n  } = props;\r\n  const [currentChart, setCurrentChart] = useState();\r\n  const [currentSeries, setCurrentSeries] = useState();\r\n\r\n  let [period, setPeriod] = useLocalStorageSerializeKey([chainId, \"Chart-period\"], DEFAULT_PERIOD);\r\n  if (!(period in CHART_PERIODS)) {\r\n    period = DEFAULT_PERIOD;\r\n  }\r\n\r\n  const [hoveredCandlestick, setHoveredCandlestick] = useState();\r\n\r\n  const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  const [chartToken, setChartToken] = useState({\r\n    maxPrice: null,\r\n    minPrice: null,\r\n  });\r\n  useEffect(() => {\r\n    const tmp = getChartToken(swapOption, fromToken, toToken, chainId);\r\n    setChartToken(tmp);\r\n  }, [swapOption, fromToken, toToken, chainId]);\r\n\r\n  const symbol = chartToken ? (chartToken.isWrapped ? chartToken.baseSymbol : chartToken.symbol) : undefined;\r\n  const marketName = chartToken ? symbol + \"_USD\" : undefined;\r\n  const previousMarketName = usePrevious(marketName);\r\n\r\n  const currentOrders = useMemo(() => {\r\n    if (swapOption === SWAP || !chartToken) {\r\n      return [];\r\n    }\r\n\r\n    return orders.filter((order) => {\r\n      if (order.type === SWAP) {\r\n        // we can't show non-stable to non-stable swap orders with existing charts\r\n        // so to avoid users confusion we'll show only long/short orders\r\n        return false;\r\n      }\r\n\r\n      const indexToken = getToken(chainId, order.indexToken);\r\n      return order.indexToken === chartToken.address || (chartToken.isNative && indexToken.isWrapped);\r\n    });\r\n  }, [orders, chartToken, swapOption, chainId]);\r\n\r\n  const ref = useRef(null);\r\n  const chartRef = useRef(null);\r\n\r\n  const currentAveragePrice =\r\n    chartToken.maxPrice && chartToken.minPrice ? chartToken.maxPrice.add(chartToken.minPrice).div(2) : null;\r\n  const [priceData, updatePriceData] = useChartPrices(\r\n    chainId,\r\n    chartToken.symbol,\r\n    chartToken.isStable,\r\n    period,\r\n    currentAveragePrice\r\n  );\r\n\r\n  const [chartInited, setChartInited] = useState(false);\r\n  useEffect(() => {\r\n    if (marketName !== previousMarketName) {\r\n      setChartInited(false);\r\n    }\r\n  }, [marketName, previousMarketName]);\r\n\r\n  const scaleChart = useCallback(() => {\r\n    const from = Date.now() / 1000 - (7 * 24 * CHART_PERIODS[period]) / 2 + timezoneOffset;\r\n    const to = Date.now() / 1000 + timezoneOffset;\r\n    currentChart.timeScale().setVisibleRange({ from, to });\r\n  }, [currentChart, period]);\r\n\r\n  const onCrosshairMove = useCallback(\r\n    (evt) => {\r\n      if (!evt.time) {\r\n        setHoveredCandlestick(null);\r\n        return;\r\n      }\r\n\r\n      for (const point of evt.seriesPrices.values()) {\r\n        setHoveredCandlestick((hoveredCandlestick) => {\r\n          if (hoveredCandlestick && hoveredCandlestick.time === evt.time) {\r\n            // rerender optimisations\r\n            return hoveredCandlestick;\r\n          }\r\n          return {\r\n            time: evt.time,\r\n            ...point,\r\n          };\r\n        });\r\n        break;\r\n      }\r\n    },\r\n    [setHoveredCandlestick]\r\n  );\r\n\r\n  useEffect(() => {\r\n    if (!ref.current || !priceData || !priceData.length || currentChart) {\r\n      return;\r\n    }\r\n\r\n    const chart = createChart(\r\n      chartRef.current,\r\n      getChartOptions(chartRef.current.offsetWidth, chartRef.current.offsetHeight)\r\n    );\r\n\r\n    chart.subscribeCrosshairMove(onCrosshairMove);\r\n\r\n    const series = chart.addCandlestickSeries(getSeriesOptions());\r\n\r\n    setCurrentChart(chart);\r\n    setCurrentSeries(series);\r\n  }, [ref, priceData, currentChart, onCrosshairMove]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      updatePriceData(undefined, true);\r\n    }, 60 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [updatePriceData]);\r\n\r\n  useEffect(() => {\r\n    if (!currentChart) {\r\n      return;\r\n    }\r\n    const resizeChart = () => {\r\n      currentChart.resize(chartRef.current.offsetWidth, chartRef.current.offsetHeight);\r\n    };\r\n    window.addEventListener(\"resize\", resizeChart);\r\n    return () => window.removeEventListener(\"resize\", resizeChart);\r\n  }, [currentChart]);\r\n\r\n  useEffect(() => {\r\n    if (currentSeries && priceData && priceData.length) {\r\n      currentSeries.setData(priceData);\r\n\r\n      if (!chartInited) {\r\n        scaleChart();\r\n        setChartInited(true);\r\n      }\r\n    }\r\n  }, [priceData, currentSeries, chartInited, scaleChart]);\r\n\r\n  useEffect(() => {\r\n    const lines = [];\r\n    if (currentSeries && savedShouldShowPositionLines) {\r\n      if (currentOrders && currentOrders.length > 0) {\r\n        currentOrders.forEach((order) => {\r\n          const indexToken = getToken(chainId, order.indexToken);\r\n          let tokenSymbol;\r\n          if (indexToken && indexToken.symbol) {\r\n            tokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n          }\r\n          const title = `${order.type === INCREASE ? \"Inc.\" : \"Dec.\"} ${tokenSymbol} ${\r\n            order.isLong ? \"Long\" : \"Short\"\r\n          }`;\r\n          const color = \"#3a3e5e\";\r\n          lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(order.triggerPrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: title.padEnd(PRICE_LINE_TEXT_WIDTH, \" \"),\r\n            })\r\n          );\r\n        });\r\n      }\r\n      if (positions && positions.length > 0) {\r\n        const color = \"#3a3e5e\";\r\n\r\n        positions.forEach((position) => {\r\n          lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(position.averagePrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: `Open ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}`.padEnd(\r\n                PRICE_LINE_TEXT_WIDTH,\r\n                \" \"\r\n              ),\r\n            })\r\n          );\r\n\r\n          const liquidationPrice = getLiquidationPrice(position);\r\n          lines.push(\r\n            currentSeries.createPriceLine({\r\n              price: parseFloat(formatAmount(liquidationPrice, USD_DECIMALS, 2)),\r\n              color,\r\n              title: `Liq. ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}`.padEnd(\r\n                PRICE_LINE_TEXT_WIDTH,\r\n                \" \"\r\n              ),\r\n            })\r\n          );\r\n        });\r\n      }\r\n    }\r\n    return () => {\r\n      lines.forEach((line) => currentSeries.removePriceLine(line));\r\n    };\r\n  }, [currentOrders, positions, currentSeries, chainId, savedShouldShowPositionLines]);\r\n\r\n  const candleStatsHtml = useMemo(() => {\r\n    if (!priceData) {\r\n      return null;\r\n    }\r\n    const candlestick = hoveredCandlestick || priceData[priceData.length - 1];\r\n    if (!candlestick) {\r\n      return null;\r\n    }\r\n\r\n    const className = cx({\r\n      \"ExchangeChart-bottom-stats\": true,\r\n      positive: candlestick.open <= candlestick.close,\r\n      negative: candlestick.open > candlestick.close,\r\n      [`length-${String(parseInt(candlestick.close)).length}`]: true,\r\n    });\r\n\r\n    const toFixedNumbers = 2;\r\n\r\n    return (\r\n      <div className={className}>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">O</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.open.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">H</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.high.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">L</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.low.toFixed(toFixedNumbers)}</span>\r\n        <span className=\"ExchangeChart-bottom-stats-label\">C</span>\r\n        <span className=\"ExchangeChart-bottom-stats-value\">{candlestick.close.toFixed(toFixedNumbers)}</span>\r\n      </div>\r\n    );\r\n  }, [hoveredCandlestick, priceData]);\r\n\r\n  let high;\r\n  let low;\r\n  let deltaPrice;\r\n  let delta;\r\n  let deltaPercentage;\r\n  let deltaPercentageStr;\r\n\r\n  const now = parseInt(Date.now() / 1000);\r\n  const timeThreshold = now - 24 * 60 * 60;\r\n\r\n  if (priceData) {\r\n    for (let i = priceData.length - 1; i > 0; i--) {\r\n      const price = priceData[i];\r\n      if (price.time < timeThreshold) {\r\n        break;\r\n      }\r\n      if (!low) {\r\n        low = price.low;\r\n      }\r\n      if (!high) {\r\n        high = price.high;\r\n      }\r\n\r\n      if (price.high > high) {\r\n        high = price.high;\r\n      }\r\n      if (price.low < low) {\r\n        low = price.low;\r\n      }\r\n\r\n      deltaPrice = price.open;\r\n    }\r\n  }\r\n\r\n  if (deltaPrice && currentAveragePrice) {\r\n    const average = parseFloat(formatAmount(currentAveragePrice, USD_DECIMALS, 2));\r\n    delta = average - deltaPrice;\r\n    deltaPercentage = (delta * 100) / average;\r\n    if (deltaPercentage > 0) {\r\n      deltaPercentageStr = `+${deltaPercentage.toFixed(2)}%`;\r\n    } else {\r\n      deltaPercentageStr = `${deltaPercentage.toFixed(2)}%`;\r\n    }\r\n    if (deltaPercentage === 0) {\r\n      deltaPercentageStr = \"0.00\";\r\n    }\r\n  }\r\n\r\n  if (!chartToken) {\r\n    return null;\r\n  }\r\n\r\n  const onSelectToken = (token) => {\r\n    const tmp = getTokenInfo(infoTokens, token.address);\r\n    setChartToken(tmp);\r\n    setToTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"ExchangeChart tv\" ref={ref}>\r\n      <div className=\"ExchangeChart-top App-box App-box-border\">\r\n        <div className=\"ExchangeChart-top-inner\">\r\n          <div>\r\n            <div className=\"ExchangeChart-title\">\r\n              <ChartTokenSelector\r\n                chainId={chainId}\r\n                selectedToken={chartToken}\r\n                swapOption={swapOption}\r\n                infoTokens={infoTokens}\r\n                onSelectToken={onSelectToken}\r\n                className=\"chart-token-selector\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ExchangeChart-info-label\">\r\n              Current Price\r\n            </div>\r\n            <div className=\"ExchangeChart-main-price\">\r\n              {chartToken.maxPrice && formatAmount(chartToken.maxPrice, USD_DECIMALS, 2, true)}\r\n            </div>\r\n          </div>\r\n          <div>\r\n            <div className=\"ExchangeChart-info-label\">24h Change</div>\r\n            <div className={cx({ positive: deltaPercentage > 0, negative: deltaPercentage < 0 })}>\r\n              {!deltaPercentageStr && \"-\"}\r\n              {deltaPercentageStr && deltaPercentageStr}\r\n            </div>\r\n          </div>\r\n          <div className=\"ExchangeChart-additional-info\">\r\n            <div className=\"ExchangeChart-info-label\">24h High</div>\r\n            <div>\r\n              {!high && \"-\"}\r\n              {high && numberWithCommas(high.toFixed(2))}\r\n            </div>\r\n          </div>\r\n          <div className=\"ExchangeChart-additional-info\">\r\n            <div className=\"ExchangeChart-info-label\">24h Low</div>\r\n            <div>\r\n              {!low && \"-\"}\r\n              {low && numberWithCommas(low.toFixed(2))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"ExchangeChart-bottom App-box App-box-border\">\r\n        <div className=\"ExchangeChart-bottom-header\">\r\n          <div className=\"ExchangeChart-bottom-controls\">\r\n            <Tab options={Object.keys(CHART_PERIODS)} option={period} setOption={setPeriod} />\r\n          </div>\r\n          {candleStatsHtml}\r\n        </div>\r\n        <div className=\"ExchangeChart-bottom-content\" ref={chartRef}></div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useCallback, useEffect, useMemo } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  formatAmount,\r\n  bigNumberify,\r\n  ARBITRUM,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  DEFAULT_HIGHER_SLIPPAGE_AMOUNT,\r\n  USD_DECIMALS,\r\n  DUST_USD,\r\n  BASIS_POINTS_DIVISOR,\r\n  USDG_ADDRESS,\r\n  SLIPPAGE_BPS_KEY,\r\n  TRIGGER_PREFIX_BELOW,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  MIN_PROFIT_TIME,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  getLeverage,\r\n  getMarginFee,\r\n  PRECISION,\r\n  MARKET,\r\n  STOP,\r\n  DECREASE,\r\n  useLocalStorageSerializeKey,\r\n  calculatePositionDelta,\r\n  getDeltaStr,\r\n  getProfitPrice,\r\n  formatDateTime,\r\n  getTimeRemaining,\r\n  getNextToAmount,\r\n  getUsd,\r\n  USDG_DECIMALS,\r\n  CLOSE_POSITION_RECEIVE_TOKEN_KEY,\r\n  useLocalStorageByChainId,\r\n  adjustForDecimals,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { createDecreaseOrder, useHasOutdatedUi } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport TokenSelector from \"./TokenSelector\";\r\nimport { getTokens } from \"../../config/Tokens\";\r\nimport \"./PositionSeller.css\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport marketImg from '../../img/ddl/icon_market.svg'\r\nimport marketActiveImg from '../../img/ddl/icon_market_active.svg'\r\nimport triggerImg from '../../img/ddl/icon_trigger.svg'\r\nimport triggerActiveImg from '../../img/ddl/icon_trigger_active.svg'\r\n\r\nconst CLOSE_ICONS = {\r\n  Market: marketImg,\r\n  Market_active: marketActiveImg,\r\n  Stop: triggerImg,\r\n  Stop_active: triggerActiveImg,\r\n}\r\n\r\nconst { AddressZero } = ethers.constants;\r\nconst ORDER_SIZE_DUST_USD = expandDecimals(1, USD_DECIMALS - 1); // $0.10\r\n\r\nconst orderOptionLabels = {\r\n  [MARKET]: \"Market\",\r\n  [STOP]: \"Trigger\",\r\n};\r\n\r\nfunction getTokenAmount(usdAmount, tokenAddress, max, infoTokens) {\r\n  if (!usdAmount) {\r\n    return;\r\n  }\r\n  if (tokenAddress === USDG_ADDRESS) {\r\n    return usdAmount.mul(expandDecimals(1, 18)).div(PRECISION);\r\n  }\r\n  const info = getTokenInfo(infoTokens, tokenAddress);\r\n  if (!info) {\r\n    return;\r\n  }\r\n  if (max && !info.maxPrice) {\r\n    return;\r\n  }\r\n  if (!max && !info.minPrice) {\r\n    return;\r\n  }\r\n\r\n  return usdAmount.mul(expandDecimals(1, info.decimals)).div(max ? info.minPrice : info.maxPrice);\r\n}\r\n\r\nfunction shouldSwap(collateralToken, receiveToken) {\r\n  // If position collateral is WETH in contract, then position.collateralToken is { symbol: “ETH”, isNative: true, … }\r\n  // @see https://github.com/gmx-io/gmx-interface/blob/master/src/pages/Exchange/Exchange.js#L162\r\n  // meaning if collateralToken.isNative === true in reality position has WETH as a collateral\r\n  // and if collateralToken.isNative === true and receiveToken.isNative === true then position’s WETH will be unwrapped and user will receive native ETH\r\n  const isCollateralWrapped = collateralToken.isNative;\r\n\r\n  const isSameToken =\r\n    collateralToken.address === receiveToken.address || (isCollateralWrapped && receiveToken.isWrapped);\r\n\r\n  const isUnwrap = isCollateralWrapped && receiveToken.isNative;\r\n\r\n  return !isSameToken && !isUnwrap;\r\n}\r\n\r\nfunction getSwapLimits(infoTokens, fromTokenAddress, toTokenAddress) {\r\n  const fromInfo = getTokenInfo(infoTokens, fromTokenAddress);\r\n  const toInfo = getTokenInfo(infoTokens, toTokenAddress);\r\n\r\n  let maxInUsd;\r\n  let maxIn;\r\n  let maxOut;\r\n  let maxOutUsd;\r\n\r\n  if (!fromInfo?.maxUsdgAmount) {\r\n    maxInUsd = bigNumberify(0);\r\n    maxIn = bigNumberify(0);\r\n  } else {\r\n    maxInUsd = fromInfo.maxUsdgAmount\r\n      .sub(fromInfo.usdgAmount)\r\n      .mul(expandDecimals(1, USD_DECIMALS))\r\n      .div(expandDecimals(1, USDG_DECIMALS));\r\n\r\n    maxIn = maxInUsd.mul(expandDecimals(1, fromInfo.decimals)).div(fromInfo.maxPrice).toString();\r\n  }\r\n\r\n  if (!toInfo?.poolAmount || !toInfo?.bufferAmount) {\r\n    maxOut = bigNumberify(0);\r\n    maxOutUsd = bigNumberify(0);\r\n  } else {\r\n    maxOut = toInfo.availableAmount.gt(toInfo.poolAmount.sub(toInfo.bufferAmount))\r\n      ? toInfo.poolAmount.sub(toInfo.bufferAmount)\r\n      : toInfo.availableAmount;\r\n\r\n    maxOutUsd = getUsd(maxOut, toInfo.address, false, infoTokens);\r\n  }\r\n\r\n  return {\r\n    maxIn,\r\n    maxInUsd,\r\n    maxOut,\r\n    maxOutUsd,\r\n  };\r\n}\r\n\r\nexport default function PositionSeller(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    account,\r\n    library,\r\n    infoTokens,\r\n    setPendingTxns,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    isWaitingForPluginApproval,\r\n    isPluginApproving,\r\n    orderBookApproved,\r\n    setOrdersToaOpen,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    isHigherSlippageAllowed,\r\n    setIsHigherSlippageAllowed,\r\n    minExecutionFee,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n  } = props;\r\n  const [savedSlippageAmount] = useLocalStorageSerializeKey([chainId, SLIPPAGE_BPS_KEY], DEFAULT_SLIPPAGE_AMOUNT);\r\n  const [keepLeverage, setKeepLeverage] = useLocalStorageSerializeKey([chainId, \"Exchange-keep-leverage\"], true);\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [isProfitWarningAccepted, setIsProfitWarningAccepted] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n  const toTokens = getTokens(chainId);\r\n\r\n  const [savedRecieveTokenAddress, setSavedRecieveTokenAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    `${CLOSE_POSITION_RECEIVE_TOKEN_KEY}-${position?.indexToken?.symbol}-${position.isLong ? \"long\" : \"short\"}`\r\n  );\r\n\r\n  const [swapToToken, setSwapToToken] = useState(() =>\r\n    savedRecieveTokenAddress ? toTokens.find((token) => token.address === savedRecieveTokenAddress) : undefined\r\n  );\r\n\r\n  let allowedSlippage = savedSlippageAmount;\r\n  if (isHigherSlippageAllowed) {\r\n    allowedSlippage = DEFAULT_HIGHER_SLIPPAGE_AMOUNT;\r\n  }\r\n\r\n  const orderOptions = [MARKET, STOP];\r\n  let [orderOption, setOrderOption] = useState(MARKET);\r\n\r\n  if (!flagOrdersEnabled) {\r\n    orderOption = MARKET;\r\n  }\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved && orderOption === MARKET;\r\n\r\n  const onOrderOptionChange = (option) => {\r\n    setOrderOption(option);\r\n  };\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(\"\");\r\n  const triggerPriceUsd = orderOption === MARKET ? 0 : parseValue(triggerPriceValue, USD_DECIMALS);\r\n\r\n  const [nextDelta, nextHasProfit = bigNumberify(0)] = useMemo(() => {\r\n    if (!position) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    if (orderOption !== STOP) {\r\n      return [position.delta, position.hasProfit, position.deltaPercentage];\r\n    }\r\n\r\n    if (!triggerPriceUsd) {\r\n      return [bigNumberify(0), false];\r\n    }\r\n\r\n    const { delta, hasProfit, deltaPercentage } = calculatePositionDelta(triggerPriceUsd, position);\r\n    return [delta, hasProfit, deltaPercentage];\r\n  }, [position, orderOption, triggerPriceUsd]);\r\n\r\n  const existingOrders = useMemo(() => {\r\n    if (orderOption === STOP && (!triggerPriceUsd || triggerPriceUsd.eq(0))) {\r\n      return [];\r\n    }\r\n    if (!orders || !position) {\r\n      return [];\r\n    }\r\n\r\n    const ret = [];\r\n    for (const order of orders) {\r\n      // only Stop orders can't be executed without corresponding opened position\r\n      if (order.type !== DECREASE) continue;\r\n\r\n      // if user creates Stop-Loss we need only Stop-Loss orders and vice versa\r\n      if (orderOption === STOP) {\r\n        const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n        if (triggerAboveThreshold !== order.triggerAboveThreshold) continue;\r\n      }\r\n\r\n      const sameToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      if (order.isLong === position.isLong && sameToken) {\r\n        ret.push(order);\r\n      }\r\n    }\r\n    return ret;\r\n  }, [position, orders, triggerPriceUsd, orderOption, nativeTokenAddress]);\r\n\r\n  const existingOrder = existingOrders[0];\r\n\r\n  const needOrderBookApproval = orderOption === STOP && !orderBookApproved;\r\n\r\n  const isSwapAllowed = orderOption === MARKET;\r\n\r\n  const { data: hasOutdatedUi } = useHasOutdatedUi();\r\n\r\n  let collateralToken;\r\n  let receiveToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let isClosing;\r\n  let sizeDelta;\r\n\r\n  let nextCollateral;\r\n  let collateralDelta = bigNumberify(0);\r\n  let receiveAmount = bigNumberify(0);\r\n  let convertedReceiveAmount = bigNumberify(0);\r\n  let adjustedDelta = bigNumberify(0);\r\n\r\n  let isNotEnoughReceiveTokenLiquidity;\r\n  let isCollateralPoolCapacityExceeded;\r\n\r\n  let title;\r\n  let fundingFee;\r\n  let positionFee;\r\n  let swapFeeToken;\r\n  let swapFee;\r\n  let totalFees = bigNumberify(0);\r\n\r\n  let executionFee = orderOption === STOP ? getConstant(chainId, \"DECREASE_ORDER_EXECUTION_GAS_FEE\") : minExecutionFee;\r\n\r\n  let executionFeeUsd = getUsd(executionFee, nativeTokenAddress, false, infoTokens) || bigNumberify(0);\r\n\r\n  if (position) {\r\n    fundingFee = position.fundingFee;\r\n    fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n    sizeDelta = fromAmount;\r\n\r\n    title = `Close ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (fromAmount) {\r\n      isClosing = position.size.sub(fromAmount).lt(DUST_USD);\r\n      positionFee = getMarginFee(fromAmount);\r\n    }\r\n\r\n    if (isClosing) {\r\n      sizeDelta = position.size;\r\n      receiveAmount = position.collateral;\r\n    } else if (orderOption === STOP && sizeDelta && existingOrders.length > 0) {\r\n      let residualSize = position.size;\r\n      for (const order of existingOrders) {\r\n        residualSize = residualSize.sub(order.sizeDelta);\r\n      }\r\n      if (residualSize.sub(sizeDelta).abs().lt(ORDER_SIZE_DUST_USD)) {\r\n        sizeDelta = residualSize;\r\n      }\r\n    }\r\n\r\n    if (sizeDelta) {\r\n      adjustedDelta = nextDelta.mul(sizeDelta).div(position.size);\r\n    }\r\n\r\n    if (nextHasProfit) {\r\n      receiveAmount = receiveAmount.add(adjustedDelta);\r\n    } else {\r\n      if (receiveAmount.gt(adjustedDelta)) {\r\n        receiveAmount = receiveAmount.sub(adjustedDelta);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    if (keepLeverage && sizeDelta && !isClosing) {\r\n      collateralDelta = sizeDelta.mul(position.collateral).div(position.size);\r\n      // if the position will be realising a loss then reduce collateralDelta by the realised loss\r\n      if (!nextHasProfit) {\r\n        const deductions = adjustedDelta.add(positionFee).add(fundingFee);\r\n        if (collateralDelta.gt(deductions)) {\r\n          collateralDelta = collateralDelta = collateralDelta.sub(deductions);\r\n        } else {\r\n          collateralDelta = bigNumberify(0);\r\n        }\r\n      }\r\n    }\r\n\r\n    maxAmount = position.size;\r\n    maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n    maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n\r\n    if (fromAmount && collateralToken.maxPrice) {\r\n      convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n      convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n    }\r\n\r\n    totalFees = totalFees.add(positionFee || bigNumberify(0)).add(fundingFee || bigNumberify(0));\r\n\r\n    receiveAmount = receiveAmount.add(collateralDelta);\r\n\r\n    if (sizeDelta) {\r\n      if (receiveAmount.gt(totalFees)) {\r\n        receiveAmount = receiveAmount.sub(totalFees);\r\n      } else {\r\n        receiveAmount = bigNumberify(0);\r\n      }\r\n    }\r\n\r\n    receiveToken = isSwapAllowed && swapToToken ? swapToToken : collateralToken;\r\n\r\n    // Calculate swap fees\r\n    if (isSwapAllowed && swapToToken) {\r\n      const { feeBasisPoints } = getNextToAmount(\r\n        chainId,\r\n        convertedAmount,\r\n        collateralToken.address,\r\n        receiveToken.address,\r\n        infoTokens,\r\n        undefined,\r\n        undefined,\r\n        usdgSupply,\r\n        totalTokenWeights,\r\n        true\r\n      );\r\n\r\n      if (feeBasisPoints) {\r\n        swapFee = receiveAmount.mul(feeBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n        swapFeeToken = getTokenAmount(swapFee, collateralToken.address, false, infoTokens);\r\n        totalFees = totalFees.add(swapFee || bigNumberify(0));\r\n        receiveAmount = receiveAmount.sub(swapFee);\r\n      }\r\n    }\r\n\r\n    convertedReceiveAmount = getTokenAmount(receiveAmount, receiveToken.address, false, infoTokens);\r\n\r\n    // Check swap limits (max in / max out)\r\n    if (isSwapAllowed && shouldSwap(collateralToken, receiveToken)) {\r\n      const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n      const receiveTokenInfo = getTokenInfo(infoTokens, receiveToken.address);\r\n\r\n      isNotEnoughReceiveTokenLiquidity =\r\n        receiveTokenInfo.availableAmount.lt(convertedReceiveAmount) ||\r\n        receiveTokenInfo.bufferAmount.gt(receiveTokenInfo.poolAmount.sub(convertedReceiveAmount));\r\n\r\n      if (\r\n        collateralInfo.maxUsdgAmount &&\r\n        collateralInfo.maxUsdgAmount.gt(0) &&\r\n        collateralInfo.usdgAmount &&\r\n        collateralInfo.maxPrice\r\n      ) {\r\n        const usdgFromAmount = adjustForDecimals(receiveAmount, USD_DECIMALS, USDG_DECIMALS);\r\n        const nextUsdgAmount = collateralInfo.usdgAmount.add(usdgFromAmount);\r\n\r\n        if (nextUsdgAmount.gt(collateralInfo.maxUsdgAmount)) {\r\n          isCollateralPoolCapacityExceeded = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (isClosing) {\r\n      nextCollateral = bigNumberify(0);\r\n    } else {\r\n      if (position.collateral) {\r\n        nextCollateral = position.collateral;\r\n        if (collateralDelta && collateralDelta.gt(0)) {\r\n          nextCollateral = position.collateral.sub(collateralDelta);\r\n        } else if (position.delta && position.delta.gt(0) && sizeDelta) {\r\n          if (!position.hasProfit) {\r\n            nextCollateral = nextCollateral.sub(adjustedDelta);\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    if (fromAmount) {\r\n      if (!isClosing && !keepLeverage) {\r\n        nextLeverage = getLeverage({\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          hasProfit: nextHasProfit,\r\n          delta: nextDelta,\r\n          includeDelta: savedIsPnlInLeverage,\r\n        });\r\n        nextLiquidationPrice = getLiquidationPrice({\r\n          isLong: position.isLong,\r\n          size: position.size,\r\n          sizeDelta,\r\n          collateral: position.collateral,\r\n          averagePrice: position.averagePrice,\r\n          entryFundingRate: position.entryFundingRate,\r\n          cumulativeFundingRate: position.cumulativeFundingRate,\r\n          delta: nextDelta,\r\n          hasProfit: nextHasProfit,\r\n          includeDelta: true,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  const [deltaStr, deltaPercentageStr] = useMemo(() => {\r\n    if (!position || !position.markPrice) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n    if (orderOption !== STOP) {\r\n      const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n        position.markPrice,\r\n        position,\r\n        fromAmount\r\n      );\r\n      const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n        delta: pendingDelta,\r\n        deltaPercentage: pendingDeltaPercentage,\r\n        hasProfit,\r\n      });\r\n      return [deltaStr, deltaPercentageStr];\r\n    }\r\n    if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n      return [\"-\", \"-\"];\r\n    }\r\n\r\n    const { pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(\r\n      triggerPriceUsd,\r\n      position,\r\n      fromAmount\r\n    );\r\n\r\n    const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n      delta: pendingDelta,\r\n      deltaPercentage: pendingDeltaPercentage,\r\n      hasProfit,\r\n    });\r\n    return [deltaStr, deltaPercentageStr];\r\n  }, [position, triggerPriceUsd, orderOption, fromAmount]);\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (orderOption === STOP) return [t`Trigger order disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Position close disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (hasOutdatedUi) {\r\n      return t`Page outdated, please refresh`;\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (orderOption === STOP) {\r\n      if (!triggerPriceUsd || triggerPriceUsd.eq(0)) {\r\n        return t`Enter Price`;\r\n      }\r\n      if (position.isLong && triggerPriceUsd.lte(liquidationPrice)) {\r\n        return t`Price below Liq. Price`;\r\n      }\r\n      if (!position.isLong && triggerPriceUsd.gte(liquidationPrice)) {\r\n        return t`Price above Liq. Price`;\r\n      }\r\n\r\n      if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n        return t`Invalid price, see warning`;\r\n      }\r\n    }\r\n\r\n    if (isNotEnoughReceiveTokenLiquidity) {\r\n      return \"Insufficient receive token liquidity\";\r\n    }\r\n\r\n    if (isCollateralPoolCapacityExceeded) {\r\n      return `${collateralToken.symbol} pool exceeded, can only Receive ${collateralToken.symbol}`;\r\n    }\r\n\r\n    if (!isClosing && position && position.size && fromAmount) {\r\n      if (position.size.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Leftover position below 10 USD`;\r\n      }\r\n      if (nextCollateral && nextCollateral.lt(expandDecimals(5, USD_DECIMALS))) {\r\n        return t`Leftover collateral below 5 USD`;\r\n      }\r\n    }\r\n\r\n    if (position && position.size && position.size.lt(fromAmount)) {\r\n      return t`Max close amount exceeded`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverage && nextLeverage.gt(30.5 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Max leverage: 30.5xt`;\r\n    }\r\n\r\n    if (hasPendingProfit && orderOption !== STOP && !isProfitWarningAccepted) {\r\n      return t`Forfeit profit not checked`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n      return false;\r\n    }\r\n    if (isPluginApproving) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const hasPendingProfit = MIN_PROFIT_TIME > 0 && position.delta.eq(0) && position.pendingDelta.gt(0);\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (orderOption === STOP) {\r\n      if (isSubmitting) return t`Creating Order...`;\r\n\r\n      if (needOrderBookApproval && isWaitingForPluginApproval) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (isPluginApproving) {\r\n        return t`Enabling Orders...`;\r\n      }\r\n      if (needOrderBookApproval) {\r\n        return t`Enable Orders`;\r\n      }\r\n\r\n      return t`Create Order`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (hasPendingProfit) {\r\n      return t`Close without profit`;\r\n    }\r\n    return isSubmitting ? t`Closing...` : t`Close`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n    setIsProfitWarningAccepted(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const onClickPrimary = async () => {\r\n    if (needOrderBookApproval) {\r\n      setOrdersToaOpen(true);\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: t`Enable leverage sent.`,\r\n        failMsg: t`Enable leverage failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    setIsSubmitting(true);\r\n\r\n    const collateralTokenAddress = position.collateralToken.isNative\r\n      ? nativeTokenAddress\r\n      : position.collateralToken.address;\r\n    const indexTokenAddress = position.indexToken.isNative ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    if (orderOption === STOP) {\r\n      const triggerAboveThreshold = triggerPriceUsd.gt(position.markPrice);\r\n\r\n      createDecreaseOrder(\r\n        chainId,\r\n        library,\r\n        indexTokenAddress,\r\n        sizeDelta,\r\n        collateralTokenAddress,\r\n        collateralDelta,\r\n        position.isLong,\r\n        triggerPriceUsd,\r\n        triggerAboveThreshold,\r\n        {\r\n          sentMsg: t`Order submitted!`,\r\n          successMsg: t`Order created!`,\r\n          failMsg: t`Order creation failed.`,\r\n          setPendingTxns,\r\n        }\r\n      )\r\n        .then(() => {\r\n          setFromValue(\"\");\r\n          setIsVisible(false);\r\n        })\r\n        .finally(() => {\r\n          setIsSubmitting(false);\r\n        });\r\n      return;\r\n    }\r\n\r\n    const priceBasisPoints = position.isLong\r\n      ? BASIS_POINTS_DIVISOR - allowedSlippage\r\n      : BASIS_POINTS_DIVISOR + allowedSlippage;\r\n    const refPrice = position.isLong ? position.indexToken.minPrice : position.indexToken.maxPrice;\r\n    let priceLimit = refPrice.mul(priceBasisPoints).div(BASIS_POINTS_DIVISOR);\r\n    const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n    const minProfitTimeExpired = parseInt(Date.now() / 1000) > minProfitExpiration;\r\n\r\n    if (nextHasProfit && !minProfitTimeExpired && !isProfitWarningAccepted) {\r\n      if ((position.isLong && priceLimit.lt(profitPrice)) || (!position.isLong && priceLimit.gt(profitPrice))) {\r\n        priceLimit = profitPrice;\r\n      }\r\n    }\r\n\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n\r\n    const path = [tokenAddress0];\r\n\r\n    const isUnwrap = receiveToken.address === AddressZero;\r\n    const isSwap = receiveToken.address !== tokenAddress0;\r\n\r\n    if (isSwap) {\r\n      if (isUnwrap && tokenAddress0 !== nativeTokenAddress) {\r\n        path.push(nativeTokenAddress);\r\n      } else if (!isUnwrap) {\r\n        path.push(receiveToken.address);\r\n      }\r\n    }\r\n\r\n    const withdrawETH = isUnwrap;\r\n\r\n    const params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      collateralDelta, // _collateralDelta\r\n      sizeDelta, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n    ];\r\n\r\n    const successMsg = t`Requested decrease of ${position.indexToken.symbol} ${\r\n      position.isLong ? \"Long\" : \"Short\"\r\n    } by ${formatAmount(sizeDelta, USD_DECIMALS, 2)} USD.`;\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n\r\n    callContract(chainId, contract, \"createDecreasePosition\", params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Close submitted!`,\r\n      successMsg,\r\n      failMsg: t`Close failed.`,\r\n      setPendingTxns,\r\n      // for Arbitrum, sometimes the successMsg shows after the position has already been executed\r\n      // hide the success message for Arbitrum as a workaround\r\n      hideSuccessMsg: chainId === ARBITRUM,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        let nextSize = position.size.sub(sizeDelta);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            size: nextSize,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const renderExistingOrderWarning = useCallback(() => {\r\n    if (!existingOrder) {\r\n      return;\r\n    }\r\n    const indexToken = getTokenInfo(infoTokens, existingOrder.indexToken);\r\n    const sizeInToken = formatAmount(\r\n      existingOrder.sizeDelta.mul(PRECISION).div(existingOrder.triggerPrice),\r\n      USD_DECIMALS,\r\n      4,\r\n      true\r\n    );\r\n    const prefix = existingOrder.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n    return (\r\n      <div className=\"Confirmation-box-warning\">\r\n        You have an active order to decrease {existingOrder.isLong ? \"Long\" : \"Short\"} {sizeInToken} {indexToken.symbol}{\" \"}\r\n        ($\r\n        {formatAmount(existingOrder.sizeDelta, USD_DECIMALS, 2, true)}) at {prefix}{\" \"}\r\n        {formatAmount(existingOrder.triggerPrice, USD_DECIMALS, 2, true)}\r\n      </div>\r\n    );\r\n  }, [existingOrder, infoTokens]);\r\n\r\n  function renderMinProfitWarning() {\r\n    if (MIN_PROFIT_TIME === 0) {\r\n      return null;\r\n    }\r\n\r\n    if (profitPrice && nextDelta.eq(0) && nextHasProfit) {\r\n      const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n\r\n      if (orderOption === MARKET) {\r\n        return (\r\n          <div className=\"Confirmation-box-warning\">\r\n            Reducing the position at the current price will forfeit a&nbsp;\r\n            <a\r\n              href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\"\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n            >\r\n              pending profit\r\n            </a>{\" \"}\r\n            of {deltaStr}. <br />\r\n            <br />\r\n            Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n            applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n          </div>\r\n        );\r\n      }\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          This order will forfeit a&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            profit\r\n          </a>{\" \"}\r\n          of {deltaStr}. <br />\r\n          Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n          applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}.\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  const profitPrice = getProfitPrice(orderOption === MARKET ? position.markPrice : triggerPriceUsd, position);\r\n\r\n  let triggerPricePrefix;\r\n  if (triggerPriceUsd) {\r\n    triggerPricePrefix = triggerPriceUsd.gt(position.markPrice) ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n  }\r\n\r\n  const shouldShowExistingOrderWarning = false;\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal\r\n          className=\"PositionSeller-modal\"\r\n          isVisible={isVisible}\r\n          setIsVisible={setIsVisible}\r\n          label={title}\r\n          allowContentTouchMove\r\n        >\r\n          {flagOrdersEnabled && (\r\n            <Tab\r\n              options={orderOptions}\r\n              option={orderOption}\r\n              optionLabels={orderOptionLabels}\r\n              onChange={onOrderOptionChange}\r\n              icons={CLOSE_ICONS}\r\n            />\r\n          )}\r\n          <div className=\"Exchange-swap-section\">\r\n            <div className=\"Exchange-swap-section-top\">\r\n              <div className=\"muted\">\r\n                {convertedAmountFormatted && (\r\n                  <div className=\"Exchange-swap-usd\">\r\n                    Close: {convertedAmountFormatted} {position.collateralToken.symbol}\r\n                  </div>\r\n                )}\r\n                {!convertedAmountFormatted && \"Close\"}\r\n              </div>\r\n              {maxAmount && (\r\n                <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                  Max: {maxAmountFormatted}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"Exchange-swap-section-bottom\">\r\n              <div className=\"Exchange-swap-input-container\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"0\"\r\n                  placeholder=\"0.0\"\r\n                  className=\"Exchange-swap-input\"\r\n                  value={fromValue}\r\n                  onChange={(e) => setFromValue(e.target.value)}\r\n                />\r\n                {fromValue !== maxAmountFormattedFree && (\r\n                  <div\r\n                    className=\"Exchange-swap-max\"\r\n                    onClick={() => {\r\n                      setFromValue(maxAmountFormattedFree);\r\n                    }}\r\n                  >\r\n                    MAX\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"PositionEditor-token-symbol\">USD</div>\r\n            </div>\r\n          </div>\r\n          {orderOption === STOP && (\r\n            <div className=\"Exchange-swap-section\">\r\n              <div className=\"Exchange-swap-section-top\">\r\n                <div className=\"muted\">\r\n                  <Trans>Price</Trans>\r\n                </div>\r\n                <div\r\n                  className=\"muted align-right clickable\"\r\n                  onClick={() => {\r\n                    setTriggerPriceValue(formatAmountFree(position.markPrice, USD_DECIMALS, 2));\r\n                  }}\r\n                >\r\n                  Mark: {formatAmount(position.markPrice, USD_DECIMALS, 2, true)}\r\n                </div>\r\n              </div>\r\n              <div className=\"Exchange-swap-section-bottom\">\r\n                <div className=\"Exchange-swap-input-container\">\r\n                  <input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    placeholder=\"0.0\"\r\n                    className=\"Exchange-swap-input\"\r\n                    value={triggerPriceValue}\r\n                    onChange={onTriggerPriceChange}\r\n                  />\r\n                </div>\r\n                <div className=\"PositionEditor-token-symbol\">USD</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {renderMinProfitWarning()}\r\n          {shouldShowExistingOrderWarning && renderExistingOrderWarning()}\r\n          <div className=\"PositionEditor-info-box\">\r\n            {minExecutionFeeErrorMessage && (\r\n              <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n            )}\r\n            {hasPendingProfit && orderOption !== STOP && (\r\n              <div className=\"PositionEditor-accept-profit-warning\">\r\n                <Checkbox isChecked={isProfitWarningAccepted} setIsChecked={setIsProfitWarningAccepted}>\r\n                  <span className=\"muted\">Forfeit profit</span>\r\n                </Checkbox>\r\n              </div>\r\n            )}\r\n            <div className=\"PositionEditor-keep-leverage-settings\">\r\n              <Checkbox isChecked={keepLeverage} setIsChecked={setKeepLeverage}>\r\n                <span className=\"muted font-sm\">Keep leverage at {formatAmount(position.leverage, 4, 2)}x</span>\r\n              </Checkbox>\r\n            </div>\r\n            {orderOption === MARKET && (\r\n              <div className=\"PositionEditor-allow-higher-slippage\">\r\n                <Checkbox isChecked={isHigherSlippageAllowed} setIsChecked={setIsHigherSlippageAllowed}>\r\n                  <span className=\"muted font-sm\">Allow up to 1% slippage</span>\r\n                </Checkbox>\r\n              </div>\r\n            )}\r\n            {orderOption === MARKET && (\r\n              <div>\r\n                <ExchangeInfoRow label=\"Allowed Slippage\">\r\n                  <Tooltip\r\n                    handle={`${formatAmount(allowedSlippage, 2, 2)}%`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          You can change this in the settings menu on the top right of the page.\r\n                          <br />\r\n                          <br />\r\n                          Note that a low allowed slippage, e.g. less than 0.5%, may result in failed orders if prices\r\n                          are volatile.\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </ExchangeInfoRow>\r\n              </div>\r\n            )}\r\n            {orderOption === STOP && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Trigger Price</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {!triggerPriceUsd && \"-\"}\r\n                  {triggerPriceUsd && `${triggerPricePrefix} ${formatAmount(triggerPriceUsd, USD_DECIMALS, 2, true)}`}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Entry Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}</div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Liq. Price</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {isClosing && orderOption !== STOP && \"-\"}\r\n                {(!isClosing || orderOption === STOP) && (\r\n                  <div>\r\n                    {(!nextLiquidationPrice || nextLiquidationPrice.eq(liquidationPrice)) && (\r\n                      <div>{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}</div>\r\n                    )}\r\n                    {nextLiquidationPrice && !nextLiquidationPrice.eq(liquidationPrice) && (\r\n                      <div>\r\n                        <div className=\"inline-block muted\">\r\n                          ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                          <BsArrowRight className=\"transition-arrow\" />\r\n                        </div>\r\n                        ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Size</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {position && position.size && fromAmount && (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.size, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(position.size.sub(fromAmount), USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                )}\r\n                {position && position.size && !fromAmount && (\r\n                  <div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n                )}\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Collateral ({collateralToken.symbol})</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {nextCollateral && !nextCollateral.eq(position.collateral) ? (\r\n                  <div>\r\n                    <div className=\"inline-block muted\">\r\n                      ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                      <BsArrowRight className=\"transition-arrow\" />\r\n                    </div>\r\n                    ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                  </div>\r\n                ) : (\r\n                  `$${formatAmount(position.collateral, USD_DECIMALS, 4, true)}`\r\n                )}\r\n              </div>\r\n            </div>\r\n            {!keepLeverage && (\r\n              <div className=\"Exchange-info-row\">\r\n                <div className=\"Exchange-info-label\">\r\n                  <Trans>Leverage</Trans>\r\n                </div>\r\n                <div className=\"align-right\">\r\n                  {isClosing && \"-\"}\r\n                  {!isClosing && (\r\n                    <div>\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>PnL</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                {deltaStr} ({deltaPercentageStr})\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Fees</Trans>\r\n              </div>\r\n              <div className=\"align-right\">\r\n                <Tooltip\r\n                  position=\"right-top\"\r\n                  className=\"PositionSeller-fees-tooltip\"\r\n                  handle={\r\n                    <div>\r\n                      {totalFees ? `$${formatAmount(totalFees.add(executionFeeUsd), USD_DECIMALS, 2, true)}` : \"-\"}\r\n                    </div>\r\n                  }\r\n                  renderContent={() => (\r\n                    <div>\r\n                      {fundingFee && (\r\n                        <StatsTooltipRow label=\"Borrow fee\" value={formatAmount(fundingFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {positionFee && (\r\n                        <StatsTooltipRow label=\"Closing fee\" value={formatAmount(positionFee, USD_DECIMALS, 2, true)} />\r\n                      )}\r\n\r\n                      {swapFee && (\r\n                        <StatsTooltipRow\r\n                          label=\"Swap fee\"\r\n                          showDollar={false}\r\n                          value={`${formatAmount(swapFeeToken, collateralToken.decimals, 5)} ${collateralToken.symbol}\r\n                           ($${formatAmount(swapFee, USD_DECIMALS, 2, true)})`}\r\n                        />\r\n                      )}\r\n\r\n                      <StatsTooltipRow\r\n                        label=\"Execution fee\"\r\n                        showDollar={false}\r\n                        value={`${formatAmount(executionFee, 18, 5, true)} ${nativeTokenSymbol} ($${formatAmount(\r\n                          executionFeeUsd,\r\n                          USD_DECIMALS,\r\n                          2\r\n                        )})`}\r\n                      />\r\n\r\n                      <br />\r\n\r\n                      <div className=\"PositionSeller-fee-item\">\r\n                        <a href=\"https://gmxio.gitbook.io/gmx/trading#fees\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                          More Info\r\n                        </a>{\" \"}\r\n                        about fees.\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"Exchange-info-row PositionSeller-receive-row top-line\">\r\n              <div className=\"Exchange-info-label\">\r\n                <Trans>Receive</Trans>\r\n              </div>\r\n\r\n              {!isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right PositionSelector-selected-receive-token\">\r\n                  {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;{receiveToken.symbol} ($\r\n                  {formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                </div>\r\n              )}\r\n\r\n              {isSwapAllowed && receiveToken && (\r\n                <div className=\"align-right\">\r\n                  <TokenSelector\r\n                    // Scroll lock lead to side effects\r\n                    // if it applied on modal inside another modal\r\n                    disableBodyScrollLock={true}\r\n                    className={cx(\"PositionSeller-token-selector\", {\r\n                      warning: isNotEnoughReceiveTokenLiquidity || isCollateralPoolCapacityExceeded,\r\n                    })}\r\n                    label={\"Receive\"}\r\n                    showBalances={false}\r\n                    chainId={chainId}\r\n                    tokenAddress={receiveToken.address}\r\n                    onSelectToken={(token) => {\r\n                      setSwapToToken(token);\r\n                      setSavedRecieveTokenAddress(token.address);\r\n                    }}\r\n                    tokens={toTokens}\r\n                    getTokenState={(tokenOptionInfo) => {\r\n                      if (!shouldSwap(collateralToken, tokenOptionInfo)) {\r\n                        return;\r\n                      }\r\n\r\n                      const convertedTokenAmount = getTokenAmount(\r\n                        receiveAmount,\r\n                        tokenOptionInfo.address,\r\n                        false,\r\n                        infoTokens\r\n                      );\r\n\r\n                      const isNotEnoughLiquidity =\r\n                        tokenOptionInfo.availableAmount.lt(convertedTokenAmount) ||\r\n                        tokenOptionInfo.bufferAmount.gt(tokenOptionInfo.poolAmount.sub(convertedTokenAmount));\r\n\r\n                      if (isNotEnoughLiquidity) {\r\n                        const { maxIn, maxOut, maxInUsd, maxOutUsd } = getSwapLimits(\r\n                          infoTokens,\r\n                          collateralToken.address,\r\n                          tokenOptionInfo.address\r\n                        );\r\n\r\n                        const collateralInfo = getTokenInfo(infoTokens, collateralToken.address);\r\n\r\n                        return {\r\n                          disabled: true,\r\n                          message: (\r\n                            <div>\r\n                              Insufficient Available Liquidity to swap to {tokenOptionInfo.symbol}:\r\n                              <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${collateralInfo.symbol} in`}\r\n                                value={[\r\n                                  `${formatAmount(maxIn, collateralInfo.decimals, 0, true)} ${collateralInfo.symbol}`,\r\n                                  `($${formatAmount(maxInUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={`Max ${tokenOptionInfo.symbol} out`}\r\n                                value={[\r\n                                  `${formatAmount(maxOut, tokenOptionInfo.decimals, 0, true)} ${\r\n                                    tokenOptionInfo.symbol\r\n                                  }`,\r\n                                  `($${formatAmount(maxOutUsd, USD_DECIMALS, 0, true)})`,\r\n                                ]}\r\n                              />\r\n                            </div>\r\n                          ),\r\n                        };\r\n                      }\r\n                    }}\r\n                    infoTokens={infoTokens}\r\n                    showTokenImgInDropdown={true}\r\n                    selectedTokenLabel={\r\n                      <span className=\"PositionSelector-selected-receive-token\">\r\n                        {formatAmount(convertedReceiveAmount, receiveToken.decimals, 4, true)}&nbsp;\r\n                        {receiveToken.symbol} (${formatAmount(receiveAmount, USD_DECIMALS, 2, true)})\r\n                      </span>\r\n                    }\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-button-container\">\r\n            <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n              {getPrimaryText()}\r\n            </button>\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport useSWR from \"swr\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { ethers } from \"ethers\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  BASIS_POINTS_DIVISOR,\r\n  DEPOSIT_FEE,\r\n  DUST_BNB,\r\n  helperToast,\r\n  formatAmount,\r\n  bigNumberify,\r\n  usePrevious,\r\n  formatAmountFree,\r\n  parseValue,\r\n  expandDecimals,\r\n  shouldRaiseGasError,\r\n  getTokenInfo,\r\n  getLiquidationPrice,\r\n  approveTokens,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n} from \"../../lib/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport Modal from \"../Modal/Modal\";\r\n\r\nimport PositionRouter from \"../../abis/PositionRouter.json\";\r\nimport Token from \"../../abis/Token.json\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\n\r\nimport { getConstant } from \"../../config/chains\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nimport depositImg from '../../img/ddl/icon_dollar.svg'\r\nimport depositActiveImg from '../../img/ddl/icon_dollar_active.svg'\r\nimport withdrawImg from '../../img/ddl/icon_withdraw.svg'\r\nimport withdrawActiveImg from '../../img/ddl/icon_withdraw_active.svg'\r\n\r\nconst DEPOSIT = t`Deposit`;\r\nconst WITHDRAW = t`Withdraw`;\r\nconst EDIT_OPTIONS = [DEPOSIT, WITHDRAW];\r\nconst EDIT_ICONS = {\r\n  [DEPOSIT]: depositImg,\r\n  [WITHDRAW]: withdrawImg,\r\n  [DEPOSIT + '_active']: depositActiveImg,\r\n  [WITHDRAW + '_active']: withdrawActiveImg,\r\n\r\n}\r\nconst { AddressZero } = ethers.constants;\r\n\r\nexport default function PositionEditor(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positionsMap,\r\n    positionKey,\r\n    isVisible,\r\n    setIsVisible,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    collateralTokenAddress,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    getUsd,\r\n    getLeverage,\r\n    savedIsPnlInLeverage,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    chainId,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n  } = props;\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const position = positionsMap && positionKey ? positionsMap[positionKey] : undefined;\r\n  const [option, setOption] = useState(DEPOSIT);\r\n  const [fromValue, setFromValue] = useState(\"\");\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isSwapping, setIsSwapping] = useState(false);\r\n  const prevIsVisible = usePrevious(isVisible);\r\n\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  const { data: tokenAllowance } = useSWR(\r\n    [active, chainId, collateralTokenAddress, \"allowance\", account, routerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  // const { data: minExecutionFee } = useSWR([active, chainId, positionRouterAddress, \"minExecutionFee\"], {\r\n  //   fetcher: fetcher(library, PositionRouter),\r\n  // });\r\n\r\n  const isDeposit = option === DEPOSIT;\r\n  const isWithdrawal = option === WITHDRAW;\r\n\r\n  const needPositionRouterApproval = !positionRouterApproved;\r\n\r\n  let collateralToken;\r\n  let maxAmount;\r\n  let maxAmountFormatted;\r\n  let maxAmountFormattedFree;\r\n  let fromAmount;\r\n  let needApproval;\r\n\r\n  let convertedAmount;\r\n  let convertedAmountFormatted;\r\n\r\n  let nextLeverage;\r\n  let nextLeverageExcludingPnl;\r\n  let liquidationPrice;\r\n  let nextLiquidationPrice;\r\n  let nextCollateral;\r\n\r\n  let title;\r\n  let collateralDelta;\r\n  if (position) {\r\n    title = `Edit ${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol}`;\r\n    collateralToken = position.collateralToken;\r\n    liquidationPrice = getLiquidationPrice(position);\r\n\r\n    if (isDeposit) {\r\n      fromAmount = parseValue(fromValue, collateralToken.decimals);\r\n      maxAmount = collateralToken ? collateralToken.balance : bigNumberify(0);\r\n      maxAmountFormatted = formatAmount(maxAmount, collateralToken.decimals, 4, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, collateralToken.decimals, 8);\r\n      if (fromAmount) {\r\n        convertedAmount = getUsd(fromAmount, position.collateralToken.address, false, infoTokens);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, USD_DECIMALS, 2);\r\n      }\r\n    } else {\r\n      fromAmount = parseValue(fromValue, USD_DECIMALS);\r\n      maxAmount = position.collateral;\r\n      maxAmountFormatted = formatAmount(maxAmount, USD_DECIMALS, 2, true);\r\n      maxAmountFormattedFree = formatAmountFree(maxAmount, USD_DECIMALS, 2);\r\n      if (fromAmount) {\r\n        convertedAmount = fromAmount.mul(expandDecimals(1, collateralToken.decimals)).div(collateralToken.maxPrice);\r\n        convertedAmountFormatted = formatAmount(convertedAmount, collateralToken.decimals, 4, true);\r\n      }\r\n    }\r\n    needApproval = isDeposit && tokenAllowance && fromAmount && fromAmount.gt(tokenAllowance);\r\n\r\n    if (fromAmount) {\r\n      collateralDelta = isDeposit ? convertedAmount : fromAmount;\r\n      if (position.isLong) {\r\n        collateralDelta = collateralDelta.mul(BASIS_POINTS_DIVISOR - DEPOSIT_FEE).div(BASIS_POINTS_DIVISOR);\r\n      }\r\n      nextLeverage = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: savedIsPnlInLeverage,\r\n      });\r\n      nextLeverageExcludingPnl = getLeverage({\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        hasProfit: position.hasProfit,\r\n        delta: position.delta,\r\n        includeDelta: false,\r\n      });\r\n\r\n      nextLiquidationPrice = getLiquidationPrice({\r\n        isLong: position.isLong,\r\n        size: position.size,\r\n        collateral: position.collateral,\r\n        averagePrice: position.averagePrice,\r\n        entryFundingRate: position.entryFundingRate,\r\n        cumulativeFundingRate: position.cumulativeFundingRate,\r\n        collateralDelta,\r\n        increaseCollateral: isDeposit,\r\n      });\r\n\r\n      nextCollateral = isDeposit ? position.collateral.add(collateralDelta) : position.collateral.sub(collateralDelta);\r\n    }\r\n  }\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (isDeposit) return [t`Deposit disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`Withdraw disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n    if (!fromAmount) {\r\n      return t`Enter an amount`;\r\n    }\r\n    if (nextLeverage && nextLeverage.eq(0)) {\r\n      return t`Enter an amount`;\r\n    }\r\n\r\n    if (!isDeposit && fromAmount) {\r\n      if (fromAmount.gte(position.collateral)) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n      if (position.collateral.sub(fromAmount).lt(expandDecimals(10, USD_DECIMALS))) {\r\n        return t`Min order: 10 USD`;\r\n      }\r\n    }\r\n\r\n    if (!isDeposit && fromAmount && nextLiquidationPrice) {\r\n      if (position.isLong && position.markPrice.lt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n      if (!position.isLong && position.markPrice.gt(nextLiquidationPrice)) {\r\n        return t`Invalid liq. price`;\r\n      }\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.lt(1.1 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Min leverage: 1.1x`;\r\n    }\r\n\r\n    if (nextLeverageExcludingPnl && nextLeverageExcludingPnl.gt(30.5 * BASIS_POINTS_DIVISOR)) {\r\n      return t`Max leverage: 30x`;\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n    if (isSwapping) {\r\n      return false;\r\n    }\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return false;\r\n    }\r\n    if (isPositionRouterApproving) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n    if (isSwapping) {\r\n      if (isDeposit) {\r\n        return t`Depositing...`;\r\n      }\r\n      return t`Withdrawing...`;\r\n    }\r\n\r\n    if (isApproving) {\r\n      return t`Approving ${position.collateralToken.symbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${position.collateralToken.symbol}`;\r\n    }\r\n\r\n    if (needPositionRouterApproval && isWaitingForPositionRouterApproval) {\r\n      return t`Enabling Leverage`;\r\n    }\r\n\r\n    if (isPositionRouterApproving) {\r\n      return t`Enabling Leverage...`;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      return t`Enable Leverage`;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      return t`Deposit`;\r\n    }\r\n\r\n    return t`Withdraw`;\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFromValue(\"\");\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (prevIsVisible !== isVisible) {\r\n      resetForm();\r\n    }\r\n  }, [prevIsVisible, isVisible]);\r\n\r\n  const depositCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const path = [tokenAddress0];\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n\r\n    const priceBasisPoints = position.isLong ? 11000 : 9000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const referralCode = ethers.constants.HashZero;\r\n    let params = [\r\n      path, // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _amountIn\r\n      0, // _minOut\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      priceLimit, // _acceptablePrice\r\n      minExecutionFee, // _executionFee\r\n      referralCode, // _referralCode\r\n    ];\r\n\r\n    let method = \"createIncreasePosition\";\r\n    let value = minExecutionFee;\r\n    if (collateralTokenAddress === AddressZero) {\r\n      method = \"createIncreasePositionETH\";\r\n      value = fromAmount.add(minExecutionFee);\r\n      params = [\r\n        path, // _path\r\n        indexTokenAddress, // _indexToken\r\n        0, // _minOut\r\n        0, // _sizeDelta\r\n        position.isLong, // _isLong\r\n        priceLimit, // _acceptablePrice\r\n        minExecutionFee, // _executionFee\r\n        referralCode, // _referralCode\r\n      ];\r\n    }\r\n\r\n    if (shouldRaiseGasError(getTokenInfo(infoTokens, collateralTokenAddress), fromAmount)) {\r\n      setIsSwapping(false);\r\n      helperToast.error(`Leave at least ${formatAmount(DUST_BNB, 18, 3)} ETH for gas`);\r\n      return;\r\n    }\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: t`Deposit submitted.`,\r\n      successMsg: t`Requested deposit of ${formatAmount(fromAmount, position.collateralToken.decimals, 4)} ${\r\n        position.collateralToken.symbol\r\n      } into ${position.indexToken.symbol} ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Deposit failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n\r\n        setPendingPositions({ ...pendingPositions });\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const withdrawCollateral = async () => {\r\n    setIsSwapping(true);\r\n    const tokenAddress0 = collateralTokenAddress === AddressZero ? nativeTokenAddress : collateralTokenAddress;\r\n    const indexTokenAddress =\r\n      position.indexToken.address === AddressZero ? nativeTokenAddress : position.indexToken.address;\r\n    const priceBasisPoints = position.isLong ? 9000 : 11000;\r\n    const priceLimit = position.indexToken.maxPrice.mul(priceBasisPoints).div(10000);\r\n\r\n    const withdrawETH = collateralTokenAddress === AddressZero || collateralTokenAddress === nativeTokenAddress;\r\n    const params = [\r\n      [tokenAddress0], // _path\r\n      indexTokenAddress, // _indexToken\r\n      fromAmount, // _collateralDelta\r\n      0, // _sizeDelta\r\n      position.isLong, // _isLong\r\n      account, // _receiver\r\n      priceLimit, // _acceptablePrice\r\n      0, // _minOut\r\n      minExecutionFee, // _executionFee\r\n      withdrawETH, // _withdrawETH\r\n    ];\r\n\r\n    const method = \"createDecreasePosition\";\r\n\r\n    const contract = new ethers.Contract(positionRouterAddress, PositionRouter.abi, library.getSigner());\r\n    callContract(chainId, contract, method, params, {\r\n      value: minExecutionFee,\r\n      sentMsg: t`Withdrawal submitted.`,\r\n      successMsg: t`Requested withdrawal of ${formatAmount(fromAmount, USD_DECIMALS, 2)} USD from ${\r\n        position.indexToken.symbol\r\n      } ${position.isLong ? \"Long\" : \"Short\"}.`,\r\n      failMsg: t`Withdrawal failed.`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async (res) => {\r\n        setFromValue(\"\");\r\n        setIsVisible(false);\r\n\r\n        pendingPositions[position.key] = {\r\n          updatedAt: Date.now(),\r\n          pendingChanges: {\r\n            collateralSnapshot: position.collateral,\r\n            expectingCollateralChange: true,\r\n          },\r\n        };\r\n      })\r\n      .finally(() => {\r\n        setIsSwapping(false);\r\n      });\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (needApproval) {\r\n      approveTokens({\r\n        setIsApproving,\r\n        library,\r\n        tokenAddress: collateralTokenAddress,\r\n        spender: routerAddress,\r\n        chainId: chainId,\r\n        infoTokens,\r\n        getTokenInfo,\r\n        pendingTxns,\r\n        setPendingTxns,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (needPositionRouterApproval) {\r\n      approvePositionRouter({\r\n        sentMsg: isDeposit ? t`Enable deposit sent.` : t`Enable withdraw sent.`,\r\n        failMsg: isDeposit ? t`Enable deposit failed.` : t`Enable withdraw failed.`,\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (isDeposit) {\r\n      depositCollateral();\r\n      return;\r\n    }\r\n\r\n    withdrawCollateral();\r\n  };\r\n  const nativeTokenSymbol = getConstant(chainId, \"nativeTokenSymbol\");\r\n\r\n  return (\r\n    <div className=\"PositionEditor\">\r\n      {position && (\r\n        <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={title}>\r\n          <div>\r\n            <Tab options={EDIT_OPTIONS} option={option} setOption={setOption} onChange={resetForm}\r\n              icons={EDIT_ICONS} />\r\n            {(isDeposit || isWithdrawal) && (\r\n              <div>\r\n                <div className=\"Exchange-swap-section\">\r\n                  <div className=\"Exchange-swap-section-top\">\r\n                    <div className=\"muted\">\r\n                      {convertedAmountFormatted && (\r\n                        <div className=\"Exchange-swap-usd\">\r\n                          {isDeposit ? t`Deposit` : t`Withdraw`}: {convertedAmountFormatted}{\" \"}\r\n                          {isDeposit ? \"USD\" : position.collateralToken.symbol}\r\n                        </div>\r\n                      )}\r\n                      {!convertedAmountFormatted && `${isDeposit ? t`Deposit` : t`Withdraw`}`}\r\n                    </div>\r\n                    {maxAmount && (\r\n                      <div className=\"muted align-right clickable\" onClick={() => setFromValue(maxAmountFormattedFree)}>\r\n                        Max: {maxAmountFormatted}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"Exchange-swap-section-bottom\">\r\n                    <div className=\"Exchange-swap-input-container\">\r\n                      <input\r\n                        type=\"number\"\r\n                        min=\"0\"\r\n                        placeholder=\"0.0\"\r\n                        className=\"Exchange-swap-input\"\r\n                        value={fromValue}\r\n                        onChange={(e) => setFromValue(e.target.value)}\r\n                      />\r\n                      {fromValue !== maxAmountFormattedFree && (\r\n                        <div\r\n                          className=\"Exchange-swap-max\"\r\n                          onClick={() => {\r\n                            setFromValue(maxAmountFormattedFree);\r\n                          }}\r\n                        >\r\n                          MAX\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"PositionEditor-token-symbol\">\r\n                      {isDeposit ? position.collateralToken.symbol : \"USD\"}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div className=\"PositionEditor-info-box\">\r\n                  {minExecutionFeeErrorMessage && (\r\n                    <div className=\"Confirmation-box-warning\">{minExecutionFeeErrorMessage}</div>\r\n                  )}\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Size</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">{formatAmount(position.size, USD_DECIMALS, 2, true)} USD</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Collateral</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextCollateral && <div>${formatAmount(position.collateral, USD_DECIMALS, 2, true)}</div>}\r\n                      {nextCollateral && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextCollateral, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Leverage</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLeverage && <div>{formatAmount(position.leverage, 4, 2, true)}x</div>}\r\n                      {nextLeverage && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            {formatAmount(position.leverage, 4, 2, true)}x\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          {formatAmount(nextLeverage, 4, 2, true)}x\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Mark Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Liq. Price</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      {!nextLiquidationPrice && (\r\n                        <div>\r\n                          {!fromAmount && `$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}\r\n                          {fromAmount && \"-\"}\r\n                        </div>\r\n                      )}\r\n                      {nextLiquidationPrice && (\r\n                        <div>\r\n                          <div className=\"inline-block muted\">\r\n                            ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                            <BsArrowRight className=\"transition-arrow\" />\r\n                          </div>\r\n                          ${formatAmount(nextLiquidationPrice, USD_DECIMALS, 2, true)}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"Exchange-info-row\">\r\n                    <div className=\"Exchange-info-label\">\r\n                      <Trans>Execution Fee</Trans>\r\n                    </div>\r\n                    <div className=\"align-right\">\r\n                      <Tooltip\r\n                        handle={`${formatAmountFree(minExecutionFee, 18, 5)} ${nativeTokenSymbol}`}\r\n                        position=\"right-top\"\r\n                        renderContent={() => {\r\n                          return (\r\n                            <>\r\n                              <StatsTooltipRow\r\n                                label=\"Network fee\"\r\n                                showDollar={false}\r\n                                value={`${formatAmountFree(\r\n                                  minExecutionFee,\r\n                                  18,\r\n                                  5\r\n                                )} ${nativeTokenSymbol} ($${formatAmount(minExecutionFeeUSD, USD_DECIMALS, 2)})`}\r\n                              />\r\n                              <br />\r\n                              This is the network cost required to execute the {isDeposit\r\n                                ? \"deposit\"\r\n                                : \"withdrawal\"}.{\" \"}\r\n                              <a\r\n                                href=\"https://gmxio.gitbook.io/gmx/trading#execution-fee\"\r\n                                target=\"_blank\"\r\n                                rel=\"noopener noreferrer\"\r\n                              >\r\n                                More Info\r\n                              </a>\r\n                            </>\r\n                          );\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"Exchange-swap-button-container\">\r\n                  <button\r\n                    className=\"App-cta Exchange-swap-button\"\r\n                    onClick={onClickPrimary}\r\n                    disabled={!isPrimaryEnabled()}\r\n                  >\r\n                    {getPrimaryText()}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import \"./SpinningLoader.css\";\r\n\r\nimport { ImSpinner2 } from \"react-icons/im\";\r\n\r\nfunction SpinningLoader({ size = \"1.25rem\" }) {\r\n  return <ImSpinner2 className=\"spin spinning-loader\" style={{ fontSize: size }} />;\r\n}\r\n\r\nexport default SpinningLoader;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { Trans } from \"@lingui/macro\";\r\nimport { toJpeg } from \"html-to-image\";\r\nimport cx from \"classnames\";\r\nimport { BiCopy } from \"react-icons/bi\";\r\nimport { RiFileDownloadLine } from \"react-icons/ri\";\r\nimport { FiTwitter } from \"react-icons/fi\";\r\nimport { useCopyToClipboard } from \"react-use\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport gmxLogo from \"../../img/gmx-logo-with-name.svg\";\r\nimport \"./PositionShare.css\";\r\nimport { QRCodeSVG } from \"qrcode.react\";\r\nimport {\r\n  formatAmount,\r\n  getHomeUrl,\r\n  getRootShareApiUrl,\r\n  getTwitterIntentURL,\r\n  helperToast,\r\n  USD_DECIMALS,\r\n} from \"../../lib/legacy\";\r\nimport { useAffiliateCodes } from \"../../domain/referrals\";\r\nimport SpinningLoader from \"../Common/SpinningLoader\";\r\nimport useLoadImage from \"../../lib/useLoadImage\";\r\nimport shareBgImg from \"../../img/position-share-bg.png\";\r\n\r\nconst ROOT_SHARE_URL = getRootShareApiUrl();\r\nconst UPLOAD_URL = ROOT_SHARE_URL + \"/api/upload\";\r\nconst UPLOAD_SHARE = ROOT_SHARE_URL + \"/api/s\";\r\nconst config = { quality: 0.95, canvasWidth: 1036, canvasHeight: 584 };\r\n\r\nfunction getShareURL(imageInfo, ref) {\r\n  if (!imageInfo) return;\r\n  let url = `${UPLOAD_SHARE}?id=${imageInfo.id}`;\r\n  if (ref.success) {\r\n    url = url + `&ref=${ref.code}`;\r\n  }\r\n  return url;\r\n}\r\n\r\nfunction PositionShare({ setIsPositionShareModalOpen, isPositionShareModalOpen, positionToShare, account, chainId }) {\r\n  const userAffiliateCode = useAffiliateCodes(chainId, account);\r\n  const [uploadedImageInfo, setUploadedImageInfo] = useState();\r\n  const [uploadedImageError, setUploadedImageError] = useState();\r\n  const [, copyToClipboard] = useCopyToClipboard();\r\n  const sharePositionBgImg = useLoadImage(shareBgImg);\r\n  const positionRef = useRef();\r\n  const tweetLink = getTwitterIntentURL(\r\n    `Latest $${positionToShare?.indexToken?.symbol} trade on @GMX_IO`,\r\n    getShareURL(uploadedImageInfo, userAffiliateCode)\r\n  );\r\n\r\n  useEffect(() => {\r\n    (async function () {\r\n      const element = positionRef.current;\r\n      if (element && userAffiliateCode.success && sharePositionBgImg && positionToShare) {\r\n        const image = await toJpeg(element, config);\r\n        try {\r\n          const imageInfo = await fetch(UPLOAD_URL, { method: \"POST\", body: image }).then((res) => res.json());\r\n          setUploadedImageInfo(imageInfo);\r\n        } catch {\r\n          setUploadedImageInfo(null);\r\n          setUploadedImageError(\"Image generation error, please refresh and try again.\");\r\n        }\r\n      }\r\n    })();\r\n  }, [userAffiliateCode, sharePositionBgImg, positionToShare]);\r\n\r\n  async function handleDownload() {\r\n    const { indexToken, isLong } = positionToShare;\r\n    const element = positionRef.current;\r\n    if (!element) return;\r\n    const dataUrl = await toJpeg(element, config);\r\n    const link = document.createElement(\"a\");\r\n    link.download = `${indexToken.symbol}-${isLong ? \"long\" : \"short\"}.jpeg`;\r\n    link.href = dataUrl;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n  }\r\n\r\n  function handleCopy() {\r\n    if (!uploadedImageInfo) return;\r\n    const url = getShareURL(uploadedImageInfo, userAffiliateCode);\r\n    copyToClipboard(url);\r\n    helperToast.success(\"Link copied to clipboard.\");\r\n  }\r\n  return (\r\n    <Modal\r\n      className=\"position-share-modal\"\r\n      isVisible={isPositionShareModalOpen}\r\n      setIsVisible={setIsPositionShareModalOpen}\r\n      label=\"Share Position\"\r\n    >\r\n      <PositionShareCard\r\n        userAffiliateCode={userAffiliateCode}\r\n        positionRef={positionRef}\r\n        position={positionToShare}\r\n        chainId={chainId}\r\n        account={account}\r\n        uploadedImageInfo={uploadedImageInfo}\r\n        uploadedImageError={uploadedImageError}\r\n        sharePositionBgImg={sharePositionBgImg}\r\n      />\r\n      {uploadedImageError && <span className=\"error\">{uploadedImageError}</span>}\r\n\r\n      <div className=\"actions\">\r\n        <button disabled={!uploadedImageInfo} className=\"mr-base App-button-option\" onClick={handleCopy}>\r\n          <BiCopy className=\"icon\" />\r\n          <Trans>Copy</Trans>\r\n        </button>\r\n        <button className=\"mr-base App-button-option\" onClick={handleDownload}>\r\n          <RiFileDownloadLine className=\"icon\" />\r\n          <Trans>Download</Trans>\r\n        </button>\r\n        <div className={cx(\"tweet-link-container\", { disabled: !uploadedImageInfo })}>\r\n          <a\r\n            target=\"_blank\"\r\n            className={cx(\"tweet-link App-button-option\", { disabled: !uploadedImageInfo })}\r\n            rel=\"noreferrer\"\r\n            href={tweetLink}\r\n          >\r\n            <FiTwitter className=\"icon\" />\r\n            <Trans>Tweet</Trans>\r\n          </a>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nfunction PositionShareCard({\r\n  positionRef,\r\n  position,\r\n  userAffiliateCode,\r\n  uploadedImageInfo,\r\n  uploadedImageError,\r\n  sharePositionBgImg,\r\n}) {\r\n  const { code, success } = userAffiliateCode;\r\n  const { deltaAfterFeesPercentageStr, isLong, leverage, indexToken, averagePrice, markPrice } = position;\r\n  const homeURL = getHomeUrl();\r\n  return (\r\n    <div className=\"relative\">\r\n      <div ref={positionRef} className=\"position-share\" style={{ backgroundImage: `url(${sharePositionBgImg})` }}>\r\n        <img className=\"logo\" src={gmxLogo} alt=\"GMX Logo\" />\r\n        <ul className=\"info\">\r\n          <li className=\"side\">{isLong ? \"LONG\" : \"SHORT\"}</li>\r\n          <li>{formatAmount(leverage, 4, 2, true)}x&nbsp;</li>\r\n          <li>{indexToken.symbol} USD</li>\r\n        </ul>\r\n        <h3 className=\"pnl\">{deltaAfterFeesPercentageStr}</h3>\r\n        <div className=\"prices\">\r\n          <div>\r\n            <p>Entry Price</p>\r\n            <p className=\"price\">${formatAmount(averagePrice, USD_DECIMALS, 2, true)}</p>\r\n          </div>\r\n          <div>\r\n            <p>Index Price</p>\r\n            <p className=\"price\">${formatAmount(markPrice, USD_DECIMALS, 2, true)}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"referral-code\">\r\n          <div>\r\n            <QRCodeSVG size={32} value={success ? `${homeURL}/#/?ref=${code}` : `${homeURL}`} />\r\n          </div>\r\n          <div className=\"referral-code-info\">\r\n            {success ? (\r\n              <>\r\n                <p className=\"label\">Referral Code:</p>\r\n                <p className=\"code\">{code}</p>\r\n              </>\r\n            ) : (\r\n              <p className=\"code\">https://gmx.io</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {!uploadedImageInfo && !uploadedImageError && (\r\n        <div className=\"image-overlay-wrapper\">\r\n          <div className=\"image-overlay\">\r\n            <SpinningLoader />\r\n            <p className=\"loading-text\">Generating shareable image...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default PositionShare;\r\n","import { useEffect, useState } from \"react\";\r\n\r\nexport default function useLoadImage(src) {\r\n  const [sourceLoaded, setSourceLoaded] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const img = new Image();\r\n    img.src = src;\r\n    img.onload = () => setSourceLoaded(src);\r\n  }, [src]);\r\n\r\n  return sourceLoaded;\r\n}\r\n","import { Menu } from \"@headlessui/react\";\r\nimport { Trans } from \"@lingui/macro\";\r\nimport { HiDotsVertical } from \"react-icons/hi\";\r\nimport { AiOutlineEdit } from \"react-icons/ai\";\r\nimport { BiSelectMultiple } from \"react-icons/bi\";\r\nimport { RiShareBoxFill } from \"react-icons/ri\";\r\nimport \"./PositionDropdown.css\";\r\n\r\nfunction PositionDropdown({ handleEditCollateral, handleShare, handleMarketSelect }) {\r\n  return (\r\n    <Menu>\r\n      <Menu.Button as=\"div\">\r\n        <button className=\"PositionDropdown-dots-icon\">\r\n          <HiDotsVertical fontSize={20} fontWeight={700} />\r\n        </button>\r\n      </Menu.Button>\r\n      <div className=\"PositionDropdown-extra-options\">\r\n        <Menu.Items as=\"div\" className=\"menu-items\">\r\n          <Menu.Item>\r\n            <div className=\"menu-item\" onClick={handleEditCollateral}>\r\n              <AiOutlineEdit fontSize={16} />\r\n              <p>\r\n                <Trans>Edit Collateral</Trans>\r\n              </p>\r\n            </div>\r\n          </Menu.Item>\r\n          <Menu.Item>\r\n            <div className=\"menu-item\" onClick={handleMarketSelect}>\r\n              <BiSelectMultiple fontSize={16} />\r\n              <p>\r\n                <Trans>Select Market</Trans>\r\n              </p>\r\n            </div>\r\n          </Menu.Item>\r\n          <Menu.Item>\r\n            <div className=\"menu-item\" onClick={handleShare}>\r\n              <RiShareBoxFill fontSize={16} />\r\n              <p>\r\n                <Trans>Share Position</Trans>\r\n              </p>\r\n            </div>\r\n          </Menu.Item>\r\n        </Menu.Items>\r\n      </div>\r\n    </Menu>\r\n  );\r\n}\r\n\r\nexport default PositionDropdown;\r\n","import React, { useState } from \"react\";\r\nimport cx from \"classnames\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport PositionSeller from \"./PositionSeller\";\r\nimport PositionEditor from \"./PositionEditor\";\r\nimport OrdersToa from \"./OrdersToa\";\r\n\r\nimport { ImSpinner2 } from \"react-icons/im\";\r\n\r\nimport {\r\n  helperToast,\r\n  bigNumberify,\r\n  getLiquidationPrice,\r\n  getUsd,\r\n  getLeverage,\r\n  formatAmount,\r\n  getOrderError,\r\n  USD_DECIMALS,\r\n  FUNDING_RATE_PRECISION,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  INCREASE,\r\n  DECREASE,\r\n} from \"../../lib/legacy\";\r\nimport PositionShare from \"./PositionShare\";\r\nimport PositionDropdown from \"./PositionDropdown\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\n\r\nconst getOrdersForPosition = (account, position, orders, nativeTokenAddress) => {\r\n  if (!orders || orders.length === 0) {\r\n    return [];\r\n  }\r\n  /* eslint-disable array-callback-return */\r\n  return orders\r\n    .filter((order) => {\r\n      if (order.type === SWAP) {\r\n        return false;\r\n      }\r\n      const hasMatchingIndexToken =\r\n        order.indexToken === nativeTokenAddress\r\n          ? position.indexToken.isNative\r\n          : order.indexToken === position.indexToken.address;\r\n      const hasMatchingCollateralToken =\r\n        order.collateralToken === nativeTokenAddress\r\n          ? position.collateralToken.isNative\r\n          : order.collateralToken === position.collateralToken.address;\r\n      if (order.isLong === position.isLong && hasMatchingIndexToken && hasMatchingCollateralToken) {\r\n        return true;\r\n      }\r\n    })\r\n    .map((order) => {\r\n      order.error = getOrderError(account, order, undefined, position);\r\n      if (order.type === DECREASE && order.sizeDelta.gt(position.size)) {\r\n        order.error = \"Order size is bigger than position, will only be executable if position increases\";\r\n      }\r\n      return order;\r\n    });\r\n};\r\n\r\nexport default function PositionsList(props) {\r\n  const {\r\n    pendingPositions,\r\n    setPendingPositions,\r\n    positions,\r\n    positionsDataIsLoading,\r\n    positionsMap,\r\n    infoTokens,\r\n    active,\r\n    account,\r\n    library,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    setListSection,\r\n    flagOrdersEnabled,\r\n    savedIsPnlInLeverage,\r\n    chainId,\r\n    nativeTokenAddress,\r\n    orders,\r\n    setIsWaitingForPluginApproval,\r\n    approveOrderBook,\r\n    isPluginApproving,\r\n    isWaitingForPluginApproval,\r\n    orderBookApproved,\r\n    positionRouterApproved,\r\n    isWaitingForPositionRouterApproval,\r\n    isPositionRouterApproving,\r\n    approvePositionRouter,\r\n    showPnlAfterFees,\r\n    setMarket,\r\n    minExecutionFee,\r\n    minExecutionFeeUSD,\r\n    minExecutionFeeErrorMessage,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n  } = props;\r\n\r\n  const [positionToEditKey, setPositionToEditKey] = useState(undefined);\r\n  const [positionToSellKey, setPositionToSellKey] = useState(undefined);\r\n  const [positionToShare, setPositionToShare] = useState(null);\r\n  const [isPositionEditorVisible, setIsPositionEditorVisible] = useState(undefined);\r\n  const [isPositionSellerVisible, setIsPositionSellerVisible] = useState(undefined);\r\n  const [collateralTokenAddress, setCollateralTokenAddress] = useState(undefined);\r\n  const [isPositionShareModalOpen, setIsPositionShareModalOpen] = useState(false);\r\n  const [ordersToaOpen, setOrdersToaOpen] = useState(false);\r\n  const [isHigherSlippageAllowed, setIsHigherSlippageAllowed] = useState(false);\r\n\r\n  const editPosition = (position) => {\r\n    setCollateralTokenAddress(position.collateralToken.address);\r\n    setPositionToEditKey(position.key);\r\n    setIsPositionEditorVisible(true);\r\n  };\r\n\r\n  const sellPosition = (position) => {\r\n    setPositionToSellKey(position.key);\r\n    setIsPositionSellerVisible(true);\r\n    setIsHigherSlippageAllowed(false);\r\n  };\r\n\r\n  const onPositionClick = (position) => {\r\n    helperToast.success(`${position.isLong ? \"Long\" : \"Short\"} ${position.indexToken.symbol} market selected`);\r\n    setMarket(position.isLong ? LONG : SHORT, position.indexToken.address);\r\n  };\r\n\r\n  return (\r\n    <div className=\"PositionsList\">\r\n      <PositionEditor\r\n        pendingPositions={pendingPositions}\r\n        setPendingPositions={setPendingPositions}\r\n        positionsMap={positionsMap}\r\n        positionKey={positionToEditKey}\r\n        isVisible={isPositionEditorVisible}\r\n        setIsVisible={setIsPositionEditorVisible}\r\n        infoTokens={infoTokens}\r\n        active={active}\r\n        account={account}\r\n        library={library}\r\n        collateralTokenAddress={collateralTokenAddress}\r\n        pendingTxns={pendingTxns}\r\n        setPendingTxns={setPendingTxns}\r\n        getUsd={getUsd}\r\n        getLeverage={getLeverage}\r\n        savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n        positionRouterApproved={positionRouterApproved}\r\n        isPositionRouterApproving={isPositionRouterApproving}\r\n        isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n        approvePositionRouter={approvePositionRouter}\r\n        chainId={chainId}\r\n        minExecutionFee={minExecutionFee}\r\n        minExecutionFeeUSD={minExecutionFeeUSD}\r\n        minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n      />\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionShareModalOpen && (\r\n        <PositionShare\r\n          setIsPositionShareModalOpen={setIsPositionShareModalOpen}\r\n          isPositionShareModalOpen={isPositionShareModalOpen}\r\n          positionToShare={positionToShare}\r\n          chainId={chainId}\r\n          account={account}\r\n        />\r\n      )}\r\n      {ordersToaOpen && (\r\n        <OrdersToa\r\n          setIsVisible={setOrdersToaOpen}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n        />\r\n      )}\r\n      {isPositionSellerVisible && (\r\n        <PositionSeller\r\n          pendingPositions={pendingPositions}\r\n          setPendingPositions={setPendingPositions}\r\n          setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n          approveOrderBook={approveOrderBook}\r\n          isPluginApproving={isPluginApproving}\r\n          isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n          orderBookApproved={orderBookApproved}\r\n          positionsMap={positionsMap}\r\n          positionKey={positionToSellKey}\r\n          isVisible={isPositionSellerVisible}\r\n          setIsVisible={setIsPositionSellerVisible}\r\n          infoTokens={infoTokens}\r\n          active={active}\r\n          account={account}\r\n          orders={orders}\r\n          library={library}\r\n          pendingTxns={pendingTxns}\r\n          setPendingTxns={setPendingTxns}\r\n          flagOrdersEnabled={flagOrdersEnabled}\r\n          savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n          chainId={chainId}\r\n          nativeTokenAddress={nativeTokenAddress}\r\n          setOrdersToaOpen={setOrdersToaOpen}\r\n          positionRouterApproved={positionRouterApproved}\r\n          isPositionRouterApproving={isPositionRouterApproving}\r\n          isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n          approvePositionRouter={approvePositionRouter}\r\n          isHigherSlippageAllowed={isHigherSlippageAllowed}\r\n          setIsHigherSlippageAllowed={setIsHigherSlippageAllowed}\r\n          minExecutionFee={minExecutionFee}\r\n          minExecutionFeeUSD={minExecutionFeeUSD}\r\n          minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n          usdgSupply={usdgSupply}\r\n          totalTokenWeights={totalTokenWeights}\r\n        />\r\n      )}\r\n      {positions && (\r\n        <div className=\"Exchange-list small\">\r\n          <div>\r\n            {positions.length === 0 && positionsDataIsLoading && (\r\n              <div className=\"Exchange-empty-positions-list-note App-card\">\r\n                <Trans>Loading...</Trans>\r\n              </div>\r\n            )}\r\n            {positions.length === 0 && !positionsDataIsLoading && (\r\n              <div className=\"Exchange-empty-positions-list-note App-card Exchange-list-empty-note\">\r\n                <Trans>No open positions</Trans>\r\n              </div>\r\n            )}\r\n            {positions.map((position) => {\r\n              const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n              const liquidationPrice = getLiquidationPrice(position);\r\n              const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n              const positionDelta =\r\n                position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n              let borrowFeeUSD;\r\n              if (position.collateralToken && position.collateralToken.fundingRate) {\r\n                const borrowFeeRate = position.collateralToken.fundingRate\r\n                  .mul(position.size)\r\n                  .mul(24)\r\n                  .div(FUNDING_RATE_PRECISION);\r\n                borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n              }\r\n\r\n              return (\r\n                <div key={position.key} className=\"App-card\">\r\n                  {/* <div className=\"App-card-title\">\r\n                    <span className=\"Exchange-list-title\">{position.indexToken.symbol}</span>\r\n                  </div> */}\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Position</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <div className=\"Exchange-list-token\">{position.indexToken.symbol}</div>\r\n                        <span\r\n                          className={cx(\"Exchange-list-side\", {\r\n                            positive: position.isLong,\r\n                            negative: !position.isLong,\r\n                          })}\r\n                        ><span className=\"Exchange-list-leverage\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n                          {position.isLong ? t`Long` : t`Short`}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Net Value</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <Tooltip\r\n                          handle={`$${formatAmount(position.netValue, USD_DECIMALS, 2, true)}`}\r\n                          position=\"right-bottom\"\r\n                          handleClassName=\"plain\"\r\n                          renderContent={() => {\r\n                            return (\r\n                              <>\r\n                                Net Value:{\" \"}\r\n                                {showPnlAfterFees\r\n                                  ? \"Initial Collateral - Fees + PnL\"\r\n                                  : \"Initial Collateral - Borrow Fee + PnL\"}\r\n                                <br />\r\n                                <br />\r\n                                <StatsTooltipRow\r\n                                  label=\"Initial Collateral\"\r\n                                  value={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                                />\r\n                                <StatsTooltipRow label=\"PnL\" value={position.deltaBeforeFeesStr} showDollar={false} />\r\n                                <StatsTooltipRow\r\n                                  label=\"Borrow Fee\"\r\n                                  value={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n                                />\r\n                                <StatsTooltipRow\r\n                                  label=\"Open + Close fee\"\r\n                                  value={formatAmount(position.positionFee, USD_DECIMALS, 2, true)}\r\n                                />\r\n                                <StatsTooltipRow\r\n                                  label=\"PnL After Fees\"\r\n                                  value={`${position.deltaAfterFeesStr} (${position.deltaAfterFeesPercentageStr})`}\r\n                                  showDollar={false}\r\n                                />\r\n                              </>\r\n                            );\r\n                          }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    {/* <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Leverage</Trans>\r\n                      </div>\r\n                      <div>\r\n                        {formatAmount(position.leverage, 4, 2, true)}x&nbsp;\r\n                        <span\r\n                          className={cx(\"Exchange-list-side\", {\r\n                            positive: position.isLong,\r\n                            negative: !position.isLong,\r\n                          })}\r\n                        >\r\n                          {position.isLong ? t`Long` : t`Short`}\r\n                        </span>\r\n                      </div>\r\n                    </div> */}\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Size</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Collateral</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <Tooltip\r\n                          handle={`$${formatAmount(position.collateralAfterFee, USD_DECIMALS, 2, true)}`}\r\n                          position=\"right-bottom\"\r\n                          handleClassName={cx(\"plain\", { negative: position.hasLowCollateral })}\r\n                          renderContent={() => {\r\n                            return (\r\n                              <>\r\n                                {position.hasLowCollateral && (\r\n                                  <div>\r\n                                    WARNING: This position has a low amount of collateral after deducting borrowing\r\n                                    fees, deposit more collateral to reduce the position's liquidation risk.\r\n                                    <br />\r\n                                    <br />\r\n                                  </div>\r\n                                )}\r\n                                <StatsTooltipRow\r\n                                  label=\"Initial Collateral\"\r\n                                  value={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                                />\r\n                                <StatsTooltipRow\r\n                                  label=\"Borrow Fee\"\r\n                                  value={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n                                />\r\n                                <StatsTooltipRow label={t`Borrow Fee / Day`} value={borrowFeeUSD} />\r\n                                <span>Use the \"Edit\" button to deposit or withdraw collateral.</span>\r\n                              </>\r\n                            );\r\n                          }}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                    {/* <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>PnL</Trans>\r\n                      </div>\r\n                      <div>\r\n                        <span\r\n                          className={cx(\"Exchange-list-info-label\", {\r\n                            positive: hasPositionProfit && positionDelta.gt(0),\r\n                            negative: !hasPositionProfit && positionDelta.gt(0),\r\n                            muted: positionDelta.eq(0),\r\n                          })}\r\n                        >\r\n                          {position.deltaStr} ({position.deltaPercentageStr})\r\n                        </span>\r\n                      </div>\r\n                    </div> */}\r\n                    {/* <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Orders</Trans>\r\n                      </div>\r\n                      <div>\r\n                        {positionOrders.length === 0 && \"None\"}\r\n                        {positionOrders.map((order) => {\r\n                          const orderText = () => (\r\n                            <>\r\n                              {order.triggerAboveThreshold ? \">\" : \"<\"} {formatAmount(order.triggerPrice, 30, 2, true)}:\r\n                              {order.type === INCREASE ? \" +\" : \" -\"}${formatAmount(order.sizeDelta, 30, 2, true)}\r\n                            </>\r\n                          );\r\n                          if (order.error) {\r\n                            return (\r\n                              <div key={`${order.isLong}-${order.type}-${order.index}`} className=\"Position-list-order\">\r\n                                <Tooltip\r\n                                  className=\"order-error\"\r\n                                  handle={orderText()}\r\n                                  position=\"right-bottom\"\r\n                                  handleClassName=\"plain\"\r\n                                  renderContent={() => <span className=\"negative\">{order.error}</span>}\r\n                                />\r\n                              </div>\r\n                            );\r\n                          } else {\r\n                            return (\r\n                              <div key={`${order.isLong}-${order.type}-${order.index}`} className=\"Position-list-order\">\r\n                                {orderText()}\r\n                              </div>\r\n                            );\r\n                          }\r\n                        })}\r\n                      </div>\r\n                    </div> */}\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-content\">\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Mark Price</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Entry Price</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}</div>\r\n                    </div>\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Trans>Liq. Price</Trans>\r\n                      </div>\r\n                      <div>${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}</div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-options\">\r\n                    <button\r\n                      className=\"App-button-option App-card-option\"\r\n                      disabled={position.size.eq(0)}\r\n                      onClick={() => editPosition(position)}\r\n                    >\r\n                      <Trans> Edit</Trans>\r\n                    </button>\r\n                    <button\r\n                      className=\"App-button-option App-card-option\"\r\n                      disabled={position.size.eq(0)}\r\n                      onClick={() => sellPosition(position)}\r\n                    >\r\n                      Close\r\n                    </button>\r\n                    \r\n                    {/* <button\r\n                      className=\"Exchange-list-action App-button-option App-card-option\"\r\n                      onClick={() => {\r\n                        setPositionToShare(position);\r\n                        setIsPositionShareModalOpen(true);\r\n                      }}\r\n                      disabled={position.size.eq(0)}\r\n                    >\r\n                      <Trans>Share</Trans>\r\n                    </button> */}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      <table className=\"Exchange-list large App-box\">\r\n        <tbody>\r\n          <tr className=\"Exchange-list-header\">\r\n            <th>\r\n              <Trans>Position</Trans>\r\n            </th>\r\n            <th>\r\n              <Trans>Net Value</Trans>\r\n            </th>\r\n            <th>\r\n              <Trans>Size</Trans>\r\n            </th>\r\n            <th>\r\n              <Trans>Collateral</Trans>\r\n            </th>\r\n            <th>\r\n              <Trans>Mark Price</Trans>\r\n            </th>\r\n            <th>\r\n              <Trans>Entry Price</Trans>\r\n            </th>\r\n            <th>\r\n              <Trans>Liq. Price</Trans>\r\n            </th>\r\n            <th></th>\r\n            <th></th>\r\n          </tr>\r\n          {positions.length === 0 && positionsDataIsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\">\r\n                <div className=\"Exchange-empty-positions-list-note\">Loading...</div>\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {positions.length === 0 && !positionsDataIsLoading && (\r\n            <tr>\r\n              <td colSpan=\"15\">\r\n                <div className=\"Exchange-empty-positions-list-note Exchange-list-empty-note\">No open positions</div>\r\n              </td>\r\n            </tr>\r\n          )}\r\n          {positions.map((position) => {\r\n            const liquidationPrice = getLiquidationPrice(position) || bigNumberify(0);\r\n            const positionOrders = getOrdersForPosition(account, position, orders, nativeTokenAddress);\r\n            const hasOrderError = !!positionOrders.find((order) => order.error);\r\n            const hasPositionProfit = position[showPnlAfterFees ? \"hasProfitAfterFees\" : \"hasProfit\"];\r\n            const positionDelta =\r\n              position[showPnlAfterFees ? \"pendingDeltaAfterFees\" : \"pendingDelta\"] || bigNumberify(0);\r\n            let borrowFeeUSD;\r\n            if (position.collateralToken && position.collateralToken.fundingRate) {\r\n              const borrowFeeRate = position.collateralToken.fundingRate\r\n                .mul(position.size)\r\n                .mul(24)\r\n                .div(FUNDING_RATE_PRECISION);\r\n              borrowFeeUSD = formatAmount(borrowFeeRate, USD_DECIMALS, 2);\r\n            }\r\n\r\n            return (\r\n              <tr key={position.key}>\r\n                <td className=\"clickable\" onClick={() => onPositionClick(position)}>\r\n                  <div className=\"Exchange-list-title\">\r\n                    {position.indexToken.symbol}\r\n                    {position.hasPendingChanges && <ImSpinner2 className=\"spin position-loading-icon\" />}\r\n                  </div>\r\n                  <div className=\"Exchange-list-info-label\">\r\n                    {position.leverage && (\r\n                      <span className=\"muted\">{formatAmount(position.leverage, 4, 2, true)}x&nbsp;</span>\r\n                    )}\r\n                    <span className={cx({ positive: position.isLong, negative: !position.isLong })}>\r\n                      {position.isLong ? \"Long\" : \"Short\"}\r\n                    </span>\r\n                  </div>\r\n                </td>\r\n                <td>\r\n                  <div>\r\n                    {!position.netValue && \"Opening...\"}\r\n                    {position.netValue && (\r\n                      <Tooltip\r\n                        handle={`$${formatAmount(position.netValue, USD_DECIMALS, 2, true)}`}\r\n                        position=\"left-bottom\"\r\n                        handleClassName=\"plain\"\r\n                        renderContent={() => {\r\n                          return (\r\n                            <>\r\n                              Net Value:{\" \"}\r\n                              {showPnlAfterFees\r\n                                ? t`Initial Collateral - Fees + PnL`\r\n                                : t`Initial Collateral - Borrow Fee + PnL`}\r\n                              <br />\r\n                              <br />\r\n                              <StatsTooltipRow\r\n                                label={t`Initial Collateralt`}\r\n                                value={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                              />\r\n                              <StatsTooltipRow label={`PnL`} value={position.deltaBeforeFeesStr} showDollar={false} />\r\n                              <StatsTooltipRow\r\n                                label={t`Borrow Fee`}\r\n                                value={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n                              />\r\n                              <StatsTooltipRow\r\n                                label={`Open + Close fee`}\r\n                                value={formatAmount(position.positionFee, USD_DECIMALS, 2, true)}\r\n                              />\r\n                              <StatsTooltipRow\r\n                                label={`PnL After Fees`}\r\n                                value={`${position.deltaAfterFeesStr} (${position.deltaAfterFeesPercentageStr})`}\r\n                                showDollar={false}\r\n                              />\r\n                            </>\r\n                          );\r\n                        }}\r\n                      />\r\n                    )}\r\n                  </div>\r\n                  {position.deltaStr && (\r\n                    <div\r\n                      className={cx(\"Exchange-list-info-label\", {\r\n                        positive: hasPositionProfit && positionDelta.gt(0),\r\n                        negative: !hasPositionProfit && positionDelta.gt(0),\r\n                        muted: positionDelta.eq(0),\r\n                      })}\r\n                    >\r\n                      {position.deltaStr} ({position.deltaPercentageStr})\r\n                    </div>\r\n                  )}\r\n                </td>\r\n                <td>\r\n                  <div>${formatAmount(position.size, USD_DECIMALS, 2, true)}</div>\r\n                  {positionOrders.length > 0 && (\r\n                    <div onClick={() => setListSection && setListSection(\"Orders\")}>\r\n                      <Tooltip\r\n                        handle={`Orders (${positionOrders.length})`}\r\n                        position=\"left-bottom\"\r\n                        handleClassName={cx(\r\n                          [\"Exchange-list-info-label\", \"Exchange-position-list-orders\", \"plain\", \"clickable\"],\r\n                          { muted: !hasOrderError, negative: hasOrderError }\r\n                        )}\r\n                        renderContent={() => {\r\n                          return (\r\n                            <>\r\n                              <strong>Active Orders</strong>\r\n                              {positionOrders.map((order) => {\r\n                                return (\r\n                                  <div\r\n                                    key={`${order.isLong}-${order.type}-${order.index}`}\r\n                                    className=\"Position-list-order\"\r\n                                  >\r\n                                    {order.triggerAboveThreshold ? \">\" : \"<\"}{\" \"}\r\n                                    {formatAmount(order.triggerPrice, 30, 2, true)}:\r\n                                    {order.type === INCREASE ? \" +\" : \" -\"}${formatAmount(order.sizeDelta, 30, 2, true)}\r\n                                    {order.error && (\r\n                                      <>\r\n                                        , <span className=\"negative\">{order.error}</span>\r\n                                      </>\r\n                                    )}\r\n                                  </div>\r\n                                );\r\n                              })}\r\n                            </>\r\n                          );\r\n                        }}\r\n                      />\r\n                    </div>\r\n                  )}\r\n                </td>\r\n                <td>\r\n                  <Tooltip\r\n                    handle={`$${formatAmount(position.collateralAfterFee, USD_DECIMALS, 2, true)}`}\r\n                    position=\"left-bottom\"\r\n                    handleClassName={cx(\"plain\", { negative: position.hasLowCollateral })}\r\n                    renderContent={() => {\r\n                      return (\r\n                        <>\r\n                          {position.hasLowCollateral && (\r\n                            <div>\r\n                              <Trans>\r\n                                WARNING: This position has a low amount of collateral after deducting borrowing fees,\r\n                                deposit more collateral to reduce the position's liquidation risk.\r\n                              </Trans>\r\n                              <br />\r\n                              <br />\r\n                            </div>\r\n                          )}\r\n\r\n                          <StatsTooltipRow\r\n                            label={t`Initial Collateral`}\r\n                            value={formatAmount(position.collateral, USD_DECIMALS, 2, true)}\r\n                          />\r\n                          <StatsTooltipRow\r\n                            label={t`Borrow Fee`}\r\n                            value={formatAmount(position.fundingFee, USD_DECIMALS, 2, true)}\r\n                          />\r\n                          <StatsTooltipRow label={t`Borrow Fee / Day`} value={borrowFeeUSD} />\r\n                          <br />\r\n                          <Trans>Use the \"Edit\" button to deposit or withdraw collateral.</Trans>\r\n                        </>\r\n                      );\r\n                    }}\r\n                  />\r\n                </td>\r\n                <td className=\"\" onClick={() => {\r\n                  // onPositionClick(position)\r\n                  return;\r\n                }}>\r\n                  <Tooltip\r\n                    handle={`$${formatAmount(position.markPrice, USD_DECIMALS, 2, true)}`}\r\n                    position=\"left-bottom\"\r\n                    handleClassName=\"plain\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          Click on a row to select the position's market, then use the swap box to increase your\r\n                          position size if needed.\r\n                          <br />\r\n                          <br />\r\n                          Use the \"Close\" button to reduce your position size, or to set stop-loss / take-profit orders.\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                </td>\r\n                <td className=\"\" onClick={() => {\r\n                  // onPositionClick(position)\r\n                  return;\r\n                }}>\r\n                  ${formatAmount(position.averagePrice, USD_DECIMALS, 2, true)}\r\n                </td>\r\n                <td className=\"\" onClick={() => {\r\n                  // onPositionClick(position)\r\n                  return;\r\n                }}>\r\n                  ${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}\r\n                </td>\r\n\r\n                <td className=\"td-btn\">\r\n                  <button\r\n                    className=\"Exchange-list-action\"\r\n                    onClick={() => editPosition(position)}\r\n                    // disabled={position.size.eq(0)}\r\n                  >\r\n                    Edit\r\n                  </button>\r\n                </td>\r\n                <td className=\"td-btn\">\r\n                  <button\r\n                    className=\"Exchange-list-action\"\r\n                    onClick={() => sellPosition(position)}\r\n                    disabled={position.size.eq(0)}\r\n                  >\r\n                    Close\r\n                  </button>\r\n                  {/* <PositionDropdown\r\n                    handleEditCollateral={() => {\r\n                      editPosition(position);\r\n                    }}\r\n                    handleShare={() => {\r\n                      setPositionToShare(position);\r\n                      setIsPositionShareModalOpen(true);\r\n                    }}\r\n                    handleMarketSelect={() => {\r\n                      onPositionClick(position);\r\n                    }}\r\n                  /> */}\r\n                </td>\r\n                <td className=\"td-btn\">\r\n                  <Tooltip\r\n                    className=\"collateral-locked-icon\"\r\n                    position=\"right-bottom\"\r\n                    enabled={true}\r\n                    handle=\"\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <div>\r\n                          Your position is locked as collateral\r\n                        </div>\r\n                      );\r\n                    }} />\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useMemo } from \"react\";\r\nimport { BsArrowRight } from \"react-icons/bs\";\r\n\r\nimport {\r\n  PRECISION,\r\n  USD_DECIMALS,\r\n  SWAP,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n  MIN_PROFIT_TIME,\r\n  DECREASE,\r\n  INCREASE,\r\n  useChainId,\r\n  getTokenInfo,\r\n  isTriggerRatioInverted,\r\n  bigNumberify,\r\n  formatAmountFree,\r\n  parseValue,\r\n  getNextToAmount,\r\n  getExchangeRate,\r\n  formatAmount,\r\n  getExchangeRateDisplay,\r\n  calculatePositionDelta,\r\n  getLiquidationPrice,\r\n  formatDateTime,\r\n  getDeltaStr,\r\n  getProfitPrice,\r\n  getTimeRemaining,\r\n} from \"../../lib/legacy\";\r\nimport { updateSwapOrder, updateIncreaseOrder, updateDecreaseOrder } from \"../../domain/legacy\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport ExchangeInfoRow from \"./ExchangeInfoRow\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nexport default function OrderEditor(props) {\r\n  const {\r\n    account,\r\n    order,\r\n    setEditingOrder,\r\n    infoTokens,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    library,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    getPositionForOrder,\r\n    positionsMap,\r\n    savedShouldDisableValidationForTesting,\r\n  } = props;\r\n\r\n  const { chainId } = useChainId();\r\n\r\n  const position = order.type !== SWAP ? getPositionForOrder(account, order, positionsMap) : null;\r\n  const liquidationPrice = order.type === DECREASE && position ? getLiquidationPrice(position) : null;\r\n\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const fromTokenInfo = order.type === SWAP ? getTokenInfo(infoTokens, order.path[0], true, nativeTokenAddress) : null;\r\n  const toTokenInfo =\r\n    order.type === SWAP\r\n      ? getTokenInfo(infoTokens, order.path[order.path.length - 1], order.shouldUnwrap, nativeTokenAddress)\r\n      : null;\r\n\r\n  const triggerRatioInverted = useMemo(() => {\r\n    if (order.type !== SWAP) {\r\n      return null;\r\n    }\r\n\r\n    return isTriggerRatioInverted(fromTokenInfo, toTokenInfo);\r\n  }, [toTokenInfo, fromTokenInfo, order.type]);\r\n\r\n  let initialRatio = 0;\r\n  if (order.triggerRatio) {\r\n    initialRatio = triggerRatioInverted ? PRECISION.mul(PRECISION).div(order.triggerRatio) : order.triggerRatio;\r\n  }\r\n  const [triggerRatioValue, setTriggerRatioValue] = useState(formatAmountFree(initialRatio, USD_DECIMALS, 6));\r\n\r\n  const [triggerPriceValue, setTriggerPriceValue] = useState(formatAmountFree(order.triggerPrice, USD_DECIMALS, 4));\r\n  const triggerPrice = useMemo(() => {\r\n    return triggerPriceValue ? parseValue(triggerPriceValue, USD_DECIMALS) : 0;\r\n  }, [triggerPriceValue]);\r\n\r\n  const triggerRatio = useMemo(() => {\r\n    if (!triggerRatioValue) {\r\n      return bigNumberify(0);\r\n    }\r\n    let ratio = parseValue(triggerRatioValue, USD_DECIMALS);\r\n    if (triggerRatioInverted) {\r\n      ratio = PRECISION.mul(PRECISION).div(ratio);\r\n    }\r\n    return ratio;\r\n  }, [triggerRatioValue, triggerRatioInverted]);\r\n\r\n  const indexTokenMarkPrice = useMemo(() => {\r\n    if (order.type === SWAP) {\r\n      return;\r\n    }\r\n    const toTokenInfo = getTokenInfo(infoTokens, order.indexToken);\r\n    return order.isLong ? toTokenInfo.maxPrice : toTokenInfo.minPrice;\r\n  }, [infoTokens, order]);\r\n\r\n  let toAmount;\r\n  if (order.type === SWAP) {\r\n    const { amount } = getNextToAmount(\r\n      chainId,\r\n      order.amountIn,\r\n      order.path[0],\r\n      order.path[order.path.length - 1],\r\n      infoTokens,\r\n      undefined,\r\n      triggerRatio,\r\n      usdgSupply,\r\n      totalTokenWeights\r\n    );\r\n    toAmount = amount;\r\n  }\r\n\r\n  const onClickPrimary = () => {\r\n    setIsSubmitting(true);\r\n\r\n    let func;\r\n    let params;\r\n\r\n    if (order.type === SWAP) {\r\n      func = updateSwapOrder;\r\n      params = [chainId, library, order.index, toAmount, triggerRatio, order.triggerAboveThreshold];\r\n    } else if (order.type === DECREASE) {\r\n      func = updateDecreaseOrder;\r\n      params = [\r\n        chainId,\r\n        library,\r\n        order.index,\r\n        order.collateralDelta,\r\n        order.sizeDelta,\r\n        triggerPrice,\r\n        order.triggerAboveThreshold,\r\n      ];\r\n    } else if (order.type === INCREASE) {\r\n      func = updateIncreaseOrder;\r\n      params = [chainId, library, order.index, order.sizeDelta, triggerPrice, order.triggerAboveThreshold];\r\n    }\r\n\r\n    params.push({\r\n      successMsg: \"Order updated!\",\r\n      failMsg: \"Order update failed.\",\r\n      sentMsg: \"Order update submitted!\",\r\n      pendingTxns,\r\n      setPendingTxns,\r\n    });\r\n\r\n    return func(...params)\r\n      .then(() => {\r\n        setEditingOrder(null);\r\n      })\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const onTriggerRatioChange = (evt) => {\r\n    setTriggerRatioValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const onTriggerPriceChange = (evt) => {\r\n    setTriggerPriceValue(evt.target.value || \"\");\r\n  };\r\n\r\n  const getError = () => {\r\n    if ((!triggerRatio || triggerRatio.eq(0)) && (!triggerPrice || triggerPrice.eq(0))) {\r\n      return \"Enter Price\";\r\n    }\r\n    if (order.type === SWAP && triggerRatio.eq(order.triggerRatio)) {\r\n      return \"Enter new Price\";\r\n    }\r\n    if (order.type !== SWAP && triggerPrice.eq(order.triggerPrice)) {\r\n      return \"Enter new Price\";\r\n    }\r\n    if (position) {\r\n      if (order.type === DECREASE) {\r\n        if (position.isLong && triggerPrice.lte(liquidationPrice)) {\r\n          return \"Price below Liq. Price\";\r\n        }\r\n        if (!position.isLong && triggerPrice.gte(liquidationPrice)) {\r\n          return \"Price above Liq. Price\";\r\n        }\r\n      }\r\n\r\n      const { delta, hasProfit } = calculatePositionDelta(triggerPrice, position);\r\n      if (hasProfit && delta.eq(0)) {\r\n        return \"Invalid price, see warning\";\r\n      }\r\n    }\r\n\r\n    if (order.type !== SWAP && indexTokenMarkPrice && !savedShouldDisableValidationForTesting) {\r\n      if (order.triggerAboveThreshold && indexTokenMarkPrice.gt(triggerPrice)) {\r\n        return \"Price below Mark Price\";\r\n      }\r\n      if (!order.triggerAboveThreshold && indexTokenMarkPrice.lt(triggerPrice)) {\r\n        return \"Price above Mark Price\";\r\n      }\r\n    }\r\n\r\n    if (order.type === SWAP) {\r\n      const currentRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n      if (currentRate && !currentRate.gte(triggerRatio)) {\r\n        return `Price is ${triggerRatioInverted ? \"below\" : \"above\"} Mark Price`;\r\n      }\r\n    }\r\n  };\r\n\r\n  const renderMinProfitWarning = () => {\r\n    if (MIN_PROFIT_TIME === 0 || order.type === SWAP || !position || !triggerPrice || triggerPrice.eq(0)) {\r\n      return null;\r\n    }\r\n\r\n    const { delta, pendingDelta, pendingDeltaPercentage, hasProfit } = calculatePositionDelta(triggerPrice, position);\r\n    if (hasProfit && delta.eq(0)) {\r\n      const { deltaStr } = getDeltaStr({\r\n        delta: pendingDelta,\r\n        deltaPercentage: pendingDeltaPercentage,\r\n        hasProfit,\r\n      });\r\n      const profitPrice = getProfitPrice(triggerPrice, position);\r\n      const minProfitExpiration = position.lastIncreasedTime + MIN_PROFIT_TIME;\r\n      return (\r\n        <div className=\"Confirmation-box-warning\">\r\n          This order will forfeit a&nbsp;\r\n          <a href=\"https://gmxio.gitbook.io/gmx/trading#minimum-price-change\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            profit\r\n          </a>{\" \"}\r\n          of {deltaStr}. <br />\r\n          Profit price: {position.isLong ? \">\" : \"<\"} ${formatAmount(profitPrice, USD_DECIMALS, 2, true)}. This rule\r\n          only applies for the next {getTimeRemaining(minProfitExpiration)}, until {formatDateTime(minProfitExpiration)}\r\n          .\r\n        </div>\r\n      );\r\n    }\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    const error = getError();\r\n    if (error) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    const error = getError();\r\n    if (error) {\r\n      return error;\r\n    }\r\n\r\n    if (isSubmitting) {\r\n      return \"Updating Order...\";\r\n    }\r\n    return \"Update Order\";\r\n  };\r\n\r\n  if (order.type !== SWAP) {\r\n    const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n    return (\r\n      <Modal\r\n        isVisible={true}\r\n        className=\"Exchange-list-modal\"\r\n        setIsVisible={() => setEditingOrder(null)}\r\n        label=\"Edit order\"\r\n      >\r\n        {renderMinProfitWarning()}\r\n        <div className=\"Exchange-swap-section\">\r\n          <div className=\"Exchange-swap-section-top\">\r\n            <div className=\"muted\">Price</div>\r\n            <div\r\n              className=\"muted align-right clickable\"\r\n              onClick={() => {\r\n                setTriggerPriceValue(formatAmountFree(indexTokenMarkPrice, USD_DECIMALS, 2));\r\n              }}\r\n            >\r\n              Mark: {formatAmount(indexTokenMarkPrice, USD_DECIMALS, 2)}\r\n            </div>\r\n          </div>\r\n          <div className=\"Exchange-swap-section-bottom\">\r\n            <div className=\"Exchange-swap-input-container\">\r\n              <input\r\n                type=\"number\"\r\n                min=\"0\"\r\n                placeholder=\"0.0\"\r\n                className=\"Exchange-swap-input\"\r\n                value={triggerPriceValue}\r\n                onChange={onTriggerPriceChange}\r\n              />\r\n            </div>\r\n            <div className=\"PositionEditor-token-symbol\">USD</div>\r\n          </div>\r\n        </div>\r\n        <ExchangeInfoRow label=\"Price\">\r\n          {triggerPrice && !triggerPrice.eq(order.triggerPrice) ? (\r\n            <>\r\n              <span className=\"muted\">\r\n                {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n              </span>\r\n              &nbsp;\r\n              <BsArrowRight />\r\n              &nbsp;\r\n              {triggerPricePrefix} {formatAmount(triggerPrice, USD_DECIMALS, 2, true)}\r\n            </>\r\n          ) : (\r\n            <span>\r\n              {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n            </span>\r\n          )}\r\n        </ExchangeInfoRow>\r\n        {liquidationPrice && (\r\n          <div className=\"Exchange-info-row\">\r\n            <div className=\"Exchange-info-label\">Liq. Price</div>\r\n            <div className=\"align-right\">{`$${formatAmount(liquidationPrice, USD_DECIMALS, 2, true)}`}</div>\r\n          </div>\r\n        )}\r\n        <div className=\"Exchange-swap-button-container\">\r\n          <button\r\n            className=\"App-cta Exchange-swap-button Exchange-list-modal-button\"\r\n            onClick={onClickPrimary}\r\n            disabled={!isPrimaryEnabled()}\r\n          >\r\n            {getPrimaryText()}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      isVisible={true}\r\n      className=\"Exchange-list-modal\"\r\n      setIsVisible={() => setEditingOrder(null)}\r\n      label=\"Edit order\"\r\n    >\r\n      <div className=\"Exchange-swap-section\">\r\n        <div className=\"Exchange-swap-section-top\">\r\n          <div className=\"muted\">Price</div>\r\n          {fromTokenInfo && toTokenInfo && (\r\n            <div\r\n              className=\"muted align-right clickable\"\r\n              onClick={() => {\r\n                setTriggerRatioValue(\r\n                  formatAmountFree(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 10)\r\n                );\r\n              }}\r\n            >\r\n              Mark Price:{\" \"}\r\n              {formatAmount(getExchangeRate(fromTokenInfo, toTokenInfo, triggerRatioInverted), USD_DECIMALS, 2)}\r\n            </div>\r\n          )}\r\n        </div>\r\n        <div className=\"Exchange-swap-section-bottom\">\r\n          <div className=\"Exchange-swap-input-container\">\r\n            <input\r\n              type=\"number\"\r\n              min=\"0\"\r\n              placeholder=\"0.0\"\r\n              className=\"Exchange-swap-input\"\r\n              value={triggerRatioValue}\r\n              onChange={onTriggerRatioChange}\r\n            />\r\n          </div>\r\n          {(() => {\r\n            if (!toTokenInfo) return;\r\n            if (!fromTokenInfo) return;\r\n            const [tokenA, tokenB] = triggerRatioInverted ? [toTokenInfo, fromTokenInfo] : [fromTokenInfo, toTokenInfo];\r\n            return (\r\n              <div className=\"PositionEditor-token-symbol\">\r\n                {tokenA.symbol}&nbsp;/&nbsp;{tokenB.symbol}\r\n              </div>\r\n            );\r\n          })()}\r\n        </div>\r\n      </div>\r\n      <ExchangeInfoRow label=\"Minimum received\">\r\n        {triggerRatio && !triggerRatio.eq(order.triggerRatio) ? (\r\n          <>\r\n            <span className=\"muted\">{formatAmount(order.minOut, toTokenInfo.decimals, 4, true)}</span>\r\n            &nbsp;\r\n            <BsArrowRight />\r\n            &nbsp;\r\n            {formatAmount(toAmount, toTokenInfo.decimals, 4, true)}\r\n          </>\r\n        ) : (\r\n          formatAmount(order.minOut, toTokenInfo.decimals, 4, true)\r\n        )}\r\n        &nbsp;{toTokenInfo.symbol}\r\n      </ExchangeInfoRow>\r\n      <ExchangeInfoRow label=\"Price\">\r\n        {triggerRatio && !triggerRatio.eq(0) && !triggerRatio.eq(order.triggerRatio) ? (\r\n          <>\r\n            <span className=\"muted\">\r\n              {getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo, {\r\n                omitSymbols: !triggerRatio || !triggerRatio.eq(order.triggerRatio),\r\n              })}\r\n            </span>\r\n            &nbsp;\r\n            <BsArrowRight />\r\n            &nbsp;\r\n            {getExchangeRateDisplay(triggerRatio, fromTokenInfo, toTokenInfo)}\r\n          </>\r\n        ) : (\r\n          getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo, {\r\n            omitSymbols: !triggerRatio || !triggerRatio.eq(order.triggerRatio),\r\n          })\r\n        )}\r\n      </ExchangeInfoRow>\r\n      {fromTokenInfo && (\r\n        <div className=\"Exchange-info-row\">\r\n          <div className=\"Exchange-info-label\">{fromTokenInfo.symbol} price</div>\r\n          <div className=\"align-right\">{formatAmount(fromTokenInfo.minPrice, USD_DECIMALS, 2, true)} USD</div>\r\n        </div>\r\n      )}\r\n      {toTokenInfo && (\r\n        <div className=\"Exchange-info-row\">\r\n          <div className=\"Exchange-info-label\">{toTokenInfo.symbol} price</div>\r\n          <div className=\"align-right\">{formatAmount(toTokenInfo.maxPrice, USD_DECIMALS, 2, true)} USD</div>\r\n        </div>\r\n      )}\r\n      <div className=\"Exchange-swap-button-container\">\r\n        <button\r\n          className=\"App-cta Exchange-swap-button Exchange-list-modal-button\"\r\n          onClick={onClickPrimary}\r\n          disabled={!isPrimaryEnabled()}\r\n        >\r\n          {getPrimaryText()}\r\n        </button>\r\n      </div>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useState, useCallback } from \"react\";\r\nimport { Trans } from \"@lingui/macro\";\r\n\r\nimport {\r\n  SWAP,\r\n  INCREASE,\r\n  DECREASE,\r\n  USD_DECIMALS,\r\n  formatAmount,\r\n  getOrderError,\r\n  TRIGGER_PREFIX_ABOVE,\r\n  TRIGGER_PREFIX_BELOW,\r\n  getExchangeRateDisplay,\r\n  getTokenInfo,\r\n  getExchangeRate,\r\n  getPositionForOrder,\r\n  getUsd,\r\n} from \"../../lib/legacy.js\";\r\nimport { handleCancelOrder } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\nimport OrderEditor from \"./OrderEditor\";\r\n\r\nimport \"./OrdersList.css\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\n\r\nexport default function OrdersList(props) {\r\n  const {\r\n    account,\r\n    library,\r\n    setPendingTxns,\r\n    pendingTxns,\r\n    infoTokens,\r\n    positionsMap,\r\n    totalTokenWeights,\r\n    usdgSupply,\r\n    orders,\r\n    hideActions,\r\n    chainId,\r\n    savedShouldDisableValidationForTesting,\r\n    cancelOrderIdList,\r\n    setCancelOrderIdList,\r\n  } = props;\r\n\r\n  const [editingOrder, setEditingOrder] = useState(null);\r\n\r\n  const onCancelClick = useCallback(\r\n    (order) => {\r\n      handleCancelOrder(chainId, library, order, { pendingTxns, setPendingTxns });\r\n    },\r\n    [library, pendingTxns, setPendingTxns, chainId]\r\n  );\r\n\r\n  const onEditClick = useCallback(\r\n    (order) => {\r\n      setEditingOrder(order);\r\n    },\r\n    [setEditingOrder]\r\n  );\r\n\r\n  const renderHead = useCallback(() => {\r\n    const isAllOrdersSelected = cancelOrderIdList?.length > 0 && cancelOrderIdList?.length === orders.length;\r\n    return (\r\n      <tr className=\"Exchange-list-header\">\r\n        {orders.length > 0 && (\r\n          <th>\r\n            <div className=\"checkbox-inline \">\r\n              <Checkbox\r\n                isChecked={isAllOrdersSelected}\r\n                setIsChecked={() => {\r\n                  if (isAllOrdersSelected) {\r\n                    setCancelOrderIdList([]);\r\n                  } else {\r\n                    const allOrderIds = orders.map((o) => `${o.type}-${o.index}`);\r\n                    setCancelOrderIdList(allOrderIds);\r\n                  }\r\n                }}\r\n              />\r\n            </div>\r\n          </th>\r\n        )}\r\n\r\n        <th>\r\n          <div>\r\n            <Trans>Type</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Order</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Price</Trans>\r\n          </div>\r\n        </th>\r\n        <th>\r\n          <div>\r\n            <Trans>Mark Price</Trans>\r\n          </div>\r\n        </th>\r\n      </tr>\r\n    );\r\n  }, [cancelOrderIdList, orders, setCancelOrderIdList]);\r\n\r\n  const renderEmptyRow = useCallback(() => {\r\n    if (orders && orders.length) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <tr>\r\n        <td colSpan=\"5\" className=\"Exchange-list-empty-note\">\r\n          <Trans>No open orders</Trans>\r\n        </td>\r\n      </tr>\r\n    );\r\n  }, [orders]);\r\n\r\n  const renderActions = useCallback(\r\n    (order) => {\r\n      return (\r\n        <>\r\n          <td>\r\n            <button className=\"Exchange-list-action\" onClick={() => onEditClick(order)}>\r\n              <Trans>Edit</Trans>\r\n            </button>\r\n          </td>\r\n          <td>\r\n            <button className=\"Exchange-list-action\" onClick={() => onCancelClick(order)}>\r\n              <Trans>Cancel</Trans>\r\n            </button>\r\n          </td>\r\n        </>\r\n      );\r\n    },\r\n    [onEditClick, onCancelClick]\r\n  );\r\n\r\n  const renderLargeList = useCallback(() => {\r\n    if (!orders || !orders.length) {\r\n      return null;\r\n    }\r\n    return orders.map((order) => {\r\n      if (order.type === SWAP) {\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromTokenInfo = getTokenInfo(infoTokens, order.path[0], true, nativeTokenAddress);\r\n        const toTokenInfo = getTokenInfo(\r\n          infoTokens,\r\n          order.path[order.path.length - 1],\r\n          order.shouldUnwrap,\r\n          nativeTokenAddress\r\n        );\r\n\r\n        const markExchangeRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n        const orderId = `${order.type}-${order.index}`;\r\n\r\n        return (\r\n          <tr className=\"Exchange-list-item\" key={orderId}>\r\n            <td>\r\n              <div className=\"checkbox-inline \">\r\n                <Checkbox\r\n                  isChecked={cancelOrderIdList?.includes(orderId)}\r\n                  setIsChecked={() => {\r\n                    setCancelOrderIdList((prevState) => {\r\n                      if (prevState.includes(orderId)) {\r\n                        return prevState.filter((i) => i !== orderId);\r\n                      } else {\r\n                        return prevState.concat(orderId);\r\n                      }\r\n                    });\r\n                  }}\r\n                />\r\n              </div>\r\n            </td>\r\n            <td className=\"Exchange-list-item-type\">Limit</td>\r\n            <td>\r\n              Swap{\" \"}\r\n              {formatAmount(\r\n                order.amountIn,\r\n                fromTokenInfo.decimals,\r\n                fromTokenInfo.isStable || fromTokenInfo.isUsdg ? 2 : 4,\r\n                true\r\n              )}{\" \"}\r\n              {fromTokenInfo.symbol} for{\" \"}\r\n              {formatAmount(\r\n                order.minOut,\r\n                toTokenInfo.decimals,\r\n                toTokenInfo.isStable || toTokenInfo.isUsdg ? 2 : 4,\r\n                true\r\n              )}{\" \"}\r\n              {toTokenInfo.symbol}\r\n            </td>\r\n            <td>\r\n              <Tooltip\r\n                handle={getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo)}\r\n                renderContent={() => `\r\n                  You will receive at least ${formatAmount(\r\n                    order.minOut,\r\n                    toTokenInfo.decimals,\r\n                    toTokenInfo.isStable || toTokenInfo.isUsdg ? 2 : 4,\r\n                    true\r\n                  )} ${\r\n                  toTokenInfo.symbol\r\n                } if this order is executed. The execution price may vary depending on swap fees at the time the order is executed.\r\n                `}\r\n              />\r\n            </td>\r\n            <td>{getExchangeRateDisplay(markExchangeRate, fromTokenInfo, toTokenInfo, true)}</td>\r\n            {!hideActions && renderActions(order)}\r\n          </tr>\r\n        );\r\n      }\r\n\r\n      const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n\r\n      // Longs Increase: max price\r\n      // Longs Decrease: min price\r\n      // Short Increase: min price\r\n      // Short Decrease: max price\r\n      const maximisePrice = (order.type === INCREASE && order.isLong) || (order.type === DECREASE && !order.isLong);\r\n\r\n      const markPrice = maximisePrice ? indexToken.contractMaxPrice : indexToken.contractMinPrice;\r\n      const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n      const indexTokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n\r\n      const error = getOrderError(account, order, positionsMap);\r\n      const orderId = `${order.type}-${order.index}`;\r\n      const orderText = (\r\n        <>\r\n          {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n          &nbsp;by ${formatAmount(order.sizeDelta, USD_DECIMALS, 2, true)}\r\n          {error && <div className=\"Exchange-list-item-error\">{error}</div>}\r\n        </>\r\n      );\r\n\r\n      return (\r\n        <tr className=\"Exchange-list-item\" key={`${order.isLong}-${order.type}-${order.index}`}>\r\n          <td className=\"Exchange-list-item-type\">\r\n            <div>\r\n              <Checkbox\r\n                isChecked={cancelOrderIdList?.includes(orderId)}\r\n                setIsChecked={() => {\r\n                  setCancelOrderIdList((prevState) => {\r\n                    if (prevState.includes(orderId)) {\r\n                      return prevState.filter((i) => i !== orderId);\r\n                    } else {\r\n                      return prevState.concat(orderId);\r\n                    }\r\n                  });\r\n                }}\r\n              />\r\n            </div>\r\n          </td>\r\n          <td className=\"Exchange-list-item-type\">{order.type === INCREASE ? \"Limit\" : \"Trigger\"}</td>\r\n          <td>\r\n            {order.type === DECREASE ? (\r\n              orderText\r\n            ) : (\r\n              <Tooltip\r\n                handle={orderText}\r\n                position=\"right-bottom\"\r\n                renderContent={() => {\r\n                  const collateralTokenInfo = getTokenInfo(infoTokens, order.purchaseToken);\r\n                  const collateralUSD = getUsd(order.purchaseTokenAmount, order.purchaseToken, false, infoTokens);\r\n                  return (\r\n                    <StatsTooltipRow\r\n                      label=\"Collateral\"\r\n                      value={`${formatAmount(collateralUSD, USD_DECIMALS, 2, true)} (${formatAmount(\r\n                        order.purchaseTokenAmount,\r\n                        collateralTokenInfo.decimals,\r\n                        4,\r\n                        true\r\n                      )}\r\n                      ${collateralTokenInfo.baseSymbol || collateralTokenInfo.symbol})`}\r\n                    />\r\n                  );\r\n                }}\r\n              />\r\n            )}\r\n          </td>\r\n          <td>\r\n            {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n          </td>\r\n          <td>\r\n            <Tooltip\r\n              handle={formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n              position=\"right-bottom\"\r\n              renderContent={() => {\r\n                return (\r\n                  <Trans>\r\n                    The price that orders can be executed at may differ slightly from the chart price, as market orders\r\n                    update oracle prices, while limit/trigger orders do not.\r\n                  </Trans>\r\n                );\r\n              }}\r\n            />\r\n          </td>\r\n          {!hideActions && renderActions(order)}\r\n        </tr>\r\n      );\r\n    });\r\n  }, [\r\n    orders,\r\n    renderActions,\r\n    infoTokens,\r\n    positionsMap,\r\n    hideActions,\r\n    chainId,\r\n    account,\r\n    cancelOrderIdList,\r\n    setCancelOrderIdList,\r\n  ]);\r\n\r\n  const renderSmallList = useCallback(() => {\r\n    if (!orders || !orders.length) {\r\n      return null;\r\n    }\r\n\r\n    return orders.map((order) => {\r\n      if (order.type === SWAP) {\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromTokenInfo = getTokenInfo(infoTokens, order.path[0], true, nativeTokenAddress);\r\n        const toTokenInfo = getTokenInfo(\r\n          infoTokens,\r\n          order.path[order.path.length - 1],\r\n          order.shouldUnwrap,\r\n          nativeTokenAddress\r\n        );\r\n        const markExchangeRate = getExchangeRate(fromTokenInfo, toTokenInfo);\r\n\r\n        return (\r\n          <div key={`${order.type}-${order.index}`} className=\"App-card\">\r\n            <div className=\"App-card-title-small\">\r\n              Swap {formatAmount(order.amountIn, fromTokenInfo.decimals, fromTokenInfo.isStable ? 2 : 4, true)}{\" \"}\r\n              {fromTokenInfo.symbol} for{\" \"}\r\n              {formatAmount(order.minOut, toTokenInfo.decimals, toTokenInfo.isStable ? 2 : 4, true)}{\" \"}\r\n              {toTokenInfo.symbol}\r\n            </div>\r\n            <div className=\"App-card-divider\"></div>\r\n            <div className=\"App-card-content\">\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">Price</div>\r\n                <div>\r\n                  <Tooltip\r\n                    position=\"right-bottom\"\r\n                    handle={getExchangeRateDisplay(order.triggerRatio, fromTokenInfo, toTokenInfo)}\r\n                    renderContent={() => `\r\n                    You will receive at least ${formatAmount(\r\n                      order.minOut,\r\n                      toTokenInfo.decimals,\r\n                      toTokenInfo.isStable || toTokenInfo.isUsdg ? 2 : 4,\r\n                      true\r\n                    )} ${\r\n                      toTokenInfo.symbol\r\n                    } if this order is executed. The exact execution price may vary depending on fees at the time the order is executed.\r\n                  `}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Mark Price</Trans>\r\n                </div>\r\n                <div>{getExchangeRateDisplay(markExchangeRate, fromTokenInfo, toTokenInfo)}</div>\r\n              </div>\r\n              {!hideActions && (\r\n                <>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-options\">\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => onEditClick(order)}>\r\n                      <Trans>Edit</Trans>\r\n                    </button>\r\n                    <button className=\"App-button-option App-card-option\" onClick={() => onCancelClick(order)}>\r\n                      <Trans>Cancel</Trans>\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n      const maximisePrice = (order.type === INCREASE && order.isLong) || (order.type === DECREASE && !order.isLong);\r\n      const markPrice = maximisePrice ? indexToken.contractMaxPrice : indexToken.contractMinPrice;\r\n      const triggerPricePrefix = order.triggerAboveThreshold ? TRIGGER_PREFIX_ABOVE : TRIGGER_PREFIX_BELOW;\r\n      const indexTokenSymbol = indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol;\r\n\r\n      const collateralTokenInfo = getTokenInfo(infoTokens, order.purchaseToken);\r\n      const collateralUSD = getUsd(order.purchaseTokenAmount, order.purchaseToken, true, infoTokens);\r\n\r\n      const error = getOrderError(account, order, positionsMap);\r\n\r\n      return (\r\n        <div key={`${order.isLong}-${order.type}-${order.index}`} className=\"App-card\">\r\n          <div className=\"App-card-title-small\">\r\n            {order.type === INCREASE ? \"Increase\" : \"Decrease\"} {indexTokenSymbol} {order.isLong ? \"Long\" : \"Short\"}\r\n            &nbsp;by ${formatAmount(order.sizeDelta, USD_DECIMALS, 2, true)}\r\n            {error && <div className=\"Exchange-list-item-error\">{error}</div>}\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"App-card-content\">\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div>\r\n                {triggerPricePrefix} {formatAmount(order.triggerPrice, USD_DECIMALS, 2, true)}\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Mark Price</Trans>\r\n              </div>\r\n              <div>\r\n                <Tooltip\r\n                  handle={formatAmount(markPrice, USD_DECIMALS, 2, true)}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <Trans>\r\n                        The price that the order can be executed at may differ slightly from the chart price as market\r\n                        orders can change the price while limit / trigger orders cannot.\r\n                      </Trans>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            {order.type === INCREASE && (\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Collateral</Trans>\r\n                </div>\r\n                <div>\r\n                  ${formatAmount(collateralUSD, USD_DECIMALS, 2, true)} (\r\n                  {formatAmount(order.purchaseTokenAmount, collateralTokenInfo.decimals, 4, true)}{\" \"}\r\n                  {collateralTokenInfo.baseSymbol || collateralTokenInfo.symbol})\r\n                </div>\r\n              </div>\r\n            )}\r\n            {!hideActions && (\r\n              <>\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-options\">\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onEditClick(order)}>\r\n                    <Trans>Edit</Trans>\r\n                  </button>\r\n                  <button className=\"App-button-option App-card-option\" onClick={() => onCancelClick(order)}>\r\n                    <Trans>Cancel</Trans>\r\n                  </button>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    });\r\n  }, [orders, onEditClick, onCancelClick, infoTokens, positionsMap, hideActions, chainId, account]);\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <table className=\"Exchange-list Orders App-box large\">\r\n        <tbody>\r\n          {renderHead()}\r\n          {renderEmptyRow()}\r\n          {renderLargeList()}\r\n        </tbody>\r\n      </table>\r\n      <div className=\"Exchange-list Orders small\">\r\n        {(!orders || orders.length === 0) && (\r\n          <div className=\"Exchange-empty-positions-list-note App-card\">No open orders</div>\r\n        )}\r\n        {renderSmallList()}\r\n      </div>\r\n      {editingOrder && (\r\n        <OrderEditor\r\n          account={account}\r\n          order={editingOrder}\r\n          setEditingOrder={setEditingOrder}\r\n          infoTokens={infoTokens}\r\n          pendingTxns={pendingTxns}\r\n          setPendingTxns={setPendingTxns}\r\n          getPositionForOrder={getPositionForOrder}\r\n          positionsMap={positionsMap}\r\n          library={library}\r\n          totalTokenWeights={totalTokenWeights}\r\n          usdgSupply={usdgSupply}\r\n          savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n        />\r\n      )}\r\n    </React.Fragment>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useCallback, useMemo } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Tooltip from \"../../components/Tooltip/Tooltip\";\r\n\r\nimport {\r\n  USD_DECIMALS,\r\n  MAX_LEVERAGE,\r\n  BASIS_POINTS_DIVISOR,\r\n  LIQUIDATION_FEE,\r\n  TRADES_PAGE_SIZE,\r\n  formatAmount,\r\n  getExplorerUrl,\r\n  formatDateTime,\r\n  deserialize,\r\n  getExchangeRateDisplay,\r\n  bigNumberify,\r\n} from \"../../lib/legacy\";\r\nimport { useTrades, useLiquidationsData } from \"../../domain/legacy\";\r\nimport { getContract } from \"../../config/Addresses\";\r\n\r\nimport \"./TradeHistory.css\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getPositionDisplay(increase, indexToken, isLong, sizeDelta) {\r\n  const symbol = indexToken ? (indexToken.isWrapped ? indexToken.baseSymbol : indexToken.symbol) : \"\";\r\n  return `\r\n    ${increase ? \"Increase\" : \"Decrease\"} ${symbol} ${isLong ? \"Long\" : \"Short\"}\r\n    ${increase ? \"+\" : \"-\"}${formatAmount(sizeDelta, USD_DECIMALS, 2, true)} USD`;\r\n}\r\n\r\nfunction getOrderActionTitle(action) {\r\n  let actionDisplay;\r\n\r\n  if (action.startsWith(\"Create\")) {\r\n    actionDisplay = \"Create\";\r\n  } else if (action.startsWith(\"Cancel\")) {\r\n    actionDisplay = \"Cancel\";\r\n  } else {\r\n    actionDisplay = \"Update\";\r\n  }\r\n\r\n  return `${actionDisplay} Order`;\r\n}\r\n\r\nfunction renderLiquidationTooltip(liquidationData, label) {\r\n  const minCollateral = liquidationData.size.mul(BASIS_POINTS_DIVISOR).div(MAX_LEVERAGE);\r\n  const text =\r\n    liquidationData.type === \"full\"\r\n      ? \"This position was liquidated as the max leverage of 100x was exceeded\"\r\n      : \"Max leverage of 100x was exceeded, the remaining collateral after deducting losses and fees have been sent back to your account\";\r\n  return (\r\n    <Tooltip\r\n      position=\"left-top\"\r\n      handle={label}\r\n      renderContent={() => (\r\n        <>\r\n          {text}\r\n          <br />\r\n          <br />\r\n          Initial collateral: ${formatAmount(liquidationData.collateral, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          Min required collateral: ${formatAmount(minCollateral, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          Borrow fee: ${formatAmount(liquidationData.borrowFee, USD_DECIMALS, 2, true)}\r\n          <br />\r\n          PnL: -${formatAmount(liquidationData.loss, USD_DECIMALS, 2, true)}\r\n          {liquidationData.type === \"full\" && <div>Liquidation fee: ${formatAmount(LIQUIDATION_FEE, 30, 2, true)}</div>}\r\n        </>\r\n      )}\r\n    />\r\n  );\r\n}\r\n\r\nfunction getLiquidationData(liquidationsDataMap, key, timestamp) {\r\n  return liquidationsDataMap && liquidationsDataMap[`${key}:${timestamp}`];\r\n}\r\n\r\nexport default function TradeHistory(props) {\r\n  const { account, infoTokens, getTokenInfo, chainId, nativeTokenAddress, shouldShowPaginationButtons } = props;\r\n  const [pageIds, setPageIds] = useState({});\r\n  const [pageIndex, setPageIndex] = useState(0);\r\n\r\n  const getAfterId = () => {\r\n    return pageIds[pageIndex];\r\n  };\r\n\r\n  const { trades, updateTrades } = useTrades(chainId, account, props.forSingleAccount, getAfterId());\r\n\r\n  const liquidationsData = useLiquidationsData(chainId, account);\r\n  const liquidationsDataMap = useMemo(() => {\r\n    if (!liquidationsData) {\r\n      return null;\r\n    }\r\n    return liquidationsData.reduce((memo, item) => {\r\n      const liquidationKey = `${item.key}:${item.timestamp}`;\r\n      memo[liquidationKey] = item;\r\n      return memo;\r\n    }, {});\r\n  }, [liquidationsData]);\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      updateTrades(undefined, true);\r\n    }, 10 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [updateTrades]);\r\n\r\n  const loadNextPage = () => {\r\n    if (!trades || trades.length === 0) {\r\n      return;\r\n    }\r\n\r\n    const lastTrade = trades[trades.length - 1];\r\n    pageIds[pageIndex + 1] = lastTrade.id;\r\n    setPageIds(pageIds);\r\n    setPageIndex(pageIndex + 1);\r\n  };\r\n\r\n  const loadPrevPage = () => {\r\n    setPageIndex(pageIndex - 1);\r\n  };\r\n\r\n  const getMsg = useCallback(\r\n    (trade) => {\r\n      const tradeData = trade.data;\r\n      const params = JSON.parse(tradeData.params);\r\n      const defaultMsg = \"\";\r\n\r\n      if (tradeData.action === \"BuyUSDG\") {\r\n        const token = getTokenInfo(infoTokens, params.token, true, nativeTokenAddress);\r\n        if (!token) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.tokenAmount, token.decimals, 4, true)} ${token.symbol} for ${formatAmount(\r\n          params.usdgAmount,\r\n          18,\r\n          4,\r\n          true\r\n        )} USDG`;\r\n      }\r\n\r\n      if (tradeData.action === \"SellUSDG\") {\r\n        const token = getTokenInfo(infoTokens, params.token, true, nativeTokenAddress);\r\n        if (!token) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.usdgAmount, 18, 4, true)} USDG for ${formatAmount(\r\n          params.tokenAmount,\r\n          token.decimals,\r\n          4,\r\n          true\r\n        )} ${token.symbol}`;\r\n      }\r\n\r\n      if (tradeData.action === \"Swap\") {\r\n        const tokenIn = getTokenInfo(infoTokens, params.tokenIn, true, nativeTokenAddress);\r\n        const tokenOut = getTokenInfo(infoTokens, params.tokenOut, true, nativeTokenAddress);\r\n        if (!tokenIn || !tokenOut) {\r\n          return defaultMsg;\r\n        }\r\n        return `Swap ${formatAmount(params.amountIn, tokenIn.decimals, 4, true)} ${tokenIn.symbol} for ${formatAmount(\r\n          params.amountOut,\r\n          tokenOut.decimals,\r\n          4,\r\n          true\r\n        )} ${tokenOut.symbol}`;\r\n      }\r\n\r\n      if (tradeData.action === \"CreateIncreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Request deposit into ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return `Request increase ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, Acceptable Price: ${params.isLong ? \"<\" : \">\"} ${formatAmount(\r\n          params.acceptablePrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"CreateDecreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Request withdrawal from ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return `Request decrease ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, -${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, Acceptable Price: ${params.isLong ? \">\" : \"<\"} ${formatAmount(\r\n          params.acceptablePrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"CancelIncreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return (\r\n            <>\r\n              Could not execute deposit into {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"}\r\n            </>\r\n          );\r\n        }\r\n\r\n        return (\r\n          <>\r\n            Could not increase {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"},\r\n            {`+${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)}`} USD, Acceptable Price:&nbsp;\r\n            {params.isLong ? \"<\" : \">\"}&nbsp;\r\n            <Tooltip\r\n              position=\"left-top\"\r\n              handle={`${formatAmount(params.acceptablePrice, USD_DECIMALS, 2, true)} USD`}\r\n              renderContent={() => <>Try increasing the \"Allowed Slippage\", under the Settings menu on the top right</>}\r\n            />\r\n          </>\r\n        );\r\n      }\r\n\r\n      if (tradeData.action === \"CancelDecreasePosition\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Could not execute withdrawal from ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n\r\n        return (\r\n          <>\r\n            Could not decrease {indexToken.symbol} {params.isLong ? \"Long\" : \"Short\"},\r\n            {`+${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)}`} USD, Acceptable Price:&nbsp;\r\n            {params.isLong ? \">\" : \"<\"}&nbsp;\r\n            <Tooltip\r\n              position=\"left-top\"\r\n              handle={`${formatAmount(params.acceptablePrice, USD_DECIMALS, 2, true)} USD`}\r\n              renderContent={() => <>Try increasing the \"Allowed Slippage\", under the Settings menu on the top right</>}\r\n            />\r\n          </>\r\n        );\r\n      }\r\n\r\n      if (tradeData.action === \"IncreasePosition-Long\" || tradeData.action === \"IncreasePosition-Short\") {\r\n        if (params.flags?.isOrderExecution) {\r\n          return;\r\n        }\r\n\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Deposit ${formatAmount(params.collateralDelta, USD_DECIMALS, 2, true)} USD into ${\r\n            indexToken.symbol\r\n          } ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n        return `Increase ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          params.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD, ${indexToken.symbol} Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD`;\r\n      }\r\n\r\n      if (tradeData.action === \"DecreasePosition-Long\" || tradeData.action === \"DecreasePosition-Short\") {\r\n        if (params.flags?.isOrderExecution) {\r\n          return;\r\n        }\r\n\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        if (bigNumberify(params.sizeDelta).eq(0)) {\r\n          return `Withdraw ${formatAmount(params.collateralDelta, USD_DECIMALS, 2, true)} USD from ${\r\n            indexToken.symbol\r\n          } ${params.isLong ? \"Long\" : \"Short\"}`;\r\n        }\r\n        const isLiquidation = params.flags?.isLiquidation;\r\n        const liquidationData = getLiquidationData(liquidationsDataMap, params.key, tradeData.timestamp);\r\n\r\n        if (isLiquidation && liquidationData) {\r\n          return (\r\n            <>\r\n              {renderLiquidationTooltip(liquidationData, \"Partial Liquidation\")} {indexToken.symbol}{\" \"}\r\n              {params.isLong ? \"Long\" : \"Short\"}, -{formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)} USD,{\" \"}\r\n              {indexToken.symbol}&nbsp; Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD\r\n            </>\r\n          );\r\n        }\r\n        const actionDisplay = isLiquidation ? \"Partially Liquidated\" : \"Decreased\";\r\n        return `\r\n        ${actionDisplay} ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"},\r\n        -${formatAmount(params.sizeDelta, USD_DECIMALS, 2, true)} USD,\r\n        ${indexToken.symbol} Price: ${formatAmount(params.price, USD_DECIMALS, 2, true)} USD\r\n      `;\r\n      }\r\n\r\n      if (tradeData.action === \"LiquidatePosition-Long\" || tradeData.action === \"LiquidatePosition-Short\") {\r\n        const indexToken = getTokenInfo(infoTokens, params.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const liquidationData = getLiquidationData(liquidationsDataMap, params.key, tradeData.timestamp);\r\n        if (liquidationData) {\r\n          return (\r\n            <>\r\n              {renderLiquidationTooltip(liquidationData, \"Liquidated\")} {indexToken.symbol}{\" \"}\r\n              {params.isLong ? \"Long\" : \"Short\"}, -{formatAmount(params.size, USD_DECIMALS, 2, true)} USD,&nbsp;\r\n              {indexToken.symbol} Price: ${formatAmount(params.markPrice, USD_DECIMALS, 2, true)} USD\r\n            </>\r\n          );\r\n        }\r\n        return `\r\n        Liquidated ${indexToken.symbol} ${params.isLong ? \"Long\" : \"Short\"},\r\n        -${formatAmount(params.size, USD_DECIMALS, 2, true)} USD,\r\n        ${indexToken.symbol} Price: ${formatAmount(params.markPrice, USD_DECIMALS, 2, true)} USD\r\n      `;\r\n      }\r\n\r\n      if ([\"ExecuteIncreaseOrder\", \"ExecuteDecreaseOrder\"].includes(tradeData.action)) {\r\n        const order = deserialize(params.order);\r\n        const indexToken = getTokenInfo(infoTokens, order.indexToken, true, nativeTokenAddress);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const longShortDisplay = order.isLong ? \"Long\" : \"Short\";\r\n        const executionPriceDisplay = formatAmount(order.executionPrice, USD_DECIMALS, 2, true);\r\n        const sizeDeltaDisplay = `${order.type === \"Increase\" ? \"+\" : \"-\"}${formatAmount(\r\n          order.sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )}`;\r\n\r\n        return `\r\n        Execute Order: ${order.type} ${indexToken.symbol} ${longShortDisplay}\r\n        ${sizeDeltaDisplay} USD, Price: ${executionPriceDisplay} USD\r\n      `;\r\n      }\r\n\r\n      if (\r\n        [\r\n          \"CreateIncreaseOrder\",\r\n          \"CancelIncreaseOrder\",\r\n          \"UpdateIncreaseOrder\",\r\n          \"CreateDecreaseOrder\",\r\n          \"CancelDecreaseOrder\",\r\n          \"UpdateDecreaseOrder\",\r\n        ].includes(tradeData.action)\r\n      ) {\r\n        const order = deserialize(params.order);\r\n        const indexToken = getTokenInfo(infoTokens, order.indexToken);\r\n        if (!indexToken) {\r\n          return defaultMsg;\r\n        }\r\n        const increase = tradeData.action.includes(\"Increase\");\r\n        const priceDisplay = `${order.triggerAboveThreshold ? \">\" : \"<\"} ${formatAmount(\r\n          order.triggerPrice,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )}`;\r\n        return `\r\n        ${getOrderActionTitle(tradeData.action)}:\r\n        ${getPositionDisplay(increase, indexToken, order.isLong, order.sizeDelta)},\r\n        Price: ${priceDisplay}\r\n      `;\r\n      }\r\n\r\n      if (tradeData.action === \"ExecuteSwapOrder\") {\r\n        const order = deserialize(params.order);\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromToken = getTokenInfo(infoTokens, order.path[0] === nativeTokenAddress ? AddressZero : order.path[0]);\r\n        const toToken = getTokenInfo(infoTokens, order.shouldUnwrap ? AddressZero : order.path[order.path.length - 1]);\r\n        if (!fromToken || !toToken) {\r\n          return defaultMsg;\r\n        }\r\n        const fromAmountDisplay = formatAmount(order.amountIn, fromToken.decimals, fromToken.isStable ? 2 : 4, true);\r\n        const toAmountDisplay = formatAmount(order.amountOut, toToken.decimals, toToken.isStable ? 2 : 4, true);\r\n        return `\r\n        Execute Order: Swap ${fromAmountDisplay} ${fromToken.symbol} for ${toAmountDisplay} ${toToken.symbol}\r\n      `;\r\n      }\r\n\r\n      if ([\"CreateSwapOrder\", \"UpdateSwapOrder\", \"CancelSwapOrder\"].includes(tradeData.action)) {\r\n        const order = deserialize(params.order);\r\n        const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n        const fromToken = getTokenInfo(infoTokens, order.path[0] === nativeTokenAddress ? AddressZero : order.path[0]);\r\n        const toToken = getTokenInfo(infoTokens, order.shouldUnwrap ? AddressZero : order.path[order.path.length - 1]);\r\n        if (!fromToken || !toToken) {\r\n          return defaultMsg;\r\n        }\r\n        const amountInDisplay = fromToken\r\n          ? formatAmount(order.amountIn, fromToken.decimals, fromToken.isStable ? 2 : 4, true)\r\n          : \"\";\r\n        const minOutDisplay = toToken\r\n          ? formatAmount(order.minOut, toToken.decimals, toToken.isStable ? 2 : 4, true)\r\n          : \"\";\r\n\r\n        return `\r\n        ${getOrderActionTitle(tradeData.action)}:\r\n        Swap ${amountInDisplay} ${fromToken?.symbol || \"\"} for ${minOutDisplay} ${toToken?.symbol || \"\"},\r\n        Price: ${getExchangeRateDisplay(order.triggerRatio, fromToken, toToken)}`;\r\n      }\r\n    },\r\n    [getTokenInfo, infoTokens, nativeTokenAddress, chainId, liquidationsDataMap]\r\n  );\r\n\r\n  const tradesWithMessages = useMemo(() => {\r\n    if (!trades) {\r\n      return [];\r\n    }\r\n\r\n    return trades\r\n      .map((trade) => ({\r\n        msg: getMsg(trade),\r\n        ...trade,\r\n      }))\r\n      .filter((trade) => trade.msg);\r\n  }, [trades, getMsg]);\r\n\r\n  return (\r\n    <div className=\"TradeHistory\">\r\n      {tradesWithMessages.length === 0 && <div className=\"TradeHistory-row App-box Exchange-list-empty-note\">No trades yet</div>}\r\n      {tradesWithMessages.length > 0 &&\r\n        tradesWithMessages.map((trade, index) => {\r\n          const tradeData = trade.data;\r\n          const txUrl = getExplorerUrl(chainId) + \"tx/\" + tradeData.txhash;\r\n\r\n          let msg = getMsg(trade);\r\n\r\n          if (!msg) {\r\n            return null;\r\n          }\r\n\r\n          return (\r\n            <div className=\"TradeHistory-row App-box App-box-border\" key={index}>\r\n              <div>\r\n                <div className=\"muted TradeHistory-time\">\r\n                  {formatDateTime(tradeData.timestamp)}\r\n                  {(!account || account.length === 0) && (\r\n                    <span>\r\n                      {\" \"}\r\n                      (<Link to={`/actions/${tradeData.account}`}>{tradeData.account}</Link>)\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                <a className=\"plain\" href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  {msg}\r\n                </a>\r\n              </div>\r\n            </div>\r\n          );\r\n        })}\r\n      {shouldShowPaginationButtons && (\r\n        <div>\r\n          {pageIndex > 0 && (\r\n            <button className=\"App-button-option App-card-option\" onClick={loadPrevPage}>\r\n              Prev\r\n            </button>\r\n          )}\r\n          {trades && trades.length >= TRADES_PAGE_SIZE && (\r\n            <button className=\"App-button-option App-card-option\" onClick={loadNextPage}>\r\n              Next\r\n            </button>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport { formatAmount, expandDecimals, bigNumberify } from \"../../lib/legacy\";\r\n\r\nimport \"./ExchangeWalletTokens.css\";\r\n\r\nexport default function ExchangeWalletTokens(props) {\r\n  const { tokens, mintingCap, infoTokens, onSelectToken } = props;\r\n\r\n  return (\r\n    <div className=\"ExchangeWalletTokens App-box\">\r\n      {tokens.map((token) => {\r\n        let info = infoTokens ? infoTokens[token.address] : {};\r\n        let mintAmount;\r\n        let balance = info.balance;\r\n        if (mintingCap && info.usdgAmount) {\r\n          mintAmount = mintingCap.sub(info.usdgAmount);\r\n        }\r\n        if (mintAmount && mintAmount.lt(0)) {\r\n          mintAmount = bigNumberify(0);\r\n        }\r\n        let balanceUsd;\r\n        if (balance && info.maxPrice) {\r\n          balanceUsd = balance.mul(info.maxPrice).div(expandDecimals(1, token.decimals));\r\n        }\r\n        return (\r\n          <div className=\"ExchangeWalletTokens-token-row\" onClick={() => onSelectToken(token)} key={token.address}>\r\n            <div className=\"ExchangeWalletTokens-top-row\">\r\n              <div>{token.symbol}</div>\r\n              {balance && (\r\n                <div className=\"align-right\">\r\n                  {balance.gt(0) && formatAmount(balance, token.decimals, 4, true)}\r\n                  {balance.eq(0) && \"-\"}\r\n                </div>\r\n              )}\r\n            </div>\r\n            <div className=\"ExchangeWalletTokens-content-row\">\r\n              <div className=\"ExchangeWalletTokens-token-name\">{token.name}</div>\r\n              {balanceUsd && balanceUsd.gt(0) && (\r\n                <div className=\"align-right\">${formatAmount(balanceUsd, 30, 2, true)}</div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nimport \"./ExchangeBanner.css\";\r\n\r\nexport default function ExchangeBanner(props) {\r\n  const { hideBanner } = props;\r\n\r\n  return (\r\n    <div className=\"ExchangeBanner\">\r\n      <p className=\"ExchangeBanner-text\">\r\n        Trade on GMX and win <span className=\"ExchangeBanner-price\">$250.000</span> in prizes! Live until November 30th,{\" \"}\r\n        <a\r\n          href=\"https://medium.com/@gmx.io/gmx-trading-competition-win-250-000-usd-in-prizes-1346504b96f6\"\r\n          target=\"_blank\"\r\n          className=\"ExchangeBanner-link\"\r\n          rel=\"noreferrer\"\r\n        >\r\n          click here\r\n        </a>{\" \"}\r\n        to learn more.\r\n      </p>\r\n      <span\r\n        className=\"ExchangeBanner-close\"\r\n        onClick={(e) => {\r\n          hideBanner();\r\n        }}\r\n      >\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"11.25\" height=\"11.25\" viewBox=\"0 0 11.25 11.25\">\r\n          <path\r\n            id=\"ic_close\"\r\n            d=\"M11-2.565,6.818-6.75,11-10.935a.844.844,0,0,0,0-1.193.844.844,0,0,0-1.193,0L5.625-7.943,1.44-12.128a.844.844,0,0,0-1.193,0,.844.844,0,0,0,0,1.193L4.432-6.75.247-2.565a.844.844,0,0,0,0,1.193.844.844,0,0,0,1.193,0L5.625-5.557,9.81-1.372a.844.844,0,0,0,1.193,0A.844.844,0,0,0,11-2.565Z\"\r\n            transform=\"translate(0 12.375)\"\r\n            fill=\"#fff\"\r\n          />\r\n        </svg>\r\n      </span>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useMemo, useCallback, forwardRef, useImperativeHandle } from \"react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport cx from \"classnames\";\r\n\r\nimport {\r\n  FUNDING_RATE_PRECISION,\r\n  BASIS_POINTS_DIVISOR,\r\n  MARGIN_FEE_BASIS_POINTS,\r\n  SWAP,\r\n  LONG,\r\n  SHORT,\r\n  USD_DECIMALS,\r\n  getExplorerUrl,\r\n  helperToast,\r\n  formatAmount,\r\n  bigNumberify,\r\n  getTokenInfo,\r\n  getPositionKey,\r\n  getPositionContractKey,\r\n  getLeverage,\r\n  useLocalStorageSerializeKey,\r\n  useLocalStorageByChainId,\r\n  getDeltaStr,\r\n  useChainId,\r\n  useAccountOrders,\r\n  getPageTitle,\r\n} from \"../../lib/legacy\";\r\nimport { getConstant } from \"../../config/chains\";\r\nimport { approvePlugin, useInfoTokens, useMinExecutionFee, cancelMultipleOrders } from \"../../domain/legacy\";\r\n\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport { getTokens, getToken, getWhitelistedTokens, getTokenBySymbol } from \"../../config/Tokens\";\r\n\r\nimport Reader from \"../../abis/ReaderV2.json\";\r\nimport VaultV2 from \"../../abis/VaultV2.json\";\r\nimport Router from \"../../abis/Router.json\";\r\nimport Token from \"../../abis/Token.json\";\r\n\r\nimport Checkbox from \"../../components/Checkbox/Checkbox\";\r\nimport SwapBox from \"../../components/Exchange/SwapBox\";\r\nimport ExchangeTVChart, { getChartToken } from \"../../components/Exchange/ExchangeTVChart\";\r\nimport PositionsList from \"../../components/Exchange/PositionsList\";\r\nimport OrdersList from \"../../components/Exchange/OrdersList\";\r\nimport TradeHistory from \"../../components/Exchange/TradeHistory\";\r\nimport ExchangeWalletTokens from \"../../components/Exchange/ExchangeWalletTokens\";\r\nimport ExchangeBanner from \"../../components/Exchange/ExchangeBanner\";\r\nimport Tab from \"../../components/Tab/Tab\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\n\r\nimport \"./Exchange.scss\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nconst { AddressZero } = ethers.constants;\r\n\r\nconst PENDING_POSITION_VALID_DURATION = 600 * 1000;\r\nconst UPDATED_POSITION_VALID_DURATION = 60 * 1000;\r\n\r\nconst notifications = {};\r\n\r\nfunction pushSuccessNotification(chainId, message, e) {\r\n  const { transactionHash } = e;\r\n  const id = ethers.utils.id(message + transactionHash);\r\n  if (notifications[id]) {\r\n    return;\r\n  }\r\n\r\n  notifications[id] = true;\r\n\r\n  const txUrl = getExplorerUrl(chainId) + \"tx/\" + transactionHash;\r\n  helperToast.success(\r\n    <div>\r\n      {message}{\" \"}\r\n      <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        View\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction pushErrorNotification(chainId, message, e) {\r\n  const { transactionHash } = e;\r\n  const id = ethers.utils.id(message + transactionHash);\r\n  if (notifications[id]) {\r\n    return;\r\n  }\r\n\r\n  notifications[id] = true;\r\n\r\n  const txUrl = getExplorerUrl(chainId) + \"tx/\" + transactionHash;\r\n  helperToast.error(\r\n    <div>\r\n      {message}{\" \"}\r\n      <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        View\r\n      </a>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getFundingFee(data) {\r\n  let { entryFundingRate, cumulativeFundingRate, size } = data;\r\n  if (entryFundingRate && cumulativeFundingRate) {\r\n    return size.mul(cumulativeFundingRate.sub(entryFundingRate)).div(FUNDING_RATE_PRECISION);\r\n  }\r\n  return;\r\n}\r\n\r\nconst getTokenAddress = (token, nativeTokenAddress) => {\r\n  if (token.address === AddressZero) {\r\n    return nativeTokenAddress;\r\n  }\r\n  return token.address;\r\n};\r\n\r\nfunction applyPendingChanges(position, pendingPositions) {\r\n  if (!pendingPositions) {\r\n    return;\r\n  }\r\n  const { key } = position;\r\n\r\n  if (\r\n    pendingPositions[key] &&\r\n    pendingPositions[key].updatedAt &&\r\n    pendingPositions[key].pendingChanges &&\r\n    pendingPositions[key].updatedAt + PENDING_POSITION_VALID_DURATION > Date.now()\r\n  ) {\r\n    const { pendingChanges } = pendingPositions[key];\r\n    if (pendingChanges.size && position.size.eq(pendingChanges.size)) {\r\n      return;\r\n    }\r\n\r\n    if (pendingChanges.expectingCollateralChange && !position.collateral.eq(pendingChanges.collateralSnapshot)) {\r\n      return;\r\n    }\r\n\r\n    position.hasPendingChanges = true;\r\n    position.pendingChanges = pendingChanges;\r\n  }\r\n}\r\n\r\nexport function getPositions(\r\n  chainId,\r\n  positionQuery,\r\n  positionData,\r\n  infoTokens,\r\n  includeDelta,\r\n  showPnlAfterFees,\r\n  account,\r\n  pendingPositions,\r\n  updatedPositions\r\n) {\r\n  const propsLength = getConstant(chainId, \"positionReaderPropsLength\");\r\n  const positions = [];\r\n  const positionsMap = {};\r\n  if (!positionData) {\r\n    return { positions, positionsMap };\r\n  }\r\n  const { collateralTokens, indexTokens, isLong } = positionQuery;\r\n  for (let i = 0; i < collateralTokens.length; i++) {\r\n    const collateralToken = getTokenInfo(infoTokens, collateralTokens[i], true, getContract(chainId, \"NATIVE_TOKEN\"));\r\n    const indexToken = getTokenInfo(infoTokens, indexTokens[i], true, getContract(chainId, \"NATIVE_TOKEN\"));\r\n    const key = getPositionKey(account, collateralTokens[i], indexTokens[i], isLong[i]);\r\n    let contractKey;\r\n    if (account) {\r\n      contractKey = getPositionContractKey(account, collateralTokens[i], indexTokens[i], isLong[i]);\r\n    }\r\n\r\n    const position = {\r\n      key,\r\n      contractKey,\r\n      collateralToken,\r\n      indexToken,\r\n      isLong: isLong[i],\r\n      size: positionData[i * propsLength],\r\n      collateral: positionData[i * propsLength + 1],\r\n      averagePrice: positionData[i * propsLength + 2],\r\n      entryFundingRate: positionData[i * propsLength + 3],\r\n      cumulativeFundingRate: collateralToken.cumulativeFundingRate,\r\n      hasRealisedProfit: positionData[i * propsLength + 4].eq(1),\r\n      realisedPnl: positionData[i * propsLength + 5],\r\n      lastIncreasedTime: positionData[i * propsLength + 6].toNumber(),\r\n      hasProfit: positionData[i * propsLength + 7].eq(1),\r\n      delta: positionData[i * propsLength + 8],\r\n      markPrice: isLong[i] ? indexToken.minPrice : indexToken.maxPrice,\r\n    };\r\n\r\n    if (\r\n      updatedPositions &&\r\n      updatedPositions[key] &&\r\n      updatedPositions[key].updatedAt &&\r\n      updatedPositions[key].updatedAt + UPDATED_POSITION_VALID_DURATION > Date.now()\r\n    ) {\r\n      const updatedPosition = updatedPositions[key];\r\n      position.size = updatedPosition.size;\r\n      position.collateral = updatedPosition.collateral;\r\n      position.averagePrice = updatedPosition.averagePrice;\r\n      position.entryFundingRate = updatedPosition.entryFundingRate;\r\n    }\r\n\r\n    let fundingFee = getFundingFee(position);\r\n    position.fundingFee = fundingFee ? fundingFee : bigNumberify(0);\r\n    position.collateralAfterFee = position.collateral.sub(position.fundingFee);\r\n\r\n    position.closingFee = position.size.mul(MARGIN_FEE_BASIS_POINTS).div(BASIS_POINTS_DIVISOR);\r\n    position.positionFee = position.size.mul(MARGIN_FEE_BASIS_POINTS).mul(2).div(BASIS_POINTS_DIVISOR);\r\n    position.totalFees = position.positionFee.add(position.fundingFee);\r\n\r\n    position.pendingDelta = position.delta;\r\n\r\n    if (position.collateral.gt(0)) {\r\n      position.hasLowCollateral =\r\n        position.collateralAfterFee.lt(0) || position.size.div(position.collateralAfterFee.abs()).gt(50);\r\n\r\n      if (position.averagePrice && position.markPrice) {\r\n        const priceDelta = position.averagePrice.gt(position.markPrice)\r\n          ? position.averagePrice.sub(position.markPrice)\r\n          : position.markPrice.sub(position.averagePrice);\r\n        position.pendingDelta = position.size.mul(priceDelta).div(position.averagePrice);\r\n\r\n        position.delta = position.pendingDelta;\r\n\r\n        if (position.isLong) {\r\n          position.hasProfit = position.markPrice.gte(position.averagePrice);\r\n        } else {\r\n          position.hasProfit = position.markPrice.lte(position.averagePrice);\r\n        }\r\n      }\r\n\r\n      position.deltaPercentage = position.pendingDelta.mul(BASIS_POINTS_DIVISOR).div(position.collateral);\r\n\r\n      const { deltaStr, deltaPercentageStr } = getDeltaStr({\r\n        delta: position.pendingDelta,\r\n        deltaPercentage: position.deltaPercentage,\r\n        hasProfit: position.hasProfit,\r\n      });\r\n\r\n      position.deltaStr = deltaStr;\r\n      position.deltaPercentageStr = deltaPercentageStr;\r\n      position.deltaBeforeFeesStr = deltaStr;\r\n\r\n      let hasProfitAfterFees;\r\n      let pendingDeltaAfterFees;\r\n\r\n      if (position.hasProfit) {\r\n        if (position.pendingDelta.gt(position.totalFees)) {\r\n          hasProfitAfterFees = true;\r\n          pendingDeltaAfterFees = position.pendingDelta.sub(position.totalFees);\r\n        } else {\r\n          hasProfitAfterFees = false;\r\n          pendingDeltaAfterFees = position.totalFees.sub(position.pendingDelta);\r\n        }\r\n      } else {\r\n        hasProfitAfterFees = false;\r\n        pendingDeltaAfterFees = position.pendingDelta.add(position.totalFees);\r\n      }\r\n\r\n      position.hasProfitAfterFees = hasProfitAfterFees;\r\n      position.pendingDeltaAfterFees = pendingDeltaAfterFees;\r\n      position.deltaPercentageAfterFees = position.pendingDeltaAfterFees\r\n        .mul(BASIS_POINTS_DIVISOR)\r\n        .div(position.collateral);\r\n\r\n      const { deltaStr: deltaAfterFeesStr, deltaPercentageStr: deltaAfterFeesPercentageStr } = getDeltaStr({\r\n        delta: position.pendingDeltaAfterFees,\r\n        deltaPercentage: position.deltaPercentageAfterFees,\r\n        hasProfit: hasProfitAfterFees,\r\n      });\r\n\r\n      position.deltaAfterFeesStr = deltaAfterFeesStr;\r\n      position.deltaAfterFeesPercentageStr = deltaAfterFeesPercentageStr;\r\n\r\n      if (showPnlAfterFees) {\r\n        position.deltaStr = position.deltaAfterFeesStr;\r\n        position.deltaPercentageStr = position.deltaAfterFeesPercentageStr;\r\n      }\r\n\r\n      let netValue = position.hasProfit\r\n        ? position.collateral.add(position.pendingDelta)\r\n        : position.collateral.sub(position.pendingDelta);\r\n\r\n      netValue = netValue.sub(position.fundingFee);\r\n\r\n      if (showPnlAfterFees) {\r\n        netValue = netValue.sub(position.closingFee);\r\n      }\r\n\r\n      position.netValue = netValue;\r\n    }\r\n\r\n    position.leverage = getLeverage({\r\n      size: position.size,\r\n      collateral: position.collateral,\r\n      entryFundingRate: position.entryFundingRate,\r\n      cumulativeFundingRate: position.cumulativeFundingRate,\r\n      hasProfit: position.hasProfit,\r\n      delta: position.delta,\r\n      includeDelta,\r\n    });\r\n\r\n    positionsMap[key] = position;\r\n\r\n    applyPendingChanges(position, pendingPositions);\r\n\r\n    if (position.size.gt(0) || position.hasPendingChanges) {\r\n      positions.push(position);\r\n    }\r\n  }\r\n\r\n  return { positions, positionsMap };\r\n}\r\n\r\nexport function getPositionQuery(tokens, nativeTokenAddress) {\r\n  const collateralTokens = [];\r\n  const indexTokens = [];\r\n  const isLong = [];\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const token = tokens[i];\r\n    if (token.isStable) {\r\n      continue;\r\n    }\r\n    if (token.isWrapped) {\r\n      continue;\r\n    }\r\n    collateralTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n    indexTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n    isLong.push(true);\r\n  }\r\n\r\n  for (let i = 0; i < tokens.length; i++) {\r\n    const stableToken = tokens[i];\r\n    if (!stableToken.isStable) {\r\n      continue;\r\n    }\r\n\r\n    for (let j = 0; j < tokens.length; j++) {\r\n      const token = tokens[j];\r\n      if (token.isStable) {\r\n        continue;\r\n      }\r\n      if (token.isWrapped) {\r\n        continue;\r\n      }\r\n      collateralTokens.push(stableToken.address);\r\n      indexTokens.push(getTokenAddress(token, nativeTokenAddress));\r\n      isLong.push(false);\r\n    }\r\n  }\r\n\r\n  return { collateralTokens, indexTokens, isLong };\r\n}\r\n\r\nexport const Exchange = forwardRef((props, ref) => {\r\n  const {\r\n    savedIsPnlInLeverage,\r\n    setSavedIsPnlInLeverage,\r\n    savedShowPnlAfterFees,\r\n    savedSlippageAmount,\r\n    pendingTxns,\r\n    setPendingTxns,\r\n    savedShouldShowPositionLines,\r\n    setSavedShouldShowPositionLines,\r\n    connectWallet,\r\n    savedShouldDisableValidationForTesting,\r\n  } = props;\r\n  const [showBanner, setShowBanner] = useLocalStorageSerializeKey(\"showBanner\", true);\r\n  const [bannerHidden, setBannerHidden] = useLocalStorageSerializeKey(\"bannerHidden\", null);\r\n\r\n  const [pendingPositions, setPendingPositions] = useState({});\r\n  const [updatedPositions, setUpdatedPositions] = useState({});\r\n\r\n  const hideBanner = () => {\r\n    const hiddenLimit = new Date(new Date().getTime() + 2 * 24 * 60 * 60 * 1000);\r\n    setBannerHidden(hiddenLimit);\r\n    setShowBanner(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (new Date() > new Date(\"2021-11-30\")) {\r\n      setShowBanner(false);\r\n    } else {\r\n      if (bannerHidden && new Date(bannerHidden) > new Date()) {\r\n        setShowBanner(false);\r\n      } else {\r\n        setBannerHidden(null);\r\n        setShowBanner(true);\r\n      }\r\n    }\r\n  }, [showBanner, bannerHidden, setBannerHidden, setShowBanner]);\r\n\r\n  const { active, account, library } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  const currentAccount = account;\r\n\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n  const readerAddress = getContract(chainId, \"Reader\");\r\n  const usdgAddress = getContract(chainId, \"USDG\");\r\n\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const whitelistedTokenAddresses = whitelistedTokens.map((token) => token.address);\r\n\r\n  const positionQuery = getPositionQuery(whitelistedTokens, nativeTokenAddress);\r\n\r\n  const defaultCollateralSymbol = getConstant(chainId, \"defaultCollateralSymbol\");\r\n  const defaultTokenSelection = useMemo(\r\n    () => ({\r\n      [SWAP]: {\r\n        from: AddressZero,\r\n        to: getTokenBySymbol(chainId, defaultCollateralSymbol).address,\r\n      },\r\n      [LONG]: {\r\n        from: AddressZero,\r\n        to: AddressZero,\r\n      },\r\n      [SHORT]: {\r\n        from: getTokenBySymbol(chainId, defaultCollateralSymbol).address,\r\n        to: AddressZero,\r\n      },\r\n    }),\r\n    [chainId, defaultCollateralSymbol]\r\n  );\r\n\r\n  const [tokenSelection, setTokenSelection] = useLocalStorageByChainId(\r\n    chainId,\r\n    \"Exchange-token-selection-v2\",\r\n    defaultTokenSelection\r\n  );\r\n  const [swapOption, setSwapOption] = useLocalStorageByChainId(chainId, \"Swap-option-v2\", LONG);\r\n\r\n  const fromTokenAddress = tokenSelection[swapOption].from;\r\n  const toTokenAddress = tokenSelection[swapOption].to;\r\n\r\n  const setFromTokenAddress = useCallback(\r\n    (selectedSwapOption, address) => {\r\n      const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n      newTokenSelection[selectedSwapOption].from = address;\r\n      setTokenSelection(newTokenSelection);\r\n    },\r\n    [tokenSelection, setTokenSelection]\r\n  );\r\n\r\n  const setToTokenAddress = useCallback(\r\n    (selectedSwapOption, address) => {\r\n      const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n      newTokenSelection[selectedSwapOption].to = address;\r\n      if (selectedSwapOption === LONG || selectedSwapOption === SHORT) {\r\n        newTokenSelection[LONG].to = address;\r\n        newTokenSelection[SHORT].to = address;\r\n      }\r\n      setTokenSelection(newTokenSelection);\r\n    },\r\n    [tokenSelection, setTokenSelection]\r\n  );\r\n\r\n  const setMarket = (selectedSwapOption, toTokenAddress) => {\r\n    setSwapOption(selectedSwapOption);\r\n    const newTokenSelection = JSON.parse(JSON.stringify(tokenSelection));\r\n    newTokenSelection[selectedSwapOption].to = toTokenAddress;\r\n    if (selectedSwapOption === LONG || selectedSwapOption === SHORT) {\r\n      newTokenSelection[LONG].to = toTokenAddress;\r\n      newTokenSelection[SHORT].to = toTokenAddress;\r\n    }\r\n    setTokenSelection(newTokenSelection);\r\n  };\r\n\r\n  const [isConfirming, setIsConfirming] = useState(false);\r\n  const [isPendingConfirmation, setIsPendingConfirmation] = useState(false);\r\n\r\n  const tokens = getTokens(chainId);\r\n\r\n  const tokenAddresses = tokens.map((token) => token.address);\r\n  const { data: tokenBalances } = useSWR(active && [active, chainId, readerAddress, \"getTokenBalances\", account], {\r\n    fetcher: fetcher(library, Reader, [tokenAddresses]),\r\n  });\r\n\r\n  const { data: positionData, error: positionDataError } = useSWR(\r\n    active && [active, chainId, readerAddress, \"getPositions\", vaultAddress, account],\r\n    {\r\n      fetcher: fetcher(library, Reader, [\r\n        positionQuery.collateralTokens,\r\n        positionQuery.indexTokens,\r\n        positionQuery.isLong,\r\n      ]),\r\n    }\r\n  );\r\n\r\n\r\n  const positionsDataIsLoading = active && !positionData && !positionDataError;\r\n\r\n  const { data: fundingRateInfo } = useSWR([active, chainId, readerAddress, \"getFundingRates\"], {\r\n    fetcher: fetcher(library, Reader, [vaultAddress, nativeTokenAddress, whitelistedTokenAddresses]),\r\n  });\r\n\r\n  const { data: totalTokenWeights } = useSWR(\r\n    [`Exchange:totalTokenWeights:${active}`, chainId, vaultAddress, \"totalTokenWeights\"],\r\n    {\r\n      fetcher: fetcher(library, VaultV2),\r\n    }\r\n  );\r\n\r\n  const { data: usdgSupply } = useSWR([`Exchange:usdgSupply:${active}`, chainId, usdgAddress, \"totalSupply\"], {\r\n    fetcher: fetcher(library, Token),\r\n  });\r\n\r\n  const orderBookAddress = getContract(chainId, \"OrderBook\");\r\n  const routerAddress = getContract(chainId, \"Router\");\r\n  const { data: orderBookApproved } = useSWR(\r\n    active && [active, chainId, routerAddress, \"approvedPlugins\", account, orderBookAddress],\r\n    {\r\n      fetcher: fetcher(library, Router),\r\n    }\r\n  );\r\n\r\n  const { data: positionRouterApproved } = useSWR(\r\n    active && [active, chainId, routerAddress, \"approvedPlugins\", account, positionRouterAddress],\r\n    {\r\n      fetcher: fetcher(library, Router),\r\n    }\r\n  );\r\n\r\n  const { infoTokens } = useInfoTokens(library, chainId, active, tokenBalances, fundingRateInfo);\r\n  const { minExecutionFee, minExecutionFeeUSD, minExecutionFeeErrorMessage } = useMinExecutionFee(\r\n    library,\r\n    active,\r\n    chainId,\r\n    infoTokens\r\n  );\r\n\r\n  useEffect(() => {\r\n    const fromToken = getTokenInfo(infoTokens, fromTokenAddress);\r\n    const toToken = getTokenInfo(infoTokens, toTokenAddress);\r\n    let selectedToken = getChartToken(swapOption, fromToken, toToken, chainId);\r\n    let currentTokenPriceStr = formatAmount(selectedToken.maxPrice, USD_DECIMALS, 2, true);\r\n    let title = getPageTitle(currentTokenPriceStr + ` | ${selectedToken.symbol}${selectedToken.isStable ? \"\" : \"USD\"}`);\r\n    document.title = title;\r\n  }, [tokenSelection, swapOption, infoTokens, chainId, fromTokenAddress, toTokenAddress]);\r\n\r\n  const { positions, positionsMap } = getPositions(\r\n    chainId,\r\n    positionQuery,\r\n    positionData,\r\n    infoTokens,\r\n    savedIsPnlInLeverage,\r\n    savedShowPnlAfterFees,\r\n    account,\r\n    pendingPositions,\r\n    updatedPositions\r\n  );\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    onUpdatePosition(key, size, collateral, averagePrice, entryFundingRate, reserveAmount, realisedPnl) {\r\n      for (let i = 0; i < positions.length; i++) {\r\n        const position = positions[i];\r\n        if (position.contractKey === key) {\r\n          updatedPositions[position.key] = {\r\n            size,\r\n            collateral,\r\n            averagePrice,\r\n            entryFundingRate,\r\n            reserveAmount,\r\n            realisedPnl,\r\n            updatedAt: Date.now(),\r\n          };\r\n          setUpdatedPositions({ ...updatedPositions });\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    onClosePosition(key, size, collateral, averagePrice, entryFundingRate, reserveAmount, realisedPnl, e) {\r\n      for (let i = 0; i < positions.length; i++) {\r\n        const position = positions[i];\r\n        if (position.contractKey === key) {\r\n          updatedPositions[position.key] = {\r\n            size: bigNumberify(0),\r\n            collateral: bigNumberify(0),\r\n            averagePrice,\r\n            entryFundingRate,\r\n            reserveAmount,\r\n            realisedPnl,\r\n            updatedAt: Date.now(),\r\n          };\r\n          setUpdatedPositions({ ...updatedPositions });\r\n          break;\r\n        }\r\n      }\r\n    },\r\n\r\n    onIncreasePosition(key, account, collateralToken, indexToken, collateralDelta, sizeDelta, isLong, price, fee, e) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      let message;\r\n      if (sizeDelta.eq(0)) {\r\n        message = `Deposited ${formatAmount(collateralDelta, USD_DECIMALS, 2, true)} USD into ${tokenSymbol} ${\r\n          isLong ? \"Long\" : \"Short.\"\r\n        }`;\r\n      } else {\r\n        message = `Increased ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"}, +${formatAmount(\r\n          sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD.`;\r\n      }\r\n\r\n      pushSuccessNotification(chainId, message, e);\r\n    },\r\n\r\n    onDecreasePosition(key, account, collateralToken, indexToken, collateralDelta, sizeDelta, isLong, price, fee, e) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      let message;\r\n      if (sizeDelta.eq(0)) {\r\n        message = `Withdrew ${formatAmount(collateralDelta, USD_DECIMALS, 2, true)} USD from ${tokenSymbol} ${\r\n          isLong ? \"Long\" : \"Short\"\r\n        }.`;\r\n      } else {\r\n        message = `Decreased ${tokenSymbol} ${isLong ? \"Long\" : \"Short\"}, -${formatAmount(\r\n          sizeDelta,\r\n          USD_DECIMALS,\r\n          2,\r\n          true\r\n        )} USD.`;\r\n      }\r\n\r\n      pushSuccessNotification(chainId, message, e);\r\n    },\r\n\r\n    onCancelIncreasePosition(\r\n      account,\r\n      path,\r\n      indexToken,\r\n      amountIn,\r\n      minOut,\r\n      sizeDelta,\r\n      isLong,\r\n      acceptablePrice,\r\n      executionFee,\r\n      blockGap,\r\n      timeGap,\r\n      e\r\n    ) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      const message = `Could not increase ${tokenSymbol} ${\r\n        isLong ? \"Long\" : \"Short\"\r\n      } within the allowed slippage, you can adjust the allowed slippage in the settings on the top right of the page.`;\r\n\r\n      pushErrorNotification(chainId, message, e);\r\n\r\n      const key = getPositionKey(account, path[path.length - 1], indexToken, isLong);\r\n      pendingPositions[key] = {};\r\n      setPendingPositions({ ...pendingPositions });\r\n    },\r\n\r\n    onCancelDecreasePosition(\r\n      account,\r\n      path,\r\n      indexToken,\r\n      collateralDelta,\r\n      sizeDelta,\r\n      isLong,\r\n      receiver,\r\n      acceptablePrice,\r\n      minOut,\r\n      executionFee,\r\n      blockGap,\r\n      timeGap,\r\n      e\r\n    ) {\r\n      if (account !== currentAccount) {\r\n        return;\r\n      }\r\n      const indexTokenItem = getToken(chainId, indexToken);\r\n      const tokenSymbol = indexTokenItem.isWrapped ? getConstant(chainId, \"nativeTokenSymbol\") : indexTokenItem.symbol;\r\n\r\n      const message = `Could not decrease ${tokenSymbol} ${\r\n        isLong ? \"Long\" : \"Short\"\r\n      } within the allowed slippage, you can adjust the allowed slippage in the settings on the top right of the page.`;\r\n\r\n      pushErrorNotification(chainId, message, e);\r\n\r\n      const key = getPositionKey(account, path[path.length - 1], indexToken, isLong);\r\n      pendingPositions[key] = {};\r\n      setPendingPositions({ ...pendingPositions });\r\n    },\r\n  }));\r\n\r\n  const flagOrdersEnabled = true;\r\n  const [orders] = useAccountOrders(flagOrdersEnabled);\r\n\r\n  const [isWaitingForPluginApproval, setIsWaitingForPluginApproval] = useState(false);\r\n  const [isWaitingForPositionRouterApproval, setIsWaitingForPositionRouterApproval] = useState(false);\r\n  const [isPluginApproving, setIsPluginApproving] = useState(false);\r\n  const [isPositionRouterApproving, setIsPositionRouterApproving] = useState(false);\r\n  const [isCancelMultipleOrderProcessing, setIsCancelMultipleOrderProcessing] = useState(false);\r\n  const [cancelOrderIdList, setCancelOrderIdList] = useState([]);\r\n\r\n  const onMultipleCancelClick = useCallback(\r\n    async function () {\r\n      setIsCancelMultipleOrderProcessing(true);\r\n      try {\r\n        const tx = await cancelMultipleOrders(chainId, library, cancelOrderIdList, {\r\n          successMsg: t`Orders cancelled.`,\r\n          failMsg: t`Cancel failed.`,\r\n          sentMsg: t`Cancel submitted.`,\r\n          pendingTxns,\r\n          setPendingTxns,\r\n        });\r\n        const receipt = await tx.wait();\r\n        if (receipt.status === 1) {\r\n          setCancelOrderIdList([]);\r\n        }\r\n      } catch (error) {\r\n        console.error(error);\r\n      } finally {\r\n        setIsCancelMultipleOrderProcessing(false);\r\n      }\r\n    },\r\n    [\r\n      chainId,\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      setCancelOrderIdList,\r\n      cancelOrderIdList,\r\n      setIsCancelMultipleOrderProcessing,\r\n    ]\r\n  );\r\n\r\n  const approveOrderBook = () => {\r\n    setIsPluginApproving(true);\r\n    return approvePlugin(chainId, orderBookAddress, {\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      sentMsg: t`Enable orders sent.`,\r\n      failMsg: t`Enable orders failed.`,\r\n    })\r\n      .then(() => {\r\n        setIsWaitingForPluginApproval(true);\r\n      })\r\n      .finally(() => {\r\n        setIsPluginApproving(false);\r\n      });\r\n  };\r\n\r\n  const approvePositionRouter = ({ sentMsg, failMsg }) => {\r\n    setIsPositionRouterApproving(true);\r\n    return approvePlugin(chainId, positionRouterAddress, {\r\n      library,\r\n      pendingTxns,\r\n      setPendingTxns,\r\n      sentMsg,\r\n      failMsg,\r\n    })\r\n      .then(() => {\r\n        setIsWaitingForPositionRouterApproval(true);\r\n      })\r\n      .finally(() => {\r\n        setIsPositionRouterApproving(false);\r\n      });\r\n  };\r\n\r\n  const LIST_SECTIONS = [\"Positions\", flagOrdersEnabled ? \"Orders\" : undefined, \"Trades\", \"Borrows\"].filter(Boolean);\r\n  let [listSection, setListSection] = useLocalStorageByChainId(chainId, \"List-section-v2\", LIST_SECTIONS[0]);\r\n  const LIST_SECTIONS_LABELS = {\r\n    Orders: orders.length ? `Orders (${orders.length})` : undefined,\r\n    Positions: positions.length ? `Positions (${positions.length})` : undefined,\r\n  };\r\n  if (!LIST_SECTIONS.includes(listSection)) {\r\n    listSection = LIST_SECTIONS[0];\r\n  }\r\n\r\n  if (!getToken(chainId, toTokenAddress)) {\r\n    return null;\r\n  }\r\n\r\n  const renderCancelOrderButton = () => {\r\n    const orderText = cancelOrderIdList.length > 1 ? t`orders` : t`order`;\r\n    if (cancelOrderIdList.length === 0) return;\r\n    return (\r\n      <button\r\n        className=\"muted font-base cancel-order-btn\"\r\n        disabled={isCancelMultipleOrderProcessing}\r\n        type=\"button\"\r\n        onClick={onMultipleCancelClick}\r\n      >\r\n        <Trans>\r\n          Cancel {cancelOrderIdList.length} {orderText}\r\n        </Trans>\r\n      </button>\r\n    );\r\n  };\r\n\r\n  const getListSection = () => {\r\n    return (\r\n      <div>\r\n        <div className=\"Exchange-list-tab-container\">\r\n          <Tab\r\n            options={LIST_SECTIONS}\r\n            optionLabels={LIST_SECTIONS_LABELS}\r\n            option={listSection}\r\n            onChange={(section) => setListSection(section)}\r\n            type=\"inline\"\r\n            className=\"Exchange-list-tabs\"\r\n          />\r\n          {/* <div className=\"align-right Exchange-should-show-position-lines\">\r\n            {renderCancelOrderButton()}\r\n            <Checkbox\r\n              isChecked={savedShouldShowPositionLines}\r\n              setIsChecked={setSavedShouldShowPositionLines}\r\n              className={cx(\"muted chart-positions\", { active: savedShouldShowPositionLines })}\r\n            >\r\n              <span>\r\n                <Trans>Chart positions</Trans>\r\n              </span>\r\n            </Checkbox>\r\n          </div> */}\r\n        </div>\r\n        {listSection === \"Positions\" && (\r\n          <PositionsList\r\n            positionsDataIsLoading={positionsDataIsLoading}\r\n            pendingPositions={pendingPositions}\r\n            setPendingPositions={setPendingPositions}\r\n            setListSection={setListSection}\r\n            setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n            setIsWaitingForPositionRouterApproval={setIsWaitingForPositionRouterApproval}\r\n            approveOrderBook={approveOrderBook}\r\n            approvePositionRouter={approvePositionRouter}\r\n            isPluginApproving={isPluginApproving}\r\n            isPositionRouterApproving={isPositionRouterApproving}\r\n            isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n            isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n            orderBookApproved={orderBookApproved}\r\n            positionRouterApproved={positionRouterApproved}\r\n            positions={positions}\r\n            positionsMap={positionsMap}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            account={account}\r\n            library={library}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            flagOrdersEnabled={flagOrdersEnabled}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            chainId={chainId}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            setMarket={setMarket}\r\n            orders={orders}\r\n            showPnlAfterFees={savedShowPnlAfterFees}\r\n            minExecutionFee={minExecutionFee}\r\n            minExecutionFeeUSD={minExecutionFeeUSD}\r\n            minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n            usdgSupply={usdgSupply}\r\n            totalTokenWeights={totalTokenWeights}\r\n          />\r\n        )}\r\n        {listSection === \"Orders\" && (\r\n          <OrdersList\r\n            account={account}\r\n            active={active}\r\n            library={library}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            infoTokens={infoTokens}\r\n            positionsMap={positionsMap}\r\n            chainId={chainId}\r\n            orders={orders}\r\n            totalTokenWeights={totalTokenWeights}\r\n            usdgSupply={usdgSupply}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            cancelOrderIdList={cancelOrderIdList}\r\n            setCancelOrderIdList={setCancelOrderIdList}\r\n          />\r\n        )}\r\n        {listSection === \"Trades\" && (\r\n          <TradeHistory\r\n            account={account}\r\n            forSingleAccount={true}\r\n            infoTokens={infoTokens}\r\n            getTokenInfo={getTokenInfo}\r\n            chainId={chainId}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            shouldShowPaginationButtons={true}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const onSelectWalletToken = (token) => {\r\n    setFromTokenAddress(swapOption, token.address);\r\n  };\r\n\r\n  const renderChart = () => {\r\n    return (\r\n      <ExchangeTVChart\r\n        fromTokenAddress={fromTokenAddress}\r\n        toTokenAddress={toTokenAddress}\r\n        infoTokens={infoTokens}\r\n        swapOption={swapOption}\r\n        chainId={chainId}\r\n        positions={positions}\r\n        savedShouldShowPositionLines={savedShouldShowPositionLines}\r\n        orders={orders}\r\n        setToTokenAddress={setToTokenAddress}\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"Exchange page-layout\">\r\n      {showBanner && <ExchangeBanner hideBanner={hideBanner} />}\r\n      <div className=\"Exchange-content\">\r\n        <div className=\"Exchange-left\">\r\n          {renderChart()}\r\n          <div className=\"Exchange-lists large\">{getListSection()}</div>\r\n        </div>\r\n        <div className=\"Exchange-right\">\r\n          <SwapBox\r\n            pendingPositions={pendingPositions}\r\n            setPendingPositions={setPendingPositions}\r\n            setIsWaitingForPluginApproval={setIsWaitingForPluginApproval}\r\n            setIsWaitingForPositionRouterApproval={setIsWaitingForPositionRouterApproval}\r\n            approveOrderBook={approveOrderBook}\r\n            approvePositionRouter={approvePositionRouter}\r\n            isPluginApproving={isPluginApproving}\r\n            isPositionRouterApproving={isPositionRouterApproving}\r\n            isWaitingForPluginApproval={isWaitingForPluginApproval}\r\n            isWaitingForPositionRouterApproval={isWaitingForPositionRouterApproval}\r\n            orderBookApproved={orderBookApproved}\r\n            positionRouterApproved={positionRouterApproved}\r\n            orders={orders}\r\n            flagOrdersEnabled={flagOrdersEnabled}\r\n            chainId={chainId}\r\n            infoTokens={infoTokens}\r\n            active={active}\r\n            connectWallet={connectWallet}\r\n            library={library}\r\n            account={account}\r\n            positionsMap={positionsMap}\r\n            fromTokenAddress={fromTokenAddress}\r\n            setFromTokenAddress={setFromTokenAddress}\r\n            toTokenAddress={toTokenAddress}\r\n            setToTokenAddress={setToTokenAddress}\r\n            swapOption={swapOption}\r\n            setSwapOption={setSwapOption}\r\n            pendingTxns={pendingTxns}\r\n            setPendingTxns={setPendingTxns}\r\n            tokenSelection={tokenSelection}\r\n            setTokenSelection={setTokenSelection}\r\n            isConfirming={isConfirming}\r\n            setIsConfirming={setIsConfirming}\r\n            isPendingConfirmation={isPendingConfirmation}\r\n            setIsPendingConfirmation={setIsPendingConfirmation}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            setSavedIsPnlInLeverage={setSavedIsPnlInLeverage}\r\n            nativeTokenAddress={nativeTokenAddress}\r\n            savedSlippageAmount={savedSlippageAmount}\r\n            totalTokenWeights={totalTokenWeights}\r\n            usdgSupply={usdgSupply}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n            minExecutionFee={minExecutionFee}\r\n            minExecutionFeeUSD={minExecutionFeeUSD}\r\n            minExecutionFeeErrorMessage={minExecutionFeeErrorMessage}\r\n          />\r\n          <div className=\"Exchange-wallet-tokens\">\r\n            <div className=\"Exchange-wallet-tokens-content\">\r\n              <ExchangeWalletTokens tokens={tokens} infoTokens={infoTokens} onSelectToken={onSelectWalletToken} />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-lists small\">{getListSection()}</div>\r\n      </div>\r\n      {/* <Footer /> */}\r\n    </div>\r\n  );\r\n});\r\n","import \"./Referrals.css\";\r\nimport React from \"react\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport SEO from \"../../components/Common/SEO\";\r\nimport Tab from \"../../components/Tab/Tab\";\r\nimport Loader from \"../../components/Common/Loader\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\nimport {\r\n  useChainId,\r\n  getPageTitle,\r\n  REFERRALS_SELECTED_TAB_KEY,\r\n  useLocalStorageSerializeKey,\r\n  isHashZero,\r\n} from \"../../lib/legacy\";\r\nimport {\r\n  useReferralsData,\r\n  registerReferralCode,\r\n  useCodeOwner,\r\n  useReferrerTier,\r\n  useUserReferralCode,\r\n} from \"../../domain/referrals\";\r\nimport JoinReferralCode from \"../../components/Referrals/JoinReferralCode\";\r\nimport AffiliatesStats from \"../../components/Referrals/AffiliatesStats\";\r\nimport TradersStats from \"../../components/Referrals/TradersStats\";\r\nimport AddAffiliateCode from \"../../components/Referrals/AddAffiliateCode\";\r\nimport { deserializeSampleStats, isRecentReferralCodeNotExpired } from \"../../components/Referrals/referralsHelper\";\r\nimport { ethers } from \"ethers\";\r\n\r\nconst TRADERS = t`Traders`;\r\nconst AFFILIATES = t`Affiliates`;\r\nconst TAB_OPTIONS = [TRADERS, AFFILIATES];\r\n\r\nfunction Referrals({ connectWallet, setPendingTxns, pendingTxns }) {\r\n  const { active, account: walletAccount, library } = useWeb3React();\r\n  const { account: queryAccount } = useParams();\r\n  let account;\r\n  if (queryAccount && ethers.utils.isAddress(queryAccount)) {\r\n    account = ethers.utils.getAddress(queryAccount);\r\n  } else {\r\n    account = walletAccount;\r\n  }\r\n  const { chainId } = useChainId();\r\n  const [activeTab, setActiveTab] = useLocalStorage(REFERRALS_SELECTED_TAB_KEY, TRADERS);\r\n  const { data: referralsData, loading } = useReferralsData(chainId, account);\r\n  const [recentlyAddedCodes, setRecentlyAddedCodes] = useLocalStorageSerializeKey([chainId, \"REFERRAL\", account], [], {\r\n    deserializer: deserializeSampleStats,\r\n  });\r\n  const { userReferralCode, userReferralCodeString } = useUserReferralCode(library, chainId, account);\r\n  const { codeOwner } = useCodeOwner(library, chainId, account, userReferralCode);\r\n  const { referrerTier: traderTier } = useReferrerTier(library, chainId, codeOwner);\r\n\r\n  function handleCreateReferralCode(referralCode) {\r\n    return registerReferralCode(chainId, referralCode, library, {\r\n      sentMsg: t`Referral code submitted!`,\r\n      failMsg: t`Referral code creation failed.`,\r\n      pendingTxns,\r\n    });\r\n  }\r\n\r\n  function renderAffiliatesTab() {\r\n    const isReferralCodeAvailable =\r\n      referralsData?.codes?.length > 0 || recentlyAddedCodes?.filter(isRecentReferralCodeNotExpired).length > 0;\r\n    if (loading) return <Loader />;\r\n    if (isReferralCodeAvailable) {\r\n      return (\r\n        <AffiliatesStats\r\n          referralsData={referralsData}\r\n          handleCreateReferralCode={handleCreateReferralCode}\r\n          setRecentlyAddedCodes={setRecentlyAddedCodes}\r\n          recentlyAddedCodes={recentlyAddedCodes}\r\n          chainId={chainId}\r\n        />\r\n      );\r\n    } else {\r\n      return (\r\n        <AddAffiliateCode\r\n          handleCreateReferralCode={handleCreateReferralCode}\r\n          active={active}\r\n          connectWallet={connectWallet}\r\n          recentlyAddedCodes={recentlyAddedCodes}\r\n          setRecentlyAddedCodes={setRecentlyAddedCodes}\r\n        />\r\n      );\r\n    }\r\n  }\r\n\r\n  function renderTradersTab() {\r\n    if (loading) return <Loader />;\r\n    if (isHashZero(userReferralCode) || !account || !userReferralCode) {\r\n      return (\r\n        <JoinReferralCode\r\n          connectWallet={connectWallet}\r\n          active={active}\r\n          setPendingTxns={setPendingTxns}\r\n          pendingTxns={pendingTxns}\r\n        />\r\n      );\r\n    }\r\n    return (\r\n      <TradersStats\r\n        userReferralCodeString={userReferralCodeString}\r\n        chainId={chainId}\r\n        referralsData={referralsData}\r\n        setPendingTxns={setPendingTxns}\r\n        pendingTxns={pendingTxns}\r\n        traderTier={traderTier}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <SEO title={getPageTitle(\"Referrals\")}>\r\n      <div className=\"default-container page-layout Referrals\">\r\n        <div className=\"section-title-block\">\r\n          <div className=\"section-title-icon\"></div>\r\n          <div className=\"section-title-content\">\r\n            <div className=\"Page-title\">\r\n              <Trans>Referrals</Trans>\r\n            </div>\r\n            <div className=\"Page-description\">\r\n              <Trans>\r\n                Get fee discounts and earn rebates through the GMX referral program.\r\n                <br />\r\n                For more information, please read the{\" \"}\r\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://gmxio.gitbook.io/gmx/referrals\">\r\n                  referral program details\r\n                </a>\r\n                .\r\n              </Trans>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"referral-tab-container\">\r\n          <Tab options={TAB_OPTIONS} option={activeTab} setOption={setActiveTab} onChange={setActiveTab} />\r\n        </div>\r\n        {activeTab === AFFILIATES ? renderAffiliatesTab() : renderTradersTab()}\r\n      </div>\r\n      <Footer />\r\n    </SEO>\r\n  );\r\n}\r\n\r\nexport default Referrals;\r\n","import { BigNumber } from \"@ethersproject/bignumber\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { ethers } from \"ethers\";\r\nimport { getNativeToken } from \"../../config/Tokens\";\r\nimport { InfoTokens, Token } from \"../../domain/tokens/types\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport { get1InchSwapUrl } from \"../../domain/common\";\r\nimport { getLowestFeeTokenForBuyGlp } from \"../../domain/tokens/utils\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\ntype Props = {\r\n  swapToken: Token;\r\n  isVisible: boolean;\r\n  setIsVisible: () => void;\r\n  chainId: number;\r\n  glpAmount: BigNumber;\r\n  usdgSupply: BigNumber;\r\n  totalTokenWeights: BigNumber;\r\n  glpPrice: BigNumber;\r\n  swapUsdMin: BigNumber;\r\n  infoTokens: InfoTokens;\r\n};\r\n\r\nexport default function SwapErrorModal({\r\n  swapToken,\r\n  isVisible,\r\n  setIsVisible,\r\n  chainId,\r\n  glpAmount,\r\n  usdgSupply,\r\n  totalTokenWeights,\r\n  glpPrice,\r\n  infoTokens,\r\n  swapUsdMin,\r\n}: Props) {\r\n  const [lowestFeeToken, setLowestFeeToken] = useState<\r\n    { token: Token; fees: number; amountLeftToDeposit: BigNumber } | undefined\r\n  >();\r\n  useEffect(() => {\r\n    const lowestFeeTokenInfo = getLowestFeeTokenForBuyGlp(\r\n      chainId,\r\n      glpAmount,\r\n      glpPrice,\r\n      usdgSupply,\r\n      totalTokenWeights,\r\n      infoTokens,\r\n      swapToken.address,\r\n      swapUsdMin\r\n    );\r\n    setLowestFeeToken(lowestFeeTokenInfo);\r\n  }, [chainId, glpAmount, glpPrice, usdgSupply, totalTokenWeights, infoTokens, swapUsdMin, swapToken.address]);\r\n\r\n  const label = `${swapToken?.symbol} Capacity Reached`;\r\n\r\n  if (lowestFeeToken && swapUsdMin && swapUsdMin.gt(lowestFeeToken.amountLeftToDeposit)) {\r\n    return (\r\n      <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={label} className=\"Error-modal\">\r\n        <p>\r\n          There is not enough liquidity in a single token for your size. Please check the Save on Fees section and\r\n          consider splitting your order into several different ones\r\n        </p>\r\n        <p>\r\n          <a href={get1InchSwapUrl(chainId)} target=\"_blank\" rel=\"noreferrer\">\r\n            Swap on 1inch\r\n          </a>\r\n        </p>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  const nativeToken = getNativeToken(chainId);\r\n  const inputCurrency = swapToken.address === AddressZero ? nativeToken.symbol : swapToken.address;\r\n  const outputCurrency =\r\n    lowestFeeToken?.token.address === AddressZero ? nativeToken.symbol : lowestFeeToken?.token.address;\r\n  const oneInchUrl = get1InchSwapUrl(chainId, inputCurrency, outputCurrency);\r\n\r\n  return (\r\n    <Modal isVisible={isVisible} setIsVisible={setIsVisible} label={label} className=\"Error-modal\">\r\n      <p>The pool's capacity has been reached for {swapToken.symbol}. Please use another token to buy GLP.</p>\r\n      <p>Check the \"Save on Fees\" section for tokens with the lowest fees.</p>\r\n      <p>\r\n        <a href={oneInchUrl} target=\"_blank\" rel=\"noreferrer\">\r\n          Swap {swapToken.symbol} to {lowestFeeToken?.token.symbol} on 1inch\r\n        </a>\r\n      </p>\r\n    </Modal>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { useWeb3React } from \"@web3-react/core\";\r\nimport useSWR from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport Tab from \"../Tab/Tab\";\r\nimport cx from \"classnames\";\r\nimport { getToken, getTokens, getWhitelistedTokens, getWrappedToken, getNativeToken } from \"../../config/Tokens\";\r\nimport { getContract } from \"../../config/Addresses\";\r\nimport {\r\n  helperToast,\r\n  useLocalStorageByChainId,\r\n  getTokenInfo,\r\n  useChainId,\r\n  expandDecimals,\r\n  bigNumberify,\r\n  formatAmount,\r\n  formatAmountFree,\r\n  formatKeyAmount,\r\n  getBuyGlpToAmount,\r\n  getBuyGlpFromAmount,\r\n  getSellGlpFromAmount,\r\n  getSellGlpToAmount,\r\n  parseValue,\r\n  approveTokens,\r\n  getUsd,\r\n  adjustForDecimals,\r\n  GLP_DECIMALS,\r\n  USD_DECIMALS,\r\n  BASIS_POINTS_DIVISOR,\r\n  GLP_COOLDOWN_DURATION,\r\n  SECONDS_PER_YEAR,\r\n  USDG_DECIMALS,\r\n  ARBITRUM,\r\n  PLACEHOLDER_ACCOUNT,\r\n  importImage,\r\n  IS_NETWORK_DISABLED,\r\n  getChainName,\r\n} from \"../../lib/legacy\";\r\n\r\nimport { useGmxPrice, useInfoTokens } from \"../../domain/legacy\";\r\n\r\nimport TokenSelector from \"../Exchange/TokenSelector\";\r\nimport BuyInputSection from \"../BuyInputSection/BuyInputSection\";\r\nimport Tooltip from \"../Tooltip/Tooltip\";\r\n\r\nimport ReaderV2 from \"../../abis/ReaderV2.json\";\r\nimport RewardReader from \"../../abis/RewardReader.json\";\r\nimport VaultV2 from \"../../abis/VaultV2.json\";\r\nimport GlpManager from \"../../abis/GlpManager.json\";\r\nimport RewardTracker from \"../../abis/RewardTracker.json\";\r\nimport Vester from \"../../abis/Vester.json\";\r\nimport RewardRouter from \"../../abis/RewardRouter.json\";\r\nimport Token from \"../../abis/Token.json\";\r\n\r\nimport glp24Icon from \"../../img/ic_glp_24.svg\";\r\nimport glp40Icon from \"../../img/ic_glp_40.svg\";\r\nimport arrowIcon from \"../../img/ic_convert_down.svg\";\r\n\r\nimport avalanche16Icon from \"../../img/ic_avalanche_16.svg\";\r\nimport arbitrum16Icon from \"../../img/ic_arbitrum_16.svg\";\r\n\r\nimport \"./GlpSwap.css\";\r\nimport AssetDropdown from \"../../pages/Dashboard/AssetDropdown\";\r\nimport SwapErrorModal from \"./SwapErrorModal\";\r\nimport StatsTooltipRow from \"../StatsTooltip/StatsTooltipRow\";\r\nimport { fetcher } from \"../../lib/contracts/fetcher\";\r\nimport { callContract } from \"../../lib/contracts/callContract\";\r\n\r\nconst { AddressZero } = ethers.constants;\r\n\r\nfunction getStakingData(stakingInfo) {\r\n  if (!stakingInfo || stakingInfo.length === 0) {\r\n    return;\r\n  }\r\n\r\n  const keys = [\"stakedGlpTracker\", \"feeGlpTracker\"];\r\n  const data = {};\r\n  const propsLength = 5;\r\n\r\n  for (let i = 0; i < keys.length; i++) {\r\n    const key = keys[i];\r\n    data[key] = {\r\n      claimable: stakingInfo[i * propsLength],\r\n      tokensPerInterval: stakingInfo[i * propsLength + 1],\r\n      averageStakedAmounts: stakingInfo[i * propsLength + 2],\r\n      cumulativeRewards: stakingInfo[i * propsLength + 3],\r\n      totalSupply: stakingInfo[i * propsLength + 4],\r\n    };\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nfunction getTooltipContent(managedUsd, tokenInfo, token) {\r\n  return (\r\n    <>\r\n      <StatsTooltipRow\r\n        label={t`Current Pool Amount`}\r\n        value={[\r\n          `$${formatAmount(managedUsd, USD_DECIMALS, 0, true)}`,\r\n          `(${formatKeyAmount(tokenInfo, \"poolAmount\", token.decimals, 0, true)} ${token.symbol})`,\r\n        ]}\r\n      />\r\n      <StatsTooltipRow label=\"Max Pool Capacity\" value={formatAmount(tokenInfo.maxUsdgAmount, 18, 0, true)} />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default function GlpSwap(props) {\r\n  const {\r\n    savedSlippageAmount,\r\n    isBuying,\r\n    setPendingTxns,\r\n    connectWallet,\r\n    setIsBuying,\r\n    savedShouldDisableValidationForTesting,\r\n  } = props;\r\n  const history = useNavigate();\r\n  const swapLabel = isBuying ? \"BuyGlp\" : \"SellGlp\";\r\n  const tabLabel = isBuying ? t`Buy GLP` : t`Sell GLP`;\r\n  const { active, library, account } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  // const chainName = getChainName(chainId)\r\n  const tokens = getTokens(chainId);\r\n  const whitelistedTokens = getWhitelistedTokens(chainId);\r\n  const tokenList = whitelistedTokens.filter((t) => !t.isWrapped);\r\n  const visibleTokens = tokenList.filter((t) => !t.isTempHidden);\r\n  const [swapValue, setSwapValue] = useState(\"\");\r\n  const [glpValue, setGlpValue] = useState(\"\");\r\n  const [swapTokenAddress, setSwapTokenAddress] = useLocalStorageByChainId(\r\n    chainId,\r\n    `${swapLabel}-swap-token-address`,\r\n    AddressZero\r\n  );\r\n  const [isApproving, setIsApproving] = useState(false);\r\n  const [isWaitingForApproval, setIsWaitingForApproval] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [anchorOnSwapAmount, setAnchorOnSwapAmount] = useState(true);\r\n  const [feeBasisPoints, setFeeBasisPoints] = useState(\"\");\r\n  const [modalError, setModalError] = useState(false);\r\n\r\n  const readerAddress = getContract(chainId, \"Reader\");\r\n  const rewardReaderAddress = getContract(chainId, \"RewardReader\");\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const nativeTokenAddress = getContract(chainId, \"NATIVE_TOKEN\");\r\n  const stakedGlpTrackerAddress = getContract(chainId, \"StakedGlpTracker\");\r\n  const feeGlpTrackerAddress = getContract(chainId, \"FeeGlpTracker\");\r\n  const usdgAddress = getContract(chainId, \"USDG\");\r\n  const glpManagerAddress = getContract(chainId, \"GlpManager\");\r\n  const rewardRouterAddress = getContract(chainId, \"RewardRouter\");\r\n  const tokensForBalanceAndSupplyQuery = [stakedGlpTrackerAddress, usdgAddress];\r\n\r\n  const tokenAddresses = tokens.map((token) => token.address);\r\n  const { data: tokenBalances } = useSWR(\r\n    [`GlpSwap:getTokenBalances:${active}`, chainId, readerAddress, \"getTokenBalances\", account || PLACEHOLDER_ACCOUNT],\r\n    {\r\n      fetcher: fetcher(library, ReaderV2, [tokenAddresses]),\r\n    }\r\n  );\r\n\r\n  const { data: balancesAndSupplies } = useSWR(\r\n    [\r\n      `GlpSwap:getTokenBalancesWithSupplies:${active}`,\r\n      chainId,\r\n      readerAddress,\r\n      \"getTokenBalancesWithSupplies\",\r\n      account || PLACEHOLDER_ACCOUNT,\r\n    ],\r\n    {\r\n      fetcher: fetcher(library, ReaderV2, [tokensForBalanceAndSupplyQuery]),\r\n    }\r\n  );\r\n\r\n  const { data: aums } = useSWR([`GlpSwap:getAums:${active}`, chainId, glpManagerAddress, \"getAums\"], {\r\n    fetcher: fetcher(library, GlpManager),\r\n  });\r\n\r\n  const { data: totalTokenWeights } = useSWR(\r\n    [`GlpSwap:totalTokenWeights:${active}`, chainId, vaultAddress, \"totalTokenWeights\"],\r\n    {\r\n      fetcher: fetcher(library, VaultV2),\r\n    }\r\n  );\r\n\r\n  const tokenAllowanceAddress = swapTokenAddress === AddressZero ? nativeTokenAddress : swapTokenAddress;\r\n  const { data: tokenAllowance } = useSWR(\r\n    [active, chainId, tokenAllowanceAddress, \"allowance\", account || PLACEHOLDER_ACCOUNT, glpManagerAddress],\r\n    {\r\n      fetcher: fetcher(library, Token),\r\n    }\r\n  );\r\n\r\n  const { data: lastPurchaseTime } = useSWR(\r\n    [`GlpSwap:lastPurchaseTime:${active}`, chainId, glpManagerAddress, \"lastAddedAt\", account || PLACEHOLDER_ACCOUNT],\r\n    {\r\n      fetcher: fetcher(library, GlpManager),\r\n    }\r\n  );\r\n\r\n  const { data: glpBalance } = useSWR(\r\n    [`GlpSwap:glpBalance:${active}`, chainId, feeGlpTrackerAddress, \"stakedAmounts\", account || PLACEHOLDER_ACCOUNT],\r\n    {\r\n      fetcher: fetcher(library, RewardTracker),\r\n    }\r\n  );\r\n\r\n  const glpVesterAddress = getContract(chainId, \"GlpVester\");\r\n  const { data: reservedAmount } = useSWR(\r\n    [`GlpSwap:reservedAmount:${active}`, chainId, glpVesterAddress, \"pairAmounts\", account || PLACEHOLDER_ACCOUNT],\r\n    {\r\n      fetcher: fetcher(library, Vester),\r\n    }\r\n  );\r\n\r\n  const { gmxPrice } = useGmxPrice(chainId, { arbitrum: chainId === ARBITRUM ? library : undefined }, active);\r\n\r\n  const rewardTrackersForStakingInfo = [stakedGlpTrackerAddress, feeGlpTrackerAddress];\r\n  const { data: stakingInfo } = useSWR(\r\n    [`GlpSwap:stakingInfo:${active}`, chainId, rewardReaderAddress, \"getStakingInfo\", account || PLACEHOLDER_ACCOUNT],\r\n    {\r\n      fetcher: fetcher(library, RewardReader, [rewardTrackersForStakingInfo]),\r\n    }\r\n  );\r\n\r\n  const stakingData = getStakingData(stakingInfo);\r\n\r\n  const redemptionTime = lastPurchaseTime ? lastPurchaseTime.add(GLP_COOLDOWN_DURATION) : undefined;\r\n  const inCooldownWindow = redemptionTime && parseInt(Date.now() / 1000) < redemptionTime;\r\n\r\n  const glpSupply = balancesAndSupplies ? balancesAndSupplies[1] : bigNumberify(0);\r\n  const usdgSupply = balancesAndSupplies ? balancesAndSupplies[3] : bigNumberify(0);\r\n  let aum;\r\n  if (aums && aums.length > 0) {\r\n    aum = isBuying ? aums[0] : aums[1];\r\n  }\r\n  const glpPrice =\r\n    aum && aum.gt(0) && glpSupply.gt(0)\r\n      ? aum.mul(expandDecimals(1, GLP_DECIMALS)).div(glpSupply)\r\n      : expandDecimals(1, USD_DECIMALS);\r\n  let glpBalanceUsd;\r\n  if (glpBalance) {\r\n    glpBalanceUsd = glpBalance.mul(glpPrice).div(expandDecimals(1, GLP_DECIMALS));\r\n  }\r\n  const glpSupplyUsd = glpSupply.mul(glpPrice).div(expandDecimals(1, GLP_DECIMALS));\r\n\r\n  let reserveAmountUsd;\r\n  if (reservedAmount) {\r\n    reserveAmountUsd = reservedAmount.mul(glpPrice).div(expandDecimals(1, GLP_DECIMALS));\r\n  }\r\n\r\n  let maxSellAmount = glpBalance;\r\n  if (glpBalance && reservedAmount) {\r\n    maxSellAmount = glpBalance.sub(reservedAmount);\r\n  }\r\n\r\n  const { infoTokens } = useInfoTokens(library, chainId, active, tokenBalances, undefined);\r\n  const swapToken = getToken(chainId, swapTokenAddress);\r\n  const swapTokenInfo = getTokenInfo(infoTokens, swapTokenAddress);\r\n\r\n  const swapTokenBalance = swapTokenInfo && swapTokenInfo.balance ? swapTokenInfo.balance : bigNumberify(0);\r\n\r\n  const swapAmount = parseValue(swapValue, swapToken && swapToken.decimals);\r\n  const glpAmount = parseValue(glpValue, GLP_DECIMALS);\r\n\r\n  const needApproval =\r\n    isBuying && swapTokenAddress !== AddressZero && tokenAllowance && swapAmount && swapAmount.gt(tokenAllowance);\r\n\r\n  const swapUsdMin = getUsd(swapAmount, swapTokenAddress, false, infoTokens);\r\n  const glpUsdMax = glpAmount && glpPrice ? glpAmount.mul(glpPrice).div(expandDecimals(1, GLP_DECIMALS)) : undefined;\r\n\r\n  let isSwapTokenCapReached;\r\n  if (swapTokenInfo.managedUsd && swapTokenInfo.maxUsdgAmount) {\r\n    isSwapTokenCapReached = swapTokenInfo.managedUsd.gt(\r\n      adjustForDecimals(swapTokenInfo.maxUsdgAmount, USDG_DECIMALS, USD_DECIMALS)\r\n    );\r\n  }\r\n\r\n  const onSwapValueChange = (e) => {\r\n    setAnchorOnSwapAmount(true);\r\n    setSwapValue(e.target.value);\r\n  };\r\n\r\n  const onGlpValueChange = (e) => {\r\n    setAnchorOnSwapAmount(false);\r\n    setGlpValue(e.target.value);\r\n  };\r\n\r\n  const onSelectSwapToken = (token) => {\r\n    setSwapTokenAddress(token.address);\r\n    setIsWaitingForApproval(false);\r\n  };\r\n\r\n  const nativeToken = getTokenInfo(infoTokens, AddressZero);\r\n\r\n  let totalApr = bigNumberify(0);\r\n\r\n  let feeGlpTrackerAnnualRewardsUsd;\r\n  let feeGlpTrackerApr;\r\n  if (\r\n    stakingData &&\r\n    stakingData.feeGlpTracker &&\r\n    stakingData.feeGlpTracker.tokensPerInterval &&\r\n    nativeToken &&\r\n    nativeToken.minPrice &&\r\n    glpSupplyUsd &&\r\n    glpSupplyUsd.gt(0)\r\n  ) {\r\n    feeGlpTrackerAnnualRewardsUsd = stakingData.feeGlpTracker.tokensPerInterval\r\n      .mul(SECONDS_PER_YEAR)\r\n      .mul(nativeToken.minPrice)\r\n      .div(expandDecimals(1, 18));\r\n    feeGlpTrackerApr = feeGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(glpSupplyUsd);\r\n    totalApr = totalApr.add(feeGlpTrackerApr);\r\n  }\r\n\r\n  let stakedGlpTrackerAnnualRewardsUsd;\r\n  let stakedGlpTrackerApr;\r\n\r\n  if (\r\n    gmxPrice &&\r\n    stakingData &&\r\n    stakingData.stakedGlpTracker &&\r\n    stakingData.stakedGlpTracker.tokensPerInterval &&\r\n    glpSupplyUsd &&\r\n    glpSupplyUsd.gt(0)\r\n  ) {\r\n    stakedGlpTrackerAnnualRewardsUsd = stakingData.stakedGlpTracker.tokensPerInterval\r\n      .mul(SECONDS_PER_YEAR)\r\n      .mul(gmxPrice)\r\n      .div(expandDecimals(1, 18));\r\n    stakedGlpTrackerApr = stakedGlpTrackerAnnualRewardsUsd.mul(BASIS_POINTS_DIVISOR).div(glpSupplyUsd);\r\n    totalApr = totalApr.add(stakedGlpTrackerApr);\r\n  }\r\n\r\n  useEffect(() => {\r\n    const updateSwapAmounts = () => {\r\n      if (anchorOnSwapAmount) {\r\n        if (!swapAmount) {\r\n          setGlpValue(\"\");\r\n          setFeeBasisPoints(\"\");\r\n          return;\r\n        }\r\n\r\n        if (isBuying) {\r\n          const { amount: nextAmount, feeBasisPoints: feeBps } = getBuyGlpToAmount(\r\n            swapAmount,\r\n            swapTokenAddress,\r\n            infoTokens,\r\n            glpPrice,\r\n            usdgSupply,\r\n            totalTokenWeights\r\n          );\r\n          const nextValue = formatAmountFree(nextAmount, GLP_DECIMALS, GLP_DECIMALS);\r\n          setGlpValue(nextValue);\r\n          setFeeBasisPoints(feeBps);\r\n        } else {\r\n          const { amount: nextAmount, feeBasisPoints: feeBps } = getSellGlpFromAmount(\r\n            swapAmount,\r\n            swapTokenAddress,\r\n            infoTokens,\r\n            glpPrice,\r\n            usdgSupply,\r\n            totalTokenWeights\r\n          );\r\n          const nextValue = formatAmountFree(nextAmount, GLP_DECIMALS, GLP_DECIMALS);\r\n          setGlpValue(nextValue);\r\n          setFeeBasisPoints(feeBps);\r\n        }\r\n\r\n        return;\r\n      }\r\n\r\n      if (!glpAmount) {\r\n        setSwapValue(\"\");\r\n        setFeeBasisPoints(\"\");\r\n        return;\r\n      }\r\n\r\n      if (swapToken) {\r\n        if (isBuying) {\r\n          const { amount: nextAmount, feeBasisPoints: feeBps } = getBuyGlpFromAmount(\r\n            glpAmount,\r\n            swapTokenAddress,\r\n            infoTokens,\r\n            glpPrice,\r\n            usdgSupply,\r\n            totalTokenWeights\r\n          );\r\n          const nextValue = formatAmountFree(nextAmount, swapToken.decimals, swapToken.decimals);\r\n          setSwapValue(nextValue);\r\n          setFeeBasisPoints(feeBps);\r\n        } else {\r\n          const { amount: nextAmount, feeBasisPoints: feeBps } = getSellGlpToAmount(\r\n            glpAmount,\r\n            swapTokenAddress,\r\n            infoTokens,\r\n            glpPrice,\r\n            usdgSupply,\r\n            totalTokenWeights,\r\n            true\r\n          );\r\n\r\n          const nextValue = formatAmountFree(nextAmount, swapToken.decimals, swapToken.decimals);\r\n          setSwapValue(nextValue);\r\n          setFeeBasisPoints(feeBps);\r\n        }\r\n      }\r\n    };\r\n\r\n    updateSwapAmounts();\r\n  }, [\r\n    isBuying,\r\n    anchorOnSwapAmount,\r\n    swapAmount,\r\n    glpAmount,\r\n    swapToken,\r\n    swapTokenAddress,\r\n    infoTokens,\r\n    glpPrice,\r\n    usdgSupply,\r\n    totalTokenWeights,\r\n  ]);\r\n\r\n  const switchSwapOption = (hash = \"\") => {\r\n    history.push(`${history.location.pathname}#${hash}`);\r\n    props.setIsBuying(hash === \"redeem\" ? false : true);\r\n  };\r\n\r\n  const fillMaxAmount = () => {\r\n    if (isBuying) {\r\n      setAnchorOnSwapAmount(true);\r\n      setSwapValue(formatAmountFree(swapTokenBalance, swapToken.decimals, swapToken.decimals));\r\n      return;\r\n    }\r\n\r\n    setAnchorOnSwapAmount(false);\r\n    setGlpValue(formatAmountFree(maxSellAmount, GLP_DECIMALS, GLP_DECIMALS));\r\n  };\r\n\r\n  const getError = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      if (isBuying) return [t`GLP buy disabled, pending ${getChainName(chainId)} upgrade`];\r\n      return [t`GLP sell disabled, pending ${getChainName(chainId)} upgrade`];\r\n    }\r\n\r\n    if (!isBuying && inCooldownWindow) {\r\n      return [t`Redemption time not yet reached`];\r\n    }\r\n\r\n    if (!swapAmount || swapAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n    if (!glpAmount || glpAmount.eq(0)) {\r\n      return [t`Enter an amount`];\r\n    }\r\n\r\n    if (isBuying) {\r\n      const swapTokenInfo = getTokenInfo(infoTokens, swapTokenAddress);\r\n      if (\r\n        !savedShouldDisableValidationForTesting &&\r\n        swapTokenInfo &&\r\n        swapTokenInfo.balance &&\r\n        swapAmount &&\r\n        swapAmount.gt(swapTokenInfo.balance)\r\n      ) {\r\n        return [t`Insufficient ${swapTokenInfo.symbol} balance`];\r\n      }\r\n\r\n      if (swapTokenInfo.maxUsdgAmount && swapTokenInfo.usdgAmount && swapUsdMin) {\r\n        const usdgFromAmount = adjustForDecimals(swapUsdMin, USD_DECIMALS, USDG_DECIMALS);\r\n        const nextUsdgAmount = swapTokenInfo.usdgAmount.add(usdgFromAmount);\r\n        if (swapTokenInfo.maxUsdgAmount.gt(0) && nextUsdgAmount.gt(swapTokenInfo.maxUsdgAmount)) {\r\n          return [t`${swapTokenInfo.symbol} pool exceeded, try different token`, true];\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!isBuying) {\r\n      if (maxSellAmount && glpAmount && glpAmount.gt(maxSellAmount)) {\r\n        return [t`Insufficient GLP balance`];\r\n      }\r\n\r\n      const swapTokenInfo = getTokenInfo(infoTokens, swapTokenAddress);\r\n      if (\r\n        swapTokenInfo &&\r\n        swapTokenInfo.availableAmount &&\r\n        swapAmount &&\r\n        swapAmount.gt(swapTokenInfo.availableAmount)\r\n      ) {\r\n        return [t`Insufficient liquidity`];\r\n      }\r\n    }\r\n\r\n    return [false];\r\n  };\r\n\r\n  const isPrimaryEnabled = () => {\r\n    if (IS_NETWORK_DISABLED[chainId]) {\r\n      return false;\r\n    }\r\n    if (!active) {\r\n      return true;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return false;\r\n    }\r\n    if ((needApproval && isWaitingForApproval) || isApproving) {\r\n      return false;\r\n    }\r\n    if (isApproving) {\r\n      return false;\r\n    }\r\n    if (isSubmitting) {\r\n      return false;\r\n    }\r\n    if (isBuying && isSwapTokenCapReached) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  };\r\n\r\n  const getPrimaryText = () => {\r\n    if (!active) {\r\n      return t`Connect Wallet`;\r\n    }\r\n    const [error, modal] = getError();\r\n    if (error && !modal) {\r\n      return error;\r\n    }\r\n    if (isBuying && isSwapTokenCapReached) {\r\n      return t`Max Capacity for ${swapToken.symbol} Reached`;\r\n    }\r\n\r\n    if (needApproval && isWaitingForApproval) {\r\n      return t`Waiting for Approval`;\r\n    }\r\n    if (isApproving) {\r\n      return t`Approving ${swapToken.symbol}...`;\r\n    }\r\n    if (needApproval) {\r\n      return t`Approve ${swapToken.symbol}`;\r\n    }\r\n\r\n    if (isSubmitting) {\r\n      return isBuying ? t`Buying...` : t`Selling...`;\r\n    }\r\n\r\n    return isBuying ? t`Buy GLP` : t`Sell GLP`;\r\n  };\r\n\r\n  const approveFromToken = () => {\r\n    approveTokens({\r\n      setIsApproving,\r\n      library,\r\n      tokenAddress: swapToken.address,\r\n      spender: glpManagerAddress,\r\n      chainId: chainId,\r\n      onApproveSubmitted: () => {\r\n        setIsWaitingForApproval(true);\r\n      },\r\n      infoTokens,\r\n      getTokenInfo,\r\n    });\r\n  };\r\n\r\n  const buyGlp = () => {\r\n    setIsSubmitting(true);\r\n\r\n    const minGlp = glpAmount.mul(BASIS_POINTS_DIVISOR - savedSlippageAmount).div(BASIS_POINTS_DIVISOR);\r\n\r\n    const contract = new ethers.Contract(rewardRouterAddress, RewardRouter.abi, library.getSigner());\r\n    const method = swapTokenAddress === AddressZero ? \"mintAndStakeGlpETH\" : \"mintAndStakeGlp\";\r\n    const params = swapTokenAddress === AddressZero ? [0, minGlp] : [swapTokenAddress, swapAmount, 0, minGlp];\r\n    const value = swapTokenAddress === AddressZero ? swapAmount : 0;\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      value,\r\n      sentMsg: t`Buy submitted.`,\r\n      failMsg: t`Buy failed.`,\r\n      successMsg: t`${formatAmount(glpAmount, 18, 4, true)} GLP bought with ${formatAmount(\r\n        swapAmount,\r\n        swapTokenInfo.decimals,\r\n        4,\r\n        true\r\n      )} ${swapTokenInfo.symbol}!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async () => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const sellGlp = () => {\r\n    setIsSubmitting(true);\r\n\r\n    const minOut = swapAmount.mul(BASIS_POINTS_DIVISOR - savedSlippageAmount).div(BASIS_POINTS_DIVISOR);\r\n\r\n    const contract = new ethers.Contract(rewardRouterAddress, RewardRouter.abi, library.getSigner());\r\n    const method = swapTokenAddress === AddressZero ? \"unstakeAndRedeemGlpETH\" : \"unstakeAndRedeemGlp\";\r\n    const params =\r\n      swapTokenAddress === AddressZero ? [glpAmount, minOut, account] : [swapTokenAddress, glpAmount, minOut, account];\r\n\r\n    callContract(chainId, contract, method, params, {\r\n      sentMsg: t`Sell submitted!`,\r\n      failMsg: t`Sell failed.`,\r\n      successMsg: t`${formatAmount(glpAmount, 18, 4, true)} GLP sold for ${formatAmount(\r\n        swapAmount,\r\n        swapTokenInfo.decimals,\r\n        4,\r\n        true\r\n      )} ${swapTokenInfo.symbol}!`,\r\n      setPendingTxns,\r\n    })\r\n      .then(async () => {})\r\n      .finally(() => {\r\n        setIsSubmitting(false);\r\n      });\r\n  };\r\n\r\n  const onClickPrimary = () => {\r\n    if (!active) {\r\n      connectWallet();\r\n      return;\r\n    }\r\n\r\n    if (needApproval) {\r\n      approveFromToken();\r\n      return;\r\n    }\r\n\r\n    const [, modal] = getError();\r\n\r\n    if (modal) {\r\n      setModalError(true);\r\n      return;\r\n    }\r\n\r\n    if (isBuying) {\r\n      buyGlp();\r\n    } else {\r\n      sellGlp();\r\n    }\r\n  };\r\n\r\n  let payLabel = t`Pay`;\r\n  let receiveLabel = t`Receive`;\r\n  let payBalance = \"$0.00\";\r\n  let receiveBalance = \"$0.00\";\r\n  if (isBuying) {\r\n    if (swapUsdMin) {\r\n      payBalance = `$${formatAmount(swapUsdMin, USD_DECIMALS, 2, true)}`;\r\n    }\r\n    if (glpUsdMax) {\r\n      receiveBalance = `$${formatAmount(glpUsdMax, USD_DECIMALS, 2, true)}`;\r\n    }\r\n  } else {\r\n    if (glpUsdMax) {\r\n      payBalance = `$${formatAmount(glpUsdMax, USD_DECIMALS, 2, true)}`;\r\n    }\r\n    if (swapUsdMin) {\r\n      receiveBalance = `$${formatAmount(swapUsdMin, USD_DECIMALS, 2, true)}`;\r\n    }\r\n  }\r\n\r\n  const selectToken = (token) => {\r\n    setAnchorOnSwapAmount(false);\r\n    setSwapTokenAddress(token.address);\r\n    helperToast.success(t`${token.symbol} selected in order form`);\r\n  };\r\n\r\n  let feePercentageText = formatAmount(feeBasisPoints, 2, 2, true, \"-\");\r\n  if (feeBasisPoints !== undefined && feeBasisPoints.toString().length > 0) {\r\n    feePercentageText += \"%\";\r\n  }\r\n\r\n  const wrappedTokenSymbol = getWrappedToken(chainId).symbol;\r\n  const nativeTokenSymbol = getNativeToken(chainId).symbol;\r\n\r\n  const onSwapOptionChange = (opt) => {\r\n    if (opt === t`Sell GLP`) {\r\n      switchSwapOption(\"redeem\");\r\n    } else {\r\n      switchSwapOption();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"GlpSwap\">\r\n      <SwapErrorModal\r\n        isVisible={Boolean(modalError)}\r\n        setIsVisible={setModalError}\r\n        swapToken={swapToken}\r\n        chainId={chainId}\r\n        glpAmount={glpAmount}\r\n        usdgSupply={usdgSupply}\r\n        totalTokenWeights={totalTokenWeights}\r\n        glpPrice={glpPrice}\r\n        infoTokens={infoTokens}\r\n        swapUsdMin={swapUsdMin}\r\n      />\r\n      {/* <div className=\"Page-title-section\">\r\n        <div className=\"Page-title\">{isBuying ? \"Buy GLP\" : \"Sell GLP\"}</div>\r\n        {isBuying && <div className=\"Page-description\">\r\n          Purchase <a href=\"https://gmxio.gitbook.io/gmx/glp\" target=\"_blank\" rel=\"noopener noreferrer\">GLP tokens</a> to earn {nativeTokenSymbol} fees from swaps and leverage trading.<br/>\r\n          Note that there is a minimum holding time of 15 minutes after a purchase.<br/>\r\n          <div>View <Link to=\"/earn\">staking</Link> page.</div>\r\n        </div>}\r\n        {!isBuying && <div className=\"Page-description\">\r\n          Redeem your GLP tokens for any supported asset.\r\n          {inCooldownWindow && <div>\r\n            GLP tokens can only be redeemed 15 minutes after your most recent purchase.<br/>\r\n            Your last purchase was at {formatDateTime(lastPurchaseTime)}, you can redeem GLP tokens after {formatDateTime(redemptionTime)}.<br/>\r\n          </div>}\r\n          <div>View <Link to=\"/earn\">staking</Link> page.</div>\r\n        </div>}\r\n      </div> */}\r\n      <div className=\"GlpSwap-content\">\r\n        <div className=\"App-card GlpSwap-stats-card\">\r\n          <div className=\"App-card-title\">\r\n            <div className=\"App-card-title-mark\">\r\n              <div className=\"App-card-title-mark-icon\">\r\n                <img src={glp40Icon} alt=\"glp40Icon\" />\r\n                {chainId === ARBITRUM ? (\r\n                  <img src={arbitrum16Icon} alt=\"arbitrum16Icon\" className=\"selected-network-symbol\" />\r\n                ) : (\r\n                  <img src={avalanche16Icon} alt=\"avalanche16Icon\" className=\"selected-network-symbol\" />\r\n                )}\r\n              </div>\r\n              <div className=\"App-card-title-mark-info\">\r\n                <div className=\"App-card-title-mark-title\">GLP</div>\r\n                <div className=\"App-card-title-mark-subtitle\">GLP</div>\r\n              </div>\r\n              <div>\r\n                <AssetDropdown assetSymbol=\"GLP\" />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"App-card-content\">\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Price</Trans>\r\n              </div>\r\n              <div className=\"value\">${formatAmount(glpPrice, USD_DECIMALS, 3, true)}</div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Wallet</Trans>\r\n              </div>\r\n              <div className=\"value\">\r\n                {formatAmount(glpBalance, GLP_DECIMALS, 4, true)} GLP ($\r\n                {formatAmount(glpBalanceUsd, USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">Staked</div>\r\n              <div className=\"value\">\r\n                {formatAmount(glpBalance, GLP_DECIMALS, 4, true)} GLP ($\r\n                {formatAmount(glpBalanceUsd, USD_DECIMALS, 2, true)})\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"App-card-divider\"></div>\r\n          <div className=\"App-card-content\">\r\n            {!isBuying && (\r\n              <div className=\"App-card-row\">\r\n                <div className=\"label\">\r\n                  <Trans>Reserved</Trans>\r\n                </div>\r\n                <div className=\"value\">\r\n                  <Tooltip\r\n                    handle={`${formatAmount(reservedAmount, 18, 4, true)} GLP ($${formatAmount(\r\n                      reserveAmountUsd,\r\n                      USD_DECIMALS,\r\n                      2,\r\n                      true\r\n                    )})`}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() =>\r\n                      t`${formatAmount(reservedAmount, 18, 4, true)} GLP have been reserved for vesting.`\r\n                    }\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>APR</Trans>\r\n              </div>\r\n              <div className=\"value\">\r\n                <Tooltip\r\n                  handle={`${formatAmount(totalApr, 2, 2, true)}%`}\r\n                  position=\"right-bottom\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <>\r\n                        <StatsTooltipRow\r\n                          label={t`${nativeTokenSymbol} (${wrappedTokenSymbol}) APR`}\r\n                          value={`${formatAmount(feeGlpTrackerApr, 2, 2, false)}%`}\r\n                          showDollar={false}\r\n                        />\r\n                        <StatsTooltipRow\r\n                          label={t`Escrowed GMX APR`}\r\n                          value={`${formatAmount(stakedGlpTrackerApr, 2, 2, false)}%`}\r\n                          showDollar={false}\r\n                        />\r\n                      </>\r\n                    );\r\n                  }}\r\n                />\r\n              </div>\r\n            </div>\r\n            <div className=\"App-card-row\">\r\n              <div className=\"label\">\r\n                <Trans>Total Supply</Trans>\r\n              </div>\r\n              <div className=\"value\">\r\n                <Trans>\r\n                  {formatAmount(glpSupply, GLP_DECIMALS, 4, true)} GLP ($\r\n                  {formatAmount(glpSupplyUsd, USD_DECIMALS, 2, true)})\r\n                </Trans>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div className=\"GlpSwap-box App-box\">\r\n          <Tab\r\n            options={[t`Buy GLP`, t`Sell GLP`]}\r\n            option={tabLabel}\r\n            onChange={onSwapOptionChange}\r\n            className=\"Exchange-swap-option-tabs\"\r\n          />\r\n          {isBuying && (\r\n            <BuyInputSection\r\n              topLeftLabel={payLabel}\r\n              topRightLabel={t`Balance: `}\r\n              tokenBalance={`${formatAmount(swapTokenBalance, swapToken.decimals, 4, true)}`}\r\n              inputValue={swapValue}\r\n              onInputValueChange={onSwapValueChange}\r\n              showMaxButton={swapValue !== formatAmountFree(swapTokenBalance, swapToken.decimals, swapToken.decimals)}\r\n              onClickTopRightLabel={fillMaxAmount}\r\n              onClickMax={fillMaxAmount}\r\n              selectedToken={swapToken}\r\n              balance={payBalance}\r\n            >\r\n              <TokenSelector\r\n                label={t`Pay`}\r\n                chainId={chainId}\r\n                tokenAddress={swapTokenAddress}\r\n                onSelectToken={onSelectSwapToken}\r\n                tokens={whitelistedTokens}\r\n                infoTokens={infoTokens}\r\n                className=\"GlpSwap-from-token\"\r\n                showSymbolImage={true}\r\n                showTokenImgInDropdown={true}\r\n              />\r\n            </BuyInputSection>\r\n          )}\r\n\r\n          {!isBuying && (\r\n            <BuyInputSection\r\n              topLeftLabel={payLabel}\r\n              topRightLabel={t`Available: `}\r\n              tokenBalance={`${formatAmount(maxSellAmount, GLP_DECIMALS, 4, true)}`}\r\n              inputValue={glpValue}\r\n              onInputValueChange={onGlpValueChange}\r\n              showMaxButton={glpValue !== formatAmountFree(maxSellAmount, GLP_DECIMALS, GLP_DECIMALS)}\r\n              onClickTopRightLabel={fillMaxAmount}\r\n              onClickMax={fillMaxAmount}\r\n              balance={payBalance}\r\n              defaultTokenName={\"GLP\"}\r\n            >\r\n              <div className=\"selected-token\">\r\n                GLP <img src={glp24Icon} alt=\"glp24Icon\" />\r\n              </div>\r\n            </BuyInputSection>\r\n          )}\r\n\r\n          <div className=\"AppOrder-ball-container\">\r\n            <div className=\"AppOrder-ball\">\r\n              <img\r\n                src={arrowIcon}\r\n                alt=\"arrowIcon\"\r\n                onClick={() => {\r\n                  setIsBuying(!isBuying);\r\n                  switchSwapOption(isBuying ? \"redeem\" : \"\");\r\n                }}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {isBuying && (\r\n            <BuyInputSection\r\n              topLeftLabel={receiveLabel}\r\n              topRightLabel={t`Balance: `}\r\n              tokenBalance={`${formatAmount(glpBalance, GLP_DECIMALS, 4, true)}`}\r\n              inputValue={glpValue}\r\n              onInputValueChange={onGlpValueChange}\r\n              balance={receiveBalance}\r\n              defaultTokenName={\"GLP\"}\r\n            >\r\n              <div className=\"selected-token\">\r\n                GLP <img src={glp24Icon} alt=\"glp24Icon\" />\r\n              </div>\r\n            </BuyInputSection>\r\n          )}\r\n\r\n          {!isBuying && (\r\n            <BuyInputSection\r\n              topLeftLabel={receiveLabel}\r\n              topRightLabel={t`Balance: `}\r\n              tokenBalance={`${formatAmount(swapTokenBalance, swapToken.decimals, 4, true)}`}\r\n              inputValue={swapValue}\r\n              onInputValueChange={onSwapValueChange}\r\n              balance={receiveBalance}\r\n              selectedToken={swapToken}\r\n            >\r\n              <TokenSelector\r\n                label={t`Receive`}\r\n                chainId={chainId}\r\n                tokenAddress={swapTokenAddress}\r\n                onSelectToken={onSelectSwapToken}\r\n                tokens={whitelistedTokens}\r\n                infoTokens={infoTokens}\r\n                className=\"GlpSwap-from-token\"\r\n                showSymbolImage={true}\r\n                showTokenImgInDropdown={true}\r\n              />\r\n            </BuyInputSection>\r\n          )}\r\n\r\n          <div>\r\n            <div className=\"Exchange-info-row\">\r\n              <div className=\"Exchange-info-label\">{feeBasisPoints > 50 ? t`WARNING: High Fees` : t`Fees`}</div>\r\n              <div className=\"align-right fee-block\">\r\n                {isBuying && (\r\n                  <Tooltip\r\n                    handle={isBuying && isSwapTokenCapReached ? \"NA\" : feePercentageText}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      if (!feeBasisPoints) {\r\n                        return (\r\n                          <div className=\"text-white\">\r\n                            Fees will be shown once you have entered an amount in the order form.\r\n                          </div>\r\n                        );\r\n                      }\r\n                      return (\r\n                        <div className=\"text-white\">\r\n                          {feeBasisPoints > 50 && <Trans>To reduce fees, select a different asset to pay with.</Trans>}\r\n                          <Trans>Check the \"Save on Fees\" section below to get the lowest fee percentages.</Trans>\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                )}\r\n                {!isBuying && (\r\n                  <Tooltip\r\n                    handle={feePercentageText}\r\n                    position=\"right-bottom\"\r\n                    renderContent={() => {\r\n                      if (!feeBasisPoints) {\r\n                        return (\r\n                          <div className=\"text-white\">\r\n                            Fees will be shown once you have entered an amount in the order form.\r\n                          </div>\r\n                        );\r\n                      }\r\n                      return (\r\n                        <div className=\"text-white\">\r\n                          {feeBasisPoints > 50 && <Trans>To reduce fees, select a different asset to receive.</Trans>}\r\n                          <Trans>Check the \"Save on Fees\" section below to get the lowest fee percentages.</Trans>\r\n                        </div>\r\n                      );\r\n                    }}\r\n                  />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className=\"GlpSwap-cta Exchange-swap-button-container\">\r\n            <button className=\"App-cta Exchange-swap-button\" onClick={onClickPrimary} disabled={!isPrimaryEnabled()}>\r\n              {getPrimaryText()}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div className=\"Tab-title-section\">\r\n        <div className=\"Page-title\">Save on Fees</div>\r\n        {isBuying && (\r\n          <div className=\"Page-description\">\r\n            <Trans>Fees may vary depending on which asset you use to buy GLP.</Trans>\r\n            <br />{\" \"}\r\n            <Trans>\r\n              Enter the amount of GLP you want to purchase in the order form, then check here to compare fees.\r\n            </Trans>\r\n          </div>\r\n        )}\r\n        {!isBuying && (\r\n          <div className=\"Page-description\">\r\n            <Trans>Fees may vary depending on which asset you sell GLP for.</Trans>\r\n            <br />{\" \"}\r\n            <Trans>\r\n              Enter the amount of GLP you want to redeem in the order form, then check here to compare fees.\r\n            </Trans>\r\n          </div>\r\n        )}\r\n      </div>\r\n      <div className=\"GlpSwap-token-list\">\r\n        {/* <div className=\"GlpSwap-token-list-content\"> */}\r\n        <table className=\"token-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>\r\n                <Trans>TOKEN</Trans>\r\n              </th>\r\n              <th>\r\n                <Trans>PRICE</Trans>\r\n              </th>\r\n              <th>\r\n                {isBuying ? (\r\n                  <Tooltip\r\n                    handle={t`AVAILABLE`}\r\n                    tooltipIconPosition=\"right\"\r\n                    position=\"right-bottom text-none\"\r\n                    renderContent={() => (\r\n                      <p className=\"text-white\">\r\n                        <Trans>Available amount to deposit into GLP.</Trans>\r\n                      </p>\r\n                    )}\r\n                  />\r\n                ) : (\r\n                  <Tooltip\r\n                    handle={t`AVAILABLE`}\r\n                    tooltipIconPosition=\"right\"\r\n                    position=\"center-bottom text-none\"\r\n                    renderContent={() => {\r\n                      return (\r\n                        <p className=\"text-white\">\r\n                          <Trans>\r\n                            Available amount to withdraw from GLP. Funds not utilized by current open positions.\r\n                          </Trans>\r\n                        </p>\r\n                      );\r\n                    }}\r\n                  />\r\n                )}\r\n              </th>\r\n              <th>\r\n                <Trans>WALLET</Trans>\r\n              </th>\r\n              <th>\r\n                <Tooltip\r\n                  handle={t`FEES`}\r\n                  tooltipIconPosition=\"right\"\r\n                  position=\"right-bottom text-none\"\r\n                  renderContent={() => {\r\n                    return (\r\n                      <div className=\"text-white\">\r\n                        <Trans>Fees will be shown once you have entered an amount in the order form.</Trans>\r\n                      </div>\r\n                    );\r\n                  }}\r\n                />\r\n              </th>\r\n              <th></th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {visibleTokens.map((token) => {\r\n              let tokenFeeBps;\r\n              if (isBuying) {\r\n                const { feeBasisPoints: feeBps } = getBuyGlpFromAmount(\r\n                  glpAmount,\r\n                  token.address,\r\n                  infoTokens,\r\n                  glpPrice,\r\n                  usdgSupply,\r\n                  totalTokenWeights\r\n                );\r\n                tokenFeeBps = feeBps;\r\n              } else {\r\n                const { feeBasisPoints: feeBps } = getSellGlpToAmount(\r\n                  glpAmount,\r\n                  token.address,\r\n                  infoTokens,\r\n                  glpPrice,\r\n                  usdgSupply,\r\n                  totalTokenWeights\r\n                );\r\n                tokenFeeBps = feeBps;\r\n              }\r\n              const tokenInfo = getTokenInfo(infoTokens, token.address);\r\n              let managedUsd;\r\n              if (tokenInfo && tokenInfo.managedUsd) {\r\n                managedUsd = tokenInfo.managedUsd;\r\n              }\r\n              let availableAmountUsd;\r\n              if (tokenInfo && tokenInfo.minPrice && tokenInfo.availableAmount) {\r\n                availableAmountUsd = tokenInfo.availableAmount\r\n                  .mul(tokenInfo.minPrice)\r\n                  .div(expandDecimals(1, token.decimals));\r\n              }\r\n              let balanceUsd;\r\n              if (tokenInfo && tokenInfo.minPrice && tokenInfo.balance) {\r\n                balanceUsd = tokenInfo.balance.mul(tokenInfo.minPrice).div(expandDecimals(1, token.decimals));\r\n              }\r\n              const tokenImage = importImage(\"ic_\" + token.symbol.toLowerCase() + \"_40.svg\");\r\n              let isCapReached = tokenInfo.managedAmount?.gt(tokenInfo.maxUsdgAmount);\r\n\r\n              let amountLeftToDeposit = bigNumberify(0);\r\n              if (tokenInfo.maxUsdgAmount && tokenInfo.maxUsdgAmount.gt(0)) {\r\n                amountLeftToDeposit = tokenInfo.maxUsdgAmount\r\n                  .sub(tokenInfo.usdgAmount)\r\n                  .mul(expandDecimals(1, USD_DECIMALS))\r\n                  .div(expandDecimals(1, USDG_DECIMALS));\r\n              }\r\n              if (amountLeftToDeposit.lt(0)) {\r\n                amountLeftToDeposit = bigNumberify(0);\r\n              }\r\n              function renderFees() {\r\n                const swapUrl = `https://app.1inch.io/#/${chainId}/swap/`;\r\n                switch (true) {\r\n                  case (isBuying && isCapReached) || (!isBuying && managedUsd?.lt(1)):\r\n                    return (\r\n                      <Tooltip\r\n                        handle=\"NA\"\r\n                        position=\"right-bottom\"\r\n                        renderContent={() => (\r\n                          <div className=\"text-white\">\r\n                            <Trans>Max pool capacity reached for {tokenInfo.symbol}</Trans>\r\n\r\n                            <br />\r\n                            <br />\r\n                            <Trans>Please mint GLP using another token</Trans>\r\n                            <br />\r\n                            <p>\r\n                              <a href={swapUrl} target=\"_blank\" rel=\"noreferrer\">\r\n                                <Trans> Swap {tokenInfo.symbol} on 1inch</Trans>\r\n                              </a>\r\n                            </p>\r\n                          </div>\r\n                        )}\r\n                      />\r\n                    );\r\n                  case (isBuying && !isCapReached) || (!isBuying && managedUsd?.gt(0)):\r\n                    return `${formatAmount(tokenFeeBps, 2, 2, true, \"-\")}${\r\n                      tokenFeeBps !== undefined && tokenFeeBps.toString().length > 0 ? \"%\" : \"\"\r\n                    }`;\r\n                  default:\r\n                    return \"\";\r\n                }\r\n              }\r\n\r\n              return (\r\n                <tr key={token.symbol}>\r\n                  <td>\r\n                    <div className=\"App-card-title-info\">\r\n                      <div className=\"App-card-title-info-icon\">\r\n                        <img src={tokenImage} alt={token.symbol} width=\"40px\" />\r\n                      </div>\r\n                      <div className=\"App-card-title-info-text\">\r\n                        <div className=\"App-card-info-title\">{token.name}</div>\r\n                        <div className=\"App-card-info-subtitle\">{token.symbol}</div>\r\n                      </div>\r\n                      <div>\r\n                        <AssetDropdown assetSymbol={token.symbol} assetInfo={token} />\r\n                      </div>\r\n                    </div>\r\n                  </td>\r\n                  <td>${formatKeyAmount(tokenInfo, \"minPrice\", USD_DECIMALS, 2, true)}</td>\r\n                  <td>\r\n                    {isBuying && (\r\n                      <div>\r\n                        <Tooltip\r\n                          handle={\r\n                            amountLeftToDeposit && amountLeftToDeposit.lt(0)\r\n                              ? \"$0.00\"\r\n                              : `$${formatAmount(amountLeftToDeposit, USD_DECIMALS, 2, true)}`\r\n                          }\r\n                          position=\"right-bottom\"\r\n                          tooltipIconPosition=\"right\"\r\n                          renderContent={() => getTooltipContent(managedUsd, tokenInfo, token)}\r\n                        />\r\n                      </div>\r\n                    )}\r\n                    {!isBuying && (\r\n                      <div>\r\n                        <Tooltip\r\n                          handle={\r\n                            availableAmountUsd && availableAmountUsd.lt(0)\r\n                              ? \"$0.00\"\r\n                              : `$${formatAmount(availableAmountUsd, USD_DECIMALS, 2, true)}`\r\n                          }\r\n                          position=\"right-bottom\"\r\n                          tooltipIconPosition=\"right\"\r\n                          renderContent={() => getTooltipContent(managedUsd, tokenInfo, token)}\r\n                        />\r\n                      </div>\r\n                    )}\r\n                  </td>\r\n                  <td>\r\n                    {formatKeyAmount(tokenInfo, \"balance\", tokenInfo.decimals, 2, true)} {tokenInfo.symbol} ($\r\n                    {formatAmount(balanceUsd, USD_DECIMALS, 2, true)})\r\n                  </td>\r\n                  <td>{renderFees()}</td>\r\n                  <td>\r\n                    <button\r\n                      className={cx(\"App-button-option action-btn\", isBuying ? \"buying\" : \"selling\")}\r\n                      onClick={() => selectToken(token)}\r\n                    >\r\n                      {isBuying ? t`Buy with ${token.symbol}` : t`Sell for ${token.symbol}`}\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              );\r\n            })}\r\n          </tbody>\r\n        </table>\r\n        <div className=\"token-grid\">\r\n          {visibleTokens.map((token) => {\r\n            let tokenFeeBps;\r\n            if (isBuying) {\r\n              const { feeBasisPoints: feeBps } = getBuyGlpFromAmount(\r\n                glpAmount,\r\n                token.address,\r\n                infoTokens,\r\n                glpPrice,\r\n                usdgSupply,\r\n                totalTokenWeights\r\n              );\r\n              tokenFeeBps = feeBps;\r\n            } else {\r\n              const { feeBasisPoints: feeBps } = getSellGlpToAmount(\r\n                glpAmount,\r\n                token.address,\r\n                infoTokens,\r\n                glpPrice,\r\n                usdgSupply,\r\n                totalTokenWeights\r\n              );\r\n              tokenFeeBps = feeBps;\r\n            }\r\n            const tokenInfo = getTokenInfo(infoTokens, token.address);\r\n            let managedUsd;\r\n            if (tokenInfo && tokenInfo.managedUsd) {\r\n              managedUsd = tokenInfo.managedUsd;\r\n            }\r\n            let availableAmountUsd;\r\n            if (tokenInfo && tokenInfo.minPrice && tokenInfo.availableAmount) {\r\n              availableAmountUsd = tokenInfo.availableAmount\r\n                .mul(tokenInfo.minPrice)\r\n                .div(expandDecimals(1, token.decimals));\r\n            }\r\n            let balanceUsd;\r\n            if (tokenInfo && tokenInfo.minPrice && tokenInfo.balance) {\r\n              balanceUsd = tokenInfo.balance.mul(tokenInfo.minPrice).div(expandDecimals(1, token.decimals));\r\n            }\r\n\r\n            let amountLeftToDeposit = bigNumberify(0);\r\n            if (tokenInfo.maxUsdgAmount && tokenInfo.maxUsdgAmount.gt(0)) {\r\n              amountLeftToDeposit = tokenInfo.maxUsdgAmount\r\n                .sub(tokenInfo.usdgAmount)\r\n                .mul(expandDecimals(1, USD_DECIMALS))\r\n                .div(expandDecimals(1, USDG_DECIMALS));\r\n            }\r\n            if (amountLeftToDeposit.lt(0)) {\r\n              amountLeftToDeposit = bigNumberify(0);\r\n            }\r\n            let isCapReached = tokenInfo.managedAmount?.gt(tokenInfo.maxUsdgAmount);\r\n\r\n            function renderFees() {\r\n              switch (true) {\r\n                case (isBuying && isCapReached) || (!isBuying && managedUsd?.lt(1)):\r\n                  return (\r\n                    <Tooltip\r\n                      handle=\"NA\"\r\n                      position=\"right-bottom\"\r\n                      renderContent={() => (\r\n                        <Trans>\r\n                          Max pool capacity reached for {tokenInfo.symbol}. Please mint GLP using another token\r\n                        </Trans>\r\n                      )}\r\n                    />\r\n                  );\r\n                case (isBuying && !isCapReached) || (!isBuying && managedUsd?.gt(0)):\r\n                  return `${formatAmount(tokenFeeBps, 2, 2, true, \"-\")}${\r\n                    tokenFeeBps !== undefined && tokenFeeBps.toString().length > 0 ? \"%\" : \"\"\r\n                  }`;\r\n                default:\r\n                  return \"\";\r\n              }\r\n            }\r\n            const tokenImage = importImage(\"ic_\" + token.symbol.toLowerCase() + \"_24.svg\");\r\n            return (\r\n              <div className=\"App-card\" key={token.symbol}>\r\n                <div className=\"mobile-token-card\">\r\n                  <img src={tokenImage} alt={token.symbol} width=\"20px\" />\r\n                  <div className=\"token-symbol-text\">{token.symbol}</div>\r\n                  <div>\r\n                    <AssetDropdown assetSymbol={token.symbol} assetInfo={token} />\r\n                  </div>\r\n                </div>\r\n                <div className=\"App-card-divider\"></div>\r\n                <div className=\"App-card-content\">\r\n                  <div className=\"App-card-row\">\r\n                    <div className=\"label\">Price</div>\r\n                    <div>${formatKeyAmount(tokenInfo, \"minPrice\", USD_DECIMALS, 2, true)}</div>\r\n                  </div>\r\n                  {isBuying && (\r\n                    <div className=\"App-card-row\">\r\n                      <Tooltip\r\n                        handle=\"Available\"\r\n                        position=\"left-bottom\"\r\n                        renderContent={() => (\r\n                          <p className=\"text-white\">\r\n                            <Trans>Available amount to deposit into GLP.</Trans>\r\n                          </p>\r\n                        )}\r\n                      />\r\n                      <div>\r\n                        <Tooltip\r\n                          handle={amountLeftToDeposit && `$${formatAmount(amountLeftToDeposit, USD_DECIMALS, 2, true)}`}\r\n                          position=\"right-bottom\"\r\n                          tooltipIconPosition=\"right\"\r\n                          renderContent={() => getTooltipContent(managedUsd, tokenInfo, token)}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {!isBuying && (\r\n                    <div className=\"App-card-row\">\r\n                      <div className=\"label\">\r\n                        <Tooltip\r\n                          handle={t`Available`}\r\n                          position=\"left-bottom\"\r\n                          renderContent={() => {\r\n                            return (\r\n                              <p className=\"text-white\">\r\n                                <Trans>\r\n                                  Available amount to withdraw from GLP. Funds not utilized by current open positions.\r\n                                </Trans>\r\n                              </p>\r\n                            );\r\n                          }}\r\n                        />\r\n                      </div>\r\n\r\n                      <div>\r\n                        <Tooltip\r\n                          handle={\r\n                            availableAmountUsd && availableAmountUsd.lt(0)\r\n                              ? \"$0.00\"\r\n                              : `$${formatAmount(availableAmountUsd, USD_DECIMALS, 2, true)}`\r\n                          }\r\n                          position=\"right-bottom\"\r\n                          tooltipIconPosition=\"right\"\r\n                          renderContent={() => getTooltipContent(managedUsd, tokenInfo, token)}\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  <div className=\"App-card-row\">\r\n                    <div className=\"label\">\r\n                      <Trans>Wallet</Trans>\r\n                    </div>\r\n                    <div>\r\n                      {formatKeyAmount(tokenInfo, \"balance\", tokenInfo.decimals, 2, true)} {tokenInfo.symbol} ($\r\n                      {formatAmount(balanceUsd, USD_DECIMALS, 2, true)})\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"App-card-row\">\r\n                    <div>\r\n                      {tokenFeeBps ? (\r\n                        t`Fees`\r\n                      ) : (\r\n                        <Tooltip\r\n                          handle=\"Fees\"\r\n                          renderContent={() => (\r\n                            <p className=\"text-white\">\r\n                              <Trans>Fees will be shown once you have entered an amount in the order form.</Trans>\r\n                            </p>\r\n                          )}\r\n                        />\r\n                      )}\r\n                    </div>\r\n                    <div>{renderFees()}</div>\r\n                  </div>\r\n                  <div className=\"App-card-divider\"></div>\r\n                  <div className=\"App-card-options\">\r\n                    {isBuying && (\r\n                      <button className=\"App-button-option App-card-option\" onClick={() => selectToken(token)}>\r\n                        <Trans>Buy with {token.symbol}</Trans>\r\n                      </button>\r\n                    )}\r\n                    {!isBuying && (\r\n                      <button className=\"App-button-option App-card-option\" onClick={() => selectToken(token)}>\r\n                        <Trans>Sell for {token.symbol}</Trans>\r\n                      </button>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// date format: d MMM yyyy, H:mm, time should be specifed based on UTC time\r\n\r\nexport const homeEventsData = [\r\n  {\r\n    id: \"app-gmx-io-launch\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"Updates have been applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\nexport const appEventsData = [\r\n  // {\r\n  //   id: \"removal-of-min-profit-rule\",\r\n  //   title: \"Trading improvements\",\r\n  //   isActive: true,\r\n  //   validTill: \"1 Apr 2022, 12:00\",\r\n  //   bodyText: \"The 1.5% minimum profit rule has been removed\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read more\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/roadmap#30-march-2022\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"shorting-of-link-uni-re-enabled\",\r\n  //   title: \"Shorting of LINK and UNI\",\r\n  //   isActive: true,\r\n  //   validTill: \"20 Apr 2022, 12:00\",\r\n  //   bodyText: \"Shorting has been re-enabled for LINK and UNI.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Trade Now\",\r\n  //       link: \"https://gmx.io/trade\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"speed-up-page-loading\",\r\n  //   title: \"Speed Up Page Loading\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"If you experience data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"referral-program-launch\",\r\n  //   title: \"Referral Program Launch\",\r\n  //   isActive: true,\r\n  //   validTill: \"4 May 2022, 12:00\",\r\n  //   bodyText: \"The GMX referral program is now live! Get fee discounts and refer traders to earn rewards.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //     {\r\n  //       text: \"Join Now\",\r\n  //       link: \"https://gmx.io/referrals\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey\",\r\n  //   title: \"GMX Arbitrum Odyssey\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"The GMX Arbitrum Odyssey is taking place this week, all participants will receive prizes. Read on to find out more.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-arbitrum-odyssey-fc12cba2d10d\",\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"fix-arbitrum-transaction-issues\",\r\n  //   title: \"Fix Arbitrum Transactions\",\r\n  //   isActive: true,\r\n  //   validTill: \"30 Jun 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"If you experience transaction errors on Arbitrum or data loading issues, please use a free RPC URL from Alchemy.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Learn More\",\r\n  //       link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"gmx-arbitrum-odyssey-paused\",\r\n  //   title: \"GMX Arbitrum Odyssey Paused\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText: \"The GMX Arbitrum Odyssey has been paused. Please read the linked post for more information.\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://twitter.com/GMX_IO/status/1542163585111150592\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"app-gmx-io\",\r\n  //   title: \"Frontend Updates\",\r\n  //   isActive: true,\r\n  //   validTill: \"6 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"On 6 Jul 2022, updates will be applied to the GMX frontend to inform users of the separation between gmx.io and app.gmx.io\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Read More\",\r\n  //       link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  // {\r\n  //   id: \"degraded-alchemy-performance\",\r\n  //   title: \"Alchemy RPC\",\r\n  //   isActive: true,\r\n  //   validTill: \"3 Jul 2022, 12:00\",\r\n  //   bodyText:\r\n  //     \"There are ongoing syncing issues on Alchemy for Arbitrum at the moment, please check their status page and use the public Arbitrum RPC in the meantime\",\r\n  //   buttons: [\r\n  //     {\r\n  //       text: \"Check Status\",\r\n  //       link: \"https://status.alchemy.com/\",\r\n  //       newTab: true,\r\n  //     },\r\n  //     {\r\n  //       text: \"Public RPC URL\",\r\n  //       link: \"https://metamask.zendesk.com/hc/en-us/articles/4415758358299-Network-profile-Arbitrum\",\r\n  //       newTab: true,\r\n  //     },\r\n  //   ],\r\n  // },\r\n  {\r\n    id: \"app-gmx-io-settings\",\r\n    title: \"Frontend Updates\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"You are currently using app.gmx.io. Customized settings have been reset, you may need to adjust your settings by clicking on the menu in the top right after connecting your wallet.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/gmx-frontend-updates-8d13f2346e1e\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"use-alchemy-rpc-url\",\r\n    title: \"Use Alchemy RPC URL\",\r\n    isActive: true,\r\n    validTill: \"10 Jul 2022, 12:00\",\r\n    bodyText:\r\n      \"If you experience data loading or transaction issues on Arbitrum, please use a free RPC URL from Alchemy.\",\r\n    buttons: [\r\n      {\r\n        text: \"Learn More\",\r\n        link: \"https://gmxio.gitbook.io/gmx/trading#backup-rpc-urls\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    id: \"arbitrum-nitro-upgrade\",\r\n    title: \"Arbitrum Nitro Upgrade\",\r\n    isActive: true,\r\n    validTill: \"31 Aug 2022, 20:00\",\r\n    bodyText: \"The Arbitrum Nitro upgrade has been completed.\",\r\n    buttons: [\r\n      {\r\n        text: \"Read More\",\r\n        link: \"https://medium.com/@gmx.io/arbitrum-nitro-5f88c03a46fe\",\r\n        newTab: true,\r\n      },\r\n    ],\r\n  },\r\n];\r\n","function Icon({ className }) {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      aria-hidden=\"true\"\r\n      className={className}\r\n      viewBox=\"0 0 24 24\"\r\n    >\r\n      <path\r\n        strokeLinecap=\"round\"\r\n        strokeLinejoin=\"round\"\r\n        strokeWidth=\"2\"\r\n        d=\"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z\"\r\n      ></path>\r\n    </svg>\r\n  );\r\n}\r\n\r\nexport default Icon;\r\n","import \"./EventToast.css\";\r\nimport Icon from \"./AnnouncementIcon\";\r\nimport { MdOutlineClose } from \"react-icons/md\";\r\n\r\nexport default function EventToast({ event, id, onClick, t }) {\r\n  return (\r\n    <div className={`single-toast ${t.visible ? \"zoomIn\" : \"zoomOut\"}`} key={id}>\r\n      <header>\r\n        <div className=\"toast-title\">\r\n          <Icon className=\"announcement-icon\" />\r\n          <p>{event.title}</p>\r\n        </div>\r\n        <MdOutlineClose onClick={onClick} className=\"cross-icon\" color=\"white\" />\r\n      </header>\r\n      <p className=\"toast-body\">{event.bodyText}</p>\r\n      <div className=\"toast-links\">\r\n        {event.buttons.map((button) => {\r\n          if (button.newTab) {\r\n            return (\r\n              <a key={event.id + button.text} target=\"_blank\" rel=\"noreferrer noopener\" href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          } else {\r\n            return (\r\n              <a key={event.id + button.text} href={button.link}>\r\n                {button.text}\r\n              </a>\r\n            );\r\n          }\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useLocalStorage } from \"react-use\";\r\nimport toast from \"react-hot-toast\";\r\nimport { homeEventsData, appEventsData } from \"../../config/events\";\r\nimport { useEffect } from \"react\";\r\nimport EventToast from \"./EventToast\";\r\nimport { isFuture, parse } from \"date-fns\";\r\nimport { isHomeSite } from \"../../lib/legacy\";\r\n\r\nfunction useEventToast() {\r\n  const isHome = isHomeSite();\r\n  const [visited, setVisited] = useLocalStorage(\"visited-announcements\", []);\r\n\r\n  useEffect(() => {\r\n    const eventsData = isHome ? homeEventsData : appEventsData;\r\n\r\n    eventsData\r\n      .filter((event) => event.isActive)\r\n      .filter((event) => isFuture(parse(event.validTill + \", +00\", \"d MMM yyyy, H:mm, x\", new Date())))\r\n      .filter((event) => Array.isArray(visited) && !visited.includes(event.id))\r\n      .forEach((event) => {\r\n        toast.custom(\r\n          (t) => (\r\n            <EventToast\r\n              event={event}\r\n              id={event.id}\r\n              t={t}\r\n              onClick={() => {\r\n                toast.dismiss(event.id);\r\n                visited.push(event.id);\r\n                setVisited(visited);\r\n              }}\r\n            />\r\n          ),\r\n          {\r\n            id: event.id,\r\n            style: {},\r\n          }\r\n        );\r\n      });\r\n  }, [visited, setVisited, isHome]);\r\n}\r\n\r\nexport default useEventToast;\r\n","import { Toaster } from \"react-hot-toast\";\r\nimport { useWindowScroll, createBreakpoint } from \"react-use\";\r\n\r\nfunction EventToastContainer() {\r\n  let { y: scrollY } = useWindowScroll();\r\n  const useBreakpoint = createBreakpoint({ XL: 1033, L: 768, S: 350 });\r\n  const breakpoint = useBreakpoint();\r\n  return (\r\n    <Toaster\r\n      position=\"top-right\"\r\n      reverseOrder={true}\r\n      gutter={30}\r\n      containerClassName=\"event-toast-container\"\r\n      containerStyle={{\r\n        zIndex: 2,\r\n        transition: \"all 200ms\",\r\n        top: scrollY > 60 ? \"30px\" : `${93 - scrollY}px`,\r\n        right: breakpoint === \"XL\" ? \"30px\" : \"1rem\",\r\n      }}\r\n      toastOptions={{\r\n        duration: Infinity,\r\n      }}\r\n    />\r\n  );\r\n}\r\nexport default EventToastContainer;\r\n","import \"./RedirectModal.css\";\r\nimport Modal from \"../Modal/Modal\";\r\nimport Checkbox from \"../Checkbox/Checkbox\";\r\n\r\nexport function RedirectPopupModal({\r\n  redirectModalVisible,\r\n  setRedirectModalVisible,\r\n  appRedirectUrl,\r\n  setRedirectPopupTimestamp,\r\n  setShouldHideRedirectModal,\r\n  shouldHideRedirectModal,\r\n  removeRedirectPopupTimestamp,\r\n}) {\r\n  const onClickAgree = () => {\r\n    if (shouldHideRedirectModal) {\r\n      setRedirectPopupTimestamp(Date.now());\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      className=\"RedirectModal\"\r\n      isVisible={redirectModalVisible}\r\n      setIsVisible={setRedirectModalVisible}\r\n      label=\"Launch App\"\r\n    >\r\n      You are leaving GMX.io and will be redirected to a third party, independent website.\r\n      <br />\r\n      <br />\r\n      The website is a community deployed and maintained instance of the open source{\" \"}\r\n      <a href=\"https://github.com/gmx-io/gmx-interface\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        GMX front end\r\n      </a>\r\n      , hosted and served on the distributed, peer-to-peer{\" \"}\r\n      <a href=\"https://ipfs.io/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        IPFS network\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      Alternative links can be found in the{\" \"}\r\n      <a href=\"https://gmxio.gitbook.io/gmx/app-links\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        docs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      By clicking Agree you accept the{\" \"}\r\n      <a href=\"https://gmx.io/#/terms-and-conditions\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        T&Cs\r\n      </a>{\" \"}\r\n      and{\" \"}\r\n      <a href=\"https://gmx.io/#/referral-terms\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n        Referral T&Cs\r\n      </a>\r\n      .\r\n      <br />\r\n      <br />\r\n      <div className=\"mb-sm\">\r\n        <Checkbox isChecked={shouldHideRedirectModal} setIsChecked={setShouldHideRedirectModal}>\r\n          Don't show this message again for 30 days.\r\n        </Checkbox>\r\n      </div>\r\n      <a href={appRedirectUrl} className=\"App-cta Exchange-swap-button\" onClick={() => onClickAgree()}>\r\n        Agree\r\n      </a>\r\n    </Modal>\r\n  );\r\n}\r\n","import \"./Jobs.css\";\r\nimport React, { useEffect } from \"react\";\r\nimport SEO from \"../../components/Common/SEO\";\r\nimport Footer from \"../../components/Footer/Footer\";\r\nimport { getPageTitle } from \"../../lib/legacy\";\r\nimport Card from \"../../components/Common/Card\";\r\n\r\nfunction Jobs() {\r\n  useEffect(() => {\r\n    window.scrollTo(0, 0);\r\n  }, []);\r\n  return (\r\n    <SEO title={getPageTitle(\"Job Openings\")}>\r\n      <div className=\"default-container page-layout Referrals\">\r\n        <div className=\"section-title-block\">\r\n          <div className=\"section-title-icon\"></div>\r\n          <div className=\"section-title-content\">\r\n            <div className=\"Page-title\">Jobs</div>\r\n            <div className=\"Page-description\">Job openings at GMX.</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"jobs-page-body\">\r\n          <NoJob />\r\n        </div>\r\n      </div>\r\n      <Footer />\r\n    </SEO>\r\n  );\r\n}\r\n\r\nfunction NoJob() {\r\n  return (\r\n    <Card title=\"No open positions at GMX currently\">\r\n      <div className=\"body-para\">\r\n        <p className=\"subheading\">\r\n          GMX is not actively looking for new hires at the moment. However, if you think you can contribute to the\r\n          project, please email{\" \"}\r\n          <a target=\"_blank\" href=\"mailto:jobs@gmx.io\" rel=\"noopener noreferrer\">\r\n            jobs@gmx.io\r\n          </a>\r\n          .\r\n        </p>\r\n      </div>\r\n    </Card>\r\n  );\r\n}\r\n\r\n// function JobCard() {\r\n//   return (\r\n//     <Card title=\"Senior front-end developer (Full-time position)\">\r\n//       <div className=\"body-para\">\r\n//         <p className=\"subheading\">What you will do:</p>\r\n//         <ul>\r\n//           <li>Work closely with the GMX team on the GMX front-end website.</li>\r\n//           <li>Collaborate and discuss features to be worked on.</li>\r\n//           <li>Remote full-time position, flexible working hours.</li>\r\n//         </ul>\r\n//         <div className=\"mt-lg\">\r\n//           <p className=\"subheading\">What we are looking for:</p>\r\n//           <ul>\r\n//             <li>Required skills: HTML5, CSS3, React, Ethers, Web3 JS.</li>\r\n//             <li>Bonus skills: Node JS.</li>\r\n//             <li>5+ years of experience.</li>\r\n//             <li>Previous DeFi experience and knowledge.</li>\r\n//             <li>Must speak fluent English and available to start right away.</li>\r\n//             <li>Comfortable making changes to the interface following our current design guidelines.</li>\r\n//           </ul>\r\n//           <p>The salary is 60,000 to 120,000 USD + 1,000 to 3,000 GMX a year.</p>\r\n//           <p className=\"jobs-contact\">\r\n//             If the job suits you, please get in touch with{\" \"}\r\n//             <a target=\"_blank\" href=\"mailto:jobs@gmx.io\" rel=\"noopener noreferrer\">\r\n//               jobs@gmx.io\r\n//             </a>{\" \"}\r\n//             using the following email subject: Application for Senior front-end developer: [Your name]\r\n//           </p>\r\n//         </div>\r\n//       </div>\r\n//     </Card>\r\n//   );\r\n// }\r\n\r\nexport default Jobs;\r\n","import { i18n } from \"@lingui/core\";\r\nimport { en, es, zh, ko, ru, ja, fr } from \"make-plural/plurals\";\r\nimport { LANGUAGE_LOCALSTORAGE_KEY } from \"./legacy\";\r\n\r\nexport const locales = {\r\n  en: \"English\",\r\n  es: \"Spanish\",\r\n  // zh: \"Chinese\",\r\n  ko: \"Korean\",\r\n  // ru: \"Russian\",\r\n  ja: \"Japanese\",\r\n  // fr: \"French\",\r\n};\r\n\r\nexport const defaultLocale = \"en\";\r\n\r\ni18n.loadLocaleData({\r\n  en: { plurals: en },\r\n  es: { plurals: es },\r\n  zh: { plurals: zh },\r\n  ko: { plurals: ko },\r\n  ru: { plurals: ru },\r\n  ja: { plurals: ja },\r\n  fr: { plurals: fr },\r\n});\r\n\r\nexport async function dynamicActivate(locale) {\r\n  const { messages } = await import(`@lingui/loader!../config/locales/${locale}/messages.po`);\r\n  localStorage.setItem(LANGUAGE_LOCALSTORAGE_KEY, locale);\r\n  i18n.load(locale, messages);\r\n  i18n.activate(locale);\r\n}\r\n","import React, { useState, useEffect, useCallback, useRef } from \"react\";\r\nimport { SWRConfig } from \"swr\";\r\nimport { ethers } from \"ethers\";\r\nimport { Web3ReactProvider, useWeb3React } from \"@web3-react/core\";\r\nimport { Web3Provider } from \"@ethersproject/providers\";\r\nimport useScrollToTop from \"../lib/useScrollToTop\";\r\n\r\nimport { Routes, Route, HashRouter as Router, Navigate, useLocation, useNavigate } from \"react-router-dom\";\r\n\r\nimport {\r\n  ARBITRUM,\r\n  AVALANCHE,\r\n  DEFAULT_SLIPPAGE_AMOUNT,\r\n  SLIPPAGE_BPS_KEY,\r\n  IS_PNL_IN_LEVERAGE_KEY,\r\n  SHOW_PNL_AFTER_FEES_KEY,\r\n  BASIS_POINTS_DIVISOR,\r\n  SHOULD_SHOW_POSITION_LINES_KEY,\r\n  getAppBaseUrl,\r\n  isHomeSite,\r\n  clearWalletConnectData,\r\n  helperToast,\r\n  getAlchemyWsUrl,\r\n  useChainId,\r\n  getInjectedHandler,\r\n  useEagerConnect,\r\n  useLocalStorageSerializeKey,\r\n  useInactiveListener,\r\n  getExplorerUrl,\r\n  getWalletConnectHandler,\r\n  activateInjectedProvider,\r\n  hasMetaMaskWalletExtension,\r\n  hasCoinBaseWalletExtension,\r\n  isMobileDevice,\r\n  clearWalletLinkData,\r\n  SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY,\r\n  CURRENT_PROVIDER_LOCALSTORAGE_KEY,\r\n  REFERRAL_CODE_KEY,\r\n  REFERRAL_CODE_QUERY_PARAM,\r\n  isDevelopment,\r\n  DISABLE_ORDER_VALIDATION_KEY,\r\n  LANGUAGE_LOCALSTORAGE_KEY,\r\n} from \"../lib/legacy\";\r\n\r\nimport Home from \"../pages/Home/Home\";\r\nimport Dashboard from \"../pages/Dashboard/Dashboard\";\r\nimport Ecosystem from \"../pages/Ecosystem/Ecosystem\";\r\nimport Stake from \"../pages/Stake/Stake\";\r\nimport { Exchange } from \"../pages/Exchange/Exchange\";\r\nimport Actions from \"../pages/Actions/Actions\";\r\nimport OrdersOverview from \"../pages/OrdersOverview/OrdersOverview\";\r\nimport PositionsOverview from \"../pages/PositionsOverview/PositionsOverview\";\r\nimport Referrals from \"../pages/Referrals/Referrals\";\r\nimport BuyGlp from \"../pages/BuyGlp/BuyGlp\";\r\nimport BuyGMX from \"../pages/BuyGMX/BuyGMX\";\r\nimport Buy from \"../pages/Buy/Buy\";\r\nimport NftWallet from \"../pages/NftWallet/NftWallet\";\r\nimport ClaimEsGmx from \"../pages/ClaimEsGmx/ClaimEsGmx\";\r\nimport BeginAccountTransfer from \"../pages/BeginAccountTransfer/BeginAccountTransfer\";\r\nimport CompleteAccountTransfer from \"../pages/CompleteAccountTransfer/CompleteAccountTransfer\";\r\n\r\nimport { cssTransition, ToastContainer } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport Modal from \"../components/Modal/Modal\";\r\nimport Checkbox from \"../components/Checkbox/Checkbox\";\r\n\r\nimport \"../styles/Shared.scss\";\r\nimport \"../styles/Font.css\";\r\nimport \"./App.scss\";\r\nimport \"../styles/Input.scss\";\r\n\r\nimport metamaskImg from \"../img/metamask.png\";\r\nimport coinbaseImg from \"../img/coinbaseWallet.png\";\r\nimport walletConnectImg from \"../img/walletconnect-circle-blue.svg\";\r\nimport useEventToast from \"../components/EventToast/useEventToast\";\r\nimport EventToastContainer from \"../components/EventToast/EventToastContainer\";\r\nimport SEO from \"../components/Common/SEO\";\r\nimport useRouteQuery from \"../lib/useRouteQuery\";\r\nimport { encodeReferralCode, decodeReferralCode } from \"../domain/referrals\";\r\n\r\nimport { getContract } from \"../config/Addresses\";\r\nimport VaultV2 from \"../abis/VaultV2.json\";\r\nimport VaultV2b from \"../abis/VaultV2b.json\";\r\nimport PositionRouter from \"../abis/PositionRouter.json\";\r\nimport PageNotFound from \"../pages/PageNotFound/PageNotFound\";\r\nimport ReferralTerms from \"../pages/ReferralTerms/ReferralTerms\";\r\nimport TermsAndConditions from \"../pages/TermsAndConditions/TermsAndConditions\";\r\nimport { useLocalStorage } from \"react-use\";\r\nimport { RedirectPopupModal } from \"../components/ModalViews/RedirectModal\";\r\nimport { REDIRECT_POPUP_TIMESTAMP_KEY } from \"../config/ui\";\r\nimport Jobs from \"../pages/Jobs/Jobs\";\r\n\r\nimport { i18n } from \"@lingui/core\";\r\nimport { I18nProvider } from \"@lingui/react\";\r\nimport { Trans, t } from \"@lingui/macro\";\r\nimport { defaultLocale, dynamicActivate } from \"../lib/i18n\";\r\nimport { Header } from \"../components/Header/Header\";\r\n\r\nif (\"ethereum\" in window) {\r\n  window.ethereum.autoRefreshOnNetworkChange = false;\r\n}\r\n\r\nfunction getLibrary(provider) {\r\n  const library = new Web3Provider(provider);\r\n  return library;\r\n}\r\n\r\nconst Zoom = cssTransition({\r\n  enter: \"zoomIn\",\r\n  exit: \"zoomOut\",\r\n  appendPosition: false,\r\n  collapse: true,\r\n  collapseDuration: 200,\r\n  duration: 200,\r\n});\r\n\r\nconst arbWsProvider = new ethers.providers.WebSocketProvider(getAlchemyWsUrl());\r\n\r\nconst avaxWsProvider = new ethers.providers.JsonRpcProvider(\"https://api.avax.network/ext/bc/C/rpc\");\r\n\r\nfunction getWsProvider(active, chainId) {\r\n  if (!active) {\r\n    return;\r\n  }\r\n  if (chainId === ARBITRUM) {\r\n    return arbWsProvider;\r\n  }\r\n\r\n  if (chainId === AVALANCHE) {\r\n    return avaxWsProvider;\r\n  }\r\n}\r\n\r\nfunction FullApp(props) {\r\n  const isHome = isHomeSite();\r\n  const exchangeRef = useRef();\r\n  const { connector, library, deactivate, activate, active } = useWeb3React();\r\n  const { chainId } = useChainId();\r\n  const location = useLocation();\r\n  const history = useNavigate();\r\n  useEventToast();\r\n  const [activatingConnector, setActivatingConnector] = useState();\r\n  useEffect(() => {\r\n    if (activatingConnector && activatingConnector === connector) {\r\n      setActivatingConnector(undefined);\r\n    }\r\n  }, [activatingConnector, connector, chainId]);\r\n  const triedEager = useEagerConnect(setActivatingConnector);\r\n  useInactiveListener(!triedEager || !!activatingConnector);\r\n\r\n  const query = useRouteQuery();\r\n\r\n  useEffect(() => {\r\n    let referralCode = query.get(REFERRAL_CODE_QUERY_PARAM);\r\n    if (!referralCode || referralCode.length === 0) {\r\n      const params = new URLSearchParams(window.location.search);\r\n      referralCode = params.get(REFERRAL_CODE_QUERY_PARAM);\r\n    }\r\n\r\n    if (referralCode && referralCode.length <= 20) {\r\n      const encodedReferralCode = encodeReferralCode(referralCode);\r\n      if (encodeReferralCode !== ethers.constants.HashZero) {\r\n        localStorage.setItem(REFERRAL_CODE_KEY, encodedReferralCode);\r\n        const queryParams = new URLSearchParams(location.search);\r\n        if (queryParams.has(REFERRAL_CODE_QUERY_PARAM)) {\r\n          queryParams.delete(REFERRAL_CODE_QUERY_PARAM);\r\n          history.replace({\r\n            search: queryParams.toString(),\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }, [query, history, location]);\r\n\r\n  const disconnectAccount = useCallback(() => {\r\n    // only works with WalletConnect\r\n    clearWalletConnectData();\r\n    // force clear localStorage connection for MM/CB Wallet (Brave legacy)\r\n    clearWalletLinkData();\r\n    deactivate();\r\n  }, [deactivate]);\r\n\r\n  const disconnectAccountAndCloseSettings = () => {\r\n    disconnectAccount();\r\n    localStorage.removeItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY);\r\n    localStorage.removeItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY);\r\n    setIsSettingsVisible(false);\r\n  };\r\n\r\n  const connectInjectedWallet = getInjectedHandler(activate);\r\n  const activateWalletConnect = () => {\r\n    getWalletConnectHandler(activate, deactivate, setActivatingConnector)();\r\n  };\r\n\r\n  const userOnMobileDevice = \"navigator\" in window && isMobileDevice(window.navigator);\r\n\r\n  useEffect(() => {\r\n    attemptActivateWallet(\"MetaMask\");\r\n  }, [props.walletAddress])\r\n  \r\n  const activateMetaMask = () => {\r\n    if (!hasMetaMaskWalletExtension()) {\r\n      helperToast.error(\r\n        <div>\r\n          <Trans>MetaMask not detected.</Trans>\r\n          <br />\r\n          <br />\r\n          <a href=\"https://metamask.io\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            <Trans>Install MetaMask</Trans>\r\n          </a>\r\n          {userOnMobileDevice ? (\r\n            <Trans>, and use GMX with its built-in browser</Trans>\r\n          ) : (\r\n            <Trans> to start using GMX</Trans>\r\n          )}\r\n          .\r\n        </div>\r\n      );\r\n      return false;\r\n    }\r\n    attemptActivateWallet(\"MetaMask\");\r\n  };\r\n  const activateCoinBase = () => {\r\n    if (!hasCoinBaseWalletExtension()) {\r\n      helperToast.error(\r\n        <div>\r\n          <Trans>Coinbase Wallet not detected.</Trans>\r\n          <br />\r\n          <br />\r\n          <a href=\"https://www.coinbase.com/wallet\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n            <Trans>Install Coinbase Wallet</Trans>\r\n          </a>\r\n          {userOnMobileDevice ? (\r\n            <Trans>, and use GMX with its built-in browser</Trans>\r\n          ) : (\r\n            <Trans> to start using GMX</Trans>\r\n          )}\r\n          .\r\n        </div>\r\n      );\r\n      return false;\r\n    }\r\n    attemptActivateWallet(\"CoinBase\");\r\n  };\r\n\r\n  const attemptActivateWallet = (providerName) => {\r\n    localStorage.setItem(SHOULD_EAGER_CONNECT_LOCALSTORAGE_KEY, true);\r\n    localStorage.setItem(CURRENT_PROVIDER_LOCALSTORAGE_KEY, providerName);\r\n    activateInjectedProvider(providerName);\r\n    connectInjectedWallet();\r\n  };\r\n\r\n  const [walletModalVisible, setWalletModalVisible] = useState(false);\r\n  const [redirectModalVisible, setRedirectModalVisible] = useState(false);\r\n  const [shouldHideRedirectModal, setShouldHideRedirectModal] = useState(false);\r\n  const [redirectPopupTimestamp, setRedirectPopupTimestamp, removeRedirectPopupTimestamp] =\r\n    useLocalStorage(REDIRECT_POPUP_TIMESTAMP_KEY);\r\n  const [selectedToPage, setSelectedToPage] = useState(\"\");\r\n  // const connectWallet = () => setWalletModalVisible(true);\r\n  const connectWallet = props.connectWallet;\r\n\r\n  const [isSettingsVisible, setIsSettingsVisible] = useState(false);\r\n  const [savedSlippageAmount, setSavedSlippageAmount] = useLocalStorageSerializeKey(\r\n    [chainId, SLIPPAGE_BPS_KEY],\r\n    DEFAULT_SLIPPAGE_AMOUNT\r\n  );\r\n  const [slippageAmount, setSlippageAmount] = useState(0);\r\n  const [isPnlInLeverage, setIsPnlInLeverage] = useState(false);\r\n  const [shouldDisableValidationForTesting, setShouldDisableValidationForTesting] = useState(false);\r\n  const [showPnlAfterFees, setShowPnlAfterFees] = useState(false);\r\n\r\n  const [savedIsPnlInLeverage, setSavedIsPnlInLeverage] = useLocalStorageSerializeKey(\r\n    [chainId, IS_PNL_IN_LEVERAGE_KEY],\r\n    false\r\n  );\r\n\r\n  const [savedShowPnlAfterFees, setSavedShowPnlAfterFees] = useLocalStorageSerializeKey(\r\n    [chainId, SHOW_PNL_AFTER_FEES_KEY],\r\n    false\r\n  );\r\n  const [savedShouldDisableValidationForTesting, setSavedShouldDisableValidationForTesting] =\r\n    useLocalStorageSerializeKey([chainId, DISABLE_ORDER_VALIDATION_KEY], false);\r\n\r\n  const [savedShouldShowPositionLines, setSavedShouldShowPositionLines] = useLocalStorageSerializeKey(\r\n    [chainId, SHOULD_SHOW_POSITION_LINES_KEY],\r\n    false\r\n  );\r\n\r\n  const openSettings = () => {\r\n    const slippage = parseInt(savedSlippageAmount);\r\n    setSlippageAmount((slippage / BASIS_POINTS_DIVISOR) * 100);\r\n    setIsPnlInLeverage(savedIsPnlInLeverage);\r\n    setShowPnlAfterFees(savedShowPnlAfterFees);\r\n    setShouldDisableValidationForTesting(savedShouldDisableValidationForTesting);\r\n    setIsSettingsVisible(true);\r\n  };\r\n\r\n  const saveAndCloseSettings = () => {\r\n    const slippage = parseFloat(slippageAmount);\r\n    if (isNaN(slippage)) {\r\n      helperToast.error(t`Invalid slippage value`);\r\n      return;\r\n    }\r\n    if (slippage > 5) {\r\n      helperToast.error(t`Slippage should be less than 5%`);\r\n      return;\r\n    }\r\n\r\n    const basisPoints = (slippage * BASIS_POINTS_DIVISOR) / 100;\r\n    if (parseInt(basisPoints) !== parseFloat(basisPoints)) {\r\n      helperToast.error(t`Max slippage precision is 0.01%`);\r\n      return;\r\n    }\r\n\r\n    setSavedIsPnlInLeverage(isPnlInLeverage);\r\n    setSavedShowPnlAfterFees(showPnlAfterFees);\r\n    setSavedShouldDisableValidationForTesting(shouldDisableValidationForTesting);\r\n    setSavedSlippageAmount(basisPoints);\r\n    setIsSettingsVisible(false);\r\n  };\r\n\r\n  const localStorageCode = window.localStorage.getItem(REFERRAL_CODE_KEY);\r\n  const baseUrl = getAppBaseUrl();\r\n  let appRedirectUrl = baseUrl + selectedToPage;\r\n  if (localStorageCode && localStorageCode.length > 0 && localStorageCode !== ethers.constants.HashZero) {\r\n    const decodedRefCode = decodeReferralCode(localStorageCode);\r\n    if (decodedRefCode) {\r\n      appRedirectUrl = `${appRedirectUrl}?ref=${decodedRefCode}`;\r\n    }\r\n  }\r\n\r\n  const [pendingTxns, setPendingTxns] = useState([]);\r\n\r\n  const showRedirectModal = (to) => {\r\n    setRedirectModalVisible(true);\r\n    setSelectedToPage(to);\r\n  };\r\n\r\n  useEffect(() => {\r\n    const checkPendingTxns = async () => {\r\n      const updatedPendingTxns = [];\r\n      for (let i = 0; i < pendingTxns.length; i++) {\r\n        const pendingTxn = pendingTxns[i];\r\n        const receipt = await library.getTransactionReceipt(pendingTxn.hash);\r\n        if (receipt) {\r\n          if (receipt.status === 0) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.error(\r\n              <div>\r\n                <Trans>Txn failed.</Trans>{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          if (receipt.status === 1 && pendingTxn.message) {\r\n            const txUrl = getExplorerUrl(chainId) + \"tx/\" + pendingTxn.hash;\r\n            helperToast.success(\r\n              <div>\r\n                {pendingTxn.message}{\" \"}\r\n                <a href={txUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n                  <Trans>View</Trans>\r\n                </a>\r\n                <br />\r\n              </div>\r\n            );\r\n          }\r\n          continue;\r\n        }\r\n        updatedPendingTxns.push(pendingTxn);\r\n      }\r\n\r\n      if (updatedPendingTxns.length !== pendingTxns.length) {\r\n        setPendingTxns(updatedPendingTxns);\r\n      }\r\n    };\r\n\r\n    const interval = setInterval(() => {\r\n      checkPendingTxns();\r\n    }, 2 * 1000);\r\n    return () => clearInterval(interval);\r\n  }, [library, pendingTxns, chainId]);\r\n\r\n  const vaultAddress = getContract(chainId, \"Vault\");\r\n  const positionRouterAddress = getContract(chainId, \"PositionRouter\");\r\n\r\n  useEffect(() => {\r\n    const wsVaultAbi = chainId === ARBITRUM ? VaultV2.abi : VaultV2b.abi;\r\n    const wsProvider = getWsProvider(active, chainId);\r\n    if (!wsProvider) {\r\n      return;\r\n    }\r\n\r\n    const wsVault = new ethers.Contract(vaultAddress, wsVaultAbi, wsProvider);\r\n    const wsPositionRouter = new ethers.Contract(positionRouterAddress, PositionRouter.abi, wsProvider);\r\n\r\n    const callExchangeRef = (method, ...args) => {\r\n      if (!exchangeRef || !exchangeRef.current) {\r\n        return;\r\n      }\r\n\r\n      exchangeRef.current[method](...args);\r\n    };\r\n\r\n    // handle the subscriptions here instead of within the Exchange component to avoid unsubscribing and re-subscribing\r\n    // each time the Exchange components re-renders, which happens on every data update\r\n    const onUpdatePosition = (...args) => callExchangeRef(\"onUpdatePosition\", ...args);\r\n    const onClosePosition = (...args) => callExchangeRef(\"onClosePosition\", ...args);\r\n    const onIncreasePosition = (...args) => callExchangeRef(\"onIncreasePosition\", ...args);\r\n    const onDecreasePosition = (...args) => callExchangeRef(\"onDecreasePosition\", ...args);\r\n    const onCancelIncreasePosition = (...args) => callExchangeRef(\"onCancelIncreasePosition\", ...args);\r\n    const onCancelDecreasePosition = (...args) => callExchangeRef(\"onCancelDecreasePosition\", ...args);\r\n\r\n    wsVault.on(\"UpdatePosition\", onUpdatePosition);\r\n    wsVault.on(\"ClosePosition\", onClosePosition);\r\n    wsVault.on(\"IncreasePosition\", onIncreasePosition);\r\n    wsVault.on(\"DecreasePosition\", onDecreasePosition);\r\n    wsPositionRouter.on(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n    wsPositionRouter.on(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n\r\n    return function cleanup() {\r\n      wsVault.off(\"UpdatePosition\", onUpdatePosition);\r\n      wsVault.off(\"ClosePosition\", onClosePosition);\r\n      wsVault.off(\"IncreasePosition\", onIncreasePosition);\r\n      wsVault.off(\"DecreasePosition\", onDecreasePosition);\r\n      wsPositionRouter.off(\"CancelIncreasePosition\", onCancelIncreasePosition);\r\n      wsPositionRouter.off(\"CancelDecreasePosition\", onCancelDecreasePosition);\r\n    };\r\n  }, [active, chainId, vaultAddress, positionRouterAddress]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"App GMX-Interface\">\r\n        <div className=\"App-content\">\r\n          {/* <Header\r\n            disconnectAccountAndCloseSettings={disconnectAccountAndCloseSettings}\r\n            openSettings={openSettings}\r\n            setWalletModalVisible={setWalletModalVisible}\r\n            redirectPopupTimestamp={redirectPopupTimestamp}\r\n            showRedirectModal={showRedirectModal}\r\n          /> */}\r\n          <Exchange\r\n            ref={exchangeRef}\r\n            savedShowPnlAfterFees={savedShowPnlAfterFees}\r\n            savedIsPnlInLeverage={savedIsPnlInLeverage}\r\n            setSavedIsPnlInLeverage={setSavedIsPnlInLeverage}\r\n            savedSlippageAmount={savedSlippageAmount}\r\n            setPendingTxns={setPendingTxns}\r\n            pendingTxns={pendingTxns}\r\n            savedShouldShowPositionLines={savedShouldShowPositionLines}\r\n            setSavedShouldShowPositionLines={setSavedShouldShowPositionLines}\r\n            connectWallet={connectWallet}\r\n            savedShouldDisableValidationForTesting={savedShouldDisableValidationForTesting}\r\n          />\r\n        </div>\r\n      </div>\r\n      <ToastContainer\r\n        limit={1}\r\n        transition={Zoom}\r\n        position=\"bottom-right\"\r\n        autoClose={7000}\r\n        hideProgressBar={true}\r\n        newestOnTop={false}\r\n        closeOnClick={false}\r\n        draggable={false}\r\n        pauseOnHover\r\n      />\r\n      <EventToastContainer />\r\n      <RedirectPopupModal\r\n        redirectModalVisible={redirectModalVisible}\r\n        setRedirectModalVisible={setRedirectModalVisible}\r\n        appRedirectUrl={appRedirectUrl}\r\n        setRedirectPopupTimestamp={setRedirectPopupTimestamp}\r\n        setShouldHideRedirectModal={setShouldHideRedirectModal}\r\n        shouldHideRedirectModal={shouldHideRedirectModal}\r\n        removeRedirectPopupTimestamp={removeRedirectPopupTimestamp}\r\n      />\r\n      <Modal\r\n        className=\"Connect-wallet-modal\"\r\n        isVisible={walletModalVisible}\r\n        setIsVisible={setWalletModalVisible}\r\n        label=\"Connect Wallet\"\r\n      >\r\n        <button className=\"Wallet-btn MetaMask-btn\" onClick={activateMetaMask}>\r\n          <img src={metamaskImg} alt=\"MetaMask\" />\r\n          <div>\r\n            <Trans>MetaMask</Trans>\r\n          </div>\r\n        </button>\r\n        <button className=\"Wallet-btn CoinbaseWallet-btn\" onClick={activateCoinBase}>\r\n          <img src={coinbaseImg} alt=\"Coinbase Wallet\" />\r\n          <div>\r\n            <Trans>Coinbase Wallet</Trans>\r\n          </div>\r\n        </button>\r\n        <button className=\"Wallet-btn WalletConnect-btn\" onClick={activateWalletConnect}>\r\n          <img src={walletConnectImg} alt=\"WalletConnect\" />\r\n          <div>\r\n            <Trans>WalletConnect</Trans>\r\n          </div>\r\n        </button>\r\n      </Modal>\r\n      <Modal\r\n        className=\"App-settings\"\r\n        isVisible={isSettingsVisible}\r\n        setIsVisible={setIsSettingsVisible}\r\n        label=\"Settings\"\r\n      >\r\n        <div className=\"App-settings-row\">\r\n          <div>\r\n            <Trans>Allowed Slippage</Trans>\r\n          </div>\r\n          <div className=\"App-slippage-tolerance-input-container\">\r\n            <input\r\n              type=\"number\"\r\n              className=\"App-slippage-tolerance-input\"\r\n              min=\"0\"\r\n              value={slippageAmount}\r\n              onChange={(e) => setSlippageAmount(e.target.value)}\r\n            />\r\n            <div className=\"App-slippage-tolerance-input-percent\">%</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={showPnlAfterFees} setIsChecked={setShowPnlAfterFees}>\r\n            <Trans>Display PnL after fees</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        <div className=\"Exchange-settings-row\">\r\n          <Checkbox isChecked={isPnlInLeverage} setIsChecked={setIsPnlInLeverage}>\r\n            <Trans>Include PnL in leverage display</Trans>\r\n          </Checkbox>\r\n        </div>\r\n        {isDevelopment() && (\r\n          <div className=\"Exchange-settings-row\">\r\n            <Checkbox isChecked={shouldDisableValidationForTesting} setIsChecked={setShouldDisableValidationForTesting}>\r\n              <Trans>Disable order validations</Trans>\r\n            </Checkbox>\r\n          </div>\r\n        )}\r\n\r\n        <button className=\"App-cta Exchange-swap-button\" onClick={saveAndCloseSettings}>\r\n          <Trans>Save</Trans>\r\n        </button>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nfunction GMXInterface(props) {\r\n  // useScrollToTop();\r\n  useEffect(() => {\r\n    const defaultLanguage = localStorage.getItem(LANGUAGE_LOCALSTORAGE_KEY) || defaultLocale;\r\n    console.log(defaultLanguage);\r\n    dynamicActivate(defaultLanguage);\r\n  }, []);\r\n  return (\r\n    <SWRConfig value={{ refreshInterval: 5000 }}>\r\n      <Web3ReactProvider getLibrary={getLibrary}>\r\n        <SEO>\r\n          <I18nProvider i18n={i18n}>\r\n            <FullApp {...props} />\r\n          </I18nProvider>\r\n        </SEO>\r\n      </Web3ReactProvider>\r\n    </SWRConfig>\r\n  );\r\n}\r\n\r\nexport default GMXInterface;\r\n","import React from \"react\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nexport default function useRouteQuery() {\r\n  const { search } = useLocation();\r\n  return React.useMemo(() => new URLSearchParams(search), [search]);\r\n}\r\n","import React, { useState, useEffect, useContext } from 'react';\r\nimport { Routes, Route,\tuseLocation, useNavigate } from \"react-router-dom\";\r\nimport BorrowMarket from '../views/markets/BorrowMarket';\r\nimport SupplyMarket from '../views/markets/SupplyMarket';\r\nimport Tabs from './Tabs';\r\nimport MarketInfoBoard from './MarketInfoBoard';\r\nimport { DDL_POOL, USDC } from './utils/contracts';\r\nimport { UserStatsContext } from '../context/context';\r\nimport { ethers } from 'ethers';\r\nimport GMXInterface from '../views/gmx-test/App/App';\r\nimport { connectWallet } from './utils/wallet';\r\n\r\n\r\nconst AppRouter = ({ walletAddress, setWalletAddress}) => {\r\n\tconst loc = useLocation();\r\n\tconst navigate = useNavigate();\r\n\r\n\tuseEffect(() => {\r\n\t\tif (loc.pathname === '/' || loc.pathname === \"/app.html\") {\r\n\t\t\tnavigate('/options/borrow-market')\r\n\t\t}\r\n\t}, [loc.pathname])\r\n\t\r\n\tconst links = [\r\n\t\t{\r\n\t\t\tname: 'Borrow Market',\r\n\t\t\tto: '/options/borrow-market',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Supply Market',\r\n\t\t\tto: '/options/supply-market',\r\n\t\t},\r\n\t]\r\n\tlinks.find(link => {\r\n\t\tlink.isActive = loc.pathname === link.to;\r\n\t\treturn link.isActive;\r\n\t})\r\n\r\n\r\n\t// Supply Market state\r\n\tconst {userStats} = useContext(UserStatsContext)\r\n\tconst [supplyStep, setSupplyStep] = useState(0)\r\n\r\n\tuseEffect(() => {\r\n\t\tif (walletAddress) {\r\n\t\t\tUSDC.allowance(walletAddress, DDL_POOL.address)\r\n\t\t\t\t.then((res) => {\r\n\t\t\t\t\tif (Number(ethers.utils.formatUnits(res, 6)) >= userStats.balance) {\r\n\t\t\t\t\t\tsetSupplyStep(1)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetSupplyStep(0)\r\n\t\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t}, [userStats.balance, walletAddress])\r\n\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Routes>\r\n\t\t\t\t<Route path=\"/perpetuals\" element={<GMXInterface connectWallet={() => {\r\n\t\t\t\t\tconnectWallet(setWalletAddress)\r\n\t\t\t\t}} walletAddress={walletAddress}/>} />\r\n\t\t\t\t<Route path=\"/options\">\r\n\t\t\t\t\t<Route path=\"/options/borrow-market\" element={\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Tabs className='market-tabs' links={links}></Tabs>\r\n\t\t\t\t\t\t\t<MarketInfoBoard></MarketInfoBoard>\r\n\t\t\t\t\t\t\t<BorrowMarket walletAddress={walletAddress} setWalletAddress={setWalletAddress} />\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t} />\r\n\t\t\t\t\t<Route path=\"/options/supply-market\" element={\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Tabs className='market-tabs' links={links}></Tabs>\r\n\t\t\t\t\t\t\t<MarketInfoBoard></MarketInfoBoard>\r\n\t\t\t\t\t\t\t<SupplyMarket walletAddress={walletAddress} setWalletAddress={setWalletAddress} supplyStep={supplyStep} setSupplyStep={setSupplyStep} />\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t} />\r\n\t\t\t\t</Route>\r\n\t\t\t</Routes>\r\n\t\t</>\r\n\t);\r\n};\r\n\r\nexport default AppRouter;","import React from 'react';\r\n\r\nconst Warning = (props) => {\r\n\treturn (\r\n\t\t<div className=\"warning\">\r\n\t\t\t{props.children}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Warning;","// Style\r\nimport './style/App.scss'\r\n\r\n// Main\r\nimport React, { useState, useEffect } from 'react';\r\n\r\nimport Header from './Header';\r\nimport Footer from './Footer';\r\nimport AppRouter from './components/AppRouter';\r\nimport { HashRouter } from 'react-router-dom';\r\nimport { UserStatsContext } from './context/context';\r\nimport { GlobalStatsContext } from './context/context';\r\nimport Warning from './components/UI/warning/Warning';\r\nimport Favicon from 'react-favicon';\r\nimport { Route } from 'react-router-dom';\r\nimport { Routes } from 'react-router-dom';\r\nimport GMXInterface from './views/gmx-test/App/App';\r\n\r\n\r\n\r\nfunction App() {\r\n\tconst [walletAddress, setWalletAddress] = useState('')\r\n\t\r\n\tconst [userStats, setUserStats] = useState({\r\n\t\tbalance: undefined,\r\n\t\tcurBalance: undefined,\r\n\t\tavail: undefined\r\n\t})\r\n\tconst [globalStats, setGlobalStats] = useState(\r\n\t\t{\r\n\t\t\ttotalSupplied: \"\",\r\n\t\t\ttotalBorrowed: \"\",\r\n\t\t\tutilRate: \"\",\r\n\t\t\tavailToBorrow: \"\",\r\n\t\t\tborrowAPY: \"\",\r\n\t\t}\r\n\t)\r\n\t\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<Favicon url=\"https://i.imgur.com/dLCWse0.png\" />\r\n\t\t\t\r\n\t\t\t<GlobalStatsContext.Provider value={{\r\n\t\t\t\tglobalStats,\r\n\t\t\t\tsetGlobalStats\r\n\t\t\t}}>\r\n\t\t\t\t<UserStatsContext.Provider value={{\r\n\t\t\t\t\tuserStats,\r\n\t\t\t\t\tsetUserStats\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<HashRouter>\r\n\t\t\t\t\t\t<div className=\"App\">\r\n\t\t\t\t\t\t\t<Header walletAddress={walletAddress}\r\n\t\t\t\t\t\t\t\tsetWalletAddress={setWalletAddress}\r\n\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t<main className='_container'>\r\n\t\t\t\t\t\t\t\t<AppRouter\r\n\t\t\t\t\t\t\t\t\twalletAddress={walletAddress}\r\n\t\t\t\t\t\t\t\t\tsetWalletAddress={setWalletAddress} />\r\n\t\t\t\t\t\t\t</main>\r\n\r\n\t\t\t\t\t\t\t<Footer></Footer>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</HashRouter>\r\n\t\t\t\t\t\r\n\t\t\t\t</UserStatsContext.Provider>\r\n\t\t\t</GlobalStatsContext.Provider>\r\n\t\t\t<Warning>\r\n\t\t\t\tDeDeLend is in beta. Use at your own risk\r\n\t\t\t</Warning>\r\n\t\t</>\r\n\t\t\r\n\t);\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport App from './App';\r\n\r\nconst root = ReactDOM.createRoot(document.getElementById('root'));\r\nroot.render(\r\n\t<React.StrictMode>\r\n\t\t<App />\r\n\t</React.StrictMode>\r\n);\r\n"],"sourceRoot":""}